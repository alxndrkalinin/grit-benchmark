[100, 200, 500, 1000, 2500, 5000]
[{'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}]
[{'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}, {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}]

Processing n_feats: 100

Processing n_plates: 4

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 44615.51it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:09:56, 42.39s/it]Processing groups:   2%|▏         | 2/100 [00:43<29:25, 18.01s/it]  Processing groups:   5%|▌         | 5/100 [00:45<08:49,  5.57s/it]Processing groups:  23%|██▎       | 23/100 [00:47<01:07,  1.14it/s]Processing groups:  33%|███▎      | 33/100 [01:25<02:18,  2.07s/it]Processing groups:  34%|███▍      | 34/100 [01:27<02:16,  2.07s/it]Processing groups:  38%|███▊      | 38/100 [01:28<01:39,  1.61s/it]Processing groups:  41%|████      | 41/100 [01:29<01:22,  1.39s/it]Processing groups:  50%|█████     | 50/100 [01:30<00:38,  1.31it/s]Processing groups:  53%|█████▎    | 53/100 [01:30<00:30,  1.52it/s]Processing groups:  56%|█████▌    | 56/100 [01:30<00:23,  1.88it/s]Processing groups:  58%|█████▊    | 58/100 [01:32<00:24,  1.72it/s]Processing groups:  62%|██████▏   | 62/100 [01:34<00:21,  1.78it/s]Processing groups:  65%|██████▌   | 65/100 [02:10<02:01,  3.49s/it]Processing groups:  68%|██████▊   | 68/100 [02:10<01:22,  2.59s/it]Processing groups:  70%|███████   | 70/100 [02:11<01:03,  2.11s/it]Processing groups:  72%|███████▏  | 72/100 [02:12<00:49,  1.75s/it]Processing groups:  73%|███████▎  | 73/100 [02:13<00:44,  1.64s/it]Processing groups:  75%|███████▌  | 75/100 [02:14<00:32,  1.32s/it]Processing groups:  86%|████████▌ | 86/100 [02:14<00:06,  2.32it/s]Processing groups:  96%|█████████▌| 96/100 [02:14<00:00,  4.27it/s]Processing groups:  99%|█████████▉| 99/100 [02:19<00:00,  2.25it/s]Processing groups: 100%|██████████| 100/100 [02:19<00:00,  1.39s/it]

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43522.92it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:31, 42.74s/it]Processing groups:   3%|▎         | 3/100 [00:44<18:57, 11.72s/it]  Processing groups:   4%|▍         | 4/100 [00:47<13:59,  8.75s/it]Processing groups:  33%|███▎      | 33/100 [01:27<02:03,  1.84s/it]Processing groups:  37%|███▋      | 37/100 [01:28<01:41,  1.61s/it]Processing groups:  43%|████▎     | 43/100 [01:31<01:15,  1.33s/it]Processing groups:  56%|█████▌    | 56/100 [01:31<00:33,  1.33it/s]Processing groups:  61%|██████    | 61/100 [01:33<00:27,  1.44it/s]Processing groups:  61%|██████    | 61/100 [01:48<00:27,  1.44it/s]Processing groups:  65%|██████▌   | 65/100 [02:11<01:20,  2.30s/it]Processing groups:  79%|███████▉  | 79/100 [02:12<00:25,  1.22s/it]Processing groups:  84%|████████▍ | 84/100 [02:12<00:15,  1.02it/s]Processing groups:  88%|████████▊ | 88/100 [02:12<00:09,  1.21it/s]Processing groups:  91%|█████████ | 91/100 [02:13<00:06,  1.40it/s]Processing groups:  95%|█████████▌| 95/100 [02:13<00:02,  1.81it/s]Processing groups:  98%|█████████▊| 98/100 [02:17<00:01,  1.37it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.38s/it]

Processing n_feats: 200

Processing n_plates: 4

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36682.74it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:13:15, 44.40s/it]Processing groups:   2%|▏         | 2/100 [00:46<31:36, 19.35s/it]  Processing groups:  15%|█▌        | 15/100 [00:46<02:20,  1.65s/it]Processing groups:  21%|██        | 21/100 [00:47<01:26,  1.09s/it]Processing groups:  30%|███       | 30/100 [00:47<00:42,  1.64it/s]Processing groups:  30%|███       | 30/100 [01:00<00:42,  1.64it/s]Processing groups:  33%|███▎      | 33/100 [01:27<03:11,  2.85s/it]Processing groups:  34%|███▍      | 34/100 [01:28<02:57,  2.69s/it]Processing groups:  37%|███▋      | 37/100 [01:30<02:16,  2.17s/it]Processing groups:  39%|███▉      | 39/100 [01:30<01:50,  1.80s/it]Processing groups:  46%|████▌     | 46/100 [01:31<00:50,  1.07it/s]Processing groups:  49%|████▉     | 49/100 [01:32<00:42,  1.21it/s]Processing groups:  51%|█████     | 51/100 [01:32<00:34,  1.44it/s]Processing groups:  54%|█████▍    | 54/100 [01:32<00:23,  1.95it/s]Processing groups:  59%|█████▉    | 59/100 [01:33<00:14,  2.92it/s]Processing groups:  61%|██████    | 61/100 [01:34<00:14,  2.68it/s]Processing groups:  61%|██████    | 61/100 [01:50<00:14,  2.68it/s]Processing groups:  65%|██████▌   | 65/100 [02:11<01:59,  3.43s/it]Processing groups:  66%|██████▌   | 66/100 [02:15<02:02,  3.59s/it]Processing groups:  70%|███████   | 70/100 [02:17<01:09,  2.31s/it]Processing groups:  79%|███████▉  | 79/100 [02:17<00:21,  1.05s/it]Processing groups:  82%|████████▏ | 82/100 [02:17<00:15,  1.17it/s]Processing groups:  97%|█████████▋| 97/100 [02:22<00:01,  1.91it/s]Processing groups:  98%|█████████▊| 98/100 [02:22<00:01,  1.97it/s]Processing groups: 100%|██████████| 100/100 [02:22<00:00,  1.42s/it]

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43559.08it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:18:24, 47.52s/it]Processing groups:  33%|███▎      | 33/100 [01:29<02:33,  2.29s/it] Processing groups:  35%|███▌      | 35/100 [01:32<02:25,  2.24s/it]Processing groups:  45%|████▌     | 45/100 [01:36<01:25,  1.56s/it]Processing groups:  65%|██████▌   | 65/100 [02:13<00:59,  1.71s/it]Processing groups:  66%|██████▌   | 66/100 [02:13<00:56,  1.66s/it]Processing groups:  67%|██████▋   | 67/100 [02:15<00:54,  1.65s/it]Processing groups:  68%|██████▊   | 68/100 [02:15<00:50,  1.57s/it]Processing groups:  73%|███████▎  | 73/100 [02:16<00:30,  1.12s/it]Processing groups:  88%|████████▊ | 88/100 [02:16<00:05,  2.05it/s]Processing groups:  95%|█████████▌| 95/100 [02:16<00:01,  2.72it/s]Processing groups:  98%|█████████▊| 98/100 [02:21<00:01,  1.86it/s]Processing groups: 100%|██████████| 100/100 [02:21<00:00,  1.41s/it]

Processing n_feats: 500

Processing n_plates: 4

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.61it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33002.63it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:20:43, 48.92s/it]Processing groups:   3%|▎         | 3/100 [00:50<21:11, 13.11s/it]  Processing groups:  21%|██        | 21/100 [00:50<01:39,  1.25s/it]Processing groups:  28%|██▊       | 28/100 [00:50<01:01,  1.17it/s]Processing groups:  28%|██▊       | 28/100 [01:03<01:01,  1.17it/s]Processing groups:  33%|███▎      | 33/100 [01:32<03:06,  2.78s/it]Processing groups:  34%|███▍      | 34/100 [01:33<02:52,  2.61s/it]Processing groups:  37%|███▋      | 37/100 [01:37<02:27,  2.34s/it]Processing groups:  40%|████      | 40/100 [01:38<01:50,  1.85s/it]Processing groups:  49%|████▉     | 49/100 [01:42<00:57,  1.14s/it]Processing groups:  61%|██████    | 61/100 [01:42<00:22,  1.71it/s]Processing groups:  61%|██████    | 61/100 [01:53<00:22,  1.71it/s]Processing groups:  65%|██████▌   | 65/100 [02:23<01:24,  2.41s/it]Processing groups:  67%|██████▋   | 67/100 [02:24<01:11,  2.18s/it]Processing groups:  77%|███████▋  | 77/100 [02:24<00:27,  1.21s/it]Processing groups:  81%|████████  | 81/100 [02:25<00:18,  1.03it/s]Processing groups:  83%|████████▎ | 83/100 [02:25<00:14,  1.16it/s]Processing groups:  93%|█████████▎| 93/100 [02:25<00:03,  2.16it/s]Processing groups:  95%|█████████▌| 95/100 [02:26<00:02,  2.37it/s]Processing groups:  97%|█████████▋| 97/100 [02:29<00:01,  1.58it/s]Processing groups:  99%|█████████▉| 99/100 [02:30<00:00,  1.65it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  1.51s/it]

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.27it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41527.76it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:22:20, 49.90s/it]Processing groups:   8%|▊         | 8/100 [00:51<07:16,  4.74s/it]  Processing groups:  10%|█         | 10/100 [00:51<05:14,  3.49s/it]Processing groups:  33%|███▎      | 33/100 [01:34<02:25,  2.18s/it]Processing groups:  36%|███▌      | 36/100 [01:35<02:01,  1.90s/it]Processing groups:  40%|████      | 40/100 [01:37<01:37,  1.62s/it]Processing groups:  42%|████▏     | 42/100 [01:38<01:25,  1.47s/it]Processing groups:  47%|████▋     | 47/100 [01:42<01:06,  1.26s/it]Processing groups:  65%|██████▌   | 65/100 [02:15<00:57,  1.63s/it]Processing groups:  66%|██████▌   | 66/100 [02:20<01:00,  1.79s/it]Processing groups:  69%|██████▉   | 69/100 [02:21<00:47,  1.52s/it]Processing groups:  71%|███████   | 71/100 [02:21<00:39,  1.36s/it]Processing groups:  73%|███████▎  | 73/100 [02:24<00:35,  1.33s/it]Processing groups:  76%|███████▌  | 76/100 [02:24<00:25,  1.05s/it]Processing groups:  78%|███████▊  | 78/100 [02:25<00:19,  1.14it/s]Processing groups:  83%|████████▎ | 83/100 [02:25<00:09,  1.80it/s]Processing groups:  92%|█████████▏| 92/100 [02:26<00:02,  3.55it/s]Processing groups:  96%|█████████▌| 96/100 [02:26<00:00,  4.35it/s]Processing groups:  98%|█████████▊| 98/100 [02:30<00:00,  2.04it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  2.37it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  1.51s/it]

Processing n_feats: 1000

Processing n_plates: 4

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.49it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28984.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:19:16, 48.05s/it]Processing groups:   3%|▎         | 3/100 [00:48<20:31, 12.70s/it]  Processing groups:   5%|▌         | 5/100 [00:49<10:02,  6.34s/it]Processing groups:   6%|▌         | 6/100 [00:50<07:57,  5.08s/it]Processing groups:  21%|██        | 21/100 [00:52<01:04,  1.22it/s]Processing groups:  33%|███▎      | 33/100 [01:34<02:23,  2.15s/it]Processing groups:  34%|███▍      | 34/100 [01:34<02:15,  2.05s/it]Processing groups:  36%|███▌      | 36/100 [01:36<02:01,  1.89s/it]Processing groups:  37%|███▋      | 37/100 [01:36<01:49,  1.74s/it]Processing groups:  40%|████      | 40/100 [01:37<01:19,  1.33s/it]Processing groups:  42%|████▏     | 42/100 [01:37<01:03,  1.10s/it]Processing groups:  46%|████▌     | 46/100 [01:38<00:41,  1.32it/s]Processing groups:  47%|████▋     | 47/100 [01:41<00:55,  1.05s/it]Processing groups:  64%|██████▍   | 64/100 [01:43<00:11,  3.07it/s]Processing groups:  65%|██████▌   | 65/100 [02:23<01:34,  2.69s/it]Processing groups:  66%|██████▌   | 66/100 [02:24<01:26,  2.56s/it]Processing groups:  69%|██████▉   | 69/100 [02:25<01:01,  1.98s/it]Processing groups:  71%|███████   | 71/100 [02:26<00:49,  1.70s/it]Processing groups:  72%|███████▏  | 72/100 [02:27<00:43,  1.56s/it]Processing groups:  76%|███████▌  | 76/100 [02:27<00:22,  1.06it/s]Processing groups:  80%|████████  | 80/100 [02:28<00:14,  1.40it/s]Processing groups:  81%|████████  | 81/100 [02:28<00:12,  1.54it/s]Processing groups:  90%|█████████ | 90/100 [02:29<00:02,  3.49it/s]Processing groups:  97%|█████████▋| 97/100 [02:33<00:01,  2.40it/s]Processing groups:  98%|█████████▊| 98/100 [02:33<00:00,  2.46it/s]Processing groups: 100%|██████████| 100/100 [02:33<00:00,  2.90it/s]Processing groups: 100%|██████████| 100/100 [02:33<00:00,  1.54s/it]

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.62it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28031.17it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:15:46, 45.92s/it]Processing groups:   2%|▏         | 2/100 [00:53<38:15, 23.42s/it]  Processing groups:  33%|███▎      | 33/100 [01:34<02:23,  2.14s/it]Processing groups:  35%|███▌      | 35/100 [01:36<02:11,  2.03s/it]Processing groups:  36%|███▌      | 36/100 [01:37<02:06,  1.98s/it]Processing groups:  38%|███▊      | 38/100 [01:40<01:58,  1.91s/it]Processing groups:  49%|████▉     | 49/100 [01:41<00:50,  1.00it/s]Processing groups:  50%|█████     | 50/100 [01:42<00:48,  1.03it/s]Processing groups:  63%|██████▎   | 63/100 [01:44<00:19,  1.92it/s]Processing groups:  65%|██████▌   | 65/100 [02:23<01:29,  2.57s/it]Processing groups:  66%|██████▌   | 66/100 [02:24<01:22,  2.43s/it]Processing groups:  67%|██████▋   | 67/100 [02:26<01:20,  2.42s/it]Processing groups:  71%|███████   | 71/100 [02:28<00:49,  1.71s/it]Processing groups:  78%|███████▊  | 78/100 [02:28<00:20,  1.06it/s]Processing groups:  80%|████████  | 80/100 [02:28<00:16,  1.21it/s]Processing groups:  81%|████████  | 81/100 [02:29<00:14,  1.29it/s]Processing groups:  82%|████████▏ | 82/100 [02:29<00:13,  1.38it/s]Processing groups:  83%|████████▎ | 83/100 [02:30<00:12,  1.41it/s]Processing groups:  97%|█████████▋| 97/100 [02:33<00:01,  2.76it/s]Processing groups:  98%|█████████▊| 98/100 [02:35<00:00,  2.34it/s]Processing groups: 100%|██████████| 100/100 [02:35<00:00,  1.55s/it]

Processing n_feats: 2500

Processing n_plates: 4

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.01s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1232.60it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:18:03, 47.31s/it]Processing groups:   2%|▏         | 2/100 [00:48<32:52, 20.13s/it]  Processing groups:   3%|▎         | 3/100 [00:48<17:55, 11.09s/it]Processing groups:   4%|▍         | 4/100 [00:50<11:58,  7.49s/it]Processing groups:   7%|▋         | 7/100 [00:53<05:09,  3.32s/it]Processing groups:  12%|█▏        | 12/100 [00:54<02:07,  1.45s/it]Processing groups:  33%|███▎      | 33/100 [01:35<02:03,  1.84s/it]Processing groups:  34%|███▍      | 34/100 [01:35<01:55,  1.75s/it]Processing groups:  35%|███▌      | 35/100 [01:37<01:54,  1.76s/it]Processing groups:  36%|███▌      | 36/100 [01:39<01:57,  1.84s/it]Processing groups:  44%|████▍     | 44/100 [01:42<01:00,  1.07s/it]Processing groups:  51%|█████     | 51/100 [01:42<00:33,  1.48it/s]Processing groups:  55%|█████▌    | 55/100 [01:44<00:28,  1.60it/s]Processing groups:  63%|██████▎   | 63/100 [01:45<00:15,  2.36it/s]Processing groups:  65%|██████▌   | 65/100 [02:25<01:40,  2.87s/it]Processing groups:  66%|██████▌   | 66/100 [02:26<01:34,  2.79s/it]Processing groups:  70%|███████   | 70/100 [02:27<00:59,  1.98s/it]Processing groups:  75%|███████▌  | 75/100 [02:29<00:33,  1.33s/it]Processing groups:  76%|███████▌  | 76/100 [02:29<00:31,  1.30s/it]Processing groups:  96%|█████████▌| 96/100 [02:30<00:01,  2.75it/s]Processing groups:  99%|█████████▉| 99/100 [02:34<00:00,  1.91it/s]Processing groups: 100%|██████████| 100/100 [02:35<00:00,  1.55s/it]

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.04s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 18282.21it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:23:00, 50.31s/it]Processing groups:   5%|▌         | 5/100 [00:56<13:57,  8.81s/it]  Processing groups:  33%|███▎      | 33/100 [01:37<02:29,  2.23s/it]Processing groups:  36%|███▌      | 36/100 [01:40<02:13,  2.09s/it]Processing groups:  37%|███▋      | 37/100 [01:41<02:09,  2.05s/it]Processing groups:  47%|████▋     | 47/100 [01:42<01:02,  1.18s/it]Processing groups:  48%|████▊     | 48/100 [01:43<01:02,  1.20s/it]Processing groups:  54%|█████▍    | 54/100 [01:44<00:37,  1.23it/s]Processing groups:  57%|█████▋    | 57/100 [01:45<00:30,  1.39it/s]Processing groups:  59%|█████▉    | 59/100 [01:45<00:25,  1.62it/s]Processing groups:  64%|██████▍   | 64/100 [01:48<00:23,  1.56it/s]Processing groups:  65%|██████▌   | 65/100 [02:25<02:18,  3.96s/it]Processing groups:  67%|██████▋   | 67/100 [02:29<01:57,  3.57s/it]Processing groups:  73%|███████▎  | 73/100 [02:30<00:52,  1.95s/it]Processing groups:  76%|███████▌  | 76/100 [02:31<00:37,  1.54s/it]Processing groups:  82%|████████▏ | 82/100 [02:32<00:17,  1.05it/s]Processing groups:  94%|█████████▍| 94/100 [02:32<00:02,  2.23it/s]Processing groups:  96%|█████████▌| 96/100 [02:32<00:01,  2.35it/s]Processing groups:  98%|█████████▊| 98/100 [02:37<00:01,  1.50it/s]Processing groups: 100%|██████████| 100/100 [02:37<00:00,  1.57s/it]

Processing n_feats: 5000

Processing n_plates: 4

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  9.91it/s]                                               0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.30s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8011.12it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:22:32, 50.02s/it]Processing groups:   4%|▍         | 4/100 [00:51<15:45,  9.85s/it]  Processing groups:   7%|▋         | 7/100 [00:52<07:21,  4.74s/it]Processing groups:   9%|▉         | 9/100 [00:53<04:54,  3.24s/it]Processing groups:  17%|█▋        | 17/100 [00:56<01:54,  1.38s/it]Processing groups:  33%|███▎      | 33/100 [01:32<02:10,  1.95s/it]Processing groups:  34%|███▍      | 34/100 [01:36<02:17,  2.08s/it]Processing groups:  35%|███▌      | 35/100 [01:38<02:15,  2.08s/it]Processing groups:  37%|███▋      | 37/100 [01:39<01:50,  1.75s/it]Processing groups:  38%|███▊      | 38/100 [01:39<01:37,  1.57s/it]Processing groups:  40%|████      | 40/100 [01:44<01:46,  1.78s/it]Processing groups:  49%|████▉     | 49/100 [01:44<00:37,  1.37it/s]Processing groups:  57%|█████▋    | 57/100 [01:44<00:18,  2.36it/s]Processing groups:  59%|█████▉    | 59/100 [01:45<00:16,  2.47it/s]Processing groups:  63%|██████▎   | 63/100 [01:45<00:11,  3.16it/s]Processing groups:  63%|██████▎   | 63/100 [02:05<00:11,  3.16it/s]Processing groups:  65%|██████▌   | 65/100 [02:21<01:53,  3.25s/it]Processing groups:  66%|██████▌   | 66/100 [02:22<01:42,  3.01s/it]Processing groups:  67%|██████▋   | 67/100 [02:28<01:51,  3.38s/it]Processing groups:  68%|██████▊   | 68/100 [02:30<01:40,  3.13s/it]Processing groups:  75%|███████▌  | 75/100 [02:31<00:31,  1.27s/it]Processing groups:  79%|███████▉  | 79/100 [02:31<00:18,  1.13it/s]Processing groups:  80%|████████  | 80/100 [02:32<00:17,  1.14it/s]Processing groups:  82%|████████▏ | 82/100 [02:32<00:12,  1.41it/s]Processing groups:  87%|████████▋ | 87/100 [02:32<00:05,  2.42it/s]Processing groups:  94%|█████████▍| 94/100 [02:33<00:01,  4.32it/s]Processing groups:  96%|█████████▌| 96/100 [02:33<00:00,  4.26it/s]Processing groups:  98%|█████████▊| 98/100 [02:37<00:01,  1.82it/s]Processing groups:  99%|█████████▉| 99/100 [02:37<00:00,  1.98it/s]Processing groups: 100%|██████████| 100/100 [02:37<00:00,  1.58s/it]

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.27s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 7206.71it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:26:40, 52.53s/it]Processing groups:   6%|▌         | 6/100 [00:55<10:56,  6.98s/it]  Processing groups:  28%|██▊       | 28/100 [00:58<01:24,  1.17s/it]Processing groups:  33%|███▎      | 33/100 [01:33<02:44,  2.46s/it]Processing groups:  34%|███▍      | 34/100 [01:34<02:36,  2.37s/it]Processing groups:  35%|███▌      | 35/100 [01:38<02:39,  2.45s/it]Processing groups:  37%|███▋      | 37/100 [01:41<02:24,  2.29s/it]Processing groups:  42%|████▏     | 42/100 [01:42<01:26,  1.48s/it]Processing groups:  48%|████▊     | 48/100 [01:44<00:54,  1.05s/it]Processing groups:  55%|█████▌    | 55/100 [01:45<00:30,  1.48it/s]Processing groups:  64%|██████▍   | 64/100 [01:47<00:16,  2.17it/s]Processing groups:  65%|██████▌   | 65/100 [02:24<01:36,  2.77s/it]Processing groups:  68%|██████▊   | 68/100 [02:24<01:10,  2.21s/it]Processing groups:  69%|██████▉   | 69/100 [02:25<01:05,  2.13s/it]Processing groups:  70%|███████   | 70/100 [02:27<01:02,  2.07s/it]Processing groups:  72%|███████▏  | 72/100 [02:28<00:47,  1.69s/it]Processing groups:  74%|███████▍  | 74/100 [02:28<00:32,  1.27s/it]Processing groups:  79%|███████▉  | 79/100 [02:29<00:14,  1.45it/s]Processing groups:  83%|████████▎ | 83/100 [02:29<00:08,  1.96it/s]Processing groups:  86%|████████▌ | 86/100 [02:30<00:05,  2.41it/s]Processing groups:  94%|█████████▍| 94/100 [02:30<00:01,  4.36it/s]Processing groups:  97%|█████████▋| 97/100 [02:35<00:01,  2.08it/s]Processing groups:  98%|█████████▊| 98/100 [02:35<00:00,  2.23it/s]Processing groups: 100%|██████████| 100/100 [02:35<00:00,  1.55s/it]
[{'replicate_reproducibility': 0.01, 'mp_value': 0.25, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.52, 'mean_ap': 0.01, 'mean_ap_p_value': 0.43, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.011666666666666667, 'mp_value': 0.18, 'mean_ap': 0.0, 'mean_ap_p_value': 0.07, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.24, 'mean_ap': 0.0, 'mean_ap_p_value': 0.18, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.023333333333333334, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.025, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.01, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.035, 'mp_value': 0.07, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.03166666666666667, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.03666666666666667, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}]
