[100, 200, 500, 1000, 2500, 5000]
[{'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}]
[{'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}, {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}, {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}, {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}, {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}, {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}, {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0}]

Processing n_feats: 100

Processing n_plates: 2

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 42612.05it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:25<42:10, 25.56s/it]Processing groups:   2%|▏         | 2/100 [00:28<19:59, 12.24s/it]Processing groups:   3%|▎         | 3/100 [00:29<11:10,  6.91s/it]Processing groups:   4%|▍         | 4/100 [00:31<07:59,  4.99s/it]Processing groups:   9%|▉         | 9/100 [00:35<02:59,  1.97s/it]Processing groups:  33%|███▎      | 33/100 [00:55<01:07,  1.01s/it]Processing groups:  35%|███▌      | 35/100 [00:57<01:07,  1.03s/it]Processing groups:  37%|███▋      | 37/100 [01:00<01:07,  1.07s/it]Processing groups:  38%|███▊      | 38/100 [01:02<01:10,  1.14s/it]Processing groups:  40%|████      | 40/100 [01:06<01:19,  1.32s/it]Processing groups:  49%|████▉     | 49/100 [01:07<00:32,  1.58it/s]Processing groups:  55%|█████▌    | 55/100 [01:08<00:21,  2.10it/s]Processing groups:  65%|██████▌   | 65/100 [01:23<00:33,  1.06it/s]Processing groups:  66%|██████▌   | 66/100 [01:29<00:43,  1.27s/it]Processing groups:  68%|██████▊   | 68/100 [01:31<00:37,  1.18s/it]Processing groups:  70%|███████   | 70/100 [01:35<00:41,  1.37s/it]Processing groups:  74%|███████▍  | 74/100 [01:36<00:25,  1.01it/s]Processing groups:  94%|█████████▍| 94/100 [01:36<00:01,  3.34it/s]Processing groups:  99%|█████████▉| 99/100 [01:38<00:00,  3.12it/s]Processing groups: 100%|██████████| 100/100 [01:38<00:00,  1.01it/s]
{'replicate_reproducibility': 0.01, 'mp_value': 0.03, 'mean_ap': 0.14, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39475.80it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:27<45:52, 27.81s/it]Processing groups:   2%|▏         | 2/100 [00:30<21:09, 12.95s/it]Processing groups:   8%|▊         | 8/100 [00:33<03:58,  2.59s/it]Processing groups:  26%|██▌       | 26/100 [00:34<00:44,  1.68it/s]Processing groups:  29%|██▉       | 29/100 [00:37<00:47,  1.49it/s]Processing groups:  33%|███▎      | 33/100 [00:57<01:53,  1.69s/it]Processing groups:  34%|███▍      | 34/100 [00:58<01:44,  1.59s/it]Processing groups:  35%|███▌      | 35/100 [00:59<01:38,  1.52s/it]Processing groups:  38%|███▊      | 38/100 [00:59<01:08,  1.11s/it]Processing groups:  39%|███▉      | 39/100 [01:01<01:16,  1.26s/it]Processing groups:  41%|████      | 41/100 [01:02<00:57,  1.03it/s]Processing groups:  42%|████▏     | 42/100 [01:03<00:57,  1.01it/s]Processing groups:  48%|████▊     | 48/100 [01:03<00:23,  2.19it/s]Processing groups:  49%|████▉     | 49/100 [01:04<00:25,  1.96it/s]Processing groups:  54%|█████▍    | 54/100 [01:10<00:38,  1.18it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<00:51,  1.47s/it]Processing groups:  68%|██████▊   | 68/100 [01:32<00:39,  1.24s/it]Processing groups:  70%|███████   | 70/100 [01:32<00:32,  1.09s/it]Processing groups:  71%|███████   | 71/100 [01:33<00:31,  1.09s/it]Processing groups:  73%|███████▎  | 73/100 [01:34<00:23,  1.14it/s]Processing groups:  77%|███████▋  | 77/100 [01:34<00:13,  1.70it/s]Processing groups:  82%|████████▏ | 82/100 [01:35<00:07,  2.54it/s]Processing groups:  86%|████████▌ | 86/100 [01:35<00:04,  3.35it/s]Processing groups:  90%|█████████ | 90/100 [01:36<00:02,  4.06it/s]Processing groups:  93%|█████████▎| 93/100 [01:36<00:01,  4.99it/s]Processing groups:  95%|█████████▌| 95/100 [01:36<00:01,  4.44it/s]Processing groups:  96%|█████████▌| 96/100 [01:37<00:00,  4.67it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:01,  2.88it/s]Processing groups:  98%|█████████▊| 98/100 [01:39<00:00,  2.30it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.04, 'mp_value': 0.06, 'mean_ap': 0.12, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38116.18it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:26<43:33, 26.40s/it]Processing groups:   2%|▏         | 2/100 [00:32<23:33, 14.42s/it]Processing groups:   3%|▎         | 3/100 [00:32<12:52,  7.96s/it]Processing groups:  16%|█▌        | 16/100 [00:34<01:20,  1.04it/s]Processing groups:  26%|██▌       | 26/100 [00:35<00:38,  1.92it/s]Processing groups:  33%|███▎      | 33/100 [00:56<01:31,  1.36s/it]Processing groups:  34%|███▍      | 34/100 [00:57<01:29,  1.35s/it]Processing groups:  35%|███▌      | 35/100 [01:00<01:33,  1.45s/it]Processing groups:  37%|███▋      | 37/100 [01:00<01:15,  1.21s/it]Processing groups:  39%|███▉      | 39/100 [01:03<01:15,  1.23s/it]Processing groups:  43%|████▎     | 43/100 [01:03<00:44,  1.27it/s]Processing groups:  44%|████▍     | 44/100 [01:04<00:43,  1.30it/s]Processing groups:  47%|████▋     | 47/100 [01:06<00:38,  1.36it/s]Processing groups:  49%|████▉     | 49/100 [01:08<00:43,  1.16it/s]Processing groups:  65%|██████▌   | 65/100 [01:28<00:39,  1.13s/it]Processing groups:  68%|██████▊   | 68/100 [01:28<00:30,  1.05it/s]Processing groups:  70%|███████   | 70/100 [01:34<00:37,  1.24s/it]Processing groups:  77%|███████▋  | 77/100 [01:34<00:17,  1.34it/s]Processing groups:  82%|████████▏ | 82/100 [01:35<00:10,  1.70it/s]Processing groups:  84%|████████▍ | 84/100 [01:36<00:08,  1.80it/s]Processing groups:  86%|████████▌ | 86/100 [01:37<00:07,  1.90it/s]Processing groups:  97%|█████████▋| 97/100 [01:39<00:00,  3.12it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.02, 'mp_value': 0.02, 'mean_ap': 0.11, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 42294.08it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:28, 33.62s/it]Processing groups:   4%|▍         | 4/100 [00:46<15:40,  9.80s/it]Processing groups:  33%|███▎      | 33/100 [00:57<01:16,  1.15s/it]Processing groups:  34%|███▍      | 34/100 [01:01<01:23,  1.27s/it]Processing groups:  35%|███▌      | 35/100 [01:01<01:18,  1.20s/it]Processing groups:  38%|███▊      | 38/100 [01:05<01:16,  1.23s/it]Processing groups:  48%|████▊     | 48/100 [01:06<00:35,  1.47it/s]Processing groups:  56%|█████▌    | 56/100 [01:08<00:23,  1.88it/s]Processing groups:  57%|█████▋    | 57/100 [01:08<00:21,  1.97it/s]Processing groups:  61%|██████    | 61/100 [01:09<00:16,  2.42it/s]Processing groups:  62%|██████▏   | 62/100 [01:09<00:14,  2.55it/s]Processing groups:  63%|██████▎   | 63/100 [01:10<00:17,  2.14it/s]Processing groups:  64%|██████▍   | 64/100 [01:18<00:54,  1.52s/it]Processing groups:  65%|██████▌   | 65/100 [01:26<01:30,  2.58s/it]Processing groups:  66%|██████▌   | 66/100 [01:29<01:29,  2.62s/it]Processing groups:  67%|██████▋   | 67/100 [01:31<01:22,  2.50s/it]Processing groups:  68%|██████▊   | 68/100 [01:33<01:15,  2.35s/it]Processing groups:  73%|███████▎  | 73/100 [01:37<00:37,  1.39s/it]Processing groups:  96%|█████████▌| 96/100 [01:39<00:01,  3.09it/s]Processing groups:  97%|█████████▋| 97/100 [01:40<00:01,  2.82it/s]Processing groups:  98%|█████████▊| 98/100 [01:40<00:00,  2.95it/s]Processing groups: 100%|██████████| 100/100 [01:40<00:00,  1.00s/it]
{'replicate_reproducibility': 0.04, 'mp_value': 0.1, 'mean_ap': 0.13, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1203.10it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:28<46:57, 28.46s/it]Processing groups:   5%|▌         | 5/100 [00:31<07:53,  4.99s/it]Processing groups:   6%|▌         | 6/100 [00:32<06:04,  3.88s/it]Processing groups:   7%|▋         | 7/100 [00:32<04:36,  2.97s/it]Processing groups:  10%|█         | 10/100 [00:34<02:34,  1.71s/it]Processing groups:  24%|██▍       | 24/100 [00:35<00:35,  2.15it/s]Processing groups:  29%|██▉       | 29/100 [00:35<00:25,  2.80it/s]Processing groups:  33%|███▎      | 33/100 [00:56<01:42,  1.53s/it]Processing groups:  34%|███▍      | 34/100 [01:01<02:00,  1.83s/it]Processing groups:  35%|███▌      | 35/100 [01:01<01:47,  1.66s/it]Processing groups:  36%|███▌      | 36/100 [01:02<01:33,  1.46s/it]Processing groups:  40%|████      | 40/100 [01:03<01:00,  1.00s/it]Processing groups:  44%|████▍     | 44/100 [01:04<00:41,  1.35it/s]Processing groups:  46%|████▌     | 46/100 [01:05<00:35,  1.54it/s]Processing groups:  53%|█████▎    | 53/100 [01:05<00:15,  2.99it/s]Processing groups:  55%|█████▌    | 55/100 [01:08<00:22,  2.02it/s]Processing groups:  64%|██████▍   | 64/100 [01:10<00:13,  2.59it/s]Processing groups:  65%|██████▌   | 65/100 [01:27<00:58,  1.66s/it]Processing groups:  66%|██████▌   | 66/100 [01:29<00:55,  1.64s/it]Processing groups:  67%|██████▋   | 67/100 [01:30<00:54,  1.64s/it]Processing groups:  68%|██████▊   | 68/100 [01:32<00:53,  1.67s/it]Processing groups:  70%|███████   | 70/100 [01:33<00:39,  1.31s/it]Processing groups:  73%|███████▎  | 73/100 [01:33<00:22,  1.19it/s]Processing groups:  78%|███████▊  | 78/100 [01:34<00:10,  2.09it/s]Processing groups:  80%|████████  | 80/100 [01:35<00:10,  1.97it/s]Processing groups:  88%|████████▊ | 88/100 [01:36<00:03,  3.67it/s]Processing groups:  93%|█████████▎| 93/100 [01:36<00:01,  4.94it/s]Processing groups:  96%|█████████▌| 96/100 [01:36<00:00,  5.94it/s]Processing groups:  98%|█████████▊| 98/100 [01:39<00:00,  2.93it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.3, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39045.84it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:51, 33.85s/it]Processing groups:  16%|█▌        | 16/100 [00:34<02:12,  1.57s/it]Processing groups:  21%|██        | 21/100 [00:36<01:31,  1.16s/it]Processing groups:  33%|███▎      | 33/100 [00:56<01:36,  1.44s/it]Processing groups:  34%|███▍      | 34/100 [00:58<01:35,  1.45s/it]Processing groups:  35%|███▌      | 35/100 [00:59<01:32,  1.42s/it]Processing groups:  36%|███▌      | 36/100 [01:00<01:28,  1.39s/it]Processing groups:  37%|███▋      | 37/100 [01:01<01:22,  1.31s/it]Processing groups:  39%|███▉      | 39/100 [01:01<01:04,  1.06s/it]Processing groups:  40%|████      | 40/100 [01:02<01:02,  1.04s/it]Processing groups:  46%|████▌     | 46/100 [01:02<00:25,  2.15it/s]Processing groups:  47%|████▋     | 47/100 [01:05<00:40,  1.32it/s]Processing groups:  51%|█████     | 51/100 [01:06<00:23,  2.10it/s]Processing groups:  58%|█████▊    | 58/100 [01:07<00:13,  3.17it/s]Processing groups:  59%|█████▉    | 59/100 [01:08<00:15,  2.57it/s]Processing groups:  61%|██████    | 61/100 [01:08<00:14,  2.65it/s]Processing groups:  65%|██████▌   | 65/100 [01:29<01:14,  2.12s/it]Processing groups:  66%|██████▌   | 66/100 [01:31<01:14,  2.20s/it]Processing groups:  69%|██████▉   | 69/100 [01:32<00:49,  1.58s/it]Processing groups:  70%|███████   | 70/100 [01:35<00:53,  1.78s/it]Processing groups:  86%|████████▌ | 86/100 [01:36<00:06,  2.30it/s]Processing groups:  90%|█████████ | 90/100 [01:36<00:03,  2.60it/s]Processing groups:  95%|█████████▌| 95/100 [01:37<00:01,  3.19it/s]Processing groups:  97%|█████████▋| 97/100 [01:39<00:01,  2.52it/s]Processing groups:  99%|█████████▉| 99/100 [01:39<00:00,  2.90it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.00it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.24, 'mean_ap': 0.7, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31681.43it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:26<44:02, 26.69s/it]Processing groups:   2%|▏         | 2/100 [00:32<23:10, 14.19s/it]Processing groups:  14%|█▍        | 14/100 [00:32<01:54,  1.33s/it]Processing groups:  17%|█▋        | 17/100 [00:33<01:28,  1.07s/it]Processing groups:  23%|██▎       | 23/100 [00:35<00:57,  1.34it/s]Processing groups:  28%|██▊       | 28/100 [00:36<00:42,  1.68it/s]Processing groups:  33%|███▎      | 33/100 [00:55<01:48,  1.63s/it]Processing groups:  34%|███▍      | 34/100 [01:02<02:16,  2.07s/it]Processing groups:  49%|████▉     | 49/100 [01:03<00:40,  1.26it/s]Processing groups:  51%|█████     | 51/100 [01:08<00:47,  1.03it/s]Processing groups:  61%|██████    | 61/100 [01:09<00:21,  1.78it/s]Processing groups:  63%|██████▎   | 63/100 [01:11<00:22,  1.66it/s]Processing groups:  65%|██████▌   | 65/100 [01:27<00:58,  1.67s/it]Processing groups:  66%|██████▌   | 66/100 [01:32<01:05,  1.94s/it]Processing groups:  67%|██████▋   | 67/100 [01:33<00:59,  1.81s/it]Processing groups:  68%|██████▊   | 68/100 [01:35<00:58,  1.83s/it]Processing groups:  73%|███████▎  | 73/100 [01:36<00:27,  1.01s/it]Processing groups:  91%|█████████ | 91/100 [01:36<00:02,  3.37it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:00,  3.10it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  3.57it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 0.95, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43071.51it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<57:32, 34.87s/it]Processing groups:   6%|▌         | 6/100 [00:37<07:19,  4.68s/it]Processing groups:  33%|███▎      | 33/100 [01:05<01:42,  1.53s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:37,  1.47s/it]Processing groups:  35%|███▌      | 35/100 [01:07<01:34,  1.46s/it]Processing groups:  36%|███▌      | 36/100 [01:07<01:27,  1.36s/it]Processing groups:  40%|████      | 40/100 [01:10<01:11,  1.19s/it]Processing groups:  43%|████▎     | 43/100 [01:11<00:55,  1.02it/s]Processing groups:  51%|█████     | 51/100 [01:12<00:27,  1.81it/s]Processing groups:  54%|█████▍    | 54/100 [01:13<00:22,  2.05it/s]Processing groups:  58%|█████▊    | 58/100 [01:13<00:16,  2.58it/s]Processing groups:  61%|██████    | 61/100 [01:14<00:13,  2.86it/s]Processing groups:  65%|██████▌   | 65/100 [01:41<01:20,  2.30s/it]Processing groups:  72%|███████▏  | 72/100 [01:42<00:38,  1.38s/it]Processing groups:  76%|███████▌  | 76/100 [01:43<00:25,  1.07s/it]Processing groups:  83%|████████▎ | 83/100 [01:44<00:11,  1.43it/s]Processing groups:  92%|█████████▏| 92/100 [01:45<00:03,  2.21it/s]Processing groups:  97%|█████████▋| 97/100 [01:47<00:01,  2.34it/s]Processing groups:  98%|█████████▊| 98/100 [01:47<00:00,  2.20it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.08s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.09, 'mean_ap': 0.01, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39364.66it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<54:35, 33.09s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:33, 14.42s/it]Processing groups:   7%|▋         | 7/100 [00:35<04:38,  2.99s/it]Processing groups:   9%|▉         | 9/100 [00:37<03:25,  2.26s/it]Processing groups:  33%|███▎      | 33/100 [00:58<01:13,  1.10s/it]Processing groups:  34%|███▍      | 34/100 [01:04<01:28,  1.34s/it]Processing groups:  35%|███▌      | 35/100 [01:06<01:30,  1.40s/it]Processing groups:  39%|███▉      | 39/100 [01:13<01:30,  1.48s/it]Processing groups:  59%|█████▉    | 59/100 [01:14<00:21,  1.90it/s]Processing groups:  65%|██████▌   | 65/100 [01:33<00:38,  1.10s/it]Processing groups:  66%|██████▌   | 66/100 [01:41<00:50,  1.49s/it]Processing groups:  80%|████████  | 80/100 [01:42<00:15,  1.30it/s]Processing groups:  83%|████████▎ | 83/100 [01:43<00:11,  1.43it/s]Processing groups:  86%|████████▌ | 86/100 [01:43<00:08,  1.67it/s]Processing groups:  90%|█████████ | 90/100 [01:44<00:05,  1.98it/s]Processing groups:  92%|█████████▏| 92/100 [01:44<00:03,  2.21it/s]Processing groups:  96%|█████████▌| 96/100 [01:44<00:01,  2.98it/s]Processing groups:  98%|█████████▊| 98/100 [01:47<00:00,  2.04it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.07s/it]
{'replicate_reproducibility': 0.05, 'mp_value': 0.08, 'mean_ap': 0.01, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29589.45it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<54:13, 32.86s/it]Processing groups:   6%|▌         | 6/100 [00:34<06:40,  4.26s/it]Processing groups:  13%|█▎        | 13/100 [00:34<02:19,  1.60s/it]Processing groups:  20%|██        | 20/100 [00:35<01:10,  1.13it/s]Processing groups:  24%|██▍       | 24/100 [00:35<00:50,  1.51it/s]Processing groups:  26%|██▌       | 26/100 [00:36<00:43,  1.72it/s]Processing groups:  27%|██▋       | 27/100 [00:36<00:39,  1.87it/s]Processing groups:  30%|███       | 30/100 [00:38<00:41,  1.69it/s]Processing groups:  33%|███▎      | 33/100 [01:01<03:05,  2.77s/it]Processing groups:  34%|███▍      | 34/100 [01:03<02:57,  2.69s/it]Processing groups:  36%|███▌      | 36/100 [01:04<02:12,  2.08s/it]Processing groups:  37%|███▋      | 37/100 [01:04<01:56,  1.84s/it]Processing groups:  38%|███▊      | 38/100 [01:09<02:30,  2.42s/it]Processing groups:  42%|████▏     | 42/100 [01:11<01:17,  1.33s/it]Processing groups:  53%|█████▎    | 53/100 [01:11<00:21,  2.17it/s]Processing groups:  58%|█████▊    | 58/100 [01:13<00:18,  2.32it/s]Processing groups:  60%|██████    | 60/100 [01:15<00:21,  1.85it/s]Processing groups:  64%|██████▍   | 64/100 [01:17<00:19,  1.84it/s]Processing groups:  65%|██████▌   | 65/100 [01:38<01:27,  2.50s/it]Processing groups:  69%|██████▉   | 69/100 [01:39<00:51,  1.65s/it]Processing groups:  70%|███████   | 70/100 [01:40<00:47,  1.60s/it]Processing groups:  74%|███████▍  | 74/100 [01:40<00:26,  1.01s/it]Processing groups:  76%|███████▌  | 76/100 [01:41<00:21,  1.11it/s]Processing groups:  78%|███████▊  | 78/100 [01:42<00:15,  1.38it/s]Processing groups:  82%|████████▏ | 82/100 [01:42<00:09,  1.89it/s]Processing groups:  87%|████████▋ | 87/100 [01:43<00:04,  2.88it/s]Processing groups:  90%|█████████ | 90/100 [01:44<00:03,  3.29it/s]Processing groups:  94%|█████████▍| 94/100 [01:44<00:01,  4.32it/s]Processing groups:  96%|█████████▌| 96/100 [01:44<00:00,  4.18it/s]Processing groups:  97%|█████████▋| 97/100 [01:47<00:01,  2.10it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.07s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.03, 'mean_ap': 0.04, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 42551.53it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<49:52, 30.23s/it]Processing groups:   2%|▏         | 2/100 [00:35<25:20, 15.51s/it]Processing groups:  30%|███       | 30/100 [00:37<00:50,  1.39it/s]Processing groups:  33%|███▎      | 33/100 [01:05<02:00,  1.80s/it]Processing groups:  35%|███▌      | 35/100 [01:10<02:03,  1.91s/it]Processing groups:  55%|█████▌    | 55/100 [01:12<00:35,  1.26it/s]Processing groups:  56%|█████▌    | 56/100 [01:14<00:36,  1.20it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<00:47,  1.35s/it]Processing groups:  67%|██████▋   | 67/100 [01:39<00:48,  1.46s/it]Processing groups:  68%|██████▊   | 68/100 [01:43<00:50,  1.57s/it]Processing groups:  83%|████████▎ | 83/100 [01:43<00:11,  1.48it/s]Processing groups:  85%|████████▌ | 85/100 [01:44<00:09,  1.59it/s]Processing groups:  94%|█████████▍| 94/100 [01:45<00:02,  2.42it/s]Processing groups:  97%|█████████▋| 97/100 [01:47<00:01,  2.11it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  2.52it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.08s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.09, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32431.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:32, 33.66s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:02, 14.72s/it]Processing groups:  25%|██▌       | 25/100 [00:35<00:55,  1.35it/s]Processing groups:  29%|██▉       | 29/100 [00:39<00:56,  1.27it/s]Processing groups:  29%|██▉       | 29/100 [00:58<00:56,  1.27it/s]Processing groups:  33%|███▎      | 33/100 [01:08<02:26,  2.18s/it]Processing groups:  35%|███▌      | 35/100 [01:09<02:05,  1.93s/it]Processing groups:  41%|████      | 41/100 [01:12<01:23,  1.42s/it]Processing groups:  53%|█████▎    | 53/100 [01:12<00:33,  1.42it/s]Processing groups:  58%|█████▊    | 58/100 [01:13<00:24,  1.73it/s]Processing groups:  64%|██████▍   | 64/100 [01:14<00:17,  2.08it/s]Processing groups:  64%|██████▍   | 64/100 [01:28<00:17,  2.08it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<01:04,  1.85s/it]Processing groups:  66%|██████▌   | 66/100 [01:36<00:58,  1.71s/it]Processing groups:  68%|██████▊   | 68/100 [01:43<01:03,  1.97s/it]Processing groups:  69%|██████▉   | 69/100 [01:43<00:56,  1.83s/it]Processing groups:  74%|███████▍  | 74/100 [01:44<00:27,  1.05s/it]Processing groups:  75%|███████▌  | 75/100 [01:45<00:24,  1.02it/s]Processing groups:  77%|███████▋  | 77/100 [01:45<00:17,  1.33it/s]Processing groups:  92%|█████████▏| 92/100 [01:46<00:01,  4.05it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:00,  3.39it/s]Processing groups:  98%|█████████▊| 98/100 [01:48<00:00,  3.32it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.09s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.04, 'mean_ap': 0.18, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 50600.84it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:31, 32.44s/it]Processing groups:   2%|▏         | 2/100 [00:32<22:02, 13.49s/it]Processing groups:   4%|▍         | 4/100 [00:33<08:27,  5.28s/it]Processing groups:   5%|▌         | 5/100 [00:34<06:27,  4.08s/it]Processing groups:  12%|█▏        | 12/100 [00:37<01:48,  1.23s/it]Processing groups:  28%|██▊       | 28/100 [00:38<00:29,  2.45it/s]Processing groups:  33%|███▎      | 33/100 [01:05<01:49,  1.64s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:42,  1.55s/it]Processing groups:  36%|███▌      | 36/100 [01:06<01:24,  1.33s/it]Processing groups:  37%|███▋      | 37/100 [01:07<01:20,  1.28s/it]Processing groups:  39%|███▉      | 39/100 [01:07<01:03,  1.04s/it]Processing groups:  42%|████▏     | 42/100 [01:10<01:01,  1.06s/it]Processing groups:  55%|█████▌    | 55/100 [01:12<00:19,  2.27it/s]Processing groups:  57%|█████▋    | 57/100 [01:14<00:21,  2.03it/s]Processing groups:  63%|██████▎   | 63/100 [01:15<00:14,  2.63it/s]Processing groups:  64%|██████▍   | 64/100 [01:16<00:15,  2.31it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<01:35,  2.73s/it]Processing groups:  67%|██████▋   | 67/100 [01:43<01:22,  2.49s/it]Processing groups:  73%|███████▎  | 73/100 [01:43<00:36,  1.35s/it]Processing groups:  80%|████████  | 80/100 [01:44<00:15,  1.32it/s]Processing groups:  86%|████████▌ | 86/100 [01:45<00:07,  1.85it/s]Processing groups:  92%|█████████▏| 92/100 [01:45<00:03,  2.63it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:01,  2.29it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.08s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 0.67, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39866.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<49:13, 29.84s/it]Processing groups:   2%|▏         | 2/100 [00:33<24:01, 14.71s/it]Processing groups:   5%|▌         | 5/100 [00:37<07:55,  5.00s/it]Processing groups:  21%|██        | 21/100 [00:37<01:03,  1.24it/s]Processing groups:  21%|██        | 21/100 [00:49<01:03,  1.24it/s]Processing groups:  33%|███▎      | 33/100 [01:07<01:45,  1.58s/it]Processing groups:  35%|███▌      | 35/100 [01:07<01:32,  1.43s/it]Processing groups:  37%|███▋      | 37/100 [01:09<01:27,  1.39s/it]Processing groups:  38%|███▊      | 38/100 [01:09<01:20,  1.29s/it]Processing groups:  51%|█████     | 51/100 [01:13<00:32,  1.50it/s]Processing groups:  65%|██████▌   | 65/100 [01:38<00:42,  1.22s/it]Processing groups:  66%|██████▌   | 66/100 [01:41<00:43,  1.28s/it]Processing groups:  71%|███████   | 71/100 [01:42<00:29,  1.01s/it]Processing groups:  74%|███████▍  | 74/100 [01:43<00:24,  1.07it/s]Processing groups:  81%|████████  | 81/100 [01:44<00:11,  1.64it/s]Processing groups:  84%|████████▍ | 84/100 [01:44<00:08,  1.87it/s]Processing groups:  86%|████████▌ | 86/100 [01:45<00:06,  2.15it/s]Processing groups:  94%|█████████▍| 94/100 [01:45<00:01,  3.67it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:01,  2.45it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.08s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.53, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40509.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:38<1:03:34, 38.53s/it]Processing groups:   2%|▏         | 2/100 [00:40<27:45, 17.00s/it]  Processing groups:   3%|▎         | 3/100 [00:40<15:04,  9.33s/it]Processing groups:   4%|▍         | 4/100 [00:42<10:23,  6.49s/it]Processing groups:  10%|█         | 10/100 [00:43<02:17,  1.53s/it]Processing groups:  13%|█▎        | 13/100 [00:47<02:12,  1.52s/it]Processing groups:  33%|███▎      | 33/100 [01:20<01:47,  1.60s/it]Processing groups:  34%|███▍      | 34/100 [01:20<01:42,  1.55s/it]Processing groups:  35%|███▌      | 35/100 [01:22<01:42,  1.58s/it]Processing groups:  44%|████▍     | 44/100 [01:24<00:51,  1.08it/s]Processing groups:  45%|████▌     | 45/100 [01:25<00:51,  1.07it/s]Processing groups:  48%|████▊     | 48/100 [01:25<00:39,  1.33it/s]Processing groups:  52%|█████▏    | 52/100 [01:27<00:30,  1.59it/s]Processing groups:  65%|██████▌   | 65/100 [01:59<00:59,  1.71s/it]Processing groups:  66%|██████▌   | 66/100 [02:00<00:56,  1.67s/it]Processing groups:  67%|██████▋   | 67/100 [02:02<00:55,  1.69s/it]Processing groups:  68%|██████▊   | 68/100 [02:03<00:50,  1.59s/it]Processing groups:  73%|███████▎  | 73/100 [02:03<00:25,  1.06it/s]Processing groups:  74%|███████▍  | 74/100 [02:04<00:24,  1.08it/s]Processing groups:  75%|███████▌  | 75/100 [02:05<00:22,  1.10it/s]Processing groups:  80%|████████  | 80/100 [02:06<00:11,  1.74it/s]Processing groups:  91%|█████████ | 91/100 [02:06<00:02,  4.25it/s]Processing groups:  94%|█████████▍| 94/100 [02:06<00:01,  4.90it/s]Processing groups:  97%|█████████▋| 97/100 [02:10<00:01,  2.32it/s]Processing groups:  99%|█████████▉| 99/100 [02:10<00:00,  2.64it/s]Processing groups: 100%|██████████| 100/100 [02:10<00:00,  1.31s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.11, 'mean_ap': 0.01, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41909.51it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:13:45, 44.70s/it]Processing groups:  11%|█         | 11/100 [00:46<04:34,  3.08s/it] Processing groups:  33%|███▎      | 33/100 [01:20<02:08,  1.92s/it]Processing groups:  36%|███▌      | 36/100 [01:23<01:56,  1.82s/it]Processing groups:  37%|███▋      | 37/100 [01:23<01:48,  1.73s/it]Processing groups:  38%|███▊      | 38/100 [01:24<01:41,  1.64s/it]Processing groups:  39%|███▉      | 39/100 [01:25<01:39,  1.64s/it]Processing groups:  40%|████      | 40/100 [01:26<01:34,  1.58s/it]Processing groups:  53%|█████▎    | 53/100 [01:28<00:26,  1.75it/s]Processing groups:  59%|█████▉    | 59/100 [01:29<00:17,  2.33it/s]Processing groups:  61%|██████    | 61/100 [01:29<00:14,  2.63it/s]Processing groups:  65%|██████▌   | 65/100 [02:02<01:27,  2.51s/it]Processing groups:  67%|██████▋   | 67/100 [02:04<01:16,  2.32s/it]Processing groups:  73%|███████▎  | 73/100 [02:06<00:40,  1.50s/it]Processing groups:  74%|███████▍  | 74/100 [02:07<00:36,  1.40s/it]Processing groups:  80%|████████  | 80/100 [02:08<00:17,  1.12it/s]Processing groups:  93%|█████████▎| 93/100 [02:09<00:02,  2.49it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:01,  1.96it/s]Processing groups: 100%|██████████| 100/100 [02:12<00:00,  1.33s/it]
{'replicate_reproducibility': 0.04, 'mp_value': 0.01, 'mean_ap': 0.02, 'mean_ap_p_value': 0.06, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40988.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:17:57, 47.25s/it]Processing groups:   8%|▊         | 8/100 [00:48<06:52,  4.49s/it]  Processing groups:  33%|███▎      | 33/100 [01:19<02:01,  1.81s/it]Processing groups:  35%|███▌      | 35/100 [01:26<02:06,  1.94s/it]Processing groups:  45%|████▌     | 45/100 [01:27<01:09,  1.26s/it]Processing groups:  48%|████▊     | 48/100 [01:28<00:57,  1.10s/it]Processing groups:  60%|██████    | 60/100 [01:30<00:27,  1.43it/s]Processing groups:  62%|██████▏   | 62/100 [01:31<00:26,  1.43it/s]Processing groups:  65%|██████▌   | 65/100 [02:00<01:16,  2.18s/it]Processing groups:  66%|██████▌   | 66/100 [02:00<01:09,  2.06s/it]Processing groups:  67%|██████▋   | 67/100 [02:02<01:08,  2.09s/it]Processing groups:  71%|███████   | 71/100 [02:04<00:41,  1.44s/it]Processing groups:  72%|███████▏  | 72/100 [02:05<00:40,  1.46s/it]Processing groups:  78%|███████▊  | 78/100 [02:08<00:21,  1.00it/s]Processing groups:  90%|█████████ | 90/100 [02:08<00:04,  2.38it/s]Processing groups:  94%|█████████▍| 94/100 [02:08<00:02,  2.99it/s]Processing groups:  98%|█████████▊| 98/100 [02:12<00:00,  2.13it/s]Processing groups: 100%|██████████| 100/100 [02:12<00:00,  1.33s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.13, 'mean_ap': 0.04, 'mean_ap_p_value': 0.08, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35584.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:08:28, 41.50s/it]Processing groups:   3%|▎         | 3/100 [00:44<19:00, 11.75s/it]  Processing groups:   5%|▌         | 5/100 [00:44<09:06,  5.75s/it]Processing groups:   7%|▋         | 7/100 [00:45<05:33,  3.59s/it]Processing groups:  24%|██▍       | 24/100 [00:46<00:46,  1.63it/s]Processing groups:  30%|███       | 30/100 [00:47<00:34,  2.01it/s]Processing groups:  30%|███       | 30/100 [01:02<00:34,  2.01it/s]Processing groups:  33%|███▎      | 33/100 [01:18<02:28,  2.21s/it]Processing groups:  34%|███▍      | 34/100 [01:23<02:39,  2.42s/it]Processing groups:  36%|███▌      | 36/100 [01:25<02:20,  2.19s/it]Processing groups:  39%|███▉      | 39/100 [01:25<01:38,  1.61s/it]Processing groups:  40%|████      | 40/100 [01:26<01:26,  1.44s/it]Processing groups:  49%|████▉     | 49/100 [01:28<00:37,  1.37it/s]Processing groups:  60%|██████    | 60/100 [01:30<00:18,  2.20it/s]Processing groups:  62%|██████▏   | 62/100 [01:31<00:17,  2.13it/s]Processing groups:  63%|██████▎   | 63/100 [01:32<00:17,  2.13it/s]Processing groups:  65%|██████▌   | 65/100 [02:01<01:46,  3.04s/it]Processing groups:  66%|██████▌   | 66/100 [02:01<01:32,  2.71s/it]Processing groups:  69%|██████▉   | 69/100 [02:03<01:03,  2.04s/it]Processing groups:  70%|███████   | 70/100 [02:04<00:56,  1.89s/it]Processing groups:  71%|███████   | 71/100 [02:05<00:51,  1.78s/it]Processing groups:  72%|███████▏  | 72/100 [02:07<00:50,  1.80s/it]Processing groups:  75%|███████▌  | 75/100 [02:07<00:25,  1.02s/it]Processing groups:  83%|████████▎ | 83/100 [02:08<00:07,  2.36it/s]Processing groups:  91%|█████████ | 91/100 [02:08<00:02,  4.29it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:01,  2.70it/s]Processing groups: 100%|██████████| 100/100 [02:12<00:00,  1.33s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.06, 'mean_ap_p_value': 0.1, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 42577.44it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:02, 43.05s/it]Processing groups:  16%|█▌        | 16/100 [00:44<02:49,  2.01s/it] Processing groups:  22%|██▏       | 22/100 [00:45<01:44,  1.34s/it]Processing groups:  26%|██▌       | 26/100 [00:45<01:15,  1.02s/it]Processing groups:  26%|██▌       | 26/100 [00:58<01:15,  1.02s/it]Processing groups:  33%|███▎      | 33/100 [01:19<02:46,  2.48s/it]Processing groups:  34%|███▍      | 34/100 [01:25<03:02,  2.76s/it]Processing groups:  38%|███▊      | 38/100 [01:26<02:07,  2.05s/it]Processing groups:  50%|█████     | 50/100 [01:28<00:48,  1.03it/s]Processing groups:  55%|█████▌    | 55/100 [01:28<00:33,  1.34it/s]Processing groups:  60%|██████    | 60/100 [01:29<00:24,  1.66it/s]Processing groups:  61%|██████    | 61/100 [01:30<00:24,  1.56it/s]Processing groups:  65%|██████▌   | 65/100 [02:00<01:30,  2.60s/it]Processing groups:  66%|██████▌   | 66/100 [02:03<01:29,  2.63s/it]Processing groups:  67%|██████▋   | 67/100 [02:04<01:19,  2.41s/it]Processing groups:  69%|██████▉   | 69/100 [02:04<00:57,  1.86s/it]Processing groups:  70%|███████   | 70/100 [02:06<00:53,  1.79s/it]Processing groups:  73%|███████▎  | 73/100 [02:07<00:34,  1.29s/it]Processing groups:  77%|███████▋  | 77/100 [02:08<00:17,  1.30it/s]Processing groups:  80%|████████  | 80/100 [02:08<00:10,  1.85it/s]Processing groups:  84%|████████▍ | 84/100 [02:08<00:05,  2.68it/s]Processing groups:  86%|████████▌ | 86/100 [02:08<00:04,  2.94it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:01,  2.83it/s]Processing groups:  99%|█████████▉| 99/100 [02:13<00:00,  3.19it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.33s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.04, 'mean_ap': 0.17, 'mean_ap_p_value': 0.23, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 46567.16it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:08:23, 41.45s/it]Processing groups:   2%|▏         | 2/100 [00:43<30:16, 18.53s/it]  Processing groups:  12%|█▏        | 12/100 [00:44<02:58,  2.03s/it]Processing groups:  23%|██▎       | 23/100 [00:45<01:07,  1.14it/s]Processing groups:  30%|███       | 30/100 [00:46<00:45,  1.53it/s]Processing groups:  33%|███▎      | 33/100 [01:19<02:42,  2.43s/it]Processing groups:  34%|███▍      | 34/100 [01:23<02:49,  2.57s/it]Processing groups:  35%|███▌      | 35/100 [01:24<02:39,  2.45s/it]Processing groups:  38%|███▊      | 38/100 [01:25<01:47,  1.74s/it]Processing groups:  49%|████▉     | 49/100 [01:26<00:39,  1.30it/s]Processing groups:  56%|█████▌    | 56/100 [01:28<00:25,  1.71it/s]Processing groups:  59%|█████▉    | 59/100 [01:28<00:19,  2.06it/s]Processing groups:  61%|██████    | 61/100 [01:29<00:18,  2.15it/s]Processing groups:  65%|██████▌   | 65/100 [01:59<01:28,  2.53s/it]Processing groups:  66%|██████▌   | 66/100 [02:07<01:44,  3.08s/it]Processing groups:  73%|███████▎  | 73/100 [02:07<00:43,  1.60s/it]Processing groups:  82%|████████▏ | 82/100 [02:08<00:16,  1.12it/s]Processing groups:  87%|████████▋ | 87/100 [02:08<00:08,  1.51it/s]Processing groups:  95%|█████████▌| 95/100 [02:09<00:02,  2.37it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:01,  1.70it/s]Processing groups:  99%|█████████▉| 99/100 [02:13<00:00,  1.89it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.33s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.24, 'mean_ap': 0.57, 'mean_ap_p_value': 0.68, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38339.16it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:40<1:06:14, 40.14s/it]Processing groups:   2%|▏         | 2/100 [00:40<27:18, 16.72s/it]  Processing groups:   3%|▎         | 3/100 [00:42<16:14, 10.05s/it]Processing groups:   8%|▊         | 8/100 [00:42<03:42,  2.41s/it]Processing groups:  10%|█         | 10/100 [00:43<02:40,  1.78s/it]Processing groups:  11%|█         | 11/100 [00:43<02:14,  1.51s/it]Processing groups:  22%|██▏       | 22/100 [00:45<00:37,  2.09it/s]Processing groups:  33%|███▎      | 33/100 [01:22<02:13,  1.99s/it]Processing groups:  36%|███▌      | 36/100 [01:24<01:53,  1.78s/it]Processing groups:  39%|███▉      | 39/100 [01:25<01:28,  1.44s/it]Processing groups:  46%|████▌     | 46/100 [01:26<00:53,  1.02it/s]Processing groups:  53%|█████▎    | 53/100 [01:28<00:32,  1.44it/s]Processing groups:  58%|█████▊    | 58/100 [01:29<00:23,  1.77it/s]Processing groups:  65%|██████▌   | 65/100 [01:59<01:06,  1.89s/it]Processing groups:  67%|██████▋   | 67/100 [02:02<01:01,  1.86s/it]Processing groups:  68%|██████▊   | 68/100 [02:04<00:57,  1.79s/it]Processing groups:  71%|███████   | 71/100 [02:04<00:40,  1.38s/it]Processing groups:  76%|███████▌  | 76/100 [02:05<00:21,  1.11it/s]Processing groups:  83%|████████▎ | 83/100 [02:06<00:09,  1.76it/s]Processing groups:  84%|████████▍ | 84/100 [02:06<00:09,  1.76it/s]Processing groups:  95%|█████████▌| 95/100 [02:06<00:01,  3.87it/s]Processing groups:  98%|█████████▊| 98/100 [02:10<00:00,  2.25it/s]Processing groups: 100%|██████████| 100/100 [02:10<00:00,  2.58it/s]Processing groups: 100%|██████████| 100/100 [02:10<00:00,  1.31s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.91, 'mean_ap': 0.96, 'mean_ap_p_value': 0.97, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}

Processing n_plates: 3

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38283.17it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<51:06, 30.98s/it]Processing groups:   2%|▏         | 2/100 [00:31<21:07, 12.93s/it]Processing groups:   3%|▎         | 3/100 [00:31<11:27,  7.09s/it]Processing groups:   4%|▍         | 4/100 [00:32<07:22,  4.61s/it]Processing groups:   6%|▌         | 6/100 [00:35<04:44,  3.03s/it]Processing groups:  23%|██▎       | 23/100 [00:37<00:37,  2.03it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:26,  1.30s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:39,  1.51s/it]Processing groups:  44%|████▍     | 44/100 [01:10<00:58,  1.04s/it]Processing groups:  61%|██████    | 61/100 [01:13<00:23,  1.69it/s]Processing groups:  65%|██████▌   | 65/100 [01:32<00:42,  1.20s/it]Processing groups:  66%|██████▌   | 66/100 [01:33<00:39,  1.17s/it]Processing groups:  67%|██████▋   | 67/100 [01:34<00:39,  1.19s/it]Processing groups:  68%|██████▊   | 68/100 [01:36<00:38,  1.21s/it]Processing groups:  69%|██████▉   | 69/100 [01:37<00:39,  1.27s/it]Processing groups:  70%|███████   | 70/100 [01:38<00:33,  1.12s/it]Processing groups:  71%|███████   | 71/100 [01:39<00:33,  1.17s/it]Processing groups:  79%|███████▉  | 79/100 [01:39<00:08,  2.35it/s]Processing groups:  81%|████████  | 81/100 [01:41<00:08,  2.12it/s]Processing groups:  92%|█████████▏| 92/100 [01:41<00:01,  4.52it/s]Processing groups:  94%|█████████▍| 94/100 [01:41<00:01,  4.79it/s]Processing groups:  96%|█████████▌| 96/100 [01:42<00:00,  5.30it/s]Processing groups:  98%|█████████▊| 98/100 [01:44<00:00,  2.65it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.023333333333333334, 'mp_value': 0.16, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 47978.77it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<49:16, 29.86s/it]Processing groups:   3%|▎         | 3/100 [00:31<13:41,  8.47s/it]Processing groups:  13%|█▎        | 13/100 [00:34<02:14,  1.54s/it]Processing groups:  19%|█▉        | 19/100 [00:34<01:16,  1.07it/s]Processing groups:  25%|██▌       | 25/100 [00:35<00:46,  1.61it/s]Processing groups:  31%|███       | 31/100 [00:35<00:29,  2.35it/s]Processing groups:  31%|███       | 31/100 [00:52<00:29,  2.35it/s]Processing groups:  33%|███▎      | 33/100 [01:03<02:36,  2.34s/it]Processing groups:  37%|███▋      | 37/100 [01:07<02:03,  1.96s/it]Processing groups:  40%|████      | 40/100 [01:08<01:34,  1.57s/it]Processing groups:  59%|█████▉    | 59/100 [01:09<00:21,  1.92it/s]Processing groups:  63%|██████▎   | 63/100 [01:13<00:23,  1.61it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<00:53,  1.54s/it]Processing groups:  66%|██████▌   | 66/100 [01:35<00:57,  1.69s/it]Processing groups:  67%|██████▋   | 67/100 [01:36<00:53,  1.63s/it]Processing groups:  70%|███████   | 70/100 [01:37<00:37,  1.27s/it]Processing groups:  75%|███████▌  | 75/100 [01:38<00:21,  1.19it/s]Processing groups:  78%|███████▊  | 78/100 [01:38<00:14,  1.51it/s]Processing groups:  83%|████████▎ | 83/100 [01:39<00:07,  2.13it/s]Processing groups:  90%|█████████ | 90/100 [01:39<00:02,  3.62it/s]Processing groups:  93%|█████████▎| 93/100 [01:40<00:01,  3.96it/s]Processing groups:  96%|█████████▌| 96/100 [01:40<00:00,  4.73it/s]Processing groups:  98%|█████████▊| 98/100 [01:43<00:00,  2.50it/s]Processing groups: 100%|██████████| 100/100 [01:43<00:00,  1.03s/it]
{'replicate_reproducibility': 0.04666666666666667, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39673.70it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:54, 32.67s/it]Processing groups:   4%|▍         | 4/100 [00:34<10:43,  6.71s/it]Processing groups:  11%|█         | 11/100 [00:34<02:43,  1.83s/it]Processing groups:  14%|█▍        | 14/100 [00:35<01:52,  1.31s/it]Processing groups:  25%|██▌       | 25/100 [00:39<00:56,  1.34it/s]Processing groups:  33%|███▎      | 33/100 [00:59<01:34,  1.41s/it]Processing groups:  34%|███▍      | 34/100 [01:02<01:40,  1.53s/it]Processing groups:  36%|███▌      | 36/100 [01:06<01:42,  1.60s/it]Processing groups:  40%|████      | 40/100 [01:09<01:22,  1.38s/it]Processing groups:  48%|████▊     | 48/100 [01:11<00:42,  1.22it/s]Processing groups:  64%|██████▍   | 64/100 [01:14<00:16,  2.25it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<00:51,  1.46s/it]Processing groups:  66%|██████▌   | 66/100 [01:37<00:50,  1.47s/it]Processing groups:  68%|██████▊   | 68/100 [01:38<00:44,  1.40s/it]Processing groups:  72%|███████▏  | 72/100 [01:39<00:28,  1.03s/it]Processing groups:  74%|███████▍  | 74/100 [01:40<00:22,  1.16it/s]Processing groups:  75%|███████▌  | 75/100 [01:40<00:20,  1.24it/s]Processing groups:  78%|███████▊  | 78/100 [01:40<00:12,  1.73it/s]Processing groups:  87%|████████▋ | 87/100 [01:41<00:03,  3.45it/s]Processing groups:  93%|█████████▎| 93/100 [01:41<00:01,  5.20it/s]Processing groups:  97%|█████████▋| 97/100 [01:44<00:00,  3.23it/s]Processing groups:  99%|█████████▉| 99/100 [01:44<00:00,  3.58it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35971.73it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:44, 31.96s/it]Processing groups:   4%|▍         | 4/100 [00:32<09:56,  6.21s/it]Processing groups:   6%|▌         | 6/100 [00:33<05:45,  3.68s/it]Processing groups:   8%|▊         | 8/100 [00:34<03:41,  2.41s/it]Processing groups:  15%|█▌        | 15/100 [00:34<01:16,  1.11it/s]Processing groups:  18%|█▊        | 18/100 [00:35<00:56,  1.46it/s]Processing groups:  27%|██▋       | 27/100 [00:37<00:31,  2.34it/s]Processing groups:  31%|███       | 31/100 [00:38<00:27,  2.54it/s]Processing groups:  33%|███▎      | 33/100 [01:01<02:24,  2.16s/it]Processing groups:  36%|███▌      | 36/100 [01:04<01:59,  1.86s/it]Processing groups:  40%|████      | 40/100 [01:05<01:20,  1.34s/it]Processing groups:  45%|████▌     | 45/100 [01:09<01:03,  1.15s/it]Processing groups:  54%|█████▍    | 54/100 [01:11<00:31,  1.45it/s]Processing groups:  62%|██████▏   | 62/100 [01:11<00:16,  2.29it/s]Processing groups:  62%|██████▏   | 62/100 [01:22<00:16,  2.29it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<00:58,  1.67s/it]Processing groups:  69%|██████▉   | 69/100 [01:36<00:41,  1.33s/it]Processing groups:  71%|███████   | 71/100 [01:37<00:36,  1.25s/it]Processing groups:  73%|███████▎  | 73/100 [01:38<00:29,  1.10s/it]Processing groups:  76%|███████▌  | 76/100 [01:39<00:21,  1.12it/s]Processing groups:  79%|███████▉  | 79/100 [01:40<00:14,  1.42it/s]Processing groups:  82%|████████▏ | 82/100 [01:40<00:09,  1.93it/s]Processing groups:  86%|████████▌ | 86/100 [01:41<00:06,  2.29it/s]Processing groups:  95%|█████████▌| 95/100 [01:41<00:01,  4.46it/s]Processing groups:  97%|█████████▋| 97/100 [01:43<00:00,  3.07it/s]Processing groups:  98%|█████████▊| 98/100 [01:43<00:00,  3.08it/s]Processing groups:  99%|█████████▉| 99/100 [01:44<00:00,  3.23it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.02, 'mean_ap': 0.0, 'mean_ap_p_value': 0.06, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43005.27it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<48:24, 29.34s/it]Processing groups:   3%|▎         | 3/100 [00:30<12:59,  8.03s/it]Processing groups:   6%|▌         | 6/100 [00:33<05:46,  3.68s/it]Processing groups:   7%|▋         | 7/100 [00:36<05:21,  3.46s/it]Processing groups:  33%|███▎      | 33/100 [01:04<01:30,  1.35s/it]Processing groups:  35%|███▌      | 35/100 [01:06<01:24,  1.30s/it]Processing groups:  36%|███▌      | 36/100 [01:07<01:24,  1.32s/it]Processing groups:  46%|████▌     | 46/100 [01:08<00:40,  1.33it/s]Processing groups:  59%|█████▉    | 59/100 [01:09<00:18,  2.24it/s]Processing groups:  64%|██████▍   | 64/100 [01:10<00:13,  2.70it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<01:08,  1.96s/it]Processing groups:  84%|████████▍ | 84/100 [01:40<00:13,  1.22it/s]Processing groups:  97%|█████████▋| 97/100 [01:43<00:01,  1.67it/s]Processing groups:  98%|█████████▊| 98/100 [01:43<00:01,  1.70it/s]Processing groups: 100%|██████████| 100/100 [01:43<00:00,  1.04s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.07, 'mean_ap': 0.02, 'mean_ap_p_value': 0.27, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36111.10it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<49:22, 29.92s/it]Processing groups:   2%|▏         | 2/100 [00:32<22:58, 14.07s/it]Processing groups:   8%|▊         | 8/100 [00:33<03:44,  2.44s/it]Processing groups:  12%|█▏        | 12/100 [00:35<02:19,  1.58s/it]Processing groups:  21%|██        | 21/100 [00:36<00:55,  1.42it/s]Processing groups:  26%|██▌       | 26/100 [00:37<00:40,  1.83it/s]Processing groups:  33%|███▎      | 33/100 [01:00<01:47,  1.60s/it]Processing groups:  34%|███▍      | 34/100 [01:08<02:17,  2.08s/it]Processing groups:  47%|████▋     | 47/100 [01:09<00:49,  1.06it/s]Processing groups:  59%|█████▉    | 59/100 [01:13<00:27,  1.47it/s]Processing groups:  65%|██████▌   | 65/100 [01:34<00:47,  1.35s/it]Processing groups:  66%|██████▌   | 66/100 [01:36<00:46,  1.36s/it]Processing groups:  67%|██████▋   | 67/100 [01:38<00:45,  1.38s/it]Processing groups:  70%|███████   | 70/100 [01:39<00:35,  1.18s/it]Processing groups:  73%|███████▎  | 73/100 [01:41<00:27,  1.03s/it]Processing groups:  86%|████████▌ | 86/100 [01:41<00:06,  2.32it/s]Processing groups:  93%|█████████▎| 93/100 [01:42<00:02,  3.34it/s]Processing groups:  97%|█████████▋| 97/100 [01:44<00:01,  2.72it/s]Processing groups:  99%|█████████▉| 99/100 [01:44<00:00,  2.98it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 0.43, 'mean_ap_p_value': 0.92, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 45206.98it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:39, 31.92s/it]Processing groups:   4%|▍         | 4/100 [00:33<10:15,  6.41s/it]Processing groups:   5%|▌         | 5/100 [00:33<07:22,  4.66s/it]Processing groups:  16%|█▌        | 16/100 [00:34<01:19,  1.05it/s]Processing groups:  17%|█▋        | 17/100 [00:36<01:24,  1.02s/it]Processing groups:  22%|██▏       | 22/100 [00:36<00:50,  1.55it/s]Processing groups:  23%|██▎       | 23/100 [00:36<00:45,  1.68it/s]Processing groups:  33%|███▎      | 33/100 [00:59<01:45,  1.58s/it]Processing groups:  34%|███▍      | 34/100 [01:06<02:11,  2.00s/it]Processing groups:  35%|███▌      | 35/100 [01:06<02:01,  1.87s/it]Processing groups:  40%|████      | 40/100 [01:08<01:10,  1.18s/it]Processing groups:  48%|████▊     | 48/100 [01:09<00:34,  1.50it/s]Processing groups:  57%|█████▋    | 57/100 [01:09<00:17,  2.41it/s]Processing groups:  60%|██████    | 60/100 [01:10<00:15,  2.60it/s]Processing groups:  61%|██████    | 61/100 [01:10<00:14,  2.69it/s]Processing groups:  64%|██████▍   | 64/100 [01:11<00:12,  2.88it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<01:39,  2.84s/it]Processing groups:  67%|██████▋   | 67/100 [01:36<01:14,  2.26s/it]Processing groups:  68%|██████▊   | 68/100 [01:38<01:10,  2.20s/it]Processing groups:  69%|██████▉   | 69/100 [01:41<01:11,  2.29s/it]Processing groups:  86%|████████▌ | 86/100 [01:41<00:06,  2.19it/s]Processing groups:  94%|█████████▍| 94/100 [01:41<00:01,  3.19it/s]Processing groups:  99%|█████████▉| 99/100 [01:44<00:00,  2.58it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.43, 'mean_ap': 0.89, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43360.94it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:43, 31.95s/it]Processing groups:   3%|▎         | 3/100 [00:34<15:07,  9.36s/it]Processing groups:   6%|▌         | 6/100 [00:37<06:21,  4.06s/it]Processing groups:   7%|▋         | 7/100 [00:37<04:55,  3.18s/it]Processing groups:  17%|█▋        | 17/100 [00:37<01:04,  1.28it/s]Processing groups:  21%|██        | 21/100 [00:39<00:53,  1.46it/s]Processing groups:  25%|██▌       | 25/100 [00:40<00:42,  1.75it/s]Processing groups:  33%|███▎      | 33/100 [01:11<02:18,  2.07s/it]Processing groups:  34%|███▍      | 34/100 [01:11<02:06,  1.92s/it]Processing groups:  36%|███▌      | 36/100 [01:11<01:42,  1.60s/it]Processing groups:  37%|███▋      | 37/100 [01:14<01:51,  1.77s/it]Processing groups:  59%|█████▉    | 59/100 [01:16<00:19,  2.11it/s]Processing groups:  61%|██████    | 61/100 [01:18<00:20,  1.95it/s]Processing groups:  65%|██████▌   | 65/100 [01:47<01:06,  1.89s/it]Processing groups:  70%|███████   | 70/100 [01:48<00:43,  1.43s/it]Processing groups:  72%|███████▏  | 72/100 [01:49<00:36,  1.32s/it]Processing groups:  74%|███████▍  | 74/100 [01:49<00:29,  1.12s/it]Processing groups:  75%|███████▌  | 75/100 [01:50<00:26,  1.07s/it]Processing groups:  77%|███████▋  | 77/100 [01:50<00:19,  1.19it/s]Processing groups:  80%|████████  | 80/100 [01:50<00:12,  1.65it/s]Processing groups:  85%|████████▌ | 85/100 [01:50<00:05,  2.84it/s]Processing groups:  88%|████████▊ | 88/100 [01:51<00:03,  3.67it/s]Processing groups:  90%|█████████ | 90/100 [01:51<00:02,  3.73it/s]Processing groups:  96%|█████████▌| 96/100 [01:51<00:00,  6.40it/s]Processing groups:  98%|█████████▊| 98/100 [01:55<00:00,  2.35it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.15s/it]
{'replicate_reproducibility': 0.05, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1033.24it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<57:43, 34.99s/it]Processing groups:   3%|▎         | 3/100 [00:36<15:29,  9.58s/it]Processing groups:   4%|▍         | 4/100 [00:36<10:19,  6.45s/it]Processing groups:   6%|▌         | 6/100 [00:37<05:08,  3.28s/it]Processing groups:  12%|█▏        | 12/100 [00:38<01:42,  1.16s/it]Processing groups:  21%|██        | 21/100 [00:38<00:39,  2.01it/s]Processing groups:  31%|███       | 31/100 [00:40<00:24,  2.77it/s]Processing groups:  31%|███       | 31/100 [00:53<00:24,  2.77it/s]Processing groups:  33%|███▎      | 33/100 [01:10<02:24,  2.15s/it]Processing groups:  36%|███▌      | 36/100 [01:13<02:01,  1.90s/it]Processing groups:  46%|████▌     | 46/100 [01:17<01:03,  1.17s/it]Processing groups:  65%|██████▌   | 65/100 [01:46<00:47,  1.35s/it]Processing groups:  66%|██████▌   | 66/100 [01:48<00:47,  1.38s/it]Processing groups:  70%|███████   | 70/100 [01:49<00:34,  1.16s/it]Processing groups:  76%|███████▌  | 76/100 [01:50<00:21,  1.10it/s]Processing groups:  85%|████████▌ | 85/100 [01:51<00:08,  1.74it/s]Processing groups:  92%|█████████▏| 92/100 [01:51<00:03,  2.41it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  2.20it/s]Processing groups:  99%|█████████▉| 99/100 [01:54<00:00,  2.35it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.04, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43804.74it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:25, 33.59s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:09, 14.18s/it]Processing groups:   3%|▎         | 3/100 [00:35<13:47,  8.53s/it]Processing groups:   4%|▍         | 4/100 [00:37<09:01,  5.64s/it]Processing groups:   6%|▌         | 6/100 [00:38<04:34,  2.92s/it]Processing groups:  24%|██▍       | 24/100 [00:38<00:29,  2.57it/s]Processing groups:  27%|██▋       | 27/100 [00:38<00:24,  3.00it/s]Processing groups:  29%|██▉       | 29/100 [00:39<00:25,  2.74it/s]Processing groups:  29%|██▉       | 29/100 [00:57<00:25,  2.74it/s]Processing groups:  33%|███▎      | 33/100 [01:11<02:51,  2.56s/it]Processing groups:  37%|███▋      | 37/100 [01:12<01:57,  1.87s/it]Processing groups:  40%|████      | 40/100 [01:14<01:32,  1.54s/it]Processing groups:  41%|████      | 41/100 [01:14<01:22,  1.40s/it]Processing groups:  49%|████▉     | 49/100 [01:18<00:46,  1.10it/s]Processing groups:  64%|██████▍   | 64/100 [01:18<00:14,  2.51it/s]Processing groups:  64%|██████▍   | 64/100 [01:37<00:14,  2.51it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:05,  1.87s/it]Processing groups:  66%|██████▌   | 66/100 [01:49<01:05,  1.93s/it]Processing groups:  74%|███████▍  | 74/100 [01:51<00:30,  1.17s/it]Processing groups:  75%|███████▌  | 75/100 [01:51<00:27,  1.11s/it]Processing groups:  81%|████████  | 81/100 [01:51<00:13,  1.44it/s]Processing groups:  94%|█████████▍| 94/100 [01:52<00:02,  2.99it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.29it/s]Processing groups:  99%|█████████▉| 99/100 [01:55<00:00,  2.50it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.07, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40221.56it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:00:36, 36.73s/it]Processing groups:   7%|▋         | 7/100 [00:37<06:06,  3.94s/it]  Processing groups:  13%|█▎        | 13/100 [00:37<02:33,  1.77s/it]Processing groups:  20%|██        | 20/100 [00:38<01:14,  1.08it/s]Processing groups:  23%|██▎       | 23/100 [00:39<01:04,  1.19it/s]Processing groups:  23%|██▎       | 23/100 [00:50<01:04,  1.19it/s]Processing groups:  33%|███▎      | 33/100 [01:11<02:18,  2.06s/it]Processing groups:  38%|███▊      | 38/100 [01:14<01:44,  1.69s/it]Processing groups:  43%|████▎     | 43/100 [01:16<01:14,  1.31s/it]Processing groups:  65%|██████▌   | 65/100 [01:45<00:45,  1.31s/it]Processing groups:  67%|██████▋   | 67/100 [01:49<00:44,  1.35s/it]Processing groups:  70%|███████   | 70/100 [01:49<00:35,  1.20s/it]Processing groups:  77%|███████▋  | 77/100 [01:50<00:19,  1.21it/s]Processing groups:  79%|███████▉  | 79/100 [01:50<00:16,  1.28it/s]Processing groups:  84%|████████▍ | 84/100 [01:51<00:09,  1.76it/s]Processing groups:  94%|█████████▍| 94/100 [01:51<00:01,  3.18it/s]Processing groups:  98%|█████████▊| 98/100 [01:54<00:00,  2.30it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.06, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 54705.93it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:01:02, 37.00s/it]Processing groups:   8%|▊         | 8/100 [00:37<05:19,  3.47s/it]  Processing groups:  12%|█▏        | 12/100 [00:39<03:07,  2.13s/it]Processing groups:  27%|██▋       | 27/100 [00:39<00:49,  1.47it/s]Processing groups:  27%|██▋       | 27/100 [00:54<00:49,  1.47it/s]Processing groups:  33%|███▎      | 33/100 [01:06<01:57,  1.76s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:58,  1.80s/it]Processing groups:  35%|███▌      | 35/100 [01:10<01:54,  1.75s/it]Processing groups:  37%|███▋      | 37/100 [01:10<01:32,  1.46s/it]Processing groups:  38%|███▊      | 38/100 [01:11<01:26,  1.39s/it]Processing groups:  40%|████      | 40/100 [01:12<01:06,  1.11s/it]Processing groups:  41%|████      | 41/100 [01:14<01:19,  1.35s/it]Processing groups:  48%|████▊     | 48/100 [01:15<00:28,  1.80it/s]Processing groups:  53%|█████▎    | 53/100 [01:15<00:17,  2.72it/s]Processing groups:  56%|█████▌    | 56/100 [01:16<00:17,  2.49it/s]Processing groups:  65%|██████▌   | 65/100 [01:41<00:56,  1.62s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<00:54,  1.59s/it]Processing groups:  68%|██████▊   | 68/100 [01:46<00:50,  1.59s/it]Processing groups:  74%|███████▍  | 74/100 [01:49<00:30,  1.16s/it]Processing groups:  81%|████████  | 81/100 [01:50<00:13,  1.43it/s]Processing groups:  89%|████████▉ | 89/100 [01:50<00:04,  2.31it/s]Processing groups:  95%|█████████▌| 95/100 [01:51<00:01,  3.05it/s]Processing groups:  97%|█████████▋| 97/100 [01:53<00:01,  2.22it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.42, 'mean_ap': 0.01, 'mean_ap_p_value': 0.35, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39915.34it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:38<1:03:45, 38.64s/it]Processing groups:   5%|▌         | 5/100 [00:40<09:45,  6.17s/it]  Processing groups:  33%|███▎      | 33/100 [01:09<01:45,  1.58s/it]Processing groups:  34%|███▍      | 34/100 [01:11<01:44,  1.59s/it]Processing groups:  35%|███▌      | 35/100 [01:11<01:39,  1.53s/it]Processing groups:  40%|████      | 40/100 [01:12<01:06,  1.11s/it]Processing groups:  41%|████      | 41/100 [01:14<01:07,  1.15s/it]Processing groups:  44%|████▍     | 44/100 [01:14<00:51,  1.10it/s]Processing groups:  45%|████▌     | 45/100 [01:16<00:52,  1.05it/s]Processing groups:  46%|████▌     | 46/100 [01:16<00:46,  1.15it/s]Processing groups:  47%|████▋     | 47/100 [01:16<00:40,  1.30it/s]Processing groups:  55%|█████▌    | 55/100 [01:17<00:17,  2.64it/s]Processing groups:  63%|██████▎   | 63/100 [01:18<00:07,  4.63it/s]Processing groups:  63%|██████▎   | 63/100 [01:29<00:07,  4.63it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:19,  2.26s/it]Processing groups:  66%|██████▌   | 66/100 [01:49<01:18,  2.32s/it]Processing groups:  68%|██████▊   | 68/100 [01:50<01:01,  1.93s/it]Processing groups:  73%|███████▎  | 73/100 [01:51<00:30,  1.14s/it]Processing groups:  85%|████████▌ | 85/100 [01:51<00:07,  2.14it/s]Processing groups:  88%|████████▊ | 88/100 [01:51<00:04,  2.41it/s]Processing groups:  92%|█████████▏| 92/100 [01:51<00:02,  3.13it/s]Processing groups:  95%|█████████▌| 95/100 [01:52<00:01,  3.44it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  1.99it/s]Processing groups:  99%|█████████▉| 99/100 [01:55<00:00,  2.27it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.29, 'mean_ap': 0.18, 'mean_ap_p_value': 0.81, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39587.58it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:00:10, 36.47s/it]Processing groups:   2%|▏         | 2/100 [00:36<24:39, 15.10s/it]  Processing groups:  12%|█▏        | 12/100 [00:39<02:44,  1.87s/it]Processing groups:  23%|██▎       | 23/100 [00:40<01:02,  1.23it/s]Processing groups:  23%|██▎       | 23/100 [00:52<01:02,  1.23it/s]Processing groups:  33%|███▎      | 33/100 [01:11<02:00,  1.80s/it]Processing groups:  37%|███▋      | 37/100 [01:14<01:41,  1.60s/it]Processing groups:  46%|████▌     | 46/100 [01:14<00:53,  1.01it/s]Processing groups:  48%|████▊     | 48/100 [01:16<00:50,  1.03it/s]Processing groups:  50%|█████     | 50/100 [01:17<00:45,  1.10it/s]Processing groups:  60%|██████    | 60/100 [01:17<00:19,  2.09it/s]Processing groups:  63%|██████▎   | 63/100 [01:21<00:23,  1.57it/s]Processing groups:  63%|██████▎   | 63/100 [01:32<00:23,  1.57it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<01:17,  2.20s/it]Processing groups:  66%|██████▌   | 66/100 [01:46<01:11,  2.11s/it]Processing groups:  68%|██████▊   | 68/100 [01:46<00:54,  1.71s/it]Processing groups:  69%|██████▉   | 69/100 [01:48<00:54,  1.76s/it]Processing groups:  70%|███████   | 70/100 [01:49<00:48,  1.62s/it]Processing groups:  80%|████████  | 80/100 [01:50<00:11,  1.77it/s]Processing groups:  87%|████████▋ | 87/100 [01:50<00:04,  2.92it/s]Processing groups:  89%|████████▉ | 89/100 [01:51<00:04,  2.66it/s]Processing groups:  93%|█████████▎| 93/100 [01:52<00:02,  3.16it/s]Processing groups:  95%|█████████▌| 95/100 [01:52<00:01,  3.65it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.06it/s]Processing groups:  99%|█████████▉| 99/100 [01:55<00:00,  2.52it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 0.96, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43540.99it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:26:23, 52.36s/it]Processing groups:   6%|▌         | 6/100 [00:52<10:11,  6.50s/it]  Processing groups:  25%|██▌       | 25/100 [00:53<01:25,  1.14s/it]Processing groups:  25%|██▌       | 25/100 [01:06<01:25,  1.14s/it]Processing groups:  33%|███▎      | 33/100 [01:36<02:52,  2.58s/it]Processing groups:  34%|███▍      | 34/100 [01:37<02:42,  2.46s/it]Processing groups:  37%|███▋      | 37/100 [01:38<02:09,  2.06s/it]Processing groups:  39%|███▉      | 39/100 [01:40<01:56,  1.90s/it]Processing groups:  44%|████▍     | 44/100 [01:43<01:18,  1.40s/it]Processing groups:  57%|█████▋    | 57/100 [01:44<00:29,  1.48it/s]Processing groups:  65%|██████▌   | 65/100 [02:27<01:17,  2.22s/it]Processing groups:  68%|██████▊   | 68/100 [02:27<01:01,  1.91s/it]Processing groups:  69%|██████▉   | 69/100 [02:28<00:57,  1.86s/it]Processing groups:  70%|███████   | 70/100 [02:29<00:51,  1.73s/it]Processing groups:  73%|███████▎  | 73/100 [02:30<00:36,  1.36s/it]Processing groups:  83%|████████▎ | 83/100 [02:31<00:11,  1.53it/s]Processing groups:  93%|█████████▎| 93/100 [02:31<00:02,  2.63it/s]Processing groups:  97%|█████████▋| 97/100 [02:36<00:01,  1.84it/s]Processing groups: 100%|██████████| 100/100 [02:36<00:00,  1.57s/it]
{'replicate_reproducibility': 0.07, 'mp_value': 0.08, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35439.83it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:22:11, 49.81s/it]Processing groups:   3%|▎         | 3/100 [00:51<21:45, 13.46s/it]  Processing groups:  16%|█▌        | 16/100 [00:52<02:27,  1.76s/it]Processing groups:  20%|██        | 20/100 [00:53<01:48,  1.35s/it]Processing groups:  33%|███▎      | 33/100 [01:35<02:42,  2.42s/it]Processing groups:  35%|███▌      | 35/100 [01:37<02:29,  2.29s/it]Processing groups:  38%|███▊      | 38/100 [01:40<02:03,  1.99s/it]Processing groups:  39%|███▉      | 39/100 [01:40<01:52,  1.85s/it]Processing groups:  41%|████      | 41/100 [01:42<01:42,  1.74s/it]Processing groups:  51%|█████     | 51/100 [01:44<00:40,  1.20it/s]Processing groups:  57%|█████▋    | 57/100 [01:45<00:25,  1.69it/s]Processing groups:  64%|██████▍   | 64/100 [01:45<00:14,  2.49it/s]Processing groups:  65%|██████▌   | 65/100 [02:24<01:45,  3.02s/it]Processing groups:  69%|██████▉   | 69/100 [02:26<01:10,  2.27s/it]Processing groups:  70%|███████   | 70/100 [02:27<01:06,  2.20s/it]Processing groups:  71%|███████   | 71/100 [02:27<00:57,  1.99s/it]Processing groups:  72%|███████▏  | 72/100 [02:29<00:54,  1.95s/it]Processing groups:  89%|████████▉ | 89/100 [02:29<00:04,  2.22it/s]Processing groups:  92%|█████████▏| 92/100 [02:30<00:03,  2.48it/s]Processing groups:  97%|█████████▋| 97/100 [02:34<00:01,  1.88it/s]Processing groups:  99%|█████████▉| 99/100 [02:34<00:00,  2.09it/s]Processing groups: 100%|██████████| 100/100 [02:34<00:00,  1.55s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.02, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34050.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:21:08, 49.18s/it]Processing groups:   2%|▏         | 2/100 [00:53<36:48, 22.54s/it]  Processing groups:  13%|█▎        | 13/100 [00:53<03:14,  2.23s/it]Processing groups:  13%|█▎        | 13/100 [01:12<03:14,  2.23s/it]Processing groups:  33%|███▎      | 33/100 [01:34<02:20,  2.09s/it]Processing groups:  34%|███▍      | 34/100 [01:34<02:12,  2.01s/it]Processing groups:  36%|███▌      | 36/100 [01:37<02:03,  1.93s/it]Processing groups:  38%|███▊      | 38/100 [01:39<01:52,  1.82s/it]Processing groups:  40%|████      | 40/100 [01:39<01:31,  1.53s/it]Processing groups:  42%|████▏     | 42/100 [01:41<01:20,  1.38s/it]Processing groups:  44%|████▍     | 44/100 [01:42<01:07,  1.20s/it]Processing groups:  52%|█████▏    | 52/100 [01:42<00:25,  1.85it/s]Processing groups:  59%|█████▉    | 59/100 [01:45<00:18,  2.18it/s]Processing groups:  59%|█████▉    | 59/100 [02:02<00:18,  2.18it/s]Processing groups:  65%|██████▌   | 65/100 [02:23<01:26,  2.48s/it]Processing groups:  68%|██████▊   | 68/100 [02:25<01:07,  2.11s/it]Processing groups:  70%|███████   | 70/100 [02:28<01:00,  2.01s/it]Processing groups:  77%|███████▋  | 77/100 [02:29<00:26,  1.17s/it]Processing groups:  83%|████████▎ | 83/100 [02:30<00:13,  1.23it/s]Processing groups:  92%|█████████▏| 92/100 [02:30<00:03,  2.10it/s]Processing groups:  96%|█████████▌| 96/100 [02:30<00:01,  2.63it/s]Processing groups:  99%|█████████▉| 99/100 [02:34<00:00,  1.73it/s]Processing groups: 100%|██████████| 100/100 [02:34<00:00,  1.55s/it]
{'replicate_reproducibility': 0.023333333333333334, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31340.54it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:23, 46.30s/it]Processing groups:   3%|▎         | 3/100 [00:47<19:54, 12.31s/it]  Processing groups:   5%|▌         | 5/100 [00:52<11:34,  7.31s/it]Processing groups:  33%|███▎      | 33/100 [01:34<02:14,  2.01s/it]Processing groups:  36%|███▌      | 36/100 [01:36<01:57,  1.84s/it]Processing groups:  38%|███▊      | 38/100 [01:36<01:45,  1.69s/it]Processing groups:  41%|████      | 41/100 [01:37<01:22,  1.40s/it]Processing groups:  45%|████▌     | 45/100 [01:37<00:58,  1.07s/it]Processing groups:  51%|█████     | 51/100 [01:39<00:40,  1.22it/s]Processing groups:  55%|█████▌    | 55/100 [01:42<00:33,  1.34it/s]Processing groups:  59%|█████▉    | 59/100 [01:42<00:22,  1.80it/s]Processing groups:  61%|██████    | 61/100 [01:42<00:20,  1.89it/s]Processing groups:  64%|██████▍   | 64/100 [01:43<00:15,  2.35it/s]Processing groups:  65%|██████▌   | 65/100 [02:20<02:35,  4.45s/it]Processing groups:  66%|██████▌   | 66/100 [02:24<02:26,  4.32s/it]Processing groups:  70%|███████   | 70/100 [02:24<01:15,  2.50s/it]Processing groups:  73%|███████▎  | 73/100 [02:25<00:48,  1.80s/it]Processing groups:  80%|████████  | 80/100 [02:26<00:18,  1.10it/s]Processing groups:  82%|████████▏ | 82/100 [02:26<00:14,  1.26it/s]Processing groups:  85%|████████▌ | 85/100 [02:27<00:09,  1.53it/s]Processing groups:  89%|████████▉ | 89/100 [02:27<00:05,  2.12it/s]Processing groups:  95%|█████████▌| 95/100 [02:28<00:01,  3.25it/s]Processing groups:  97%|█████████▋| 97/100 [02:32<00:01,  1.78it/s]Processing groups:  98%|█████████▊| 98/100 [02:32<00:01,  1.80it/s]Processing groups: 100%|██████████| 100/100 [02:32<00:00,  2.27it/s]Processing groups: 100%|██████████| 100/100 [02:32<00:00,  1.53s/it]
{'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.49, 'mean_ap': 0.0, 'mean_ap_p_value': 0.15, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35990.25it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:21:31, 49.41s/it]Processing groups:   4%|▍         | 4/100 [00:50<15:14,  9.52s/it]  Processing groups:   7%|▋         | 7/100 [00:50<06:57,  4.49s/it]Processing groups:  10%|█         | 10/100 [00:52<04:16,  2.85s/it]Processing groups:  33%|███▎      | 33/100 [01:34<02:14,  2.00s/it]Processing groups:  34%|███▍      | 34/100 [01:35<02:07,  1.93s/it]Processing groups:  35%|███▌      | 35/100 [01:35<02:00,  1.86s/it]Processing groups:  37%|███▋      | 37/100 [01:36<01:42,  1.62s/it]Processing groups:  38%|███▊      | 38/100 [01:39<01:50,  1.79s/it]Processing groups:  40%|████      | 40/100 [01:42<01:43,  1.72s/it]Processing groups:  58%|█████▊    | 58/100 [01:43<00:18,  2.23it/s]Processing groups:  64%|██████▍   | 64/100 [01:43<00:12,  2.83it/s]Processing groups:  64%|██████▍   | 64/100 [02:02<00:12,  2.83it/s]Processing groups:  65%|██████▌   | 65/100 [02:22<01:31,  2.61s/it]Processing groups:  66%|██████▌   | 66/100 [02:23<01:23,  2.45s/it]Processing groups:  70%|███████   | 70/100 [02:25<00:57,  1.92s/it]Processing groups:  74%|███████▍  | 74/100 [02:27<00:37,  1.44s/it]Processing groups:  76%|███████▌  | 76/100 [02:27<00:29,  1.24s/it]Processing groups:  79%|███████▉  | 79/100 [02:28<00:19,  1.09it/s]Processing groups:  81%|████████  | 81/100 [02:28<00:14,  1.27it/s]Processing groups:  92%|█████████▏| 92/100 [02:29<00:02,  3.06it/s]Processing groups:  97%|█████████▋| 97/100 [02:33<00:01,  2.20it/s]Processing groups:  99%|█████████▉| 99/100 [02:33<00:00,  2.32it/s]Processing groups: 100%|██████████| 100/100 [02:33<00:00,  2.47it/s]Processing groups: 100%|██████████| 100/100 [02:33<00:00,  1.54s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.35, 'mean_ap': 0.03, 'mean_ap_p_value': 0.41, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43882.65it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:17:47, 47.14s/it]Processing groups:   2%|▏         | 2/100 [00:49<34:22, 21.04s/it]  Processing groups:   6%|▌         | 6/100 [00:50<07:38,  4.88s/it]Processing groups:  10%|█         | 10/100 [00:51<03:38,  2.43s/it]Processing groups:  18%|█▊        | 18/100 [00:51<01:23,  1.02s/it]Processing groups:  33%|███▎      | 33/100 [01:33<02:20,  2.10s/it]Processing groups:  34%|███▍      | 34/100 [01:35<02:19,  2.11s/it]Processing groups:  35%|███▌      | 35/100 [01:36<02:12,  2.03s/it]Processing groups:  40%|████      | 40/100 [01:36<01:21,  1.36s/it]Processing groups:  41%|████      | 41/100 [01:37<01:16,  1.29s/it]Processing groups:  42%|████▏     | 42/100 [01:39<01:15,  1.31s/it]Processing groups:  48%|████▊     | 48/100 [01:44<00:55,  1.08s/it]Processing groups:  65%|██████▌   | 65/100 [02:21<01:04,  1.84s/it]Processing groups:  68%|██████▊   | 68/100 [02:24<00:54,  1.71s/it]Processing groups:  74%|███████▍  | 74/100 [02:25<00:32,  1.24s/it]Processing groups:  77%|███████▋  | 77/100 [02:25<00:24,  1.06s/it]Processing groups:  79%|███████▉  | 79/100 [02:26<00:20,  1.04it/s]Processing groups:  84%|████████▍ | 84/100 [02:27<00:11,  1.45it/s]Processing groups:  92%|█████████▏| 92/100 [02:27<00:03,  2.46it/s]Processing groups:  94%|█████████▍| 94/100 [02:28<00:02,  2.60it/s]Processing groups:  95%|█████████▌| 95/100 [02:28<00:01,  2.76it/s]Processing groups:  97%|█████████▋| 97/100 [02:32<00:02,  1.39it/s]Processing groups: 100%|██████████| 100/100 [02:32<00:00,  1.53s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.95, 'mean_ap': 0.22, 'mean_ap_p_value': 0.95, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 46979.21it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:18:18, 47.46s/it]Processing groups:   2%|▏         | 2/100 [00:49<34:17, 21.00s/it]  Processing groups:   7%|▋         | 7/100 [00:51<06:32,  4.22s/it]Processing groups:  10%|█         | 10/100 [00:53<04:15,  2.84s/it]Processing groups:  33%|███▎      | 33/100 [01:33<02:10,  1.95s/it]Processing groups:  35%|███▌      | 35/100 [01:34<01:57,  1.81s/it]Processing groups:  36%|███▌      | 36/100 [01:37<01:58,  1.85s/it]Processing groups:  38%|███▊      | 38/100 [01:37<01:38,  1.58s/it]Processing groups:  42%|████▏     | 42/100 [01:37<01:06,  1.16s/it]Processing groups:  44%|████▍     | 44/100 [01:39<00:58,  1.05s/it]Processing groups:  45%|████▌     | 45/100 [01:41<01:04,  1.17s/it]Processing groups:  47%|████▋     | 47/100 [01:42<00:54,  1.03s/it]Processing groups:  60%|██████    | 60/100 [01:44<00:16,  2.38it/s]Processing groups:  65%|██████▌   | 65/100 [02:22<01:24,  2.41s/it]Processing groups:  66%|██████▌   | 66/100 [02:23<01:19,  2.33s/it]Processing groups:  68%|██████▊   | 68/100 [02:24<01:02,  1.96s/it]Processing groups:  69%|██████▉   | 69/100 [02:26<01:02,  2.00s/it]Processing groups:  74%|███████▍  | 74/100 [02:27<00:31,  1.21s/it]Processing groups:  75%|███████▌  | 75/100 [02:28<00:29,  1.20s/it]Processing groups:  83%|████████▎ | 83/100 [02:29<00:09,  1.81it/s]Processing groups:  89%|████████▉ | 89/100 [02:29<00:03,  2.78it/s]Processing groups:  91%|█████████ | 91/100 [02:29<00:03,  2.95it/s]Processing groups:  95%|█████████▌| 95/100 [02:30<00:01,  3.90it/s]Processing groups:  97%|█████████▋| 97/100 [02:34<00:01,  1.73it/s]Processing groups:  99%|█████████▉| 99/100 [02:34<00:00,  1.94it/s]Processing groups: 100%|██████████| 100/100 [02:34<00:00,  1.55s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 0.95, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}

Processing n_plates: 4

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29108.92it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:07, 33.41s/it]Processing groups:   3%|▎         | 3/100 [00:33<14:14,  8.81s/it]Processing groups:   9%|▉         | 9/100 [00:35<03:32,  2.33s/it]Processing groups:  17%|█▋        | 17/100 [00:36<01:22,  1.00it/s]Processing groups:  21%|██        | 21/100 [00:37<01:02,  1.27it/s]Processing groups:  29%|██▉       | 29/100 [00:38<00:34,  2.04it/s]Processing groups:  33%|███▎      | 33/100 [01:02<02:02,  1.83s/it]Processing groups:  34%|███▍      | 34/100 [01:07<02:18,  2.09s/it]Processing groups:  35%|███▌      | 35/100 [01:09<02:14,  2.07s/it]Processing groups:  40%|████      | 40/100 [01:10<01:17,  1.29s/it]Processing groups:  48%|████▊     | 48/100 [01:10<00:35,  1.47it/s]Processing groups:  50%|█████     | 50/100 [01:12<00:37,  1.34it/s]Processing groups:  51%|█████     | 51/100 [01:12<00:33,  1.46it/s]Processing groups:  54%|█████▍    | 54/100 [01:14<00:28,  1.61it/s]Processing groups:  55%|█████▌    | 55/100 [01:14<00:25,  1.75it/s]Processing groups:  64%|██████▍   | 64/100 [01:15<00:11,  3.23it/s]Processing groups:  65%|██████▌   | 65/100 [01:34<01:08,  1.95s/it]Processing groups:  66%|██████▌   | 66/100 [01:36<01:05,  1.92s/it]Processing groups:  67%|██████▋   | 67/100 [01:43<01:26,  2.61s/it]Processing groups:  76%|███████▌  | 76/100 [01:43<00:23,  1.04it/s]Processing groups:  78%|███████▊  | 78/100 [01:44<00:18,  1.20it/s]Processing groups:  80%|████████  | 80/100 [01:44<00:15,  1.32it/s]Processing groups:  91%|█████████ | 91/100 [01:45<00:02,  3.04it/s]Processing groups:  94%|█████████▍| 94/100 [01:46<00:01,  3.21it/s]Processing groups:  97%|█████████▋| 97/100 [01:47<00:01,  2.73it/s]Processing groups:  98%|█████████▊| 98/100 [01:48<00:00,  2.66it/s]Processing groups:  99%|█████████▉| 99/100 [01:48<00:00,  2.83it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.09s/it]
{'replicate_reproducibility': 0.041666666666666664, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36523.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<52:50, 32.03s/it]Processing groups:   3%|▎         | 3/100 [00:33<14:05,  8.71s/it]Processing groups:   4%|▍         | 4/100 [00:34<09:48,  6.13s/it]Processing groups:   7%|▋         | 7/100 [00:35<04:14,  2.73s/it]Processing groups:  12%|█▏        | 12/100 [00:36<01:43,  1.18s/it]Processing groups:  18%|█▊        | 18/100 [00:36<00:50,  1.63it/s]Processing groups:  30%|███       | 30/100 [00:37<00:22,  3.06it/s]Processing groups:  33%|███▎      | 33/100 [01:06<02:09,  1.94s/it]Processing groups:  34%|███▍      | 34/100 [01:07<02:01,  1.84s/it]Processing groups:  36%|███▌      | 36/100 [01:08<01:41,  1.59s/it]Processing groups:  37%|███▋      | 37/100 [01:09<01:37,  1.55s/it]Processing groups:  38%|███▊      | 38/100 [01:09<01:25,  1.38s/it]Processing groups:  39%|███▉      | 39/100 [01:10<01:11,  1.17s/it]Processing groups:  43%|████▎     | 43/100 [01:10<00:37,  1.53it/s]Processing groups:  49%|████▉     | 49/100 [01:12<00:27,  1.88it/s]Processing groups:  56%|█████▌    | 56/100 [01:13<00:13,  3.22it/s]Processing groups:  58%|█████▊    | 58/100 [01:13<00:11,  3.62it/s]Processing groups:  60%|██████    | 60/100 [01:13<00:09,  4.26it/s]Processing groups:  60%|██████    | 60/100 [01:26<00:09,  4.26it/s]Processing groups:  65%|██████▌   | 65/100 [01:42<01:26,  2.46s/it]Processing groups:  66%|██████▌   | 66/100 [01:44<01:20,  2.37s/it]Processing groups:  75%|███████▌  | 75/100 [01:45<00:26,  1.07s/it]Processing groups:  78%|███████▊  | 78/100 [01:45<00:19,  1.11it/s]Processing groups:  82%|████████▏ | 82/100 [01:46<00:12,  1.44it/s]Processing groups:  88%|████████▊ | 88/100 [01:47<00:05,  2.16it/s]Processing groups:  92%|█████████▏| 92/100 [01:47<00:02,  2.78it/s]Processing groups:  97%|█████████▋| 97/100 [01:50<00:01,  2.44it/s]Processing groups:  98%|█████████▊| 98/100 [01:50<00:00,  2.60it/s]Processing groups: 100%|██████████| 100/100 [01:50<00:00,  1.10s/it]
{'replicate_reproducibility': 0.025, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35581.13it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:21, 31.73s/it]Processing groups:   2%|▏         | 2/100 [00:35<25:13, 15.44s/it]Processing groups:  12%|█▏        | 12/100 [00:38<02:42,  1.84s/it]Processing groups:  33%|███▎      | 33/100 [01:03<01:33,  1.39s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:45,  1.60s/it]Processing groups:  37%|███▋      | 37/100 [01:10<01:25,  1.36s/it]Processing groups:  41%|████      | 41/100 [01:10<01:01,  1.04s/it]Processing groups:  46%|████▌     | 46/100 [01:10<00:40,  1.34it/s]Processing groups:  51%|█████     | 51/100 [01:11<00:28,  1.73it/s]Processing groups:  53%|█████▎    | 53/100 [01:11<00:24,  1.90it/s]Processing groups:  58%|█████▊    | 58/100 [01:13<00:18,  2.24it/s]Processing groups:  62%|██████▏   | 62/100 [01:13<00:12,  3.02it/s]Processing groups:  64%|██████▍   | 64/100 [01:18<00:23,  1.51it/s]Processing groups:  65%|██████▌   | 65/100 [01:34<01:22,  2.37s/it]Processing groups:  66%|██████▌   | 66/100 [01:42<01:44,  3.08s/it]Processing groups:  67%|██████▋   | 67/100 [01:43<01:30,  2.74s/it]Processing groups:  73%|███████▎  | 73/100 [01:45<00:35,  1.33s/it]Processing groups:  81%|████████  | 81/100 [01:45<00:12,  1.53it/s]Processing groups:  82%|████████▏ | 82/100 [01:46<00:11,  1.51it/s]Processing groups:  95%|█████████▌| 95/100 [01:46<00:01,  3.61it/s]Processing groups:  97%|█████████▋| 97/100 [01:49<00:01,  2.51it/s]Processing groups:  99%|█████████▉| 99/100 [01:49<00:00,  2.66it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.10s/it]
{'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37052.16it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:43, 31.35s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:40, 14.49s/it]Processing groups:   5%|▌         | 5/100 [00:34<06:52,  4.34s/it]Processing groups:   8%|▊         | 8/100 [00:35<03:27,  2.25s/it]Processing groups:  21%|██        | 21/100 [00:37<00:51,  1.53it/s]Processing groups:  33%|███▎      | 33/100 [01:02<01:32,  1.37s/it]Processing groups:  34%|███▍      | 34/100 [01:07<01:45,  1.60s/it]Processing groups:  36%|███▌      | 36/100 [01:10<01:38,  1.54s/it]Processing groups:  48%|████▊     | 48/100 [01:10<00:36,  1.41it/s]Processing groups:  51%|█████     | 51/100 [01:13<00:37,  1.30it/s]Processing groups:  63%|██████▎   | 63/100 [01:15<00:17,  2.13it/s]Processing groups:  63%|██████▎   | 63/100 [01:33<00:17,  2.13it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<00:52,  1.50s/it]Processing groups:  67%|██████▋   | 67/100 [01:40<00:51,  1.57s/it]Processing groups:  70%|███████   | 70/100 [01:41<00:39,  1.30s/it]Processing groups:  71%|███████   | 71/100 [01:41<00:35,  1.21s/it]Processing groups:  72%|███████▏  | 72/100 [01:42<00:31,  1.13s/it]Processing groups:  76%|███████▌  | 76/100 [01:46<00:25,  1.07s/it]Processing groups:  93%|█████████▎| 93/100 [01:46<00:02,  3.09it/s]Processing groups:  97%|█████████▋| 97/100 [01:49<00:01,  2.61it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.09s/it]
{'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.12, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38469.27it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:16, 33.50s/it]Processing groups:   4%|▍         | 4/100 [00:33<10:20,  6.46s/it]Processing groups:   7%|▋         | 7/100 [00:34<04:40,  3.02s/it]Processing groups:   9%|▉         | 9/100 [00:35<03:27,  2.28s/it]Processing groups:  10%|█         | 10/100 [00:36<02:51,  1.91s/it]Processing groups:  11%|█         | 11/100 [00:37<02:42,  1.82s/it]Processing groups:  19%|█▉        | 19/100 [00:38<00:46,  1.75it/s]Processing groups:  22%|██▏       | 22/100 [00:40<00:48,  1.61it/s]Processing groups:  33%|███▎      | 33/100 [01:07<01:54,  1.71s/it]Processing groups:  37%|███▋      | 37/100 [01:09<01:29,  1.43s/it]Processing groups:  43%|████▎     | 43/100 [01:11<01:01,  1.08s/it]Processing groups:  54%|█████▍    | 54/100 [01:12<00:28,  1.63it/s]Processing groups:  56%|█████▌    | 56/100 [01:12<00:24,  1.79it/s]Processing groups:  57%|█████▋    | 57/100 [01:18<00:40,  1.07it/s]Processing groups:  65%|██████▌   | 65/100 [01:38<00:56,  1.61s/it]Processing groups:  66%|██████▌   | 66/100 [01:42<01:01,  1.82s/it]Processing groups:  69%|██████▉   | 69/100 [01:44<00:46,  1.49s/it]Processing groups:  73%|███████▎  | 73/100 [01:45<00:30,  1.12s/it]Processing groups:  89%|████████▉ | 89/100 [01:45<00:04,  2.42it/s]Processing groups:  93%|█████████▎| 93/100 [01:46<00:02,  2.76it/s]Processing groups:  96%|█████████▌| 96/100 [01:47<00:01,  2.78it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:01,  2.27it/s]Processing groups:  98%|█████████▊| 98/100 [01:49<00:00,  2.25it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.09s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.18, 'mean_ap': 0.01, 'mean_ap_p_value': 0.31, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 46837.57it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<54:52, 33.26s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:13, 14.83s/it]Processing groups:  13%|█▎        | 13/100 [00:36<02:14,  1.54s/it]Processing groups:  26%|██▌       | 26/100 [00:36<00:45,  1.62it/s]Processing groups:  26%|██▌       | 26/100 [00:53<00:45,  1.62it/s]Processing groups:  33%|███▎      | 33/100 [00:58<01:35,  1.42s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:59,  1.81s/it]Processing groups:  38%|███▊      | 38/100 [01:11<01:44,  1.68s/it]Processing groups:  42%|████▏     | 42/100 [01:13<01:19,  1.38s/it]Processing groups:  51%|█████     | 51/100 [01:15<00:40,  1.22it/s]Processing groups:  65%|██████▌   | 65/100 [01:32<00:35,  1.02s/it]Processing groups:  66%|██████▌   | 66/100 [01:42<00:49,  1.45s/it]Processing groups:  72%|███████▏  | 72/100 [01:43<00:30,  1.10s/it]Processing groups:  77%|███████▋  | 77/100 [01:43<00:18,  1.22it/s]Processing groups:  79%|███████▉  | 79/100 [01:44<00:16,  1.30it/s]Processing groups:  87%|████████▋ | 87/100 [01:45<00:05,  2.17it/s]Processing groups:  91%|█████████ | 91/100 [01:45<00:03,  2.74it/s]Processing groups:  93%|█████████▎| 93/100 [01:45<00:02,  3.00it/s]Processing groups:  95%|█████████▌| 95/100 [01:45<00:01,  3.49it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:01,  2.08it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.08s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 0.23, 'mean_ap_p_value': 0.94, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36076.93it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<47:51, 29.01s/it]Processing groups:   2%|▏         | 2/100 [00:35<25:26, 15.58s/it]Processing groups:   6%|▌         | 6/100 [00:36<05:58,  3.82s/it]Processing groups:  13%|█▎        | 13/100 [00:36<01:56,  1.34s/it]Processing groups:  20%|██        | 20/100 [00:36<00:55,  1.43it/s]Processing groups:  25%|██▌       | 25/100 [00:37<00:36,  2.06it/s]Processing groups:  25%|██▌       | 25/100 [00:53<00:36,  2.06it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:45,  1.58s/it]Processing groups:  34%|███▍      | 34/100 [01:05<01:53,  1.72s/it]Processing groups:  36%|███▌      | 36/100 [01:07<01:42,  1.60s/it]Processing groups:  38%|███▊      | 38/100 [01:07<01:25,  1.38s/it]Processing groups:  41%|████      | 41/100 [01:08<01:01,  1.03s/it]Processing groups:  42%|████▏     | 42/100 [01:09<01:02,  1.08s/it]Processing groups:  45%|████▌     | 45/100 [01:11<00:47,  1.16it/s]Processing groups:  54%|█████▍    | 54/100 [01:14<00:25,  1.79it/s]Processing groups:  60%|██████    | 60/100 [01:15<00:16,  2.39it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<00:52,  1.50s/it]Processing groups:  66%|██████▌   | 66/100 [01:42<01:05,  1.93s/it]Processing groups:  73%|███████▎  | 73/100 [01:42<00:29,  1.09s/it]Processing groups:  75%|███████▌  | 75/100 [01:44<00:26,  1.07s/it]Processing groups:  85%|████████▌ | 85/100 [01:45<00:08,  1.84it/s]Processing groups:  95%|█████████▌| 95/100 [01:45<00:01,  3.11it/s]Processing groups:  98%|█████████▊| 98/100 [01:48<00:00,  2.38it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.08s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.19, 'mean_ap': 0.69, 'mean_ap_p_value': 0.99, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43155.72it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:09:08, 41.91s/it]Processing groups:   2%|▏         | 2/100 [00:42<29:06, 17.82s/it]  Processing groups:   4%|▍         | 4/100 [00:45<12:01,  7.51s/it]Processing groups:  33%|███▎      | 33/100 [01:22<01:54,  1.72s/it]Processing groups:  34%|███▍      | 34/100 [01:22<01:49,  1.65s/it]Processing groups:  36%|███▌      | 36/100 [01:23<01:35,  1.49s/it]Processing groups:  37%|███▋      | 37/100 [01:23<01:30,  1.43s/it]Processing groups:  39%|███▉      | 39/100 [01:25<01:21,  1.34s/it]Processing groups:  40%|████      | 40/100 [01:26<01:17,  1.30s/it]Processing groups:  41%|████      | 41/100 [01:26<01:08,  1.15s/it]Processing groups:  43%|████▎     | 43/100 [01:27<00:52,  1.08it/s]Processing groups:  45%|████▌     | 45/100 [01:27<00:37,  1.48it/s]Processing groups:  47%|████▋     | 47/100 [01:28<00:33,  1.60it/s]Processing groups:  55%|█████▌    | 55/100 [01:29<00:13,  3.42it/s]Processing groups:  56%|█████▌    | 56/100 [01:29<00:14,  3.00it/s]Processing groups:  59%|█████▉    | 59/100 [01:31<00:17,  2.30it/s]Processing groups:  65%|██████▌   | 65/100 [02:01<01:28,  2.52s/it]Processing groups:  66%|██████▌   | 66/100 [02:07<01:36,  2.84s/it]Processing groups:  73%|███████▎  | 73/100 [02:09<00:42,  1.56s/it]Processing groups:  74%|███████▍  | 74/100 [02:10<00:39,  1.52s/it]Processing groups:  80%|████████  | 80/100 [02:10<00:17,  1.15it/s]Processing groups:  94%|█████████▍| 94/100 [02:11<00:02,  2.65it/s]Processing groups:  97%|█████████▋| 97/100 [02:15<00:01,  1.92it/s]Processing groups: 100%|██████████| 100/100 [02:15<00:00,  1.35s/it]
{'replicate_reproducibility': 0.06, 'mp_value': 0.02, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 45664.71it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:08:57, 41.79s/it]Processing groups:   3%|▎         | 3/100 [00:43<18:20, 11.35s/it]  Processing groups:   4%|▍         | 4/100 [00:43<11:57,  7.48s/it]Processing groups:   8%|▊         | 8/100 [00:43<03:59,  2.61s/it]Processing groups:  15%|█▌        | 15/100 [00:45<01:38,  1.15s/it]Processing groups:  25%|██▌       | 25/100 [00:45<00:38,  1.94it/s]Processing groups:  29%|██▉       | 29/100 [00:47<00:34,  2.07it/s]Processing groups:  29%|██▉       | 29/100 [01:07<00:34,  2.07it/s]Processing groups:  33%|███▎      | 33/100 [01:23<02:58,  2.66s/it]Processing groups:  37%|███▋      | 37/100 [01:24<02:06,  2.00s/it]Processing groups:  39%|███▉      | 39/100 [01:26<01:53,  1.85s/it]Processing groups:  41%|████      | 41/100 [01:27<01:36,  1.64s/it]Processing groups:  52%|█████▏    | 52/100 [01:29<00:35,  1.36it/s]Processing groups:  57%|█████▋    | 57/100 [01:29<00:23,  1.82it/s]Processing groups:  60%|██████    | 60/100 [01:33<00:28,  1.41it/s]Processing groups:  65%|██████▌   | 65/100 [02:04<01:26,  2.46s/it]Processing groups:  66%|██████▌   | 66/100 [02:05<01:18,  2.32s/it]Processing groups:  68%|██████▊   | 68/100 [02:06<01:01,  1.93s/it]Processing groups:  71%|███████   | 71/100 [02:07<00:43,  1.51s/it]Processing groups:  73%|███████▎  | 73/100 [02:08<00:34,  1.27s/it]Processing groups:  81%|████████  | 81/100 [02:09<00:11,  1.60it/s]Processing groups:  89%|████████▉ | 89/100 [02:09<00:03,  2.79it/s]Processing groups:  91%|█████████ | 91/100 [02:10<00:03,  2.67it/s]Processing groups:  96%|█████████▌| 96/100 [02:10<00:01,  3.47it/s]Processing groups:  98%|█████████▊| 98/100 [02:14<00:01,  1.96it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
{'replicate_reproducibility': 0.04, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36443.69it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:12:01, 43.66s/it]Processing groups:  17%|█▋        | 17/100 [00:44<02:34,  1.86s/it] Processing groups:  30%|███       | 30/100 [00:44<01:02,  1.12it/s]Processing groups:  30%|███       | 30/100 [01:02<01:02,  1.12it/s]Processing groups:  33%|███▎      | 33/100 [01:20<02:50,  2.55s/it]Processing groups:  34%|███▍      | 34/100 [01:23<02:47,  2.54s/it]Processing groups:  36%|███▌      | 36/100 [01:25<02:29,  2.33s/it]Processing groups:  38%|███▊      | 38/100 [01:26<02:01,  1.96s/it]Processing groups:  43%|████▎     | 43/100 [01:27<01:13,  1.29s/it]Processing groups:  47%|████▋     | 47/100 [01:29<00:55,  1.05s/it]Processing groups:  62%|██████▏   | 62/100 [01:30<00:15,  2.46it/s]Processing groups:  62%|██████▏   | 62/100 [01:42<00:15,  2.46it/s]Processing groups:  65%|██████▌   | 65/100 [02:03<01:11,  2.05s/it]Processing groups:  66%|██████▌   | 66/100 [02:03<01:05,  1.93s/it]Processing groups:  68%|██████▊   | 68/100 [02:07<01:00,  1.88s/it]Processing groups:  70%|███████   | 70/100 [02:08<00:48,  1.61s/it]Processing groups:  73%|███████▎  | 73/100 [02:08<00:31,  1.17s/it]Processing groups:  80%|████████  | 80/100 [02:09<00:13,  1.49it/s]Processing groups:  84%|████████▍ | 84/100 [02:09<00:07,  2.05it/s]Processing groups:  88%|████████▊ | 88/100 [02:09<00:04,  2.65it/s]Processing groups:  97%|█████████▋| 97/100 [02:13<00:01,  2.42it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  2.89it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35338.31it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:40<1:07:36, 40.98s/it]Processing groups:   2%|▏         | 2/100 [00:42<29:22, 17.99s/it]  Processing groups:   3%|▎         | 3/100 [00:44<16:54, 10.46s/it]Processing groups:   7%|▋         | 7/100 [00:44<04:32,  2.93s/it]Processing groups:  13%|█▎        | 13/100 [00:45<01:44,  1.20s/it]Processing groups:  24%|██▍       | 24/100 [00:45<00:35,  2.13it/s]Processing groups:  24%|██▍       | 24/100 [00:56<00:35,  2.13it/s]Processing groups:  33%|███▎      | 33/100 [01:19<02:04,  1.85s/it]Processing groups:  34%|███▍      | 34/100 [01:21<02:05,  1.90s/it]Processing groups:  37%|███▋      | 37/100 [01:24<01:45,  1.67s/it]Processing groups:  39%|███▉      | 39/100 [01:27<01:39,  1.63s/it]Processing groups:  55%|█████▌    | 55/100 [01:27<00:26,  1.73it/s]Processing groups:  58%|█████▊    | 58/100 [01:28<00:23,  1.79it/s]Processing groups:  60%|██████    | 60/100 [01:29<00:21,  1.83it/s]Processing groups:  64%|██████▍   | 64/100 [01:30<00:15,  2.40it/s]Processing groups:  64%|██████▍   | 64/100 [01:46<00:15,  2.40it/s]Processing groups:  65%|██████▌   | 65/100 [02:00<01:45,  3.00s/it]Processing groups:  66%|██████▌   | 66/100 [02:02<01:38,  2.89s/it]Processing groups:  69%|██████▉   | 69/100 [02:02<01:01,  1.98s/it]Processing groups:  71%|███████   | 71/100 [02:07<01:01,  2.12s/it]Processing groups:  86%|████████▌ | 86/100 [02:08<00:08,  1.57it/s]Processing groups:  96%|█████████▌| 96/100 [02:09<00:01,  2.38it/s]Processing groups:  98%|█████████▊| 98/100 [02:12<00:01,  1.84it/s]Processing groups: 100%|██████████| 100/100 [02:12<00:00,  1.33s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.14, 'mean_ap': 0.0, 'mean_ap_p_value': 0.08, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43405.82it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:08, 43.11s/it]Processing groups:   2%|▏         | 2/100 [00:44<30:26, 18.63s/it]  Processing groups:  25%|██▌       | 25/100 [00:46<01:15,  1.01s/it]Processing groups:  33%|███▎      | 33/100 [01:23<02:25,  2.17s/it]Processing groups:  34%|███▍      | 34/100 [01:25<02:22,  2.16s/it]Processing groups:  49%|████▉     | 49/100 [01:26<00:52,  1.02s/it]Processing groups:  52%|█████▏    | 52/100 [01:28<00:47,  1.02it/s]Processing groups:  54%|█████▍    | 54/100 [01:29<00:41,  1.10it/s]Processing groups:  58%|█████▊    | 58/100 [01:29<00:30,  1.38it/s]Processing groups:  62%|██████▏   | 62/100 [01:31<00:23,  1.63it/s]Processing groups:  64%|██████▍   | 64/100 [01:34<00:26,  1.33it/s]Processing groups:  65%|██████▌   | 65/100 [02:03<02:07,  3.64s/it]Processing groups:  69%|██████▉   | 69/100 [02:07<01:22,  2.67s/it]Processing groups:  70%|███████   | 70/100 [02:07<01:11,  2.39s/it]Processing groups:  71%|███████   | 71/100 [02:08<01:02,  2.17s/it]Processing groups:  77%|███████▋  | 77/100 [02:08<00:22,  1.00it/s]Processing groups:  80%|████████  | 80/100 [02:09<00:15,  1.30it/s]Processing groups:  92%|█████████▏| 92/100 [02:09<00:02,  3.12it/s]Processing groups:  96%|█████████▌| 96/100 [02:10<00:01,  3.56it/s]Processing groups:  98%|█████████▊| 98/100 [02:13<00:00,  2.07it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.34, 'mean_ap': 0.01, 'mean_ap_p_value': 0.4, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43446.28it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:15, 42.58s/it]Processing groups:   5%|▌         | 5/100 [00:49<12:17,  7.76s/it]  Processing groups:  33%|███▎      | 33/100 [01:24<02:09,  1.93s/it]Processing groups:  36%|███▌      | 36/100 [01:24<01:50,  1.73s/it]Processing groups:  37%|███▋      | 37/100 [01:25<01:45,  1.68s/it]Processing groups:  38%|███▊      | 38/100 [01:27<01:43,  1.66s/it]Processing groups:  44%|████▍     | 44/100 [01:27<00:59,  1.06s/it]Processing groups:  46%|████▌     | 46/100 [01:29<00:56,  1.04s/it]Processing groups:  58%|█████▊    | 58/100 [01:30<00:20,  2.10it/s]Processing groups:  59%|█████▉    | 59/100 [01:31<00:21,  1.88it/s]Processing groups:  64%|██████▍   | 64/100 [01:33<00:17,  2.07it/s]Processing groups:  65%|██████▌   | 65/100 [02:07<01:53,  3.24s/it]Processing groups:  70%|███████   | 70/100 [02:07<01:01,  2.07s/it]Processing groups:  72%|███████▏  | 72/100 [02:08<00:50,  1.80s/it]Processing groups:  78%|███████▊  | 78/100 [02:09<00:23,  1.08s/it]Processing groups:  80%|████████  | 80/100 [02:10<00:19,  1.01it/s]Processing groups:  93%|█████████▎| 93/100 [02:10<00:02,  2.52it/s]Processing groups:  96%|█████████▌| 96/100 [02:11<00:01,  2.88it/s]Processing groups:  98%|█████████▊| 98/100 [02:15<00:01,  1.75it/s]Processing groups: 100%|██████████| 100/100 [02:15<00:00,  2.05it/s]Processing groups: 100%|██████████| 100/100 [02:15<00:00,  1.35s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.63, 'mean_ap': 0.09, 'mean_ap_p_value': 0.96, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 46294.75it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:07:43, 41.05s/it]Processing groups:   2%|▏         | 2/100 [00:44<31:11, 19.10s/it]  Processing groups:   3%|▎         | 3/100 [00:44<16:52, 10.44s/it]Processing groups:   5%|▌         | 5/100 [00:46<07:58,  5.04s/it]Processing groups:  12%|█▏        | 12/100 [00:47<02:03,  1.40s/it]Processing groups:  33%|███▎      | 33/100 [01:21<01:44,  1.55s/it]Processing groups:  36%|███▌      | 36/100 [01:22<01:28,  1.39s/it]Processing groups:  37%|███▋      | 37/100 [01:27<01:41,  1.61s/it]Processing groups:  46%|████▌     | 46/100 [01:27<00:50,  1.06it/s]Processing groups:  51%|█████     | 51/100 [01:28<00:35,  1.37it/s]Processing groups:  59%|█████▉    | 59/100 [01:30<00:21,  1.87it/s]Processing groups:  65%|██████▌   | 65/100 [02:01<01:06,  1.89s/it]Processing groups:  66%|██████▌   | 66/100 [02:05<01:08,  2.01s/it]Processing groups:  69%|██████▉   | 69/100 [02:06<00:51,  1.65s/it]Processing groups:  70%|███████   | 70/100 [02:06<00:45,  1.51s/it]Processing groups:  71%|███████   | 71/100 [02:08<00:45,  1.56s/it]Processing groups:  78%|███████▊  | 78/100 [02:08<00:16,  1.36it/s]Processing groups:  81%|████████  | 81/100 [02:09<00:11,  1.67it/s]Processing groups:  87%|████████▋ | 87/100 [02:09<00:04,  2.69it/s]Processing groups:  95%|█████████▌| 95/100 [02:10<00:01,  4.20it/s]Processing groups:  97%|█████████▋| 97/100 [02:13<00:01,  2.22it/s]Processing groups:  99%|█████████▉| 99/100 [02:14<00:00,  2.58it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.97, 'mean_ap': 0.73, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 1, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33746.11it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:27:00, 52.73s/it]Processing groups:   2%|▏         | 2/100 [00:54<37:31, 22.97s/it]  Processing groups:   3%|▎         | 3/100 [00:55<20:24, 12.63s/it]Processing groups:   5%|▌         | 5/100 [00:56<09:26,  5.96s/it]Processing groups:  33%|███▎      | 33/100 [01:46<02:21,  2.12s/it]Processing groups:  35%|███▌      | 35/100 [01:48<02:12,  2.03s/it]Processing groups:  46%|████▌     | 46/100 [01:49<01:06,  1.23s/it]Processing groups:  48%|████▊     | 48/100 [01:51<01:02,  1.20s/it]Processing groups:  52%|█████▏    | 52/100 [01:51<00:46,  1.04it/s]Processing groups:  53%|█████▎    | 53/100 [01:52<00:45,  1.04it/s]Processing groups:  64%|██████▍   | 64/100 [01:55<00:21,  1.68it/s]Processing groups:  65%|██████▌   | 65/100 [02:39<01:57,  3.37s/it]Processing groups:  67%|██████▋   | 67/100 [02:42<01:41,  3.06s/it]Processing groups:  74%|███████▍  | 74/100 [02:43<00:47,  1.81s/it]Processing groups:  80%|████████  | 80/100 [02:44<00:24,  1.21s/it]Processing groups:  88%|████████▊ | 88/100 [02:44<00:08,  1.35it/s]Processing groups:  94%|█████████▍| 94/100 [02:44<00:03,  1.89it/s]Processing groups:  96%|█████████▌| 96/100 [02:44<00:01,  2.13it/s]Processing groups:  98%|█████████▊| 98/100 [02:49<00:01,  1.26it/s]Processing groups: 100%|██████████| 100/100 [02:49<00:00,  1.70s/it]
{'replicate_reproducibility': 0.04666666666666667, 'mp_value': 0.01, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 1, 'differ_params': 1}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1902.70it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:56<1:32:54, 56.31s/it]Processing groups:  33%|███▎      | 33/100 [01:48<03:08,  2.81s/it] Processing groups:  45%|████▌     | 45/100 [01:50<01:43,  1.88s/it]Processing groups:  50%|█████     | 50/100 [01:51<01:20,  1.60s/it]Processing groups:  64%|██████▍   | 64/100 [01:52<00:35,  1.01it/s]Processing groups:  65%|██████▌   | 65/100 [02:36<01:34,  2.71s/it]Processing groups:  66%|██████▌   | 66/100 [02:40<01:33,  2.76s/it]Processing groups:  67%|██████▋   | 67/100 [02:41<01:26,  2.62s/it]Processing groups:  72%|███████▏  | 72/100 [02:42<00:50,  1.80s/it]Processing groups:  82%|████████▏ | 82/100 [02:42<00:16,  1.06it/s]Processing groups:  85%|████████▌ | 85/100 [02:43<00:11,  1.25it/s]Processing groups:  86%|████████▌ | 86/100 [02:43<00:10,  1.30it/s]Processing groups:  96%|█████████▌| 96/100 [02:43<00:01,  2.65it/s]Processing groups:  99%|█████████▉| 99/100 [02:48<00:00,  1.59it/s]Processing groups: 100%|██████████| 100/100 [02:48<00:00,  1.69s/it]
{'replicate_reproducibility': 0.03666666666666667, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36602.71it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:56<1:33:52, 56.90s/it]Processing groups:   3%|▎         | 3/100 [00:57<24:09, 14.94s/it]  Processing groups:  20%|██        | 20/100 [00:57<02:00,  1.51s/it]Processing groups:  25%|██▌       | 25/100 [00:58<01:23,  1.11s/it]Processing groups:  25%|██▌       | 25/100 [01:14<01:23,  1.11s/it]Processing groups:  33%|███▎      | 33/100 [01:45<03:19,  2.97s/it]Processing groups:  34%|███▍      | 34/100 [01:47<03:10,  2.89s/it]Processing groups:  36%|███▌      | 36/100 [01:48<02:44,  2.58s/it]Processing groups:  40%|████      | 40/100 [01:50<01:55,  1.93s/it]Processing groups:  42%|████▏     | 42/100 [01:51<01:32,  1.60s/it]Processing groups:  58%|█████▊    | 58/100 [01:51<00:23,  1.81it/s]Processing groups:  60%|██████    | 60/100 [01:53<00:23,  1.74it/s]Processing groups:  62%|██████▏   | 62/100 [01:53<00:20,  1.90it/s]Processing groups:  65%|██████▌   | 65/100 [02:39<02:11,  3.77s/it]Processing groups:  67%|██████▋   | 67/100 [02:40<01:46,  3.21s/it]Processing groups:  68%|██████▊   | 68/100 [02:40<01:33,  2.93s/it]Processing groups:  70%|███████   | 70/100 [02:41<01:10,  2.34s/it]Processing groups:  73%|███████▎  | 73/100 [02:43<00:46,  1.72s/it]Processing groups:  81%|████████  | 81/100 [02:43<00:14,  1.32it/s]Processing groups:  88%|████████▊ | 88/100 [02:44<00:05,  2.11it/s]Processing groups:  97%|█████████▋| 97/100 [02:49<00:01,  1.86it/s]Processing groups: 100%|██████████| 100/100 [02:49<00:00,  2.19it/s]Processing groups: 100%|██████████| 100/100 [02:49<00:00,  1.70s/it]
{'replicate_reproducibility': 0.028333333333333332, 'mp_value': 0.22, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35267.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:55<1:32:19, 55.95s/it]Processing groups:   2%|▏         | 2/100 [00:56<38:31, 23.58s/it]  Processing groups:   4%|▍         | 4/100 [00:59<15:10,  9.48s/it]Processing groups:  33%|███▎      | 33/100 [01:45<02:24,  2.16s/it]Processing groups:  34%|███▍      | 34/100 [01:48<02:25,  2.21s/it]Processing groups:  40%|████      | 40/100 [01:49<01:38,  1.65s/it]Processing groups:  43%|████▎     | 43/100 [01:50<01:21,  1.42s/it]Processing groups:  48%|████▊     | 48/100 [01:51<00:55,  1.07s/it]Processing groups:  57%|█████▋    | 57/100 [01:52<00:29,  1.46it/s]Processing groups:  61%|██████    | 61/100 [01:54<00:25,  1.50it/s]Processing groups:  64%|██████▍   | 64/100 [01:56<00:23,  1.53it/s]Processing groups:  65%|██████▌   | 65/100 [02:42<02:28,  4.25s/it]Processing groups:  67%|██████▋   | 67/100 [02:42<01:55,  3.50s/it]Processing groups:  68%|██████▊   | 68/100 [02:44<01:47,  3.36s/it]Processing groups:  77%|███████▋  | 77/100 [02:45<00:31,  1.36s/it]Processing groups:  84%|████████▍ | 84/100 [02:45<00:13,  1.16it/s]Processing groups:  89%|████████▉ | 89/100 [02:46<00:06,  1.62it/s]Processing groups:  93%|█████████▎| 93/100 [02:46<00:03,  2.11it/s]Processing groups:  95%|█████████▌| 95/100 [02:46<00:02,  2.39it/s]Processing groups:  97%|█████████▋| 97/100 [02:51<00:02,  1.23it/s]Processing groups:  99%|█████████▉| 99/100 [02:51<00:00,  1.51it/s]Processing groups: 100%|██████████| 100/100 [02:51<00:00,  1.72s/it]
{'replicate_reproducibility': 0.011666666666666667, 'mp_value': 0.08, 'mean_ap': 0.0, 'mean_ap_p_value': 0.1, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32466.17it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:53<1:27:35, 53.09s/it]Processing groups:   2%|▏         | 2/100 [00:53<36:06, 22.10s/it]  Processing groups:   3%|▎         | 3/100 [00:54<20:10, 12.48s/it]Processing groups:   4%|▍         | 4/100 [00:56<13:07,  8.20s/it]Processing groups:   5%|▌         | 5/100 [00:56<08:25,  5.32s/it]Processing groups:  15%|█▌        | 15/100 [00:56<01:15,  1.12it/s]Processing groups:  15%|█▌        | 15/100 [01:10<01:15,  1.12it/s]Processing groups:  33%|███▎      | 33/100 [01:45<02:22,  2.13s/it]Processing groups:  34%|███▍      | 34/100 [01:46<02:15,  2.05s/it]Processing groups:  36%|███▌      | 36/100 [01:47<02:02,  1.91s/it]Processing groups:  37%|███▋      | 37/100 [01:50<02:04,  1.98s/it]Processing groups:  43%|████▎     | 43/100 [01:53<01:18,  1.38s/it]Processing groups:  65%|██████▌   | 65/100 [02:41<01:07,  1.93s/it]Processing groups:  68%|██████▊   | 68/100 [02:42<00:54,  1.71s/it]Processing groups:  70%|███████   | 70/100 [02:43<00:48,  1.62s/it]Processing groups:  75%|███████▌  | 75/100 [02:43<00:30,  1.20s/it]Processing groups:  78%|███████▊  | 78/100 [02:44<00:22,  1.00s/it]Processing groups:  85%|████████▌ | 85/100 [02:44<00:09,  1.58it/s]Processing groups:  89%|████████▉ | 89/100 [02:44<00:05,  2.04it/s]Processing groups:  97%|█████████▋| 97/100 [02:50<00:01,  1.71it/s]Processing groups: 100%|██████████| 100/100 [02:50<00:00,  1.71s/it]
{'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.82, 'mean_ap': 0.0, 'mean_ap_p_value': 0.55, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34022.58it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:51<1:24:51, 51.43s/it]Processing groups:   2%|▏         | 2/100 [00:54<37:24, 22.90s/it]  Processing groups:   3%|▎         | 3/100 [00:54<20:12, 12.50s/it]Processing groups:   9%|▉         | 9/100 [00:55<04:06,  2.71s/it]Processing groups:  23%|██▎       | 23/100 [00:58<01:07,  1.14it/s]Processing groups:  33%|███▎      | 33/100 [01:45<02:48,  2.52s/it]Processing groups:  35%|███▌      | 35/100 [01:46<02:30,  2.31s/it]Processing groups:  36%|███▌      | 36/100 [01:49<02:27,  2.30s/it]Processing groups:  38%|███▊      | 38/100 [01:49<02:01,  1.96s/it]Processing groups:  39%|███▉      | 39/100 [01:51<01:59,  1.95s/it]Processing groups:  49%|████▉     | 49/100 [01:52<00:41,  1.24it/s]Processing groups:  63%|██████▎   | 63/100 [01:55<00:18,  2.01it/s]Processing groups:  65%|██████▌   | 65/100 [02:39<01:32,  2.64s/it]Processing groups:  66%|██████▌   | 66/100 [02:41<01:28,  2.60s/it]Processing groups:  68%|██████▊   | 68/100 [02:41<01:10,  2.20s/it]Processing groups:  70%|███████   | 70/100 [02:41<00:55,  1.84s/it]Processing groups:  81%|████████  | 81/100 [02:42<00:14,  1.31it/s]Processing groups:  86%|████████▌ | 86/100 [02:42<00:08,  1.73it/s]Processing groups:  92%|█████████▏| 92/100 [02:43<00:03,  2.39it/s]Processing groups:  94%|█████████▍| 94/100 [02:43<00:02,  2.46it/s]Processing groups:  96%|█████████▌| 96/100 [02:44<00:01,  2.76it/s]Processing groups:  97%|█████████▋| 97/100 [02:48<00:02,  1.24it/s]Processing groups:  98%|█████████▊| 98/100 [02:49<00:01,  1.38it/s]Processing groups: 100%|██████████| 100/100 [02:49<00:00,  1.69s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 0.06, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 100 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30446.46it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:27:15, 52.89s/it]Processing groups:   2%|▏         | 2/100 [00:54<36:58, 22.64s/it]  Processing groups:   3%|▎         | 3/100 [00:54<20:02, 12.40s/it]Processing groups:   5%|▌         | 5/100 [00:55<08:45,  5.53s/it]Processing groups:  13%|█▎        | 13/100 [00:55<01:55,  1.33s/it]Processing groups:  15%|█▌        | 15/100 [00:56<01:38,  1.16s/it]Processing groups:  23%|██▎       | 23/100 [00:57<00:45,  1.70it/s]Processing groups:  26%|██▌       | 26/100 [00:57<00:34,  2.16it/s]Processing groups:  26%|██▌       | 26/100 [01:07<00:34,  2.16it/s]Processing groups:  33%|███▎      | 33/100 [01:49<03:50,  3.44s/it]Processing groups:  39%|███▉      | 39/100 [01:50<02:21,  2.31s/it]Processing groups:  42%|████▏     | 42/100 [01:51<01:51,  1.92s/it]Processing groups:  43%|████▎     | 43/100 [01:51<01:43,  1.81s/it]Processing groups:  53%|█████▎    | 53/100 [01:52<00:40,  1.17it/s]Processing groups:  63%|██████▎   | 63/100 [01:53<00:18,  2.00it/s]Processing groups:  63%|██████▎   | 63/100 [02:07<00:18,  2.00it/s]Processing groups:  65%|██████▌   | 65/100 [02:37<01:42,  2.94s/it]Processing groups:  66%|██████▌   | 66/100 [02:39<01:37,  2.87s/it]Processing groups:  68%|██████▊   | 68/100 [02:41<01:20,  2.52s/it]Processing groups:  69%|██████▉   | 69/100 [02:42<01:13,  2.37s/it]Processing groups:  72%|███████▏  | 72/100 [02:43<00:47,  1.71s/it]Processing groups:  74%|███████▍  | 74/100 [02:44<00:36,  1.40s/it]Processing groups:  85%|████████▌ | 85/100 [02:44<00:07,  2.01it/s]Processing groups:  95%|█████████▌| 95/100 [02:44<00:01,  3.59it/s]Processing groups:  99%|█████████▉| 99/100 [02:49<00:00,  2.00it/s]Processing groups: 100%|██████████| 100/100 [02:49<00:00,  1.70s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 0.72, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}

Processing n_feats: 200

Processing n_plates: 2

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30790.66it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:05, 30.36s/it]Processing groups:  12%|█▏        | 12/100 [00:34<03:12,  2.19s/it]Processing groups:  30%|███       | 30/100 [00:36<00:52,  1.34it/s]Processing groups:  33%|███▎      | 33/100 [01:00<01:58,  1.76s/it]Processing groups:  37%|███▋      | 37/100 [01:04<01:41,  1.62s/it]Processing groups:  38%|███▊      | 38/100 [01:04<01:33,  1.51s/it]Processing groups:  42%|████▏     | 42/100 [01:05<01:05,  1.13s/it]Processing groups:  49%|████▉     | 49/100 [01:06<00:35,  1.42it/s]Processing groups:  62%|██████▏   | 62/100 [01:13<00:24,  1.58it/s]Processing groups:  65%|██████▌   | 65/100 [01:28<00:44,  1.28s/it]Processing groups:  68%|██████▊   | 68/100 [01:32<00:41,  1.30s/it]Processing groups:  75%|███████▌  | 75/100 [01:34<00:22,  1.13it/s]Processing groups:  76%|███████▌  | 76/100 [01:34<00:20,  1.19it/s]Processing groups:  79%|███████▉  | 79/100 [01:35<00:15,  1.35it/s]Processing groups:  86%|████████▌ | 86/100 [01:35<00:06,  2.33it/s]Processing groups:  95%|█████████▌| 95/100 [01:35<00:01,  4.05it/s]Processing groups:  98%|█████████▊| 98/100 [01:39<00:00,  2.54it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.06, 'mp_value': 0.01, 'mean_ap': 0.04, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39922.94it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<48:59, 29.69s/it]Processing groups:   5%|▌         | 5/100 [00:33<08:07,  5.13s/it]Processing groups:   8%|▊         | 8/100 [00:38<05:22,  3.50s/it]Processing groups:  33%|███▎      | 33/100 [00:51<01:06,  1.01it/s]Processing groups:  34%|███▍      | 34/100 [00:56<01:16,  1.15s/it]Processing groups:  36%|███▌      | 36/100 [01:02<01:27,  1.37s/it]Processing groups:  38%|███▊      | 38/100 [01:03<01:16,  1.24s/it]Processing groups:  42%|████▏     | 42/100 [01:05<01:00,  1.04s/it]Processing groups:  55%|█████▌    | 55/100 [01:06<00:21,  2.08it/s]Processing groups:  61%|██████    | 61/100 [01:07<00:15,  2.57it/s]Processing groups:  63%|██████▎   | 63/100 [01:09<00:17,  2.09it/s]Processing groups:  65%|██████▌   | 65/100 [01:25<00:54,  1.56s/it]Processing groups:  66%|██████▌   | 66/100 [01:28<00:55,  1.64s/it]Processing groups:  68%|██████▊   | 68/100 [01:30<00:48,  1.52s/it]Processing groups:  71%|███████   | 71/100 [01:32<00:35,  1.22s/it]Processing groups:  73%|███████▎  | 73/100 [01:35<00:36,  1.35s/it]Processing groups:  74%|███████▍  | 74/100 [01:35<00:30,  1.19s/it]Processing groups:  90%|█████████ | 90/100 [01:35<00:02,  3.46it/s]Processing groups:  95%|█████████▌| 95/100 [01:36<00:01,  3.91it/s]Processing groups:  99%|█████████▉| 99/100 [01:38<00:00,  3.13it/s]Processing groups: 100%|██████████| 100/100 [01:38<00:00,  1.01it/s]
{'replicate_reproducibility': 0.01, 'mp_value': 0.0, 'mean_ap': 0.13, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35950.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:40, 31.32s/it]Processing groups:   3%|▎         | 3/100 [00:34<14:45,  9.13s/it]Processing groups:  12%|█▏        | 12/100 [00:36<02:37,  1.79s/it]Processing groups:  26%|██▌       | 26/100 [00:37<00:52,  1.41it/s]Processing groups:  33%|███▎      | 33/100 [00:57<01:32,  1.38s/it]Processing groups:  35%|███▌      | 35/100 [01:00<01:29,  1.38s/it]Processing groups:  38%|███▊      | 38/100 [01:00<01:09,  1.12s/it]Processing groups:  40%|████      | 40/100 [01:01<01:01,  1.02s/it]Processing groups:  42%|████▏     | 42/100 [01:03<00:59,  1.02s/it]Processing groups:  51%|█████     | 51/100 [01:04<00:25,  1.96it/s]Processing groups:  52%|█████▏    | 52/100 [01:04<00:24,  1.98it/s]Processing groups:  54%|█████▍    | 54/100 [01:05<00:21,  2.16it/s]Processing groups:  56%|█████▌    | 56/100 [01:06<00:19,  2.23it/s]Processing groups:  57%|█████▋    | 57/100 [01:09<00:34,  1.26it/s]Processing groups:  63%|██████▎   | 63/100 [01:09<00:14,  2.50it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<01:29,  2.56s/it]Processing groups:  66%|██████▌   | 66/100 [01:32<01:17,  2.27s/it]Processing groups:  67%|██████▋   | 67/100 [01:32<01:04,  1.94s/it]Processing groups:  70%|███████   | 70/100 [01:34<00:42,  1.41s/it]Processing groups:  72%|███████▏  | 72/100 [01:36<00:36,  1.30s/it]Processing groups:  90%|█████████ | 90/100 [01:36<00:03,  3.14it/s]Processing groups:  94%|█████████▍| 94/100 [01:37<00:01,  3.69it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:00,  3.12it/s]Processing groups:  98%|█████████▊| 98/100 [01:39<00:00,  3.12it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.02, 'mp_value': 0.03, 'mean_ap': 0.12, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 45051.60it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:27<44:49, 27.17s/it]Processing groups:   2%|▏         | 2/100 [00:28<19:12, 11.76s/it]Processing groups:   3%|▎         | 3/100 [00:38<18:20, 11.35s/it]Processing groups:  33%|███▎      | 33/100 [00:57<01:17,  1.15s/it]Processing groups:  34%|███▍      | 34/100 [01:01<01:21,  1.24s/it]Processing groups:  36%|███▌      | 36/100 [01:01<01:12,  1.13s/it]Processing groups:  45%|████▌     | 45/100 [01:03<00:41,  1.33it/s]Processing groups:  47%|████▋     | 47/100 [01:06<00:44,  1.19it/s]Processing groups:  56%|█████▌    | 56/100 [01:06<00:21,  2.03it/s]Processing groups:  58%|█████▊    | 58/100 [01:10<00:26,  1.56it/s]Processing groups:  64%|██████▍   | 64/100 [01:14<00:23,  1.56it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<01:06,  1.90s/it]Processing groups:  68%|██████▊   | 68/100 [01:34<00:54,  1.70s/it]Processing groups:  78%|███████▊  | 78/100 [01:35<00:18,  1.21it/s]Processing groups:  88%|████████▊ | 88/100 [01:35<00:05,  2.06it/s]Processing groups:  90%|█████████ | 90/100 [01:37<00:04,  2.04it/s]Processing groups:  96%|█████████▌| 96/100 [01:37<00:01,  2.87it/s]Processing groups:  98%|█████████▊| 98/100 [01:39<00:00,  2.35it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.0, 'mean_ap': 0.19, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37654.22it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:02, 30.33s/it]Processing groups:   3%|▎         | 3/100 [00:31<13:40,  8.46s/it]Processing groups:  21%|██        | 21/100 [00:34<01:12,  1.10it/s]Processing groups:  23%|██▎       | 23/100 [00:34<01:02,  1.23it/s]Processing groups:  32%|███▏      | 32/100 [00:34<00:31,  2.18it/s]Processing groups:  32%|███▏      | 32/100 [00:53<00:31,  2.18it/s]Processing groups:  33%|███▎      | 33/100 [00:54<01:58,  1.77s/it]Processing groups:  34%|███▍      | 34/100 [00:58<02:10,  1.97s/it]Processing groups:  37%|███▋      | 37/100 [01:02<01:48,  1.72s/it]Processing groups:  41%|████      | 41/100 [01:05<01:25,  1.45s/it]Processing groups:  58%|█████▊    | 58/100 [01:06<00:21,  1.91it/s]Processing groups:  62%|██████▏   | 62/100 [01:09<00:20,  1.87it/s]Processing groups:  64%|██████▍   | 64/100 [01:10<00:19,  1.83it/s]Processing groups:  65%|██████▌   | 65/100 [01:26<01:00,  1.72s/it]Processing groups:  66%|██████▌   | 66/100 [01:27<00:58,  1.71s/it]Processing groups:  67%|██████▋   | 67/100 [01:28<00:51,  1.55s/it]Processing groups:  68%|██████▊   | 68/100 [01:30<00:50,  1.58s/it]Processing groups:  69%|██████▉   | 69/100 [01:30<00:43,  1.41s/it]Processing groups:  70%|███████   | 70/100 [01:32<00:41,  1.39s/it]Processing groups:  72%|███████▏  | 72/100 [01:33<00:31,  1.11s/it]Processing groups:  73%|███████▎  | 73/100 [01:34<00:28,  1.07s/it]Processing groups:  76%|███████▌  | 76/100 [01:35<00:17,  1.41it/s]Processing groups:  79%|███████▉  | 79/100 [01:35<00:10,  1.97it/s]Processing groups:  91%|█████████ | 91/100 [01:35<00:01,  6.19it/s]Processing groups:  94%|█████████▍| 94/100 [01:36<00:00,  6.58it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:00,  3.63it/s]Processing groups:  99%|█████████▉| 99/100 [01:38<00:00,  4.06it/s]Processing groups: 100%|██████████| 100/100 [01:38<00:00,  1.01it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.03, 'mean_ap': 0.55, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31990.73it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:13, 31.05s/it]Processing groups:   2%|▏         | 2/100 [00:31<21:00, 12.86s/it]Processing groups:   7%|▋         | 7/100 [00:32<04:13,  2.73s/it]Processing groups:  14%|█▍        | 14/100 [00:33<01:31,  1.07s/it]Processing groups:  19%|█▉        | 19/100 [00:35<01:09,  1.17it/s]Processing groups:  32%|███▏      | 32/100 [00:36<00:26,  2.56it/s]Processing groups:  32%|███▏      | 32/100 [00:53<00:26,  2.56it/s]Processing groups:  33%|███▎      | 33/100 [00:57<01:48,  1.61s/it]Processing groups:  34%|███▍      | 34/100 [01:00<01:56,  1.76s/it]Processing groups:  35%|███▌      | 35/100 [01:00<01:45,  1.62s/it]Processing groups:  37%|███▋      | 37/100 [01:00<01:19,  1.27s/it]Processing groups:  39%|███▉      | 39/100 [01:06<01:37,  1.59s/it]Processing groups:  55%|█████▌    | 55/100 [01:07<00:21,  2.07it/s]Processing groups:  63%|██████▎   | 63/100 [01:08<00:13,  2.76it/s]Processing groups:  64%|██████▍   | 64/100 [01:11<00:18,  1.96it/s]Processing groups:  65%|██████▌   | 65/100 [01:32<01:12,  2.07s/it]Processing groups:  71%|███████   | 71/100 [01:33<00:38,  1.32s/it]Processing groups:  78%|███████▊  | 78/100 [01:33<00:17,  1.23it/s]Processing groups:  79%|███████▉  | 79/100 [01:35<00:18,  1.15it/s]Processing groups:  87%|████████▋ | 87/100 [01:35<00:06,  2.08it/s]Processing groups:  89%|████████▉ | 89/100 [01:35<00:04,  2.33it/s]Processing groups:  91%|█████████ | 91/100 [01:36<00:03,  2.49it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:01,  2.50it/s]Processing groups:  98%|█████████▊| 98/100 [01:38<00:00,  2.66it/s]Processing groups: 100%|██████████| 100/100 [01:38<00:00,  1.01it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.27, 'mean_ap': 0.92, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33426.08it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:26<43:30, 26.37s/it]Processing groups:   2%|▏         | 2/100 [00:28<20:04, 12.29s/it]Processing groups:   6%|▌         | 6/100 [00:31<05:15,  3.36s/it]Processing groups:   8%|▊         | 8/100 [00:32<03:35,  2.34s/it]Processing groups:  16%|█▌        | 16/100 [00:34<01:21,  1.03it/s]Processing groups:  33%|███▎      | 33/100 [00:51<01:05,  1.02it/s]Processing groups:  34%|███▍      | 34/100 [00:53<01:06,  1.01s/it]Processing groups:  35%|███▌      | 35/100 [00:55<01:13,  1.12s/it]Processing groups:  36%|███▌      | 36/100 [00:57<01:13,  1.14s/it]Processing groups:  37%|███▋      | 37/100 [00:59<01:18,  1.25s/it]Processing groups:  42%|████▏     | 42/100 [01:03<01:03,  1.10s/it]Processing groups:  47%|████▋     | 47/100 [01:04<00:40,  1.32it/s]Processing groups:  48%|████▊     | 48/100 [01:05<00:36,  1.44it/s]Processing groups:  59%|█████▉    | 59/100 [01:07<00:15,  2.61it/s]Processing groups:  60%|██████    | 60/100 [01:08<00:16,  2.35it/s]Processing groups:  65%|██████▌   | 65/100 [01:21<00:42,  1.21s/it]Processing groups:  66%|██████▌   | 66/100 [01:22<00:39,  1.16s/it]Processing groups:  67%|██████▋   | 67/100 [01:26<00:49,  1.51s/it]Processing groups:  68%|██████▊   | 68/100 [01:27<00:47,  1.48s/it]Processing groups:  70%|███████   | 70/100 [01:29<00:39,  1.31s/it]Processing groups:  73%|███████▎  | 73/100 [01:31<00:28,  1.04s/it]Processing groups:  75%|███████▌  | 75/100 [01:32<00:22,  1.11it/s]Processing groups:  80%|████████  | 80/100 [01:32<00:09,  2.06it/s]Processing groups:  81%|████████  | 81/100 [01:33<00:10,  1.75it/s]Processing groups:  93%|█████████▎| 93/100 [01:34<00:01,  4.85it/s]Processing groups:  96%|█████████▌| 96/100 [01:34<00:00,  5.65it/s]Processing groups:  98%|█████████▊| 98/100 [01:35<00:00,  3.71it/s]Processing groups: 100%|██████████| 100/100 [01:36<00:00,  4.05it/s]Processing groups: 100%|██████████| 100/100 [01:36<00:00,  1.04it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 128, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38625.14it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:13, 33.47s/it]Processing groups:   4%|▍         | 4/100 [00:34<10:32,  6.59s/it]Processing groups:   5%|▌         | 5/100 [00:34<07:38,  4.83s/it]Processing groups:  13%|█▎        | 13/100 [00:35<01:44,  1.20s/it]Processing groups:  17%|█▋        | 17/100 [00:36<01:11,  1.16it/s]Processing groups:  21%|██        | 21/100 [00:37<00:53,  1.46it/s]Processing groups:  33%|███▎      | 33/100 [01:03<01:42,  1.54s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:48,  1.64s/it]Processing groups:  40%|████      | 40/100 [01:11<01:21,  1.36s/it]Processing groups:  51%|█████     | 51/100 [01:11<00:35,  1.37it/s]Processing groups:  52%|█████▏    | 52/100 [01:12<00:33,  1.43it/s]Processing groups:  62%|██████▏   | 62/100 [01:13<00:16,  2.34it/s]Processing groups:  65%|██████▌   | 65/100 [01:37<00:59,  1.71s/it]Processing groups:  66%|██████▌   | 66/100 [01:38<00:54,  1.61s/it]Processing groups:  67%|██████▋   | 67/100 [01:40<00:53,  1.62s/it]Processing groups:  69%|██████▉   | 69/100 [01:40<00:42,  1.36s/it]Processing groups:  70%|███████   | 70/100 [01:43<00:44,  1.49s/it]Processing groups:  75%|███████▌  | 75/100 [01:44<00:21,  1.15it/s]Processing groups:  78%|███████▊  | 78/100 [01:44<00:14,  1.56it/s]Processing groups:  80%|████████  | 80/100 [01:44<00:10,  1.91it/s]Processing groups:  92%|█████████▏| 92/100 [01:45<00:01,  4.73it/s]Processing groups:  94%|█████████▍| 94/100 [01:45<00:01,  4.82it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:01,  2.80it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.08s/it]
{'replicate_reproducibility': 0.05, 'mp_value': 0.02, 'mean_ap': 0.02, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35662.82it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:43, 31.96s/it]Processing groups:   2%|▏         | 2/100 [00:32<22:15, 13.63s/it]Processing groups:   4%|▍         | 4/100 [00:34<09:08,  5.71s/it]Processing groups:  16%|█▌        | 16/100 [00:36<01:22,  1.02it/s]Processing groups:  20%|██        | 20/100 [00:38<01:08,  1.17it/s]Processing groups:  24%|██▍       | 24/100 [00:41<01:04,  1.18it/s]Processing groups:  25%|██▌       | 25/100 [00:41<01:00,  1.24it/s]Processing groups:  33%|███▎      | 33/100 [01:04<02:03,  1.85s/it]Processing groups:  34%|███▍      | 34/100 [01:04<01:53,  1.72s/it]Processing groups:  36%|███▌      | 36/100 [01:06<01:39,  1.56s/it]Processing groups:  37%|███▋      | 37/100 [01:08<01:39,  1.58s/it]Processing groups:  38%|███▊      | 38/100 [01:08<01:27,  1.42s/it]Processing groups:  44%|████▍     | 44/100 [01:10<00:44,  1.25it/s]Processing groups:  53%|█████▎    | 53/100 [01:12<00:22,  2.04it/s]Processing groups:  59%|█████▉    | 59/100 [01:13<00:16,  2.56it/s]Processing groups:  60%|██████    | 60/100 [01:14<00:15,  2.62it/s]Processing groups:  61%|██████    | 61/100 [01:15<00:18,  2.14it/s]Processing groups:  64%|██████▍   | 64/100 [01:17<00:20,  1.76it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<01:50,  3.16s/it]Processing groups:  66%|██████▌   | 66/100 [01:40<01:34,  2.78s/it]Processing groups:  67%|██████▋   | 67/100 [01:43<01:34,  2.88s/it]Processing groups:  77%|███████▋  | 77/100 [01:44<00:20,  1.13it/s]Processing groups:  87%|████████▋ | 87/100 [01:45<00:06,  2.09it/s]Processing groups:  92%|█████████▏| 92/100 [01:45<00:02,  2.70it/s]Processing groups:  96%|█████████▌| 96/100 [01:46<00:01,  3.05it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:01,  2.15it/s]Processing groups:  98%|█████████▊| 98/100 [01:48<00:00,  2.24it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.09s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.04, 'mean_ap': 0.03, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39316.69it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:22, 32.35s/it]Processing groups:   3%|▎         | 3/100 [00:34<14:48,  9.16s/it]Processing groups:   4%|▍         | 4/100 [00:34<09:39,  6.03s/it]Processing groups:  12%|█▏        | 12/100 [00:38<02:17,  1.56s/it]Processing groups:  33%|███▎      | 33/100 [01:05<01:31,  1.37s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:28,  1.35s/it]Processing groups:  36%|███▌      | 36/100 [01:07<01:19,  1.24s/it]Processing groups:  37%|███▋      | 37/100 [01:08<01:18,  1.25s/it]Processing groups:  38%|███▊      | 38/100 [01:09<01:13,  1.19s/it]Processing groups:  42%|████▏     | 42/100 [01:09<00:45,  1.27it/s]Processing groups:  45%|████▌     | 45/100 [01:10<00:33,  1.63it/s]Processing groups:  46%|████▌     | 46/100 [01:11<00:37,  1.42it/s]Processing groups:  47%|████▋     | 47/100 [01:11<00:34,  1.52it/s]Processing groups:  53%|█████▎    | 53/100 [01:12<00:16,  2.80it/s]Processing groups:  54%|█████▍    | 54/100 [01:13<00:20,  2.23it/s]Processing groups:  63%|██████▎   | 63/100 [01:15<00:10,  3.67it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<01:05,  1.86s/it]Processing groups:  66%|██████▌   | 66/100 [01:40<01:12,  2.15s/it]Processing groups:  68%|██████▊   | 68/100 [01:41<00:57,  1.80s/it]Processing groups:  70%|███████   | 70/100 [01:41<00:41,  1.38s/it]Processing groups:  71%|███████   | 71/100 [01:42<00:36,  1.26s/it]Processing groups:  72%|███████▏  | 72/100 [01:44<00:41,  1.47s/it]Processing groups:  73%|███████▎  | 73/100 [01:46<00:38,  1.44s/it]Processing groups:  96%|█████████▌| 96/100 [01:46<00:00,  5.06it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  3.42it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.09s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.07, 'mean_ap': 0.07, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38050.48it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:50, 32.64s/it]Processing groups:   5%|▌         | 5/100 [00:34<08:17,  5.23s/it]Processing groups:   7%|▋         | 7/100 [00:36<05:41,  3.68s/it]Processing groups:  17%|█▋        | 17/100 [00:39<01:41,  1.22s/it]Processing groups:  33%|███▎      | 33/100 [01:05<01:36,  1.45s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:35,  1.45s/it]Processing groups:  37%|███▋      | 37/100 [01:11<01:32,  1.47s/it]Processing groups:  53%|█████▎    | 53/100 [01:12<00:31,  1.48it/s]Processing groups:  58%|█████▊    | 58/100 [01:15<00:27,  1.55it/s]Processing groups:  64%|██████▍   | 64/100 [01:20<00:25,  1.43it/s]Processing groups:  65%|██████▌   | 65/100 [01:40<01:03,  1.83s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<01:04,  1.91s/it]Processing groups:  75%|███████▌  | 75/100 [01:43<00:24,  1.03it/s]Processing groups:  78%|███████▊  | 78/100 [01:44<00:17,  1.23it/s]Processing groups:  81%|████████  | 81/100 [01:45<00:13,  1.44it/s]Processing groups:  85%|████████▌ | 85/100 [01:45<00:08,  1.86it/s]Processing groups:  90%|█████████ | 90/100 [01:45<00:03,  2.76it/s]Processing groups:  94%|█████████▍| 94/100 [01:46<00:01,  3.53it/s]Processing groups:  96%|█████████▌| 96/100 [01:46<00:01,  3.49it/s]Processing groups:  98%|█████████▊| 98/100 [01:49<00:00,  2.17it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.09s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.25, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39960.98it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:16, 31.68s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:38, 15.08s/it]Processing groups:   8%|▊         | 8/100 [00:35<03:55,  2.56s/it]Processing groups:  19%|█▉        | 19/100 [00:36<01:09,  1.17it/s]Processing groups:  21%|██        | 21/100 [00:36<00:58,  1.36it/s]Processing groups:  28%|██▊       | 28/100 [00:36<00:31,  2.32it/s]Processing groups:  32%|███▏      | 32/100 [00:36<00:22,  3.00it/s]Processing groups:  32%|███▏      | 32/100 [00:55<00:22,  3.00it/s]Processing groups:  33%|███▎      | 33/100 [01:03<02:50,  2.54s/it]Processing groups:  34%|███▍      | 34/100 [01:06<02:53,  2.63s/it]Processing groups:  41%|████      | 41/100 [01:06<01:15,  1.29s/it]Processing groups:  43%|████▎     | 43/100 [01:11<01:24,  1.48s/it]Processing groups:  47%|████▋     | 47/100 [01:13<00:58,  1.11s/it]Processing groups:  65%|██████▌   | 65/100 [01:39<00:47,  1.35s/it]Processing groups:  68%|██████▊   | 68/100 [01:39<00:37,  1.17s/it]Processing groups:  72%|███████▏  | 72/100 [01:42<00:29,  1.06s/it]Processing groups:  74%|███████▍  | 74/100 [01:42<00:24,  1.05it/s]Processing groups:  76%|███████▌  | 76/100 [01:43<00:19,  1.21it/s]Processing groups:  78%|███████▊  | 78/100 [01:43<00:15,  1.39it/s]Processing groups:  81%|████████  | 81/100 [01:44<00:12,  1.57it/s]Processing groups:  92%|█████████▏| 92/100 [01:45<00:02,  3.42it/s]Processing groups:  97%|█████████▋| 97/100 [01:47<00:01,  2.93it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  3.53it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.08s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.36, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36653.88it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:23, 34.17s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:09, 14.79s/it]Processing groups:   4%|▍         | 4/100 [00:36<09:08,  5.71s/it]Processing groups:   5%|▌         | 5/100 [00:37<06:54,  4.36s/it]Processing groups:  18%|█▊        | 18/100 [00:39<01:02,  1.31it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:19,  1.18s/it]Processing groups:  34%|███▍      | 34/100 [01:03<01:23,  1.26s/it]Processing groups:  35%|███▌      | 35/100 [01:05<01:22,  1.27s/it]Processing groups:  38%|███▊      | 38/100 [01:08<01:16,  1.23s/it]Processing groups:  39%|███▉      | 39/100 [01:09<01:13,  1.20s/it]Processing groups:  40%|████      | 40/100 [01:09<01:04,  1.07s/it]Processing groups:  49%|████▉     | 49/100 [01:11<00:25,  1.99it/s]Processing groups:  50%|█████     | 50/100 [01:11<00:24,  2.03it/s]Processing groups:  53%|█████▎    | 53/100 [01:12<00:19,  2.44it/s]Processing groups:  55%|█████▌    | 55/100 [01:12<00:17,  2.59it/s]Processing groups:  57%|█████▋    | 57/100 [01:15<00:26,  1.64it/s]Processing groups:  58%|█████▊    | 58/100 [01:15<00:22,  1.86it/s]Processing groups:  65%|██████▌   | 65/100 [01:37<01:12,  2.08s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<01:22,  2.43s/it]Processing groups:  82%|████████▏ | 82/100 [01:43<00:13,  1.34it/s]Processing groups:  85%|████████▌ | 85/100 [01:44<00:09,  1.50it/s]Processing groups:  89%|████████▉ | 89/100 [01:45<00:05,  1.83it/s]Processing groups:  93%|█████████▎| 93/100 [01:45<00:02,  2.37it/s]Processing groups:  97%|█████████▋| 97/100 [01:47<00:01,  2.15it/s]Processing groups:  98%|█████████▊| 98/100 [01:48<00:00,  2.14it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  2.59it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.08s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.95, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29522.80it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:37, 31.29s/it]Processing groups:   2%|▏         | 2/100 [00:33<23:20, 14.29s/it]Processing groups:   6%|▌         | 6/100 [00:35<05:37,  3.59s/it]Processing groups:  12%|█▏        | 12/100 [00:36<02:09,  1.47s/it]Processing groups:  13%|█▎        | 13/100 [00:37<02:04,  1.43s/it]Processing groups:  22%|██▏       | 22/100 [00:39<00:53,  1.45it/s]Processing groups:  33%|███▎      | 33/100 [01:06<01:45,  1.58s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:41,  1.53s/it]Processing groups:  41%|████      | 41/100 [01:09<01:02,  1.07s/it]Processing groups:  44%|████▍     | 44/100 [01:09<00:49,  1.13it/s]Processing groups:  46%|████▌     | 46/100 [01:11<00:48,  1.12it/s]Processing groups:  48%|████▊     | 48/100 [01:14<00:54,  1.04s/it]Processing groups:  49%|████▉     | 49/100 [01:15<00:47,  1.07it/s]Processing groups:  63%|██████▎   | 63/100 [01:16<00:14,  2.62it/s]Processing groups:  64%|██████▍   | 64/100 [01:17<00:13,  2.65it/s]Processing groups:  65%|██████▌   | 65/100 [01:37<01:12,  2.07s/it]Processing groups:  66%|██████▌   | 66/100 [01:38<01:08,  2.01s/it]Processing groups:  67%|██████▋   | 67/100 [01:39<01:02,  1.90s/it]Processing groups:  73%|███████▎  | 73/100 [01:41<00:26,  1.01it/s]Processing groups:  76%|███████▌  | 76/100 [01:42<00:19,  1.23it/s]Processing groups:  81%|████████  | 81/100 [01:43<00:10,  1.74it/s]Processing groups:  91%|█████████ | 91/100 [01:43<00:02,  3.61it/s]Processing groups:  94%|█████████▍| 94/100 [01:43<00:01,  4.27it/s]Processing groups:  97%|█████████▋| 97/100 [01:47<00:01,  2.38it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.07s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.57, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 128, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38564.77it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:35, 43.39s/it]Processing groups:   3%|▎         | 3/100 [00:45<19:24, 12.01s/it]  Processing groups:   7%|▋         | 7/100 [00:45<06:07,  3.95s/it]Processing groups:  27%|██▋       | 27/100 [00:46<00:50,  1.44it/s]Processing groups:  27%|██▋       | 27/100 [00:58<00:50,  1.44it/s]Processing groups:  33%|███▎      | 33/100 [01:21<02:16,  2.03s/it]Processing groups:  34%|███▍      | 34/100 [01:27<02:29,  2.26s/it]Processing groups:  36%|███▌      | 36/100 [01:29<02:12,  2.07s/it]Processing groups:  56%|█████▌    | 56/100 [01:33<00:36,  1.21it/s]Processing groups:  65%|██████▌   | 65/100 [02:03<00:55,  1.58s/it]Processing groups:  66%|██████▌   | 66/100 [02:08<00:59,  1.75s/it]Processing groups:  69%|██████▉   | 69/100 [02:08<00:45,  1.48s/it]Processing groups:  70%|███████   | 70/100 [02:09<00:42,  1.42s/it]Processing groups:  71%|███████   | 71/100 [02:11<00:41,  1.44s/it]Processing groups:  78%|███████▊  | 78/100 [02:11<00:16,  1.32it/s]Processing groups:  82%|████████▏ | 82/100 [02:11<00:10,  1.77it/s]Processing groups:  90%|█████████ | 90/100 [02:11<00:03,  3.13it/s]Processing groups:  96%|█████████▌| 96/100 [02:12<00:00,  4.13it/s]Processing groups:  99%|█████████▉| 99/100 [02:16<00:00,  2.20it/s]Processing groups: 100%|██████████| 100/100 [02:16<00:00,  1.36s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.05, 'mean_ap': 0.03, 'mean_ap_p_value': 0.03, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36821.21it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:13:38, 44.63s/it]Processing groups:   6%|▌         | 6/100 [00:45<08:47,  5.61s/it]  Processing groups:  16%|█▌        | 16/100 [00:45<02:15,  1.61s/it]Processing groups:  22%|██▏       | 22/100 [00:45<01:19,  1.01s/it]Processing groups:  27%|██▋       | 27/100 [00:47<00:56,  1.29it/s]Processing groups:  27%|██▋       | 27/100 [01:01<00:56,  1.29it/s]Processing groups:  33%|███▎      | 33/100 [01:24<02:59,  2.68s/it]Processing groups:  35%|███▌      | 35/100 [01:27<02:42,  2.49s/it]Processing groups:  46%|████▌     | 46/100 [01:27<01:05,  1.21s/it]Processing groups:  49%|████▉     | 49/100 [01:30<00:59,  1.17s/it]Processing groups:  55%|█████▌    | 55/100 [01:31<00:38,  1.18it/s]Processing groups:  64%|██████▍   | 64/100 [01:32<00:18,  1.93it/s]Processing groups:  64%|██████▍   | 64/100 [01:51<00:18,  1.93it/s]Processing groups:  65%|██████▌   | 65/100 [02:06<01:29,  2.56s/it]Processing groups:  67%|██████▋   | 67/100 [02:06<01:13,  2.22s/it]Processing groups:  69%|██████▉   | 69/100 [02:07<00:58,  1.90s/it]Processing groups:  71%|███████   | 71/100 [02:08<00:47,  1.62s/it]Processing groups:  73%|███████▎  | 73/100 [02:08<00:35,  1.31s/it]Processing groups:  74%|███████▍  | 74/100 [02:11<00:39,  1.53s/it]Processing groups:  88%|████████▊ | 88/100 [02:11<00:04,  2.42it/s]Processing groups:  93%|█████████▎| 93/100 [02:12<00:02,  3.03it/s]Processing groups:  97%|█████████▋| 97/100 [02:15<00:01,  2.38it/s]Processing groups: 100%|██████████| 100/100 [02:15<00:00,  2.66it/s]Processing groups: 100%|██████████| 100/100 [02:15<00:00,  1.36s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.08, 'mean_ap': 0.02, 'mean_ap_p_value': 0.05, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33795.05it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:25, 37.83s/it]Processing groups:   2%|▏         | 2/100 [00:42<30:02, 18.40s/it]  Processing groups:   3%|▎         | 3/100 [00:46<18:43, 11.59s/it]Processing groups:  16%|█▌        | 16/100 [00:49<02:04,  1.49s/it]Processing groups:  33%|███▎      | 33/100 [01:18<01:47,  1.61s/it]Processing groups:  34%|███▍      | 34/100 [01:25<02:05,  1.90s/it]Processing groups:  36%|███▌      | 36/100 [01:26<01:49,  1.72s/it]Processing groups:  38%|███▊      | 38/100 [01:27<01:34,  1.53s/it]Processing groups:  39%|███▉      | 39/100 [01:28<01:28,  1.45s/it]Processing groups:  46%|████▌     | 46/100 [01:30<00:46,  1.16it/s]Processing groups:  60%|██████    | 60/100 [01:31<00:16,  2.46it/s]Processing groups:  63%|██████▎   | 63/100 [01:31<00:13,  2.74it/s]Processing groups:  64%|██████▍   | 64/100 [01:38<00:27,  1.32it/s]Processing groups:  65%|██████▌   | 65/100 [02:01<01:36,  2.76s/it]Processing groups:  66%|██████▌   | 66/100 [02:07<01:44,  3.08s/it]Processing groups:  68%|██████▊   | 68/100 [02:08<01:17,  2.44s/it]Processing groups:  69%|██████▉   | 69/100 [02:09<01:11,  2.32s/it]Processing groups:  70%|███████   | 70/100 [02:12<01:14,  2.47s/it]Processing groups:  87%|████████▋ | 87/100 [02:13<00:06,  2.07it/s]Processing groups:  95%|█████████▌| 95/100 [02:13<00:01,  3.10it/s]Processing groups:  98%|█████████▊| 98/100 [02:17<00:00,  2.14it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.37s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.18, 'mean_ap': 0.04, 'mean_ap_p_value': 0.05, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27189.84it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:15:01, 45.47s/it]Processing groups:   2%|▏         | 2/100 [00:46<31:53, 19.53s/it]  Processing groups:  22%|██▏       | 22/100 [00:49<01:33,  1.20s/it]Processing groups:  33%|███▎      | 33/100 [01:23<02:16,  2.03s/it]Processing groups:  34%|███▍      | 34/100 [01:25<02:12,  2.01s/it]Processing groups:  37%|███▋      | 37/100 [01:28<01:54,  1.82s/it]Processing groups:  38%|███▊      | 38/100 [01:30<01:53,  1.83s/it]Processing groups:  54%|█████▍    | 54/100 [01:30<00:29,  1.54it/s]Processing groups:  58%|█████▊    | 58/100 [01:31<00:25,  1.66it/s]Processing groups:  61%|██████    | 61/100 [01:32<00:21,  1.83it/s]Processing groups:  64%|██████▍   | 64/100 [01:34<00:20,  1.75it/s]Processing groups:  64%|██████▍   | 64/100 [01:46<00:20,  1.75it/s]Processing groups:  65%|██████▌   | 65/100 [02:03<01:42,  2.92s/it]Processing groups:  66%|██████▌   | 66/100 [02:09<01:53,  3.33s/it]Processing groups:  72%|███████▏  | 72/100 [02:10<00:49,  1.75s/it]Processing groups:  74%|███████▍  | 74/100 [02:11<00:41,  1.58s/it]Processing groups:  77%|███████▋  | 77/100 [02:12<00:27,  1.18s/it]Processing groups:  79%|███████▉  | 79/100 [02:12<00:20,  1.04it/s]Processing groups:  80%|████████  | 80/100 [02:13<00:18,  1.09it/s]Processing groups:  83%|████████▎ | 83/100 [02:13<00:10,  1.59it/s]Processing groups:  92%|█████████▏| 92/100 [02:13<00:02,  3.91it/s]Processing groups:  95%|█████████▌| 95/100 [02:14<00:01,  4.40it/s]Processing groups:  97%|█████████▋| 97/100 [02:17<00:01,  2.04it/s]Processing groups:  99%|█████████▉| 99/100 [02:17<00:00,  2.32it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.38s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 0.13, 'mean_ap_p_value': 0.22, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34342.95it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:57, 43.61s/it]Processing groups:   2%|▏         | 2/100 [00:44<30:31, 18.69s/it]  Processing groups:   5%|▌         | 5/100 [00:48<09:53,  6.25s/it]Processing groups:  33%|███▎      | 33/100 [01:26<02:02,  1.82s/it]Processing groups:  34%|███▍      | 34/100 [01:27<01:56,  1.76s/it]Processing groups:  41%|████      | 41/100 [01:30<01:19,  1.35s/it]Processing groups:  45%|████▌     | 45/100 [01:30<01:00,  1.10s/it]Processing groups:  56%|█████▌    | 56/100 [01:31<00:28,  1.55it/s]Processing groups:  61%|██████    | 61/100 [01:31<00:19,  1.97it/s]Processing groups:  64%|██████▍   | 64/100 [01:34<00:22,  1.63it/s]Processing groups:  64%|██████▍   | 64/100 [01:47<00:22,  1.63it/s]Processing groups:  65%|██████▌   | 65/100 [02:07<01:41,  2.90s/it]Processing groups:  67%|██████▋   | 67/100 [02:08<01:21,  2.48s/it]Processing groups:  69%|██████▉   | 69/100 [02:10<01:06,  2.15s/it]Processing groups:  72%|███████▏  | 72/100 [02:10<00:43,  1.56s/it]Processing groups:  73%|███████▎  | 73/100 [02:11<00:38,  1.44s/it]Processing groups:  76%|███████▌  | 76/100 [02:11<00:23,  1.02it/s]Processing groups:  79%|███████▉  | 79/100 [02:12<00:14,  1.40it/s]Processing groups:  87%|████████▋ | 87/100 [02:13<00:05,  2.58it/s]Processing groups:  89%|████████▉ | 89/100 [02:13<00:03,  2.98it/s]Processing groups:  97%|█████████▋| 97/100 [02:17<00:01,  2.40it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.37s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.23, 'mean_ap': 0.39, 'mean_ap_p_value': 0.56, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31954.17it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:36, 46.43s/it]Processing groups:   8%|▊         | 8/100 [00:47<06:36,  4.31s/it]  Processing groups:  17%|█▋        | 17/100 [00:47<02:18,  1.67s/it]Processing groups:  17%|█▋        | 17/100 [00:59<02:18,  1.67s/it]Processing groups:  33%|███▎      | 33/100 [01:25<02:20,  2.09s/it]Processing groups:  34%|███▍      | 34/100 [01:26<02:12,  2.01s/it]Processing groups:  42%|████▏     | 42/100 [01:27<01:17,  1.34s/it]Processing groups:  44%|████▍     | 44/100 [01:29<01:13,  1.31s/it]Processing groups:  51%|█████     | 51/100 [01:31<00:45,  1.09it/s]Processing groups:  61%|██████    | 61/100 [01:32<00:22,  1.77it/s]Processing groups:  63%|██████▎   | 63/100 [01:32<00:19,  1.93it/s]Processing groups:  65%|██████▌   | 65/100 [02:03<01:27,  2.50s/it]Processing groups:  66%|██████▌   | 66/100 [02:08<01:33,  2.75s/it]Processing groups:  68%|██████▊   | 68/100 [02:09<01:13,  2.29s/it]Processing groups:  76%|███████▌  | 76/100 [02:10<00:26,  1.11s/it]Processing groups:  80%|████████  | 80/100 [02:11<00:17,  1.15it/s]Processing groups:  84%|████████▍ | 84/100 [02:12<00:11,  1.38it/s]Processing groups:  91%|█████████ | 91/100 [02:12<00:03,  2.30it/s]Processing groups:  97%|█████████▋| 97/100 [02:16<00:01,  1.98it/s]Processing groups: 100%|██████████| 100/100 [02:16<00:00,  1.37s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.31, 'mean_ap': 0.83, 'mean_ap_p_value': 0.91, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33288.13it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:01, 43.05s/it]Processing groups:   5%|▌         | 5/100 [00:44<10:43,  6.77s/it]  Processing groups:   7%|▋         | 7/100 [00:45<06:37,  4.28s/it]Processing groups:   8%|▊         | 8/100 [00:45<05:24,  3.52s/it]Processing groups:  33%|███▎      | 33/100 [01:19<01:47,  1.60s/it]Processing groups:  34%|███▍      | 34/100 [01:27<02:05,  1.90s/it]Processing groups:  49%|████▉     | 49/100 [01:30<00:53,  1.05s/it]Processing groups:  62%|██████▏   | 62/100 [01:32<00:27,  1.41it/s]Processing groups:  64%|██████▍   | 64/100 [01:35<00:27,  1.33it/s]Processing groups:  65%|██████▌   | 65/100 [02:01<01:12,  2.06s/it]Processing groups:  66%|██████▌   | 66/100 [02:06<01:18,  2.30s/it]Processing groups:  69%|██████▉   | 69/100 [02:08<01:00,  1.96s/it]Processing groups:  70%|███████   | 70/100 [02:10<00:57,  1.91s/it]Processing groups:  74%|███████▍  | 74/100 [02:10<00:32,  1.25s/it]Processing groups:  75%|███████▌  | 75/100 [02:10<00:27,  1.12s/it]Processing groups:  85%|████████▌ | 85/100 [02:12<00:07,  1.99it/s]Processing groups:  92%|█████████▏| 92/100 [02:12<00:02,  3.13it/s]Processing groups:  95%|█████████▌| 95/100 [02:12<00:01,  3.44it/s]Processing groups:  97%|█████████▋| 97/100 [02:16<00:01,  1.93it/s]Processing groups:  99%|█████████▉| 99/100 [02:16<00:00,  2.21it/s]Processing groups: 100%|██████████| 100/100 [02:16<00:00,  1.37s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.84, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 128, 'differ_params': 1}

Processing n_plates: 3

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37098.04it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:26, 34.20s/it]Processing groups:   6%|▌         | 6/100 [00:36<07:07,  4.55s/it]Processing groups:  13%|█▎        | 13/100 [00:36<02:28,  1.70s/it]Processing groups:  33%|███▎      | 33/100 [01:03<01:37,  1.45s/it]Processing groups:  35%|███▌      | 35/100 [01:05<01:30,  1.40s/it]Processing groups:  37%|███▋      | 37/100 [01:06<01:20,  1.27s/it]Processing groups:  38%|███▊      | 38/100 [01:07<01:18,  1.26s/it]Processing groups:  41%|████      | 41/100 [01:09<01:04,  1.09s/it]Processing groups:  58%|█████▊    | 58/100 [01:10<00:16,  2.48it/s]Processing groups:  65%|██████▌   | 65/100 [01:34<00:44,  1.27s/it]Processing groups:  66%|██████▌   | 66/100 [01:35<00:43,  1.27s/it]Processing groups:  67%|██████▋   | 67/100 [01:38<00:46,  1.40s/it]Processing groups:  78%|███████▊  | 78/100 [01:39<00:14,  1.49it/s]Processing groups:  80%|████████  | 80/100 [01:41<00:14,  1.42it/s]Processing groups:  88%|████████▊ | 88/100 [01:41<00:05,  2.32it/s]Processing groups:  97%|█████████▋| 97/100 [01:43<00:01,  2.75it/s]Processing groups:  99%|█████████▉| 99/100 [01:43<00:00,  3.04it/s]Processing groups: 100%|██████████| 100/100 [01:43<00:00,  1.04s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41655.62it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:24, 31.76s/it]Processing groups:   2%|▏         | 2/100 [00:32<21:45, 13.32s/it]Processing groups:   4%|▍         | 4/100 [00:32<08:13,  5.14s/it]Processing groups:   8%|▊         | 8/100 [00:33<02:53,  1.89s/it]Processing groups:   9%|▉         | 9/100 [00:34<02:50,  1.88s/it]Processing groups:  19%|█▉        | 19/100 [00:38<01:00,  1.33it/s]Processing groups:  33%|███▎      | 33/100 [01:03<01:31,  1.37s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:36,  1.46s/it]Processing groups:  37%|███▋      | 37/100 [01:09<01:28,  1.40s/it]Processing groups:  60%|██████    | 60/100 [01:11<00:20,  1.96it/s]Processing groups:  64%|██████▍   | 64/100 [01:12<00:16,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<00:55,  1.57s/it]Processing groups:  67%|██████▋   | 67/100 [01:39<00:52,  1.60s/it]Processing groups:  73%|███████▎  | 73/100 [01:39<00:29,  1.09s/it]Processing groups:  74%|███████▍  | 74/100 [01:39<00:26,  1.01s/it]Processing groups:  78%|███████▊  | 78/100 [01:40<00:16,  1.30it/s]Processing groups:  95%|█████████▌| 95/100 [01:41<00:01,  3.40it/s]Processing groups:  97%|█████████▋| 97/100 [01:44<00:01,  2.54it/s]Processing groups:  98%|█████████▊| 98/100 [01:44<00:00,  2.61it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 45143.73it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:46, 30.78s/it]Processing groups:   5%|▌         | 5/100 [00:33<08:13,  5.20s/it]Processing groups:   7%|▋         | 7/100 [00:34<05:14,  3.38s/it]Processing groups:   8%|▊         | 8/100 [00:35<04:17,  2.80s/it]Processing groups:  16%|█▌        | 16/100 [00:36<01:15,  1.11it/s]Processing groups:  31%|███       | 31/100 [00:41<00:36,  1.89it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:46,  1.59s/it]Processing groups:  35%|███▌      | 35/100 [01:05<01:46,  1.65s/it]Processing groups:  40%|████      | 40/100 [01:05<01:07,  1.12s/it]Processing groups:  43%|████▎     | 43/100 [01:05<00:50,  1.12it/s]Processing groups:  45%|████▌     | 45/100 [01:08<00:54,  1.00it/s]Processing groups:  58%|█████▊    | 58/100 [01:09<00:16,  2.48it/s]Processing groups:  60%|██████    | 60/100 [01:09<00:14,  2.71it/s]Processing groups:  62%|██████▏   | 62/100 [01:12<00:21,  1.75it/s]Processing groups:  63%|██████▎   | 63/100 [01:14<00:25,  1.46it/s]Processing groups:  64%|██████▍   | 64/100 [01:20<00:46,  1.29s/it]Processing groups:  65%|██████▌   | 65/100 [01:26<01:08,  1.96s/it]Processing groups:  66%|██████▌   | 66/100 [01:33<01:37,  2.86s/it]Processing groups:  67%|██████▋   | 67/100 [01:34<01:20,  2.44s/it]Processing groups:  69%|██████▉   | 69/100 [01:38<01:13,  2.37s/it]Processing groups:  75%|███████▌  | 75/100 [01:40<00:27,  1.10s/it]Processing groups:  86%|████████▌ | 86/100 [01:40<00:06,  2.29it/s]Processing groups:  88%|████████▊ | 88/100 [01:41<00:04,  2.48it/s]Processing groups:  90%|█████████ | 90/100 [01:41<00:03,  2.69it/s]Processing groups:  92%|█████████▏| 92/100 [01:41<00:02,  3.09it/s]Processing groups:  95%|█████████▌| 95/100 [01:41<00:01,  3.94it/s]Processing groups:  97%|█████████▋| 97/100 [01:43<00:01,  2.41it/s]Processing groups:  98%|█████████▊| 98/100 [01:44<00:00,  2.53it/s]Processing groups:  99%|█████████▉| 99/100 [01:44<00:00,  2.86it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.09, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38879.35it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<51:00, 30.92s/it]Processing groups:   4%|▍         | 4/100 [00:32<09:55,  6.21s/it]Processing groups:   8%|▊         | 8/100 [00:32<03:52,  2.52s/it]Processing groups:  15%|█▌        | 15/100 [00:34<01:37,  1.15s/it]Processing groups:  19%|█▉        | 19/100 [00:35<01:06,  1.21it/s]Processing groups:  26%|██▌       | 26/100 [00:36<00:40,  1.84it/s]Processing groups:  32%|███▏      | 32/100 [00:40<00:37,  1.79it/s]Processing groups:  33%|███▎      | 33/100 [00:58<02:10,  1.95s/it]Processing groups:  34%|███▍      | 34/100 [01:01<02:16,  2.07s/it]Processing groups:  35%|███▌      | 35/100 [01:05<02:33,  2.36s/it]Processing groups:  43%|████▎     | 43/100 [01:10<01:12,  1.27s/it]Processing groups:  57%|█████▋    | 57/100 [01:12<00:26,  1.61it/s]Processing groups:  65%|██████▌   | 65/100 [01:33<00:44,  1.28s/it]Processing groups:  68%|██████▊   | 68/100 [01:33<00:35,  1.10s/it]Processing groups:  69%|██████▉   | 69/100 [01:36<00:36,  1.18s/it]Processing groups:  72%|███████▏  | 72/100 [01:36<00:26,  1.05it/s]Processing groups:  74%|███████▍  | 74/100 [01:37<00:22,  1.15it/s]Processing groups:  78%|███████▊  | 78/100 [01:37<00:13,  1.67it/s]Processing groups:  79%|███████▉  | 79/100 [01:39<00:15,  1.31it/s]Processing groups:  87%|████████▋ | 87/100 [01:40<00:04,  2.76it/s]Processing groups:  91%|█████████ | 91/100 [01:40<00:02,  3.61it/s]Processing groups:  93%|█████████▎| 93/100 [01:41<00:02,  3.47it/s]Processing groups:  97%|█████████▋| 97/100 [01:43<00:01,  2.79it/s]Processing groups:  98%|█████████▊| 98/100 [01:43<00:00,  2.99it/s]Processing groups:  99%|█████████▉| 99/100 [01:43<00:00,  3.16it/s]Processing groups: 100%|██████████| 100/100 [01:43<00:00,  1.04s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.03, 'mean_ap_p_value': 0.22, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35134.06it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:28<47:12, 28.61s/it]Processing groups:   3%|▎         | 3/100 [00:28<12:07,  7.50s/it]Processing groups:   5%|▌         | 5/100 [00:33<07:29,  4.73s/it]Processing groups:   6%|▌         | 6/100 [00:33<05:28,  3.50s/it]Processing groups:   9%|▉         | 9/100 [00:33<02:40,  1.77s/it]Processing groups:  15%|█▌        | 15/100 [00:35<01:13,  1.15it/s]Processing groups:  19%|█▉        | 19/100 [00:36<00:47,  1.72it/s]Processing groups:  26%|██▌       | 26/100 [00:37<00:29,  2.47it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:50,  1.64s/it]Processing groups:  34%|███▍      | 34/100 [01:02<01:45,  1.59s/it]Processing groups:  35%|███▌      | 35/100 [01:04<01:46,  1.64s/it]Processing groups:  36%|███▌      | 36/100 [01:06<01:44,  1.63s/it]Processing groups:  39%|███▉      | 39/100 [01:06<01:06,  1.08s/it]Processing groups:  40%|████      | 40/100 [01:06<00:57,  1.05it/s]Processing groups:  42%|████▏     | 42/100 [01:06<00:41,  1.38it/s]Processing groups:  46%|████▌     | 46/100 [01:07<00:25,  2.14it/s]Processing groups:  49%|████▉     | 49/100 [01:07<00:17,  3.00it/s]Processing groups:  53%|█████▎    | 53/100 [01:08<00:14,  3.22it/s]Processing groups:  54%|█████▍    | 54/100 [01:13<00:37,  1.24it/s]Processing groups:  63%|██████▎   | 63/100 [01:13<00:12,  2.88it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<01:01,  1.77s/it]Processing groups:  67%|██████▋   | 67/100 [01:36<01:02,  1.89s/it]Processing groups:  71%|███████   | 71/100 [01:38<00:40,  1.41s/it]Processing groups:  72%|███████▏  | 72/100 [01:39<00:36,  1.29s/it]Processing groups:  80%|████████  | 80/100 [01:40<00:13,  1.53it/s]Processing groups:  84%|████████▍ | 84/100 [01:41<00:08,  1.89it/s]Processing groups:  88%|████████▊ | 88/100 [01:41<00:04,  2.49it/s]Processing groups:  95%|█████████▌| 95/100 [01:41<00:01,  4.14it/s]Processing groups:  97%|█████████▋| 97/100 [01:44<00:01,  2.57it/s]Processing groups:  99%|█████████▉| 99/100 [01:44<00:00,  3.01it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.12, 'mean_ap_p_value': 0.55, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 44979.13it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<54:44, 33.18s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:30, 14.40s/it]Processing groups:   3%|▎         | 3/100 [00:37<14:35,  9.03s/it]Processing groups:  33%|███▎      | 33/100 [01:00<01:19,  1.19s/it]Processing groups:  35%|███▌      | 35/100 [01:05<01:22,  1.27s/it]Processing groups:  37%|███▋      | 37/100 [01:07<01:19,  1.26s/it]Processing groups:  49%|████▉     | 49/100 [01:08<00:35,  1.44it/s]Processing groups:  50%|█████     | 50/100 [01:09<00:36,  1.39it/s]Processing groups:  51%|█████     | 51/100 [01:10<00:35,  1.38it/s]Processing groups:  52%|█████▏    | 52/100 [01:10<00:32,  1.48it/s]Processing groups:  62%|██████▏   | 62/100 [01:13<00:17,  2.12it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<01:03,  1.80s/it]Processing groups:  66%|██████▌   | 66/100 [01:37<01:01,  1.81s/it]Processing groups:  70%|███████   | 70/100 [01:37<00:37,  1.26s/it]Processing groups:  71%|███████   | 71/100 [01:40<00:40,  1.41s/it]Processing groups:  75%|███████▌  | 75/100 [01:40<00:22,  1.11it/s]Processing groups:  76%|███████▌  | 76/100 [01:41<00:19,  1.21it/s]Processing groups:  80%|████████  | 80/100 [01:42<00:12,  1.64it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:00,  3.36it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.5, 'mean_ap': 0.85, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1175.72it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:17, 32.30s/it]Processing groups:   4%|▍         | 4/100 [00:35<11:02,  6.91s/it]Processing groups:   8%|▊         | 8/100 [00:35<04:16,  2.79s/it]Processing groups:  13%|█▎        | 13/100 [00:37<02:10,  1.50s/it]Processing groups:  29%|██▉       | 29/100 [00:37<00:31,  2.23it/s]Processing groups:  29%|██▉       | 29/100 [00:50<00:31,  2.23it/s]Processing groups:  33%|███▎      | 33/100 [01:00<01:40,  1.50s/it]Processing groups:  35%|███▌      | 35/100 [01:03<01:39,  1.53s/it]Processing groups:  44%|████▍     | 44/100 [01:04<00:50,  1.11it/s]Processing groups:  47%|████▋     | 47/100 [01:06<00:43,  1.22it/s]Processing groups:  49%|████▉     | 49/100 [01:07<00:39,  1.28it/s]Processing groups:  51%|█████     | 51/100 [01:07<00:35,  1.39it/s]Processing groups:  53%|█████▎    | 53/100 [01:11<00:43,  1.07it/s]Processing groups:  54%|█████▍    | 54/100 [01:12<00:39,  1.15it/s]Processing groups:  58%|█████▊    | 58/100 [01:13<00:26,  1.61it/s]Processing groups:  64%|██████▍   | 64/100 [01:17<00:23,  1.55it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<01:10,  2.02s/it]Processing groups:  66%|██████▌   | 66/100 [01:32<01:03,  1.86s/it]Processing groups:  67%|██████▋   | 67/100 [01:37<01:17,  2.34s/it]Processing groups:  69%|██████▉   | 69/100 [01:37<00:53,  1.73s/it]Processing groups:  76%|███████▌  | 76/100 [01:38<00:16,  1.41it/s]Processing groups:  78%|███████▊  | 78/100 [01:38<00:14,  1.55it/s]Processing groups:  79%|███████▉  | 79/100 [01:39<00:12,  1.72it/s]Processing groups:  82%|████████▏ | 82/100 [01:40<00:09,  1.89it/s]Processing groups:  87%|████████▋ | 87/100 [01:41<00:04,  2.72it/s]Processing groups:  91%|█████████ | 91/100 [01:41<00:02,  3.78it/s]Processing groups:  96%|█████████▌| 96/100 [01:42<00:00,  4.16it/s]Processing groups:  97%|█████████▋| 97/100 [01:44<00:01,  2.64it/s]Processing groups:  99%|█████████▉| 99/100 [01:44<00:00,  3.05it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 128, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37229.75it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:03, 37.61s/it]Processing groups:   2%|▏         | 2/100 [00:41<28:33, 17.49s/it]  Processing groups:  14%|█▍        | 14/100 [00:41<02:16,  1.59s/it]Processing groups:  31%|███       | 31/100 [00:41<00:40,  1.70it/s]Processing groups:  31%|███       | 31/100 [00:54<00:40,  1.70it/s]Processing groups:  33%|███▎      | 33/100 [01:13<02:20,  2.10s/it]Processing groups:  34%|███▍      | 34/100 [01:14<02:11,  2.00s/it]Processing groups:  37%|███▋      | 37/100 [01:15<01:43,  1.65s/it]Processing groups:  40%|████      | 40/100 [01:17<01:24,  1.40s/it]Processing groups:  41%|████      | 41/100 [01:18<01:20,  1.36s/it]Processing groups:  43%|████▎     | 43/100 [01:20<01:11,  1.26s/it]Processing groups:  58%|█████▊    | 58/100 [01:20<00:15,  2.66it/s]Processing groups:  62%|██████▏   | 62/100 [01:21<00:13,  2.90it/s]Processing groups:  62%|██████▏   | 62/100 [01:35<00:13,  2.90it/s]Processing groups:  65%|██████▌   | 65/100 [01:50<01:12,  2.06s/it]Processing groups:  66%|██████▌   | 66/100 [01:53<01:13,  2.15s/it]Processing groups:  69%|██████▉   | 69/100 [01:57<00:59,  1.93s/it]Processing groups:  79%|███████▉  | 79/100 [01:57<00:18,  1.13it/s]Processing groups:  84%|████████▍ | 84/100 [01:58<00:10,  1.50it/s]Processing groups:  89%|████████▉ | 89/100 [01:58<00:05,  2.01it/s]Processing groups:  97%|█████████▋| 97/100 [02:01<00:01,  2.14it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  1.22s/it]
{'replicate_reproducibility': 0.03666666666666667, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34169.48it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<57:23, 34.78s/it]Processing groups:   2%|▏         | 2/100 [00:37<26:07, 15.99s/it]Processing groups:   3%|▎         | 3/100 [00:40<16:25, 10.16s/it]Processing groups:  20%|██        | 20/100 [00:42<01:12,  1.11it/s]Processing groups:  24%|██▍       | 24/100 [00:42<00:54,  1.39it/s]Processing groups:  33%|███▎      | 33/100 [01:13<02:05,  1.87s/it]Processing groups:  35%|███▌      | 35/100 [01:14<01:53,  1.75s/it]Processing groups:  36%|███▌      | 36/100 [01:16<01:51,  1.73s/it]Processing groups:  37%|███▋      | 37/100 [01:17<01:47,  1.71s/it]Processing groups:  44%|████▍     | 44/100 [01:20<00:59,  1.07s/it]Processing groups:  62%|██████▏   | 62/100 [01:21<00:15,  2.41it/s]Processing groups:  65%|██████▌   | 65/100 [01:55<01:05,  1.88s/it]Processing groups:  76%|███████▌  | 76/100 [01:56<00:27,  1.13s/it]Processing groups:  78%|███████▊  | 78/100 [01:57<00:23,  1.06s/it]Processing groups:  94%|█████████▍| 94/100 [01:57<00:03,  1.93it/s]Processing groups:  97%|█████████▋| 97/100 [02:01<00:01,  1.69it/s]Processing groups:  99%|█████████▉| 99/100 [02:01<00:00,  1.87it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  1.21s/it]
{'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1169.16it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<59:37, 36.14s/it]Processing groups:   2%|▏         | 2/100 [00:37<25:08, 15.39s/it]Processing groups:   3%|▎         | 3/100 [00:40<15:50,  9.80s/it]Processing groups:   4%|▍         | 4/100 [00:40<09:33,  5.97s/it]Processing groups:   7%|▋         | 7/100 [00:40<03:36,  2.33s/it]Processing groups:  16%|█▌        | 16/100 [00:41<00:55,  1.52it/s]Processing groups:  21%|██        | 21/100 [00:43<00:44,  1.79it/s]Processing groups:  33%|███▎      | 33/100 [01:12<01:47,  1.61s/it]Processing groups:  34%|███▍      | 34/100 [01:14<01:48,  1.65s/it]Processing groups:  35%|███▌      | 35/100 [01:16<01:49,  1.69s/it]Processing groups:  39%|███▉      | 39/100 [01:17<01:15,  1.24s/it]Processing groups:  45%|████▌     | 45/100 [01:20<00:50,  1.09it/s]Processing groups:  52%|█████▏    | 52/100 [01:22<00:31,  1.54it/s]Processing groups:  65%|██████▌   | 65/100 [01:50<00:49,  1.41s/it]Processing groups:  66%|██████▌   | 66/100 [01:54<00:52,  1.56s/it]Processing groups:  68%|██████▊   | 68/100 [01:54<00:43,  1.36s/it]Processing groups:  69%|██████▉   | 69/100 [01:55<00:42,  1.37s/it]Processing groups:  74%|███████▍  | 74/100 [01:56<00:24,  1.08it/s]Processing groups:  75%|███████▌  | 75/100 [01:57<00:22,  1.14it/s]Processing groups:  84%|████████▍ | 84/100 [01:57<00:06,  2.32it/s]Processing groups:  94%|█████████▍| 94/100 [01:58<00:01,  4.18it/s]Processing groups:  96%|█████████▌| 96/100 [01:58<00:00,  4.57it/s]Processing groups:  98%|█████████▊| 98/100 [02:01<00:00,  2.28it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  1.22s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.07, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38980.52it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:00:23, 36.60s/it]Processing groups:   3%|▎         | 3/100 [00:39<17:13, 10.66s/it]  Processing groups:   4%|▍         | 4/100 [00:41<11:57,  7.48s/it]Processing groups:   9%|▉         | 9/100 [00:41<03:22,  2.23s/it]Processing groups:  28%|██▊       | 28/100 [00:42<00:35,  2.04it/s]Processing groups:  28%|██▊       | 28/100 [00:56<00:35,  2.04it/s]Processing groups:  33%|███▎      | 33/100 [01:10<01:50,  1.66s/it]Processing groups:  34%|███▍      | 34/100 [01:10<01:45,  1.59s/it]Processing groups:  35%|███▌      | 35/100 [01:14<01:53,  1.75s/it]Processing groups:  37%|███▋      | 37/100 [01:15<01:34,  1.50s/it]Processing groups:  38%|███▊      | 38/100 [01:18<01:43,  1.66s/it]Processing groups:  39%|███▉      | 39/100 [01:19<01:38,  1.61s/it]Processing groups:  47%|████▋     | 47/100 [01:21<00:41,  1.29it/s]Processing groups:  52%|█████▏    | 52/100 [01:22<00:25,  1.88it/s]Processing groups:  61%|██████    | 61/100 [01:22<00:12,  3.22it/s]Processing groups:  63%|██████▎   | 63/100 [01:25<00:16,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [01:53<01:30,  2.58s/it]Processing groups:  69%|██████▉   | 69/100 [01:54<00:58,  1.90s/it]Processing groups:  72%|███████▏  | 72/100 [01:56<00:43,  1.54s/it]Processing groups:  77%|███████▋  | 77/100 [01:56<00:23,  1.02s/it]Processing groups:  83%|████████▎ | 83/100 [01:57<00:11,  1.48it/s]Processing groups:  90%|█████████ | 90/100 [01:58<00:04,  2.30it/s]Processing groups:  96%|█████████▌| 96/100 [01:59<00:01,  2.96it/s]Processing groups:  97%|█████████▋| 97/100 [02:01<00:01,  1.95it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  1.22s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.13, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37573.27it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:07:51, 41.12s/it]Processing groups:  28%|██▊       | 28/100 [00:42<01:17,  1.07s/it] Processing groups:  28%|██▊       | 28/100 [00:52<01:17,  1.07s/it]Processing groups:  33%|███▎      | 33/100 [01:15<02:29,  2.23s/it]Processing groups:  35%|███▌      | 35/100 [01:18<02:18,  2.13s/it]Processing groups:  39%|███▉      | 39/100 [01:18<01:42,  1.68s/it]Processing groups:  49%|████▉     | 49/100 [01:22<00:54,  1.08s/it]Processing groups:  56%|█████▌    | 56/100 [01:23<00:35,  1.25it/s]Processing groups:  63%|██████▎   | 63/100 [01:25<00:22,  1.63it/s]Processing groups:  65%|██████▌   | 65/100 [01:53<01:14,  2.14s/it]Processing groups:  66%|██████▌   | 66/100 [01:53<01:07,  2.00s/it]Processing groups:  67%|██████▋   | 67/100 [01:55<01:06,  2.00s/it]Processing groups:  70%|███████   | 70/100 [01:56<00:43,  1.46s/it]Processing groups:  80%|████████  | 80/100 [01:57<00:13,  1.48it/s]Processing groups:  92%|█████████▏| 92/100 [01:57<00:02,  2.91it/s]Processing groups:  96%|█████████▌| 96/100 [01:57<00:01,  3.35it/s]Processing groups:  99%|█████████▉| 99/100 [02:01<00:00,  2.25it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  1.21s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 0.11, 'mean_ap_p_value': 0.71, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1190.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:35<58:50, 35.66s/it]Processing groups:   2%|▏         | 2/100 [00:36<24:39, 15.10s/it]Processing groups:   3%|▎         | 3/100 [00:39<15:19,  9.48s/it]Processing groups:   5%|▌         | 5/100 [00:40<06:55,  4.37s/it]Processing groups:  13%|█▎        | 13/100 [00:40<01:32,  1.06s/it]Processing groups:  26%|██▌       | 26/100 [00:43<00:38,  1.95it/s]Processing groups:  33%|███▎      | 33/100 [01:14<02:02,  1.83s/it]Processing groups:  38%|███▊      | 38/100 [01:20<01:42,  1.65s/it]Processing groups:  45%|████▌     | 45/100 [01:20<01:01,  1.13s/it]Processing groups:  61%|██████    | 61/100 [01:22<00:22,  1.72it/s]Processing groups:  64%|██████▍   | 64/100 [01:26<00:24,  1.49it/s]Processing groups:  65%|██████▌   | 65/100 [01:51<01:11,  2.05s/it]Processing groups:  68%|██████▊   | 68/100 [01:52<00:54,  1.69s/it]Processing groups:  69%|██████▉   | 69/100 [01:52<00:49,  1.58s/it]Processing groups:  70%|███████   | 70/100 [01:53<00:46,  1.56s/it]Processing groups:  71%|███████   | 71/100 [01:54<00:42,  1.45s/it]Processing groups:  72%|███████▏  | 72/100 [01:55<00:39,  1.42s/it]Processing groups:  78%|███████▊  | 78/100 [01:57<00:15,  1.42it/s]Processing groups:  79%|███████▉  | 79/100 [01:57<00:13,  1.54it/s]Processing groups:  86%|████████▌ | 86/100 [01:57<00:04,  3.24it/s]Processing groups:  91%|█████████ | 91/100 [01:57<00:01,  4.66it/s]Processing groups:  95%|█████████▌| 95/100 [01:57<00:00,  5.85it/s]Processing groups:  97%|█████████▋| 97/100 [02:01<00:01,  2.21it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  1.22s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.56, 'mean_ap': 0.62, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 45289.97it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:40<1:07:12, 40.73s/it]Processing groups:   3%|▎         | 3/100 [00:41<17:31, 10.84s/it]  Processing groups:   6%|▌         | 6/100 [00:41<06:39,  4.24s/it]Processing groups:  33%|███▎      | 33/100 [01:09<01:33,  1.40s/it]Processing groups:  34%|███▍      | 34/100 [01:13<01:40,  1.52s/it]Processing groups:  37%|███▋      | 37/100 [01:14<01:22,  1.31s/it]Processing groups:  41%|████      | 41/100 [01:17<01:09,  1.17s/it]Processing groups:  43%|████▎     | 43/100 [01:18<01:02,  1.10s/it]Processing groups:  45%|████▌     | 45/100 [01:21<01:03,  1.15s/it]Processing groups:  58%|█████▊    | 58/100 [01:21<00:19,  2.16it/s]Processing groups:  60%|██████    | 60/100 [01:23<00:20,  2.00it/s]Processing groups:  62%|██████▏   | 62/100 [01:24<00:18,  2.09it/s]Processing groups:  64%|██████▍   | 64/100 [01:24<00:16,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [01:49<01:49,  3.13s/it]Processing groups:  66%|██████▌   | 66/100 [01:51<01:38,  2.89s/it]Processing groups:  67%|██████▋   | 67/100 [01:51<01:22,  2.50s/it]Processing groups:  68%|██████▊   | 68/100 [01:52<01:08,  2.14s/it]Processing groups:  69%|██████▉   | 69/100 [01:52<00:56,  1.83s/it]Processing groups:  72%|███████▏  | 72/100 [01:53<00:30,  1.10s/it]Processing groups:  75%|███████▌  | 75/100 [01:55<00:21,  1.19it/s]Processing groups:  77%|███████▋  | 77/100 [01:55<00:14,  1.56it/s]Processing groups:  78%|███████▊  | 78/100 [01:55<00:12,  1.71it/s]Processing groups:  79%|███████▉  | 79/100 [01:55<00:10,  1.95it/s]Processing groups:  84%|████████▍ | 84/100 [01:56<00:04,  3.58it/s]Processing groups:  87%|████████▋ | 87/100 [01:56<00:03,  4.19it/s]Processing groups:  91%|█████████ | 91/100 [01:57<00:02,  4.32it/s]Processing groups:  97%|█████████▋| 97/100 [02:00<00:00,  3.16it/s]Processing groups:  98%|█████████▊| 98/100 [02:00<00:00,  3.15it/s]Processing groups:  99%|█████████▉| 99/100 [02:00<00:00,  3.30it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  3.22it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  1.21s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.45, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 128, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34732.56it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:20:28, 48.77s/it]Processing groups:   2%|▏         | 2/100 [00:52<35:55, 21.99s/it]  Processing groups:   3%|▎         | 3/100 [00:54<20:59, 12.98s/it]Processing groups:   4%|▍         | 4/100 [00:54<12:54,  8.07s/it]Processing groups:   5%|▌         | 5/100 [00:55<08:28,  5.36s/it]Processing groups:  33%|███▎      | 33/100 [01:39<02:02,  1.83s/it]Processing groups:  34%|███▍      | 34/100 [01:42<02:03,  1.88s/it]Processing groups:  41%|████      | 41/100 [01:42<01:16,  1.30s/it]Processing groups:  42%|████▏     | 42/100 [01:44<01:17,  1.34s/it]Processing groups:  43%|████▎     | 43/100 [01:46<01:18,  1.38s/it]Processing groups:  51%|█████     | 51/100 [01:46<00:36,  1.36it/s]Processing groups:  60%|██████    | 60/100 [01:48<00:19,  2.10it/s]Processing groups:  64%|██████▍   | 64/100 [01:48<00:14,  2.52it/s]Processing groups:  64%|██████▍   | 64/100 [02:05<00:14,  2.52it/s]Processing groups:  65%|██████▌   | 65/100 [02:30<01:56,  3.34s/it]Processing groups:  66%|██████▌   | 66/100 [02:33<01:54,  3.37s/it]Processing groups:  71%|███████   | 71/100 [02:34<01:00,  2.10s/it]Processing groups:  81%|████████  | 81/100 [02:35<00:19,  1.02s/it]Processing groups:  87%|████████▋ | 87/100 [02:35<00:09,  1.39it/s]Processing groups:  97%|█████████▋| 97/100 [02:40<00:01,  1.57it/s]Processing groups: 100%|██████████| 100/100 [02:41<00:00,  1.61s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37259.52it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:54<1:29:43, 54.38s/it]Processing groups:   4%|▍         | 4/100 [00:55<17:05, 10.68s/it]  Processing groups:  33%|███▎      | 33/100 [01:39<02:31,  2.26s/it]Processing groups:  34%|███▍      | 34/100 [01:43<02:34,  2.35s/it]Processing groups:  35%|███▌      | 35/100 [01:45<02:30,  2.32s/it]Processing groups:  36%|███▌      | 36/100 [01:45<02:18,  2.16s/it]Processing groups:  39%|███▉      | 39/100 [01:46<01:42,  1.67s/it]Processing groups:  41%|████      | 41/100 [01:47<01:25,  1.45s/it]Processing groups:  55%|█████▌    | 55/100 [01:48<00:24,  1.85it/s]Processing groups:  57%|█████▋    | 57/100 [01:50<00:26,  1.64it/s]Processing groups:  65%|██████▌   | 65/100 [02:35<01:31,  2.62s/it]Processing groups:  74%|███████▍  | 74/100 [02:36<00:42,  1.62s/it]Processing groups:  75%|███████▌  | 75/100 [02:37<00:40,  1.63s/it]Processing groups:  96%|█████████▌| 96/100 [02:38<00:02,  1.69it/s]Processing groups: 100%|██████████| 100/100 [02:43<00:00,  1.63s/it]
{'replicate_reproducibility': 0.04666666666666667, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35754.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:23:01, 50.32s/it]Processing groups:   2%|▏         | 2/100 [00:51<34:57, 21.40s/it]  Processing groups:   3%|▎         | 3/100 [00:54<21:13, 13.13s/it]Processing groups:  30%|███       | 30/100 [00:55<00:50,  1.39it/s]Processing groups:  30%|███       | 30/100 [01:08<00:50,  1.39it/s]Processing groups:  33%|███▎      | 33/100 [01:42<02:58,  2.67s/it]Processing groups:  36%|███▌      | 36/100 [01:42<02:25,  2.28s/it]Processing groups:  39%|███▉      | 39/100 [01:44<02:02,  2.00s/it]Processing groups:  45%|████▌     | 45/100 [01:46<01:16,  1.40s/it]Processing groups:  51%|█████     | 51/100 [01:46<00:47,  1.04it/s]Processing groups:  56%|█████▌    | 56/100 [01:47<00:31,  1.41it/s]Processing groups:  58%|█████▊    | 58/100 [01:48<00:28,  1.50it/s]Processing groups:  59%|█████▉    | 59/100 [01:50<00:34,  1.20it/s]Processing groups:  65%|██████▌   | 65/100 [02:32<02:02,  3.50s/it]Processing groups:  66%|██████▌   | 66/100 [02:35<01:59,  3.52s/it]Processing groups:  71%|███████   | 71/100 [02:36<01:02,  2.16s/it]Processing groups:  76%|███████▌  | 76/100 [02:36<00:33,  1.38s/it]Processing groups:  83%|████████▎ | 83/100 [02:37<00:13,  1.22it/s]Processing groups:  88%|████████▊ | 88/100 [02:37<00:07,  1.65it/s]Processing groups:  94%|█████████▍| 94/100 [02:37<00:02,  2.46it/s]Processing groups:  97%|█████████▋| 97/100 [02:42<00:01,  1.58it/s]Processing groups: 100%|██████████| 100/100 [02:42<00:00,  1.98it/s]Processing groups: 100%|██████████| 100/100 [02:42<00:00,  1.63s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.25, 'mean_ap': 0.0, 'mean_ap_p_value': 0.09, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32632.88it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:51<1:25:01, 51.53s/it]Processing groups:   3%|▎         | 3/100 [00:52<22:04, 13.66s/it]  Processing groups:  11%|█         | 11/100 [00:54<04:10,  2.81s/it]Processing groups:  26%|██▌       | 26/100 [00:54<01:07,  1.10it/s]Processing groups:  26%|██▌       | 26/100 [01:05<01:07,  1.10it/s]Processing groups:  33%|███▎      | 33/100 [01:38<02:52,  2.58s/it]Processing groups:  34%|███▍      | 34/100 [01:42<02:55,  2.67s/it]Processing groups:  39%|███▉      | 39/100 [01:44<02:01,  1.99s/it]Processing groups:  42%|████▏     | 42/100 [01:46<01:37,  1.68s/it]Processing groups:  55%|█████▌    | 55/100 [01:47<00:35,  1.27it/s]Processing groups:  56%|█████▌    | 56/100 [01:47<00:33,  1.32it/s]Processing groups:  57%|█████▋    | 57/100 [01:47<00:30,  1.41it/s]Processing groups:  60%|██████    | 60/100 [01:48<00:23,  1.69it/s]Processing groups:  65%|██████▌   | 65/100 [02:31<02:05,  3.58s/it]Processing groups:  67%|██████▋   | 67/100 [02:34<01:44,  3.17s/it]Processing groups:  70%|███████   | 70/100 [02:34<01:10,  2.37s/it]Processing groups:  71%|███████   | 71/100 [02:34<01:01,  2.13s/it]Processing groups:  72%|███████▏  | 72/100 [02:35<00:51,  1.86s/it]Processing groups:  74%|███████▍  | 74/100 [02:37<00:42,  1.63s/it]Processing groups:  77%|███████▋  | 77/100 [02:37<00:23,  1.03s/it]Processing groups:  89%|████████▉ | 89/100 [02:38<00:03,  2.75it/s]Processing groups:  97%|█████████▋| 97/100 [02:42<00:01,  2.26it/s]Processing groups:  99%|█████████▉| 99/100 [02:42<00:00,  2.52it/s]Processing groups: 100%|██████████| 100/100 [02:43<00:00,  2.45it/s]Processing groups: 100%|██████████| 100/100 [02:43<00:00,  1.63s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 0.01, 'mean_ap_p_value': 0.25, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 42777.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:21:34, 49.44s/it]Processing groups:   2%|▏         | 2/100 [00:52<36:21, 22.26s/it]  Processing groups:   8%|▊         | 8/100 [00:53<05:55,  3.86s/it]Processing groups:  11%|█         | 11/100 [00:54<03:42,  2.50s/it]Processing groups:  30%|███       | 30/100 [00:54<00:40,  1.72it/s]Processing groups:  30%|███       | 30/100 [01:10<00:40,  1.72it/s]Processing groups:  33%|███▎      | 33/100 [01:39<02:59,  2.68s/it]Processing groups:  34%|███▍      | 34/100 [01:46<03:16,  2.97s/it]Processing groups:  40%|████      | 40/100 [01:47<01:58,  1.98s/it]Processing groups:  64%|██████▍   | 64/100 [01:48<00:24,  1.48it/s]Processing groups:  64%|██████▍   | 64/100 [02:00<00:24,  1.48it/s]Processing groups:  65%|██████▌   | 65/100 [02:30<01:19,  2.28s/it]Processing groups:  67%|██████▋   | 67/100 [02:32<01:10,  2.12s/it]Processing groups:  69%|██████▉   | 69/100 [02:33<01:00,  1.96s/it]Processing groups:  71%|███████   | 71/100 [02:35<00:51,  1.79s/it]Processing groups:  76%|███████▌  | 76/100 [02:36<00:28,  1.20s/it]Processing groups:  80%|████████  | 80/100 [02:36<00:17,  1.15it/s]Processing groups:  82%|████████▏ | 82/100 [02:36<00:13,  1.35it/s]Processing groups:  87%|████████▋ | 87/100 [02:36<00:06,  2.10it/s]Processing groups:  91%|█████████ | 91/100 [02:36<00:03,  2.83it/s]Processing groups:  96%|█████████▌| 96/100 [02:36<00:00,  4.19it/s]Processing groups:  99%|█████████▉| 99/100 [02:42<00:00,  1.75it/s]Processing groups: 100%|██████████| 100/100 [02:42<00:00,  1.62s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.68, 'mean_ap': 0.05, 'mean_ap_p_value': 0.76, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1139.59it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:51<1:24:17, 51.09s/it]Processing groups:   5%|▌         | 5/100 [00:51<12:12,  7.71s/it]  Processing groups:   8%|▊         | 8/100 [00:52<06:26,  4.20s/it]Processing groups:  30%|███       | 30/100 [00:53<00:50,  1.38it/s]Processing groups:  30%|███       | 30/100 [01:07<00:50,  1.38it/s]Processing groups:  33%|███▎      | 33/100 [01:39<03:05,  2.77s/it]Processing groups:  34%|███▍      | 34/100 [01:41<02:58,  2.71s/it]Processing groups:  36%|███▌      | 36/100 [01:42<02:32,  2.38s/it]Processing groups:  47%|████▋     | 47/100 [01:44<01:02,  1.18s/it]Processing groups:  51%|█████     | 51/100 [01:46<00:50,  1.04s/it]Processing groups:  65%|██████▌   | 65/100 [02:31<01:17,  2.20s/it]Processing groups:  66%|██████▌   | 66/100 [02:33<01:13,  2.15s/it]Processing groups:  72%|███████▏  | 72/100 [02:33<00:42,  1.51s/it]Processing groups:  78%|███████▊  | 78/100 [02:33<00:23,  1.07s/it]Processing groups:  85%|████████▌ | 85/100 [02:34<00:11,  1.36it/s]Processing groups:  95%|█████████▌| 95/100 [02:34<00:02,  2.23it/s]Processing groups:  98%|█████████▊| 98/100 [02:39<00:01,  1.57it/s]Processing groups: 100%|██████████| 100/100 [02:39<00:00,  1.60s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.91, 'mean_ap': 0.66, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40044.91it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:55<1:31:52, 55.68s/it]Processing groups:  33%|███▎      | 33/100 [01:38<02:48,  2.51s/it] Processing groups:  34%|███▍      | 34/100 [01:43<02:52,  2.61s/it]Processing groups:  42%|████▏     | 42/100 [01:45<01:45,  1.82s/it]Processing groups:  46%|████▌     | 46/100 [01:45<01:20,  1.49s/it]Processing groups:  51%|█████     | 51/100 [01:45<00:55,  1.13s/it]Processing groups:  53%|█████▎    | 53/100 [01:47<00:53,  1.13s/it]Processing groups:  56%|█████▌    | 56/100 [01:48<00:40,  1.08it/s]Processing groups:  65%|██████▌   | 65/100 [02:31<01:36,  2.75s/it]Processing groups:  67%|██████▋   | 67/100 [02:31<01:19,  2.41s/it]Processing groups:  69%|██████▉   | 69/100 [02:34<01:11,  2.29s/it]Processing groups:  70%|███████   | 70/100 [02:35<01:03,  2.10s/it]Processing groups:  72%|███████▏  | 72/100 [02:37<00:52,  1.87s/it]Processing groups:  90%|█████████ | 90/100 [02:37<00:04,  2.04it/s]Processing groups:  93%|█████████▎| 93/100 [02:37<00:02,  2.34it/s]Processing groups:  97%|█████████▋| 97/100 [02:42<00:01,  1.64it/s]Processing groups: 100%|██████████| 100/100 [02:42<00:00,  1.63s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 128, 'differ_params': 1}

Processing n_plates: 4

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35990.25it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:03, 33.37s/it]Processing groups:   3%|▎         | 3/100 [00:34<14:47,  9.15s/it]Processing groups:   4%|▍         | 4/100 [00:37<10:55,  6.83s/it]Processing groups:  12%|█▏        | 12/100 [00:37<02:07,  1.45s/it]Processing groups:  30%|███       | 30/100 [00:41<00:37,  1.87it/s]Processing groups:  33%|███▎      | 33/100 [01:05<01:50,  1.65s/it]Processing groups:  37%|███▋      | 37/100 [01:07<01:29,  1.42s/it]Processing groups:  38%|███▊      | 38/100 [01:11<01:38,  1.59s/it]Processing groups:  41%|████      | 41/100 [01:13<01:19,  1.35s/it]Processing groups:  52%|█████▏    | 52/100 [01:13<00:29,  1.63it/s]Processing groups:  54%|█████▍    | 54/100 [01:14<00:28,  1.61it/s]Processing groups:  63%|██████▎   | 63/100 [01:17<00:17,  2.09it/s]Processing groups:  64%|██████▍   | 64/100 [01:19<00:19,  1.84it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<01:09,  1.98s/it]Processing groups:  66%|██████▌   | 66/100 [01:38<01:07,  1.98s/it]Processing groups:  67%|██████▋   | 67/100 [01:41<01:10,  2.15s/it]Processing groups:  69%|██████▉   | 69/100 [01:43<00:58,  1.89s/it]Processing groups:  70%|███████   | 70/100 [01:45<00:53,  1.78s/it]Processing groups:  72%|███████▏  | 72/100 [01:45<00:37,  1.34s/it]Processing groups:  76%|███████▌  | 76/100 [01:46<00:18,  1.28it/s]Processing groups:  80%|████████  | 80/100 [01:47<00:11,  1.75it/s]Processing groups:  89%|████████▉ | 89/100 [01:48<00:03,  3.57it/s]Processing groups:  95%|█████████▌| 95/100 [01:48<00:00,  5.07it/s]Processing groups:  97%|█████████▋| 97/100 [01:50<00:00,  3.29it/s]Processing groups:  98%|█████████▊| 98/100 [01:50<00:00,  3.04it/s]Processing groups:  99%|█████████▉| 99/100 [01:51<00:00,  3.27it/s]Processing groups: 100%|██████████| 100/100 [01:51<00:00,  1.11s/it]
{'replicate_reproducibility': 0.025, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34066.80it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:47, 32.00s/it]Processing groups:   2%|▏         | 2/100 [00:34<24:16, 14.87s/it]Processing groups:   3%|▎         | 3/100 [00:35<13:09,  8.14s/it]Processing groups:  12%|█▏        | 12/100 [00:36<01:53,  1.29s/it]Processing groups:  24%|██▍       | 24/100 [00:36<00:38,  1.98it/s]Processing groups:  27%|██▋       | 27/100 [00:39<00:42,  1.70it/s]Processing groups:  27%|██▋       | 27/100 [00:50<00:42,  1.70it/s]Processing groups:  33%|███▎      | 33/100 [01:03<01:57,  1.76s/it]Processing groups:  34%|███▍      | 34/100 [01:06<02:01,  1.84s/it]Processing groups:  36%|███▌      | 36/100 [01:08<01:48,  1.69s/it]Processing groups:  37%|███▋      | 37/100 [01:10<01:49,  1.74s/it]Processing groups:  38%|███▊      | 38/100 [01:10<01:34,  1.52s/it]Processing groups:  40%|████      | 40/100 [01:11<01:16,  1.28s/it]Processing groups:  44%|████▍     | 44/100 [01:12<00:41,  1.34it/s]Processing groups:  57%|█████▋    | 57/100 [01:12<00:10,  3.96it/s]Processing groups:  60%|██████    | 60/100 [01:14<00:12,  3.22it/s]Processing groups:  62%|██████▏   | 62/100 [01:17<00:20,  1.86it/s]Processing groups:  62%|██████▏   | 62/100 [01:30<00:20,  1.86it/s]Processing groups:  65%|██████▌   | 65/100 [01:37<01:08,  1.96s/it]Processing groups:  68%|██████▊   | 68/100 [01:44<01:05,  2.06s/it]Processing groups:  71%|███████   | 71/100 [01:45<00:47,  1.63s/it]Processing groups:  77%|███████▋  | 77/100 [01:45<00:21,  1.06it/s]Processing groups:  79%|███████▉  | 79/100 [01:46<00:17,  1.20it/s]Processing groups:  92%|█████████▏| 92/100 [01:46<00:02,  2.97it/s]Processing groups:  95%|█████████▌| 95/100 [01:47<00:01,  3.14it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:01,  2.75it/s]Processing groups:  99%|█████████▉| 99/100 [01:49<00:00,  2.63it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.10s/it]
{'replicate_reproducibility': 0.03166666666666667, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 47619.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:45, 32.58s/it]Processing groups:   3%|▎         | 3/100 [00:35<15:07,  9.36s/it]Processing groups:   4%|▍         | 4/100 [00:38<11:53,  7.43s/it]Processing groups:  33%|███▎      | 33/100 [01:05<01:30,  1.35s/it]Processing groups:  34%|███▍      | 34/100 [01:07<01:31,  1.39s/it]Processing groups:  35%|███▌      | 35/100 [01:08<01:25,  1.32s/it]Processing groups:  36%|███▌      | 36/100 [01:09<01:27,  1.36s/it]Processing groups:  38%|███▊      | 38/100 [01:10<01:11,  1.15s/it]Processing groups:  44%|████▍     | 44/100 [01:11<00:39,  1.42it/s]Processing groups:  47%|████▋     | 47/100 [01:11<00:31,  1.70it/s]Processing groups:  48%|████▊     | 48/100 [01:13<00:35,  1.45it/s]Processing groups:  49%|████▉     | 49/100 [01:13<00:33,  1.52it/s]Processing groups:  57%|█████▋    | 57/100 [01:17<00:21,  1.99it/s]Processing groups:  65%|██████▌   | 65/100 [01:40<00:56,  1.61s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<00:58,  1.72s/it]Processing groups:  69%|██████▉   | 69/100 [01:43<00:40,  1.32s/it]Processing groups:  72%|███████▏  | 72/100 [01:44<00:29,  1.06s/it]Processing groups:  79%|███████▉  | 79/100 [01:45<00:12,  1.64it/s]Processing groups:  82%|████████▏ | 82/100 [01:45<00:08,  2.02it/s]Processing groups:  83%|████████▎ | 83/100 [01:46<00:08,  1.96it/s]Processing groups:  90%|█████████ | 90/100 [01:46<00:02,  3.64it/s]Processing groups:  93%|█████████▎| 93/100 [01:46<00:01,  4.46it/s]Processing groups:  96%|█████████▌| 96/100 [01:47<00:00,  4.15it/s]Processing groups:  98%|█████████▊| 98/100 [01:49<00:00,  2.28it/s]Processing groups: 100%|██████████| 100/100 [01:50<00:00,  1.10s/it]
{'replicate_reproducibility': 0.008333333333333333, 'mp_value': 0.15, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 46071.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<56:00, 33.94s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:05, 14.75s/it]Processing groups:   3%|▎         | 3/100 [00:38<15:11,  9.40s/it]Processing groups:  20%|██        | 20/100 [00:39<01:07,  1.19it/s]Processing groups:  33%|███▎      | 33/100 [01:07<01:39,  1.49s/it]Processing groups:  35%|███▌      | 35/100 [01:12<01:42,  1.58s/it]Processing groups:  47%|████▋     | 47/100 [01:12<00:45,  1.16it/s]Processing groups:  52%|█████▏    | 52/100 [01:13<00:35,  1.36it/s]Processing groups:  61%|██████    | 61/100 [01:15<00:20,  1.88it/s]Processing groups:  63%|██████▎   | 63/100 [01:18<00:24,  1.50it/s]Processing groups:  65%|██████▌   | 65/100 [01:34<00:54,  1.56s/it]Processing groups:  66%|██████▌   | 66/100 [01:41<01:07,  2.00s/it]Processing groups:  67%|██████▋   | 67/100 [01:41<00:59,  1.80s/it]Processing groups:  68%|██████▊   | 68/100 [01:41<00:51,  1.60s/it]Processing groups:  69%|██████▉   | 69/100 [01:42<00:46,  1.50s/it]Processing groups:  70%|███████   | 70/100 [01:43<00:41,  1.37s/it]Processing groups:  72%|███████▏  | 72/100 [01:43<00:25,  1.08it/s]Processing groups:  73%|███████▎  | 73/100 [01:44<00:23,  1.15it/s]Processing groups:  77%|███████▋  | 77/100 [01:45<00:12,  1.82it/s]Processing groups:  78%|███████▊  | 78/100 [01:45<00:10,  2.08it/s]Processing groups:  81%|████████  | 81/100 [01:45<00:06,  3.12it/s]Processing groups:  84%|████████▍ | 84/100 [01:47<00:06,  2.54it/s]Processing groups:  86%|████████▌ | 86/100 [01:47<00:04,  3.14it/s]Processing groups:  92%|█████████▏| 92/100 [01:47<00:01,  5.22it/s]Processing groups:  95%|█████████▌| 95/100 [01:47<00:00,  6.18it/s]Processing groups:  97%|█████████▋| 97/100 [01:49<00:01,  2.98it/s]Processing groups:  98%|█████████▊| 98/100 [01:50<00:00,  3.23it/s]Processing groups:  99%|█████████▉| 99/100 [01:50<00:00,  3.14it/s]Processing groups: 100%|██████████| 100/100 [01:50<00:00,  1.11s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.15, 'mean_ap': 0.0, 'mean_ap_p_value': 0.23, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41298.78it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:56, 33.90s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:02, 14.11s/it]Processing groups:   7%|▋         | 7/100 [00:35<04:30,  2.91s/it]Processing groups:  10%|█         | 10/100 [00:35<02:40,  1.79s/it]Processing groups:  14%|█▍        | 14/100 [00:36<01:35,  1.11s/it]Processing groups:  23%|██▎       | 23/100 [00:39<00:49,  1.56it/s]Processing groups:  25%|██▌       | 25/100 [00:40<00:44,  1.69it/s]Processing groups:  33%|███▎      | 33/100 [01:05<01:59,  1.78s/it]Processing groups:  36%|███▌      | 36/100 [01:08<01:47,  1.68s/it]Processing groups:  41%|████      | 41/100 [01:09<01:09,  1.18s/it]Processing groups:  42%|████▏     | 42/100 [01:10<01:04,  1.12s/it]Processing groups:  44%|████▍     | 44/100 [01:10<00:50,  1.10it/s]Processing groups:  45%|████▌     | 45/100 [01:13<01:02,  1.14s/it]Processing groups:  50%|█████     | 50/100 [01:14<00:38,  1.29it/s]Processing groups:  60%|██████    | 60/100 [01:19<00:23,  1.70it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<00:50,  1.44s/it]Processing groups:  66%|██████▌   | 66/100 [01:38<00:49,  1.45s/it]Processing groups:  67%|██████▋   | 67/100 [01:41<00:51,  1.55s/it]Processing groups:  68%|██████▊   | 68/100 [01:43<00:51,  1.61s/it]Processing groups:  70%|███████   | 70/100 [01:44<00:42,  1.41s/it]Processing groups:  81%|████████  | 81/100 [01:45<00:09,  1.93it/s]Processing groups:  82%|████████▏ | 82/100 [01:46<00:10,  1.74it/s]Processing groups:  96%|█████████▌| 96/100 [01:47<00:00,  4.01it/s]Processing groups:  97%|█████████▋| 97/100 [01:49<00:01,  2.66it/s]Processing groups:  98%|█████████▊| 98/100 [01:50<00:00,  2.77it/s]Processing groups: 100%|██████████| 100/100 [01:50<00:00,  1.10s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 0.02, 'mean_ap_p_value': 0.79, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 49200.05it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:36, 32.49s/it]Processing groups:   2%|▏         | 2/100 [00:33<22:54, 14.03s/it]Processing groups:   4%|▍         | 4/100 [00:39<11:09,  6.97s/it]Processing groups:  30%|███       | 30/100 [00:39<00:40,  1.73it/s]Processing groups:  30%|███       | 30/100 [00:54<00:40,  1.73it/s]Processing groups:  33%|███▎      | 33/100 [01:03<01:44,  1.56s/it]Processing groups:  34%|███▍      | 34/100 [01:04<01:38,  1.50s/it]Processing groups:  36%|███▌      | 36/100 [01:06<01:32,  1.45s/it]Processing groups:  37%|███▋      | 37/100 [01:06<01:23,  1.32s/it]Processing groups:  38%|███▊      | 38/100 [01:08<01:26,  1.40s/it]Processing groups:  39%|███▉      | 39/100 [01:10<01:29,  1.47s/it]Processing groups:  40%|████      | 40/100 [01:12<01:32,  1.54s/it]Processing groups:  49%|████▉     | 49/100 [01:13<00:26,  1.95it/s]Processing groups:  51%|█████     | 51/100 [01:13<00:24,  1.99it/s]Processing groups:  59%|█████▉    | 59/100 [01:15<00:13,  3.05it/s]Processing groups:  64%|██████▍   | 64/100 [01:17<00:12,  2.89it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<01:03,  1.82s/it]Processing groups:  66%|██████▌   | 66/100 [01:39<01:10,  2.07s/it]Processing groups:  67%|██████▋   | 67/100 [01:45<01:22,  2.49s/it]Processing groups:  80%|████████  | 80/100 [01:45<00:14,  1.34it/s]Processing groups:  83%|████████▎ | 83/100 [01:46<00:11,  1.46it/s]Processing groups:  92%|█████████▏| 92/100 [01:46<00:03,  2.60it/s]Processing groups:  95%|█████████▌| 95/100 [01:46<00:01,  3.06it/s]Processing groups:  98%|█████████▊| 98/100 [01:49<00:00,  2.35it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.09s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.29, 'mean_ap': 0.67, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41943.04it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<52:57, 32.10s/it]Processing groups:   2%|▏         | 2/100 [00:32<22:02, 13.49s/it]Processing groups:   4%|▍         | 4/100 [00:34<09:03,  5.66s/it]Processing groups:   7%|▋         | 7/100 [00:34<03:50,  2.48s/it]Processing groups:   8%|▊         | 8/100 [00:35<03:19,  2.17s/it]Processing groups:   9%|▉         | 9/100 [00:36<02:40,  1.77s/it]Processing groups:  25%|██▌       | 25/100 [00:37<00:24,  3.05it/s]Processing groups:  33%|███▎      | 33/100 [01:02<01:33,  1.39s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:53,  1.71s/it]Processing groups:  35%|███▌      | 35/100 [01:10<01:49,  1.68s/it]Processing groups:  36%|███▌      | 36/100 [01:10<01:37,  1.53s/it]Processing groups:  40%|████      | 40/100 [01:10<00:58,  1.02it/s]Processing groups:  51%|█████     | 51/100 [01:11<00:21,  2.29it/s]Processing groups:  52%|█████▏    | 52/100 [01:14<00:29,  1.65it/s]Processing groups:  59%|█████▉    | 59/100 [01:15<00:15,  2.57it/s]Processing groups:  60%|██████    | 60/100 [01:15<00:14,  2.72it/s]Processing groups:  63%|██████▎   | 63/100 [01:15<00:12,  2.96it/s]Processing groups:  65%|██████▌   | 65/100 [01:41<01:37,  2.79s/it]Processing groups:  69%|██████▉   | 69/100 [01:42<00:56,  1.84s/it]Processing groups:  72%|███████▏  | 72/100 [01:44<00:43,  1.54s/it]Processing groups:  74%|███████▍  | 74/100 [01:44<00:32,  1.23s/it]Processing groups:  79%|███████▉  | 79/100 [01:45<00:15,  1.37it/s]Processing groups:  85%|████████▌ | 85/100 [01:45<00:06,  2.21it/s]Processing groups:  90%|█████████ | 90/100 [01:45<00:03,  3.05it/s]Processing groups:  93%|█████████▎| 93/100 [01:46<00:01,  3.68it/s]Processing groups:  95%|█████████▌| 95/100 [01:46<00:01,  4.17it/s]Processing groups:  97%|█████████▋| 97/100 [01:48<00:01,  2.43it/s]Processing groups:  98%|█████████▊| 98/100 [01:48<00:00,  2.40it/s]Processing groups: 100%|██████████| 100/100 [01:48<00:00,  1.09s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.49, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 128, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31303.11it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:13:59, 44.84s/it]Processing groups:   4%|▍         | 4/100 [00:46<14:24,  9.01s/it]  Processing groups:  17%|█▋        | 17/100 [00:48<02:11,  1.59s/it]Processing groups:  33%|███▎      | 33/100 [01:24<02:12,  1.98s/it]Processing groups:  35%|███▌      | 35/100 [01:27<02:06,  1.94s/it]Processing groups:  39%|███▉      | 39/100 [01:28<01:36,  1.58s/it]Processing groups:  46%|████▌     | 46/100 [01:30<01:01,  1.15s/it]Processing groups:  57%|█████▋    | 57/100 [01:33<00:32,  1.31it/s]Processing groups:  62%|██████▏   | 62/100 [01:34<00:23,  1.65it/s]Processing groups:  65%|██████▌   | 65/100 [02:10<01:25,  2.44s/it]Processing groups:  71%|███████   | 71/100 [02:10<00:49,  1.70s/it]Processing groups:  72%|███████▏  | 72/100 [02:11<00:45,  1.63s/it]Processing groups:  74%|███████▍  | 74/100 [02:11<00:35,  1.38s/it]Processing groups:  75%|███████▌  | 75/100 [02:11<00:31,  1.26s/it]Processing groups:  85%|████████▌ | 85/100 [02:12<00:07,  1.95it/s]Processing groups:  87%|████████▋ | 87/100 [02:12<00:06,  2.03it/s]Processing groups:  89%|████████▉ | 89/100 [02:12<00:04,  2.40it/s]Processing groups:  91%|█████████ | 91/100 [02:13<00:03,  2.54it/s]Processing groups:  93%|█████████▎| 93/100 [02:13<00:02,  3.07it/s]Processing groups:  95%|█████████▌| 95/100 [02:14<00:01,  3.24it/s]Processing groups:  97%|█████████▋| 97/100 [02:18<00:02,  1.38it/s]Processing groups: 100%|██████████| 100/100 [02:18<00:00,  1.38s/it]
{'replicate_reproducibility': 0.041666666666666664, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34975.85it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:18:32, 47.60s/it]Processing groups:  28%|██▊       | 28/100 [00:48<01:29,  1.24s/it] Processing groups:  28%|██▊       | 28/100 [01:04<01:29,  1.24s/it]Processing groups:  33%|███▎      | 33/100 [01:23<02:40,  2.40s/it]Processing groups:  34%|███▍      | 34/100 [01:24<02:35,  2.36s/it]Processing groups:  35%|███▌      | 35/100 [01:27<02:34,  2.37s/it]Processing groups:  38%|███▊      | 38/100 [01:28<01:59,  1.93s/it]Processing groups:  44%|████▍     | 44/100 [01:30<01:11,  1.28s/it]Processing groups:  51%|█████     | 51/100 [01:31<00:38,  1.27it/s]Processing groups:  55%|█████▌    | 55/100 [01:31<00:27,  1.63it/s]Processing groups:  65%|██████▌   | 65/100 [02:05<01:07,  1.92s/it]Processing groups:  66%|██████▌   | 66/100 [02:05<01:01,  1.81s/it]Processing groups:  67%|██████▋   | 67/100 [02:11<01:10,  2.12s/it]Processing groups:  72%|███████▏  | 72/100 [02:13<00:40,  1.46s/it]Processing groups:  81%|████████  | 81/100 [02:13<00:14,  1.31it/s]Processing groups:  83%|████████▎ | 83/100 [02:13<00:11,  1.45it/s]Processing groups:  89%|████████▉ | 89/100 [02:13<00:04,  2.23it/s]Processing groups:  97%|█████████▋| 97/100 [02:17<00:01,  2.13it/s]Processing groups:  99%|█████████▉| 99/100 [02:18<00:00,  2.29it/s]Processing groups: 100%|██████████| 100/100 [02:18<00:00,  1.38s/it]
{'replicate_reproducibility': 0.025, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41568.92it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:12:37, 44.02s/it]Processing groups:   2%|▏         | 2/100 [00:46<32:05, 19.64s/it]  Processing groups:  12%|█▏        | 12/100 [00:47<03:07,  2.13s/it]Processing groups:  30%|███       | 30/100 [00:47<00:45,  1.53it/s]Processing groups:  30%|███       | 30/100 [01:05<00:45,  1.53it/s]Processing groups:  33%|███▎      | 33/100 [01:21<02:26,  2.19s/it]Processing groups:  34%|███▍      | 34/100 [01:24<02:27,  2.23s/it]Processing groups:  37%|███▋      | 37/100 [01:28<02:09,  2.06s/it]Processing groups:  39%|███▉      | 39/100 [01:28<01:45,  1.73s/it]Processing groups:  44%|████▍     | 44/100 [01:30<01:04,  1.16s/it]Processing groups:  47%|████▋     | 47/100 [01:34<01:04,  1.22s/it]Processing groups:  65%|██████▌   | 65/100 [02:03<00:52,  1.50s/it]Processing groups:  66%|██████▌   | 66/100 [02:10<01:00,  1.77s/it]Processing groups:  67%|██████▋   | 67/100 [02:11<00:56,  1.70s/it]Processing groups:  68%|██████▊   | 68/100 [02:12<00:52,  1.63s/it]Processing groups:  71%|███████   | 71/100 [02:12<00:34,  1.19s/it]Processing groups:  73%|███████▎  | 73/100 [02:12<00:26,  1.03it/s]Processing groups:  76%|███████▌  | 76/100 [02:12<00:16,  1.46it/s]Processing groups:  78%|███████▊  | 78/100 [02:14<00:16,  1.37it/s]Processing groups:  85%|████████▌ | 85/100 [02:14<00:05,  2.83it/s]Processing groups:  95%|█████████▌| 95/100 [02:15<00:01,  4.92it/s]Processing groups:  98%|█████████▊| 98/100 [02:19<00:00,  2.50it/s]Processing groups: 100%|██████████| 100/100 [02:19<00:00,  1.39s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43504.86it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:13:07, 44.32s/it]Processing groups:   6%|▌         | 6/100 [00:46<09:01,  5.76s/it]  Processing groups:  19%|█▉        | 19/100 [00:46<01:51,  1.37s/it]Processing groups:  28%|██▊       | 28/100 [00:47<00:59,  1.21it/s]Processing groups:  28%|██▊       | 28/100 [01:05<00:59,  1.21it/s]Processing groups:  33%|███▎      | 33/100 [01:23<02:44,  2.46s/it]Processing groups:  34%|███▍      | 34/100 [01:26<02:42,  2.46s/it]Processing groups:  35%|███▌      | 35/100 [01:26<02:30,  2.31s/it]Processing groups:  36%|███▌      | 36/100 [01:27<02:12,  2.07s/it]Processing groups:  39%|███▉      | 39/100 [01:30<01:50,  1.81s/it]Processing groups:  53%|█████▎    | 53/100 [01:33<00:32,  1.47it/s]Processing groups:  64%|██████▍   | 64/100 [01:33<00:14,  2.54it/s]Processing groups:  64%|██████▍   | 64/100 [01:45<00:14,  2.54it/s]Processing groups:  65%|██████▌   | 65/100 [02:05<01:13,  2.10s/it]Processing groups:  66%|██████▌   | 66/100 [02:06<01:07,  1.99s/it]Processing groups:  68%|██████▊   | 68/100 [02:10<01:04,  2.00s/it]Processing groups:  70%|███████   | 70/100 [02:11<00:50,  1.68s/it]Processing groups:  73%|███████▎  | 73/100 [02:11<00:32,  1.21s/it]Processing groups:  75%|███████▌  | 75/100 [02:11<00:24,  1.01it/s]Processing groups:  81%|████████  | 81/100 [02:12<00:10,  1.79it/s]Processing groups:  84%|████████▍ | 84/100 [02:13<00:08,  1.99it/s]Processing groups:  89%|████████▉ | 89/100 [02:13<00:03,  2.98it/s]Processing groups:  95%|█████████▌| 95/100 [02:14<00:01,  4.24it/s]Processing groups:  97%|█████████▋| 97/100 [02:17<00:01,  2.04it/s]Processing groups:  99%|█████████▉| 99/100 [02:17<00:00,  2.42it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.38s/it]
{'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.12, 'mean_ap': 0.0, 'mean_ap_p_value': 0.26, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 47233.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:15:25, 45.72s/it]Processing groups:   5%|▌         | 5/100 [00:46<11:06,  7.02s/it]  Processing groups:  10%|█         | 10/100 [00:47<04:19,  2.88s/it]Processing groups:  33%|███▎      | 33/100 [01:24<02:05,  1.88s/it]Processing groups:  35%|███▌      | 35/100 [01:25<01:52,  1.72s/it]Processing groups:  36%|███▌      | 36/100 [01:27<01:53,  1.77s/it]Processing groups:  40%|████      | 40/100 [01:32<01:37,  1.63s/it]Processing groups:  61%|██████    | 61/100 [01:35<00:24,  1.56it/s]Processing groups:  65%|██████▌   | 65/100 [02:07<01:01,  1.75s/it]Processing groups:  66%|██████▌   | 66/100 [02:07<00:57,  1.69s/it]Processing groups:  68%|██████▊   | 68/100 [02:09<00:51,  1.59s/it]Processing groups:  71%|███████   | 71/100 [02:09<00:36,  1.28s/it]Processing groups:  72%|███████▏  | 72/100 [02:12<00:38,  1.36s/it]Processing groups:  75%|███████▌  | 75/100 [02:12<00:24,  1.01it/s]Processing groups:  76%|███████▌  | 76/100 [02:12<00:21,  1.13it/s]Processing groups:  77%|███████▋  | 77/100 [02:13<00:21,  1.05it/s]Processing groups:  88%|████████▊ | 88/100 [02:14<00:04,  2.95it/s]Processing groups:  97%|█████████▋| 97/100 [02:18<00:01,  2.69it/s]Processing groups:  98%|█████████▊| 98/100 [02:18<00:00,  2.73it/s]Processing groups: 100%|██████████| 100/100 [02:18<00:00,  1.39s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.35, 'mean_ap': 0.0, 'mean_ap_p_value': 0.79, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 44440.60it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:14:40, 45.26s/it]Processing groups:  10%|█         | 10/100 [00:46<05:03,  3.37s/it] Processing groups:  29%|██▉       | 29/100 [00:46<01:04,  1.10it/s]Processing groups:  29%|██▉       | 29/100 [01:06<01:04,  1.10it/s]Processing groups:  33%|███▎      | 33/100 [01:23<02:41,  2.41s/it]Processing groups:  34%|███▍      | 34/100 [01:28<02:47,  2.55s/it]Processing groups:  39%|███▉      | 39/100 [01:29<01:53,  1.86s/it]Processing groups:  51%|█████     | 51/100 [01:30<00:46,  1.06it/s]Processing groups:  54%|█████▍    | 54/100 [01:30<00:37,  1.23it/s]Processing groups:  58%|█████▊    | 58/100 [01:31<00:28,  1.46it/s]Processing groups:  63%|██████▎   | 63/100 [01:31<00:18,  1.96it/s]Processing groups:  63%|██████▎   | 63/100 [01:46<00:18,  1.96it/s]Processing groups:  65%|██████▌   | 65/100 [02:09<01:47,  3.06s/it]Processing groups:  71%|███████   | 71/100 [02:11<00:58,  2.03s/it]Processing groups:  72%|███████▏  | 72/100 [02:12<00:54,  1.95s/it]Processing groups:  74%|███████▍  | 74/100 [02:12<00:41,  1.59s/it]Processing groups:  79%|███████▉  | 79/100 [02:12<00:20,  1.03it/s]Processing groups:  81%|████████  | 81/100 [02:12<00:15,  1.22it/s]Processing groups:  84%|████████▍ | 84/100 [02:13<00:10,  1.59it/s]Processing groups:  86%|████████▌ | 86/100 [02:13<00:07,  1.79it/s]Processing groups:  97%|█████████▋| 97/100 [02:17<00:01,  2.34it/s]Processing groups:  98%|█████████▊| 98/100 [02:18<00:00,  2.36it/s]Processing groups: 100%|██████████| 100/100 [02:18<00:00,  1.38s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.55, 'mean_ap': 0.55, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40729.31it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:08:13, 41.35s/it]Processing groups:   2%|▏         | 2/100 [00:47<33:22, 20.43s/it]  Processing groups:  31%|███       | 31/100 [00:48<00:58,  1.18it/s]Processing groups:  31%|███       | 31/100 [01:07<00:58,  1.18it/s]Processing groups:  33%|███▎      | 33/100 [01:28<02:47,  2.50s/it]Processing groups:  34%|███▍      | 34/100 [01:28<02:36,  2.37s/it]Processing groups:  39%|███▉      | 39/100 [01:30<01:49,  1.79s/it]Processing groups:  58%|█████▊    | 58/100 [01:32<00:31,  1.31it/s]Processing groups:  62%|██████▏   | 62/100 [01:33<00:25,  1.49it/s]Processing groups:  64%|██████▍   | 64/100 [01:36<00:27,  1.30it/s]Processing groups:  65%|██████▌   | 65/100 [02:06<01:35,  2.72s/it]Processing groups:  66%|██████▌   | 66/100 [02:10<01:36,  2.84s/it]Processing groups:  69%|██████▉   | 69/100 [02:11<01:05,  2.11s/it]Processing groups:  70%|███████   | 70/100 [02:11<00:57,  1.93s/it]Processing groups:  74%|███████▍  | 74/100 [02:12<00:33,  1.28s/it]Processing groups:  77%|███████▋  | 77/100 [02:13<00:21,  1.08it/s]Processing groups:  78%|███████▊  | 78/100 [02:13<00:18,  1.17it/s]Processing groups:  89%|████████▉ | 89/100 [02:14<00:03,  2.89it/s]Processing groups:  95%|█████████▌| 95/100 [02:14<00:01,  4.11it/s]Processing groups:  97%|█████████▋| 97/100 [02:18<00:01,  2.16it/s]Processing groups:  98%|█████████▊| 98/100 [02:18<00:00,  2.24it/s]Processing groups:  99%|█████████▉| 99/100 [02:18<00:00,  2.42it/s]Processing groups: 100%|██████████| 100/100 [02:18<00:00,  1.39s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 128, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 2, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 15.59it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34072.33it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:01<1:41:23, 61.45s/it]Processing groups:   2%|▏         | 2/100 [01:02<42:04, 25.76s/it]  Processing groups:   3%|▎         | 3/100 [01:02<22:46, 14.09s/it]Processing groups:  21%|██        | 21/100 [01:03<01:29,  1.14s/it]Processing groups:  24%|██▍       | 24/100 [01:03<01:13,  1.03it/s]Processing groups:  24%|██▍       | 24/100 [01:16<01:13,  1.03it/s]Processing groups:  33%|███▎      | 33/100 [01:54<03:20,  3.00s/it]Processing groups:  34%|███▍      | 34/100 [01:58<03:21,  3.05s/it]Processing groups:  36%|███▌      | 36/100 [01:58<02:47,  2.62s/it]Processing groups:  37%|███▋      | 37/100 [01:58<02:29,  2.37s/it]Processing groups:  38%|███▊      | 38/100 [01:59<02:13,  2.16s/it]Processing groups:  39%|███▉      | 39/100 [02:00<02:00,  1.97s/it]Processing groups:  41%|████      | 41/100 [02:00<01:23,  1.41s/it]Processing groups:  44%|████▍     | 44/100 [02:01<00:53,  1.05it/s]Processing groups:  46%|████▌     | 46/100 [02:02<00:42,  1.28it/s]Processing groups:  49%|████▉     | 49/100 [02:02<00:28,  1.78it/s]Processing groups:  51%|█████     | 51/100 [02:02<00:21,  2.27it/s]Processing groups:  52%|█████▏    | 52/100 [02:03<00:21,  2.26it/s]Processing groups:  53%|█████▎    | 53/100 [02:03<00:19,  2.37it/s]Processing groups:  57%|█████▋    | 57/100 [02:04<00:12,  3.54it/s]Processing groups:  61%|██████    | 61/100 [02:05<00:09,  3.91it/s]Processing groups:  62%|██████▏   | 62/100 [02:06<00:14,  2.68it/s]Processing groups:  65%|██████▌   | 65/100 [02:52<03:23,  5.82s/it]Processing groups:  66%|██████▌   | 66/100 [02:57<03:13,  5.69s/it]Processing groups:  68%|██████▊   | 68/100 [02:58<02:09,  4.06s/it]Processing groups:  69%|██████▉   | 69/100 [03:01<02:00,  3.90s/it]Processing groups:  76%|███████▌  | 76/100 [03:01<00:34,  1.45s/it]Processing groups:  85%|████████▌ | 85/100 [03:01<00:10,  1.45it/s]Processing groups:  87%|████████▋ | 87/100 [03:02<00:08,  1.59it/s]Processing groups:  95%|█████████▌| 95/100 [03:02<00:01,  2.78it/s]Processing groups:  97%|█████████▋| 97/100 [03:07<00:02,  1.47it/s]Processing groups:  99%|█████████▉| 99/100 [03:08<00:00,  1.64it/s]Processing groups: 100%|██████████| 100/100 [03:08<00:00,  1.88s/it]
{'replicate_reproducibility': 0.028333333333333332, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}

Processing features_differ: {'gaussian': 4, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 18.84it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 44431.19it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:02<1:43:48, 62.91s/it]Processing groups:  12%|█▏        | 12/100 [01:03<05:33,  3.79s/it] Processing groups:  12%|█▏        | 12/100 [01:16<05:33,  3.79s/it]Processing groups:  33%|███▎      | 33/100 [01:54<03:08,  2.81s/it]Processing groups:  34%|███▍      | 34/100 [01:56<03:02,  2.77s/it]Processing groups:  36%|███▌      | 36/100 [01:58<02:43,  2.55s/it]Processing groups:  40%|████      | 40/100 [01:59<01:59,  2.00s/it]Processing groups:  41%|████      | 41/100 [02:00<01:55,  1.95s/it]Processing groups:  53%|█████▎    | 53/100 [02:01<00:40,  1.16it/s]Processing groups:  55%|█████▌    | 55/100 [02:02<00:35,  1.26it/s]Processing groups:  58%|█████▊    | 58/100 [02:02<00:26,  1.56it/s]Processing groups:  59%|█████▉    | 59/100 [02:03<00:25,  1.59it/s]Processing groups:  65%|██████▌   | 65/100 [02:53<02:19,  3.97s/it]Processing groups:  68%|██████▊   | 68/100 [02:53<01:38,  3.09s/it]Processing groups:  69%|██████▉   | 69/100 [02:55<01:30,  2.91s/it]Processing groups:  71%|███████   | 71/100 [02:55<01:06,  2.29s/it]Processing groups:  72%|███████▏  | 72/100 [02:57<01:02,  2.23s/it]Processing groups:  81%|████████  | 81/100 [02:57<00:15,  1.20it/s]Processing groups:  89%|████████▉ | 89/100 [02:57<00:05,  2.11it/s]Processing groups:  92%|█████████▏| 92/100 [02:58<00:03,  2.43it/s]Processing groups:  97%|█████████▋| 97/100 [03:04<00:01,  1.56it/s]Processing groups:  98%|█████████▊| 98/100 [03:04<00:01,  1.65it/s]Processing groups: 100%|██████████| 100/100 [03:04<00:00,  1.84s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.15, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}

Processing features_differ: {'gaussian': 8, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 19.62it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 45605.13it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:58<1:36:42, 58.61s/it]Processing groups:   2%|▏         | 2/100 [00:59<40:02, 24.52s/it]  Processing groups:  11%|█         | 11/100 [01:00<04:29,  3.02s/it]Processing groups:  12%|█▏        | 12/100 [01:02<04:11,  2.86s/it]Processing groups:  30%|███       | 30/100 [01:03<00:49,  1.40it/s]Processing groups:  30%|███       | 30/100 [01:20<00:49,  1.40it/s]Processing groups:  33%|███▎      | 33/100 [01:52<03:30,  3.13s/it]Processing groups:  34%|███▍      | 34/100 [01:55<03:26,  3.14s/it]Processing groups:  35%|███▌      | 35/100 [01:58<03:19,  3.07s/it]Processing groups:  40%|████      | 40/100 [02:00<02:01,  2.02s/it]Processing groups:  43%|████▎     | 43/100 [02:00<01:29,  1.57s/it]Processing groups:  50%|█████     | 50/100 [02:00<00:43,  1.15it/s]Processing groups:  53%|█████▎    | 53/100 [02:01<00:35,  1.34it/s]Processing groups:  55%|█████▌    | 55/100 [02:01<00:28,  1.59it/s]Processing groups:  59%|█████▉    | 59/100 [02:02<00:18,  2.23it/s]Processing groups:  61%|██████    | 61/100 [02:03<00:16,  2.30it/s]Processing groups:  64%|██████▍   | 64/100 [02:03<00:13,  2.67it/s]Processing groups:  65%|██████▌   | 65/100 [02:52<03:40,  6.29s/it]Processing groups:  66%|██████▌   | 66/100 [02:53<03:06,  5.49s/it]Processing groups:  67%|██████▋   | 67/100 [02:53<02:30,  4.56s/it]Processing groups:  68%|██████▊   | 68/100 [02:55<02:08,  4.02s/it]Processing groups:  69%|██████▉   | 69/100 [02:58<01:57,  3.79s/it]Processing groups:  72%|███████▏  | 72/100 [02:59<00:56,  2.03s/it]Processing groups:  84%|████████▍ | 84/100 [02:59<00:09,  1.73it/s]Processing groups:  97%|█████████▋| 97/100 [03:05<00:01,  1.96it/s]Processing groups: 100%|██████████| 100/100 [03:05<00:00,  1.86s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.18, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}

Processing features_differ: {'gaussian': 16, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 18.49it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40948.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:59<1:37:46, 59.26s/it]Processing groups:   2%|▏         | 2/100 [01:02<43:25, 26.58s/it]  Processing groups:  26%|██▌       | 26/100 [01:03<01:34,  1.27s/it]Processing groups:  26%|██▌       | 26/100 [01:23<01:34,  1.27s/it]Processing groups:  33%|███▎      | 33/100 [01:55<03:21,  3.01s/it]Processing groups:  34%|███▍      | 34/100 [01:56<03:12,  2.91s/it]Processing groups:  36%|███▌      | 36/100 [02:02<03:05,  2.91s/it]Processing groups:  55%|█████▌    | 55/100 [02:03<00:47,  1.06s/it]Processing groups:  57%|█████▋    | 57/100 [02:05<00:45,  1.05s/it]Processing groups:  58%|█████▊    | 58/100 [02:05<00:42,  1.00s/it]Processing groups:  65%|██████▌   | 65/100 [02:56<01:56,  3.34s/it]Processing groups:  67%|██████▋   | 67/100 [02:56<01:36,  2.92s/it]Processing groups:  70%|███████   | 70/100 [02:58<01:13,  2.45s/it]Processing groups:  75%|███████▌  | 75/100 [02:59<00:41,  1.67s/it]Processing groups:  82%|████████▏ | 82/100 [03:00<00:18,  1.02s/it]Processing groups:  83%|████████▎ | 83/100 [03:00<00:16,  1.04it/s]Processing groups:  87%|████████▋ | 87/100 [03:00<00:08,  1.47it/s]Processing groups:  95%|█████████▌| 95/100 [03:01<00:01,  2.60it/s]Processing groups:  97%|█████████▋| 97/100 [03:06<00:02,  1.36it/s]Processing groups:  99%|█████████▉| 99/100 [03:06<00:00,  1.59it/s]Processing groups: 100%|██████████| 100/100 [03:06<00:00,  1.87s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.47, 'mean_ap': 0.0, 'mean_ap_p_value': 0.24, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}

Processing features_differ: {'gaussian': 32, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 19.64it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43827.63it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:55<1:31:59, 55.76s/it]Processing groups:   2%|▏         | 2/100 [00:56<38:40, 23.68s/it]  Processing groups:   3%|▎         | 3/100 [00:57<21:08, 13.08s/it]Processing groups:   5%|▌         | 5/100 [00:58<09:33,  6.03s/it]Processing groups:   6%|▌         | 6/100 [01:01<07:56,  5.06s/it]Processing groups:   9%|▉         | 9/100 [01:02<03:42,  2.44s/it]Processing groups:  33%|███▎      | 33/100 [01:55<02:31,  2.26s/it]Processing groups:  37%|███▋      | 37/100 [01:57<02:03,  1.96s/it]Processing groups:  40%|████      | 40/100 [01:59<01:44,  1.74s/it]Processing groups:  50%|█████     | 50/100 [01:59<00:50,  1.01s/it]Processing groups:  52%|█████▏    | 52/100 [02:00<00:45,  1.04it/s]Processing groups:  54%|█████▍    | 54/100 [02:02<00:44,  1.03it/s]Processing groups:  65%|██████▌   | 65/100 [02:47<01:30,  2.58s/it]Processing groups:  66%|██████▌   | 66/100 [02:52<01:30,  2.67s/it]Processing groups:  67%|██████▋   | 67/100 [02:55<01:31,  2.77s/it]Processing groups:  68%|██████▊   | 68/100 [02:56<01:22,  2.59s/it]Processing groups:  74%|███████▍  | 74/100 [02:58<00:38,  1.46s/it]Processing groups:  90%|█████████ | 90/100 [02:58<00:05,  1.88it/s]Processing groups:  96%|█████████▌| 96/100 [02:58<00:01,  2.44it/s]Processing groups:  99%|█████████▉| 99/100 [03:04<00:00,  1.58it/s]Processing groups: 100%|██████████| 100/100 [03:04<00:00,  1.84s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.65, 'mean_ap': 0.0, 'mean_ap_p_value': 0.93, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}

Processing features_differ: {'gaussian': 64, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37449.14it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:58<1:36:32, 58.52s/it]Processing groups:   2%|▏         | 2/100 [01:02<42:54, 26.27s/it]  Processing groups:  25%|██▌       | 25/100 [01:03<01:40,  1.34s/it]Processing groups:  25%|██▌       | 25/100 [01:18<01:40,  1.34s/it]Processing groups:  33%|███▎      | 33/100 [01:52<03:14,  2.90s/it]Processing groups:  34%|███▍      | 34/100 [01:53<03:04,  2.79s/it]Processing groups:  35%|███▌      | 35/100 [01:54<02:53,  2.66s/it]Processing groups:  36%|███▌      | 36/100 [01:58<02:54,  2.73s/it]Processing groups:  37%|███▋      | 37/100 [02:02<03:02,  2.90s/it]Processing groups:  43%|████▎     | 43/100 [02:03<01:27,  1.53s/it]Processing groups:  59%|█████▉    | 59/100 [02:04<00:22,  1.79it/s]Processing groups:  61%|██████    | 61/100 [02:04<00:20,  1.93it/s]Processing groups:  64%|██████▍   | 64/100 [02:05<00:16,  2.13it/s]Processing groups:  65%|██████▌   | 65/100 [02:51<02:25,  4.16s/it]Processing groups:  66%|██████▌   | 66/100 [02:53<02:14,  3.95s/it]Processing groups:  67%|██████▋   | 67/100 [02:54<01:57,  3.55s/it]Processing groups:  68%|██████▊   | 68/100 [02:56<01:43,  3.22s/it]Processing groups:  69%|██████▉   | 69/100 [02:57<01:28,  2.87s/it]Processing groups:  71%|███████   | 71/100 [02:58<00:58,  2.02s/it]Processing groups:  75%|███████▌  | 75/100 [02:59<00:29,  1.19s/it]Processing groups:  76%|███████▌  | 76/100 [02:59<00:25,  1.06s/it]Processing groups:  77%|███████▋  | 77/100 [03:00<00:22,  1.04it/s]Processing groups:  79%|███████▉  | 79/100 [03:00<00:14,  1.48it/s]Processing groups:  81%|████████  | 81/100 [03:00<00:09,  2.08it/s]Processing groups:  86%|████████▌ | 86/100 [03:00<00:03,  4.15it/s]Processing groups:  93%|█████████▎| 93/100 [03:01<00:01,  6.38it/s]Processing groups:  97%|█████████▋| 97/100 [03:06<00:01,  1.97it/s]Processing groups:  98%|█████████▊| 98/100 [03:06<00:00,  2.07it/s]Processing groups: 100%|██████████| 100/100 [03:06<00:00,  1.87s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.97, 'mean_ap': 0.22, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}

Processing features_differ: {'gaussian': 128, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 200 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 18.37it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40493.38it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:55<1:30:46, 55.02s/it]Processing groups:   2%|▏         | 2/100 [00:57<39:20, 24.09s/it]  Processing groups:   6%|▌         | 6/100 [00:58<09:04,  5.79s/it]Processing groups:   7%|▋         | 7/100 [01:01<07:51,  5.07s/it]Processing groups:   8%|▊         | 8/100 [01:02<06:12,  4.05s/it]Processing groups:  22%|██▏       | 22/100 [01:02<00:56,  1.37it/s]Processing groups:  22%|██▏       | 22/100 [01:20<00:56,  1.37it/s]Processing groups:  33%|███▎      | 33/100 [01:53<02:56,  2.63s/it]Processing groups:  35%|███▌      | 35/100 [01:55<02:39,  2.45s/it]Processing groups:  37%|███▋      | 37/100 [02:00<02:33,  2.44s/it]Processing groups:  47%|████▋     | 47/100 [02:00<01:06,  1.25s/it]Processing groups:  50%|█████     | 50/100 [02:01<00:54,  1.09s/it]Processing groups:  54%|█████▍    | 54/100 [02:03<00:41,  1.12it/s]Processing groups:  62%|██████▏   | 62/100 [02:06<00:26,  1.43it/s]Processing groups:  65%|██████▌   | 65/100 [02:51<01:56,  3.33s/it]Processing groups:  66%|██████▌   | 66/100 [02:55<01:52,  3.31s/it]Processing groups:  68%|██████▊   | 68/100 [02:57<01:33,  2.92s/it]Processing groups:  73%|███████▎  | 73/100 [02:58<00:48,  1.80s/it]Processing groups:  75%|███████▌  | 75/100 [02:58<00:37,  1.49s/it]Processing groups:  77%|███████▋  | 77/100 [02:58<00:28,  1.22s/it]Processing groups:  79%|███████▉  | 79/100 [02:59<00:22,  1.05s/it]Processing groups:  82%|████████▏ | 82/100 [03:00<00:13,  1.35it/s]Processing groups:  90%|█████████ | 90/100 [03:00<00:03,  2.82it/s]Processing groups:  93%|█████████▎| 93/100 [03:00<00:01,  3.52it/s]Processing groups:  95%|█████████▌| 95/100 [03:01<00:01,  3.61it/s]Processing groups:  97%|█████████▋| 97/100 [03:05<00:02,  1.42it/s]Processing groups:  98%|█████████▊| 98/100 [03:06<00:01,  1.36it/s]Processing groups:  99%|█████████▉| 99/100 [03:07<00:00,  1.48it/s]Processing groups: 100%|██████████| 100/100 [03:07<00:00,  1.87s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 128, 'differ_params': 1}

Processing n_feats: 500

Processing n_plates: 2

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 42482.57it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:24<39:46, 24.11s/it]Processing groups:   2%|▏         | 2/100 [00:26<18:47, 11.51s/it]Processing groups:   3%|▎         | 3/100 [00:31<13:46,  8.52s/it]Processing groups:  12%|█▏        | 12/100 [00:40<02:59,  2.04s/it]Processing groups:  33%|███▎      | 33/100 [00:58<01:18,  1.18s/it]Processing groups:  37%|███▋      | 37/100 [00:58<01:02,  1.01it/s]Processing groups:  40%|████      | 40/100 [01:02<01:01,  1.02s/it]Processing groups:  43%|████▎     | 43/100 [01:02<00:48,  1.17it/s]Processing groups:  46%|████▌     | 46/100 [01:03<00:40,  1.32it/s]Processing groups:  50%|█████     | 50/100 [01:07<00:39,  1.26it/s]Processing groups:  56%|█████▌    | 56/100 [01:07<00:23,  1.88it/s]Processing groups:  58%|█████▊    | 58/100 [01:08<00:20,  2.07it/s]Processing groups:  62%|██████▏   | 62/100 [01:09<00:17,  2.20it/s]Processing groups:  63%|██████▎   | 63/100 [01:11<00:20,  1.81it/s]Processing groups:  64%|██████▍   | 64/100 [01:18<00:50,  1.42s/it]Processing groups:  65%|██████▌   | 65/100 [01:19<00:45,  1.30s/it]Processing groups:  66%|██████▌   | 66/100 [01:25<01:09,  2.05s/it]Processing groups:  67%|██████▋   | 67/100 [01:28<01:16,  2.33s/it]Processing groups:  68%|██████▊   | 68/100 [01:29<01:01,  1.93s/it]Processing groups:  70%|███████   | 70/100 [01:34<01:04,  2.14s/it]Processing groups:  81%|████████  | 81/100 [01:36<00:13,  1.44it/s]Processing groups:  91%|█████████ | 91/100 [01:37<00:03,  2.63it/s]Processing groups:  93%|█████████▎| 93/100 [01:37<00:02,  2.93it/s]Processing groups:  96%|█████████▌| 96/100 [01:38<00:01,  2.98it/s]Processing groups:  98%|█████████▊| 98/100 [01:38<00:00,  2.91it/s]Processing groups:  99%|█████████▉| 99/100 [01:39<00:00,  3.08it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.03, 'mp_value': 0.1, 'mean_ap': 0.12, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 44644.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<49:54, 30.25s/it]Processing groups:   4%|▍         | 4/100 [00:32<10:05,  6.31s/it]Processing groups:   7%|▋         | 7/100 [00:33<04:54,  3.17s/it]Processing groups:  21%|██        | 21/100 [00:34<00:57,  1.37it/s]Processing groups:  21%|██        | 21/100 [00:50<00:57,  1.37it/s]Processing groups:  33%|███▎      | 33/100 [00:58<01:29,  1.34s/it]Processing groups:  34%|███▍      | 34/100 [00:58<01:24,  1.29s/it]Processing groups:  36%|███▌      | 36/100 [01:00<01:18,  1.22s/it]Processing groups:  37%|███▋      | 37/100 [01:03<01:26,  1.38s/it]Processing groups:  41%|████      | 41/100 [01:05<01:06,  1.12s/it]Processing groups:  48%|████▊     | 48/100 [01:06<00:36,  1.43it/s]Processing groups:  58%|█████▊    | 58/100 [01:09<00:19,  2.14it/s]Processing groups:  65%|██████▌   | 65/100 [01:25<00:38,  1.09s/it]Processing groups:  66%|██████▌   | 66/100 [01:32<00:50,  1.47s/it]Processing groups:  67%|██████▋   | 67/100 [01:33<00:46,  1.42s/it]Processing groups:  71%|███████   | 71/100 [01:34<00:29,  1.03s/it]Processing groups:  73%|███████▎  | 73/100 [01:34<00:22,  1.18it/s]Processing groups:  76%|███████▌  | 76/100 [01:35<00:16,  1.44it/s]Processing groups:  84%|████████▍ | 84/100 [01:36<00:06,  2.55it/s]Processing groups:  91%|█████████ | 91/100 [01:36<00:02,  3.99it/s]Processing groups:  93%|█████████▎| 93/100 [01:37<00:01,  3.81it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:00,  3.51it/s]Processing groups:  98%|█████████▊| 98/100 [01:39<00:00,  3.53it/s]Processing groups:  99%|█████████▉| 99/100 [01:39<00:00,  3.20it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.00it/s]
{'replicate_reproducibility': 0.02, 'mp_value': 0.02, 'mean_ap': 0.18, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 42039.73it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:13, 31.65s/it]Processing groups:   7%|▋         | 7/100 [00:32<05:16,  3.40s/it]Processing groups:   9%|▉         | 9/100 [00:32<03:45,  2.48s/it]Processing groups:  22%|██▏       | 22/100 [00:33<00:54,  1.43it/s]Processing groups:  28%|██▊       | 28/100 [00:35<00:39,  1.80it/s]Processing groups:  29%|██▉       | 29/100 [00:35<00:40,  1.77it/s]Processing groups:  30%|███       | 30/100 [00:36<00:36,  1.91it/s]Processing groups:  33%|███▎      | 33/100 [00:58<02:47,  2.50s/it]Processing groups:  34%|███▍      | 34/100 [01:00<02:41,  2.45s/it]Processing groups:  38%|███▊      | 38/100 [01:01<01:37,  1.57s/it]Processing groups:  42%|████▏     | 42/100 [01:02<01:00,  1.04s/it]Processing groups:  43%|████▎     | 43/100 [01:02<00:53,  1.06it/s]Processing groups:  45%|████▌     | 45/100 [01:05<01:00,  1.09s/it]Processing groups:  52%|█████▏    | 52/100 [01:07<00:31,  1.51it/s]Processing groups:  61%|██████    | 61/100 [01:08<00:13,  2.82it/s]Processing groups:  64%|██████▍   | 64/100 [01:08<00:10,  3.37it/s]Processing groups:  64%|██████▍   | 64/100 [01:20<00:10,  3.37it/s]Processing groups:  65%|██████▌   | 65/100 [01:32<01:20,  2.30s/it]Processing groups:  67%|██████▋   | 67/100 [01:32<01:03,  1.92s/it]Processing groups:  69%|██████▉   | 69/100 [01:33<00:49,  1.59s/it]Processing groups:  72%|███████▏  | 72/100 [01:34<00:34,  1.22s/it]Processing groups:  81%|████████  | 81/100 [01:35<00:10,  1.83it/s]Processing groups:  85%|████████▌ | 85/100 [01:35<00:06,  2.31it/s]Processing groups:  89%|████████▉ | 89/100 [01:36<00:03,  3.08it/s]Processing groups:  92%|█████████▏| 92/100 [01:36<00:02,  3.84it/s]Processing groups:  96%|█████████▌| 96/100 [01:36<00:00,  4.57it/s]Processing groups:  98%|█████████▊| 98/100 [01:39<00:00,  2.52it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 0.21, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values:  45%|████▌     | 45/100 [00:00<00:00, 426.18it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 934.16it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:20<34:32, 20.93s/it]Processing groups:   2%|▏         | 2/100 [00:29<22:41, 13.89s/it]Processing groups:   3%|▎         | 3/100 [00:33<15:13,  9.42s/it]Processing groups:  26%|██▌       | 26/100 [00:34<00:46,  1.59it/s]Processing groups:  26%|██▌       | 26/100 [00:48<00:46,  1.59it/s]Processing groups:  33%|███▎      | 33/100 [00:52<01:17,  1.16s/it]Processing groups:  34%|███▍      | 34/100 [00:58<01:35,  1.45s/it]Processing groups:  37%|███▋      | 37/100 [01:00<01:20,  1.28s/it]Processing groups:  39%|███▉      | 39/100 [01:01<01:11,  1.18s/it]Processing groups:  44%|████▍     | 44/100 [01:01<00:44,  1.27it/s]Processing groups:  45%|████▌     | 45/100 [01:02<00:43,  1.28it/s]Processing groups:  46%|████▌     | 46/100 [01:04<00:48,  1.12it/s]Processing groups:  59%|█████▉    | 59/100 [01:06<00:15,  2.69it/s]Processing groups:  62%|██████▏   | 62/100 [01:07<00:13,  2.74it/s]Processing groups:  64%|██████▍   | 64/100 [01:08<00:15,  2.36it/s]Processing groups:  65%|██████▌   | 65/100 [01:26<01:12,  2.07s/it]Processing groups:  67%|██████▋   | 67/100 [01:30<01:08,  2.09s/it]Processing groups:  68%|██████▊   | 68/100 [01:33<01:09,  2.17s/it]Processing groups:  72%|███████▏  | 72/100 [01:34<00:37,  1.33s/it]Processing groups:  75%|███████▌  | 75/100 [01:35<00:26,  1.05s/it]Processing groups:  91%|█████████ | 91/100 [01:35<00:02,  3.18it/s]Processing groups:  95%|█████████▌| 95/100 [01:35<00:01,  3.86it/s]Processing groups:  99%|█████████▉| 99/100 [01:37<00:00,  3.08it/s]Processing groups: 100%|██████████| 100/100 [01:37<00:00,  1.02it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 0.45, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39349.88it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<48:01, 29.11s/it]Processing groups:   3%|▎         | 3/100 [00:32<14:06,  8.73s/it]Processing groups:  16%|█▌        | 16/100 [00:34<01:46,  1.26s/it]Processing groups:  33%|███▎      | 33/100 [00:48<01:07,  1.00s/it]Processing groups:  34%|███▍      | 34/100 [01:05<01:56,  1.77s/it]Processing groups:  51%|█████     | 51/100 [01:06<00:41,  1.20it/s]Processing groups:  58%|█████▊    | 58/100 [01:06<00:27,  1.54it/s]Processing groups:  60%|██████    | 60/100 [01:09<00:29,  1.38it/s]Processing groups:  65%|██████▌   | 65/100 [01:19<00:34,  1.00it/s]Processing groups:  66%|██████▌   | 66/100 [01:33<01:04,  1.90s/it]Processing groups:  72%|███████▏  | 72/100 [01:34<00:35,  1.27s/it]Processing groups:  76%|███████▌  | 76/100 [01:35<00:24,  1.01s/it]Processing groups:  77%|███████▋  | 77/100 [01:37<00:23,  1.04s/it]Processing groups:  86%|████████▌ | 86/100 [01:37<00:07,  1.94it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:00,  3.01it/s]Processing groups:  99%|█████████▉| 99/100 [01:39<00:00,  2.94it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  3.09it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.00it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 0.89, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37282.70it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:27<45:01, 27.29s/it]Processing groups:   2%|▏         | 2/100 [00:28<19:54, 12.19s/it]Processing groups:   3%|▎         | 3/100 [00:29<11:17,  6.98s/it]Processing groups:   4%|▍         | 4/100 [00:32<08:38,  5.41s/it]Processing groups:   5%|▌         | 5/100 [00:32<05:36,  3.54s/it]Processing groups:  15%|█▌        | 15/100 [00:35<01:05,  1.29it/s]Processing groups:  33%|███▎      | 33/100 [00:56<01:09,  1.04s/it]Processing groups:  34%|███▍      | 34/100 [00:57<01:08,  1.04s/it]Processing groups:  35%|███▌      | 35/100 [01:03<01:32,  1.42s/it]Processing groups:  41%|████      | 41/100 [01:07<01:07,  1.15s/it]Processing groups:  65%|██████▌   | 65/100 [01:27<00:32,  1.07it/s]Processing groups:  67%|██████▋   | 67/100 [01:30<00:31,  1.05it/s]Processing groups:  68%|██████▊   | 68/100 [01:30<00:29,  1.09it/s]Processing groups:  69%|██████▉   | 69/100 [01:34<00:34,  1.12s/it]Processing groups:  72%|███████▏  | 72/100 [01:35<00:26,  1.04it/s]Processing groups:  78%|███████▊  | 78/100 [01:36<00:14,  1.55it/s]Processing groups:  95%|█████████▌| 95/100 [01:38<00:01,  3.24it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:00,  3.34it/s]Processing groups:  98%|█████████▊| 98/100 [01:38<00:00,  3.35it/s]Processing groups:  99%|█████████▉| 99/100 [01:39<00:00,  3.21it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 46916.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:41, 31.94s/it]Processing groups:   5%|▌         | 5/100 [00:34<08:17,  5.24s/it]Processing groups:  10%|█         | 10/100 [00:34<03:14,  2.16s/it]Processing groups:  28%|██▊       | 28/100 [00:35<00:39,  1.81it/s]Processing groups:  28%|██▊       | 28/100 [00:46<00:39,  1.81it/s]Processing groups:  33%|███▎      | 33/100 [00:58<01:38,  1.46s/it]Processing groups:  34%|███▍      | 34/100 [00:59<01:35,  1.45s/it]Processing groups:  35%|███▌      | 35/100 [01:04<01:55,  1.78s/it]Processing groups:  47%|████▋     | 47/100 [01:05<00:40,  1.30it/s]Processing groups:  54%|█████▍    | 54/100 [01:06<00:26,  1.74it/s]Processing groups:  57%|█████▋    | 57/100 [01:07<00:23,  1.84it/s]Processing groups:  61%|██████    | 61/100 [01:10<00:22,  1.70it/s]Processing groups:  62%|██████▏   | 62/100 [01:13<00:29,  1.27it/s]Processing groups:  65%|██████▌   | 65/100 [01:30<01:09,  1.98s/it]Processing groups:  67%|██████▋   | 67/100 [01:30<00:54,  1.65s/it]Processing groups:  69%|██████▉   | 69/100 [01:33<00:48,  1.58s/it]Processing groups:  73%|███████▎  | 73/100 [01:33<00:27,  1.00s/it]Processing groups:  76%|███████▌  | 76/100 [01:35<00:22,  1.09it/s]Processing groups:  82%|████████▏ | 82/100 [01:36<00:10,  1.80it/s]Processing groups:  92%|█████████▏| 92/100 [01:37<00:02,  3.16it/s]Processing groups:  94%|█████████▍| 94/100 [01:37<00:01,  3.53it/s]Processing groups:  95%|█████████▌| 95/100 [01:37<00:01,  3.60it/s]Processing groups:  96%|█████████▌| 96/100 [01:38<00:01,  3.12it/s]Processing groups:  97%|█████████▋| 97/100 [01:38<00:00,  3.20it/s]Processing groups:  98%|█████████▊| 98/100 [01:39<00:00,  2.53it/s]Processing groups:  99%|█████████▉| 99/100 [01:39<00:00,  2.81it/s]Processing groups: 100%|██████████| 100/100 [01:39<00:00,  1.00it/s]
{'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32486.28it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:01:33, 37.31s/it]Processing groups:   7%|▋         | 7/100 [00:37<06:09,  3.97s/it]  Processing groups:   9%|▉         | 9/100 [00:37<04:14,  2.80s/it]Processing groups:  13%|█▎        | 13/100 [00:41<02:43,  1.88s/it]Processing groups:  33%|███▎      | 33/100 [01:06<01:34,  1.41s/it]Processing groups:  34%|███▍      | 34/100 [01:11<01:46,  1.61s/it]Processing groups:  38%|███▊      | 38/100 [01:14<01:25,  1.37s/it]Processing groups:  44%|████▍     | 44/100 [01:14<00:53,  1.06it/s]Processing groups:  45%|████▌     | 45/100 [01:14<00:49,  1.12it/s]Processing groups:  48%|████▊     | 48/100 [01:16<00:44,  1.18it/s]Processing groups:  62%|██████▏   | 62/100 [01:17<00:13,  2.79it/s]Processing groups:  63%|██████▎   | 63/100 [01:18<00:14,  2.51it/s]Processing groups:  65%|██████▌   | 65/100 [01:41<01:08,  1.96s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<01:06,  1.97s/it]Processing groups:  67%|██████▋   | 67/100 [01:45<01:05,  1.99s/it]Processing groups:  68%|██████▊   | 68/100 [01:46<00:59,  1.85s/it]Processing groups:  71%|███████   | 71/100 [01:48<00:43,  1.49s/it]Processing groups:  80%|████████  | 80/100 [01:49<00:12,  1.61it/s]Processing groups:  93%|█████████▎| 93/100 [01:50<00:02,  3.36it/s]Processing groups:  97%|█████████▋| 97/100 [01:52<00:01,  2.86it/s]Processing groups:  98%|█████████▊| 98/100 [01:53<00:00,  2.82it/s]Processing groups:  99%|█████████▉| 99/100 [01:53<00:00,  2.98it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.13s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.02, 'mean_ap': 0.04, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38814.58it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:35<58:48, 35.64s/it]Processing groups:   2%|▏         | 2/100 [00:36<24:25, 14.96s/it]Processing groups:   5%|▌         | 5/100 [00:37<07:07,  4.50s/it]Processing groups:   6%|▌         | 6/100 [00:37<05:17,  3.38s/it]Processing groups:   8%|▊         | 8/100 [00:37<03:12,  2.09s/it]Processing groups:  22%|██▏       | 22/100 [00:38<00:32,  2.37it/s]Processing groups:  22%|██▏       | 22/100 [00:51<00:32,  2.37it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:22,  1.24s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:33,  1.41s/it]Processing groups:  36%|███▌      | 36/100 [01:09<01:32,  1.45s/it]Processing groups:  37%|███▋      | 37/100 [01:14<01:53,  1.79s/it]Processing groups:  45%|████▌     | 45/100 [01:16<00:53,  1.03it/s]Processing groups:  51%|█████     | 51/100 [01:16<00:32,  1.49it/s]Processing groups:  60%|██████    | 60/100 [01:17<00:16,  2.36it/s]Processing groups:  65%|██████▌   | 65/100 [01:37<00:47,  1.35s/it]Processing groups:  66%|██████▌   | 66/100 [01:42<00:52,  1.56s/it]Processing groups:  67%|██████▋   | 67/100 [01:46<00:57,  1.75s/it]Processing groups:  69%|██████▉   | 69/100 [01:46<00:44,  1.43s/it]Processing groups:  73%|███████▎  | 73/100 [01:47<00:28,  1.05s/it]Processing groups:  81%|████████  | 81/100 [01:48<00:10,  1.86it/s]Processing groups:  84%|████████▍ | 84/100 [01:48<00:07,  2.25it/s]Processing groups:  89%|████████▉ | 89/100 [01:49<00:03,  2.87it/s]Processing groups:  97%|█████████▋| 97/100 [01:51<00:00,  3.01it/s]Processing groups:  98%|█████████▊| 98/100 [01:52<00:00,  2.96it/s]Processing groups: 100%|██████████| 100/100 [01:52<00:00,  1.12s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.06, 'mean_ap': 0.11, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38009.10it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:02, 37.60s/it]Processing groups:  10%|█         | 10/100 [00:37<04:06,  2.74s/it] Processing groups:  18%|█▊        | 18/100 [00:39<01:51,  1.36s/it]Processing groups:  20%|██        | 20/100 [00:39<01:33,  1.17s/it]Processing groups:  24%|██▍       | 24/100 [00:40<01:03,  1.20it/s]Processing groups:  26%|██▌       | 26/100 [00:41<00:57,  1.28it/s]Processing groups:  33%|███▎      | 33/100 [01:08<02:33,  2.29s/it]Processing groups:  36%|███▌      | 36/100 [01:09<01:55,  1.80s/it]Processing groups:  38%|███▊      | 38/100 [01:15<02:06,  2.04s/it]Processing groups:  41%|████      | 41/100 [01:19<01:51,  1.89s/it]Processing groups:  65%|██████▌   | 65/100 [01:38<00:36,  1.04s/it]Processing groups:  66%|██████▌   | 66/100 [01:42<00:40,  1.19s/it]Processing groups:  68%|██████▊   | 68/100 [01:47<00:41,  1.30s/it]Processing groups:  76%|███████▌  | 76/100 [01:48<00:19,  1.21it/s]Processing groups:  77%|███████▋  | 77/100 [01:50<00:21,  1.08it/s]Processing groups:  79%|███████▉  | 79/100 [01:50<00:17,  1.21it/s]Processing groups:  96%|█████████▌| 96/100 [01:51<00:01,  3.38it/s]Processing groups:  99%|█████████▉| 99/100 [01:53<00:00,  2.69it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.07, 'mean_ap': 0.14, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41618.42it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:47, 34.42s/it]Processing groups:   2%|▏         | 2/100 [00:36<25:24, 15.56s/it]Processing groups:   3%|▎         | 3/100 [00:38<15:05,  9.33s/it]Processing groups:   8%|▊         | 8/100 [00:39<03:34,  2.33s/it]Processing groups:  11%|█         | 11/100 [00:39<02:08,  1.45s/it]Processing groups:  24%|██▍       | 24/100 [00:41<00:38,  1.95it/s]Processing groups:  33%|███▎      | 33/100 [01:09<01:44,  1.57s/it]Processing groups:  34%|███▍      | 34/100 [01:10<01:42,  1.55s/it]Processing groups:  36%|███▌      | 36/100 [01:11<01:28,  1.39s/it]Processing groups:  40%|████      | 40/100 [01:15<01:16,  1.27s/it]Processing groups:  53%|█████▎    | 53/100 [01:18<00:31,  1.49it/s]Processing groups:  62%|██████▏   | 62/100 [01:18<00:16,  2.30it/s]Processing groups:  62%|██████▏   | 62/100 [01:33<00:16,  2.30it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<00:57,  1.63s/it]Processing groups:  67%|██████▋   | 67/100 [01:45<00:49,  1.52s/it]Processing groups:  69%|██████▉   | 69/100 [01:47<00:44,  1.42s/it]Processing groups:  70%|███████   | 70/100 [01:48<00:41,  1.37s/it]Processing groups:  73%|███████▎  | 73/100 [01:48<00:27,  1.00s/it]Processing groups:  74%|███████▍  | 74/100 [01:49<00:24,  1.05it/s]Processing groups:  75%|███████▌  | 75/100 [01:50<00:25,  1.02s/it]Processing groups:  86%|████████▌ | 86/100 [01:50<00:04,  3.12it/s]Processing groups:  88%|████████▊ | 88/100 [01:51<00:03,  3.44it/s]Processing groups:  91%|█████████ | 91/100 [01:51<00:02,  4.10it/s]Processing groups:  93%|█████████▎| 93/100 [01:52<00:02,  3.44it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  2.78it/s]Processing groups:  98%|█████████▊| 98/100 [01:54<00:00,  2.79it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.07, 'mean_ap': 0.35, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38349.68it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:00:12, 36.49s/it]Processing groups:   6%|▌         | 6/100 [00:37<07:23,  4.71s/it]  Processing groups:   7%|▋         | 7/100 [00:37<05:53,  3.80s/it]Processing groups:  14%|█▍        | 14/100 [00:39<02:00,  1.40s/it]Processing groups:  22%|██▏       | 22/100 [00:40<00:56,  1.39it/s]Processing groups:  33%|███▎      | 33/100 [01:07<01:47,  1.61s/it]Processing groups:  34%|███▍      | 34/100 [01:10<01:50,  1.68s/it]Processing groups:  35%|███▌      | 35/100 [01:12<01:54,  1.76s/it]Processing groups:  36%|███▌      | 36/100 [01:13<01:48,  1.69s/it]Processing groups:  48%|████▊     | 48/100 [01:16<00:37,  1.39it/s]Processing groups:  53%|█████▎    | 53/100 [01:16<00:24,  1.89it/s]Processing groups:  55%|█████▌    | 55/100 [01:18<00:27,  1.62it/s]Processing groups:  55%|█████▌    | 55/100 [01:37<00:27,  1.62it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<00:53,  1.52s/it]Processing groups:  66%|██████▌   | 66/100 [01:44<00:51,  1.53s/it]Processing groups:  67%|██████▋   | 67/100 [01:46<00:50,  1.54s/it]Processing groups:  68%|██████▊   | 68/100 [01:47<00:48,  1.51s/it]Processing groups:  76%|███████▌  | 76/100 [01:49<00:19,  1.26it/s]Processing groups:  77%|███████▋  | 77/100 [01:49<00:17,  1.33it/s]Processing groups:  86%|████████▌ | 86/100 [01:49<00:05,  2.76it/s]Processing groups:  91%|█████████ | 91/100 [01:50<00:02,  3.76it/s]Processing groups:  97%|█████████▋| 97/100 [01:52<00:00,  3.02it/s]Processing groups:  99%|█████████▉| 99/100 [01:53<00:00,  3.22it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.13s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 0.84, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 45447.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:29, 33.63s/it]Processing groups:   2%|▏         | 2/100 [00:38<27:38, 16.92s/it]Processing groups:  16%|█▌        | 16/100 [00:40<02:00,  1.44s/it]Processing groups:  21%|██        | 21/100 [00:41<01:20,  1.02s/it]Processing groups:  33%|███▎      | 33/100 [01:06<01:47,  1.60s/it]Processing groups:  34%|███▍      | 34/100 [01:08<01:47,  1.62s/it]Processing groups:  35%|███▌      | 35/100 [01:11<01:53,  1.74s/it]Processing groups:  37%|███▋      | 37/100 [01:12<01:36,  1.52s/it]Processing groups:  38%|███▊      | 38/100 [01:13<01:24,  1.37s/it]Processing groups:  40%|████      | 40/100 [01:13<01:07,  1.12s/it]Processing groups:  46%|████▌     | 46/100 [01:15<00:38,  1.39it/s]Processing groups:  56%|█████▌    | 56/100 [01:20<00:25,  1.74it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<00:50,  1.44s/it]Processing groups:  67%|██████▋   | 67/100 [01:44<00:42,  1.29s/it]Processing groups:  68%|██████▊   | 68/100 [01:45<00:39,  1.22s/it]Processing groups:  70%|███████   | 70/100 [01:46<00:33,  1.12s/it]Processing groups:  72%|███████▏  | 72/100 [01:49<00:33,  1.18s/it]Processing groups:  80%|████████  | 80/100 [01:50<00:13,  1.52it/s]Processing groups:  90%|█████████ | 90/100 [01:51<00:03,  2.91it/s]Processing groups:  97%|█████████▋| 97/100 [01:53<00:01,  2.78it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.15, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34660.80it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:09:47, 42.30s/it]Processing groups:  33%|███▎      | 33/100 [01:11<02:00,  1.79s/it] Processing groups:  40%|████      | 40/100 [01:17<01:34,  1.58s/it]Processing groups:  57%|█████▋    | 57/100 [01:18<00:38,  1.10it/s]Processing groups:  58%|█████▊    | 58/100 [01:18<00:36,  1.14it/s]Processing groups:  59%|█████▉    | 59/100 [01:19<00:34,  1.19it/s]Processing groups:  61%|██████    | 61/100 [01:20<00:32,  1.20it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:20,  2.29s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<01:14,  2.18s/it]Processing groups:  67%|██████▋   | 67/100 [01:48<01:08,  2.07s/it]Processing groups:  69%|██████▉   | 69/100 [01:49<00:52,  1.69s/it]Processing groups:  75%|███████▌  | 75/100 [01:49<00:21,  1.15it/s]Processing groups:  82%|████████▏ | 82/100 [01:50<00:09,  1.94it/s]Processing groups:  88%|████████▊ | 88/100 [01:50<00:04,  2.92it/s]Processing groups:  90%|█████████ | 90/100 [01:50<00:03,  3.28it/s]Processing groups:  92%|█████████▏| 92/100 [01:51<00:02,  3.60it/s]Processing groups:  94%|█████████▍| 94/100 [01:51<00:01,  4.12it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  1.99it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35671.92it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:17:45, 47.12s/it]Processing groups:   8%|▊         | 8/100 [00:48<06:55,  4.51s/it]  Processing groups:  19%|█▉        | 19/100 [00:49<02:01,  1.51s/it]Processing groups:  19%|█▉        | 19/100 [01:03<02:01,  1.51s/it]Processing groups:  33%|███▎      | 33/100 [01:26<02:23,  2.15s/it]Processing groups:  37%|███▋      | 37/100 [01:31<02:03,  1.96s/it]Processing groups:  42%|████▏     | 42/100 [01:32<01:28,  1.52s/it]Processing groups:  47%|████▋     | 47/100 [01:32<01:02,  1.17s/it]Processing groups:  55%|█████▌    | 55/100 [01:34<00:35,  1.26it/s]Processing groups:  56%|█████▌    | 56/100 [01:35<00:37,  1.18it/s]Processing groups:  59%|█████▉    | 59/100 [01:38<00:35,  1.17it/s]Processing groups:  65%|██████▌   | 65/100 [02:10<01:27,  2.51s/it]Processing groups:  66%|██████▌   | 66/100 [02:14<01:30,  2.65s/it]Processing groups:  69%|██████▉   | 69/100 [02:14<01:02,  2.01s/it]Processing groups:  70%|███████   | 70/100 [02:16<00:59,  2.00s/it]Processing groups:  80%|████████  | 80/100 [02:17<00:16,  1.21it/s]Processing groups:  93%|█████████▎| 93/100 [02:18<00:02,  2.44it/s]Processing groups:  95%|█████████▌| 95/100 [02:19<00:02,  2.41it/s]Processing groups:  97%|█████████▋| 97/100 [02:22<00:01,  1.73it/s]Processing groups: 100%|██████████| 100/100 [02:22<00:00,  2.12it/s]Processing groups: 100%|██████████| 100/100 [02:22<00:00,  1.43s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.21, 'mean_ap': 0.04, 'mean_ap_p_value': 0.07, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1130.23it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:15, 46.22s/it]Processing groups:   3%|▎         | 3/100 [00:46<19:42, 12.19s/it]  Processing groups:   6%|▌         | 6/100 [00:47<07:44,  4.94s/it]Processing groups:  11%|█         | 11/100 [00:48<03:02,  2.05s/it]Processing groups:  19%|█▉        | 19/100 [00:50<01:21,  1.00s/it]Processing groups:  31%|███       | 31/100 [00:50<00:33,  2.04it/s]Processing groups:  33%|███▎      | 33/100 [01:30<03:03,  2.75s/it]Processing groups:  40%|████      | 40/100 [01:31<01:45,  1.76s/it]Processing groups:  42%|████▏     | 42/100 [01:33<01:38,  1.70s/it]Processing groups:  52%|█████▏    | 52/100 [01:36<00:47,  1.01it/s]Processing groups:  62%|██████▏   | 62/100 [01:39<00:28,  1.35it/s]Processing groups:  65%|██████▌   | 65/100 [02:12<01:18,  2.25s/it]Processing groups:  66%|██████▌   | 66/100 [02:14<01:15,  2.22s/it]Processing groups:  68%|██████▊   | 68/100 [02:14<01:00,  1.90s/it]Processing groups:  69%|██████▉   | 69/100 [02:16<00:57,  1.87s/it]Processing groups:  86%|████████▌ | 86/100 [02:16<00:07,  1.83it/s]Processing groups:  89%|████████▉ | 89/100 [02:16<00:05,  2.09it/s]Processing groups:  92%|█████████▏| 92/100 [02:17<00:03,  2.48it/s]Processing groups:  94%|█████████▍| 94/100 [02:17<00:02,  2.55it/s]Processing groups:  96%|█████████▌| 96/100 [02:18<00:01,  2.72it/s]Processing groups:  98%|█████████▊| 98/100 [02:21<00:01,  1.53it/s]Processing groups: 100%|██████████| 100/100 [02:21<00:00,  1.91it/s]Processing groups: 100%|██████████| 100/100 [02:21<00:00,  1.42s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.02, 'mean_ap': 0.05, 'mean_ap_p_value': 0.08, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38522.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:12:40, 44.04s/it]Processing groups:   3%|▎         | 3/100 [00:45<19:32, 12.08s/it]  Processing groups:   4%|▍         | 4/100 [00:46<13:15,  8.28s/it]Processing groups:   6%|▌         | 6/100 [00:47<06:43,  4.29s/it]Processing groups:  12%|█▏        | 12/100 [00:47<02:03,  1.40s/it]Processing groups:  29%|██▉       | 29/100 [00:49<00:30,  2.31it/s]Processing groups:  29%|██▉       | 29/100 [01:07<00:30,  2.31it/s]Processing groups:  33%|███▎      | 33/100 [01:27<02:29,  2.23s/it]Processing groups:  34%|███▍      | 34/100 [01:29<02:26,  2.23s/it]Processing groups:  35%|███▌      | 35/100 [01:30<02:17,  2.11s/it]Processing groups:  37%|███▋      | 37/100 [01:30<01:47,  1.70s/it]Processing groups:  39%|███▉      | 39/100 [01:31<01:25,  1.41s/it]Processing groups:  42%|████▏     | 42/100 [01:33<01:13,  1.27s/it]Processing groups:  44%|████▍     | 44/100 [01:34<01:00,  1.09s/it]Processing groups:  54%|█████▍    | 54/100 [01:35<00:21,  2.18it/s]Processing groups:  64%|██████▍   | 64/100 [01:38<00:13,  2.60it/s]Processing groups:  65%|██████▌   | 65/100 [02:09<01:20,  2.30s/it]Processing groups:  66%|██████▌   | 66/100 [02:12<01:18,  2.32s/it]Processing groups:  68%|██████▊   | 68/100 [02:13<01:05,  2.04s/it]Processing groups:  69%|██████▉   | 69/100 [02:15<01:01,  1.98s/it]Processing groups:  70%|███████   | 70/100 [02:15<00:51,  1.73s/it]Processing groups:  73%|███████▎  | 73/100 [02:16<00:31,  1.18s/it]Processing groups:  75%|███████▌  | 75/100 [02:16<00:23,  1.07it/s]Processing groups:  76%|███████▌  | 76/100 [02:17<00:21,  1.13it/s]Processing groups:  92%|█████████▏| 92/100 [02:17<00:01,  4.82it/s]Processing groups:  96%|█████████▌| 96/100 [02:18<00:00,  5.56it/s]Processing groups:  98%|█████████▊| 98/100 [02:22<00:00,  2.40it/s]Processing groups: 100%|██████████| 100/100 [02:22<00:00,  1.42s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.1, 'mean_ap_p_value': 0.18, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41527.76it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:19:42, 48.31s/it]Processing groups:   2%|▏         | 2/100 [00:49<33:10, 20.32s/it]  Processing groups:   4%|▍         | 4/100 [00:49<12:24,  7.76s/it]Processing groups:  23%|██▎       | 23/100 [00:49<01:03,  1.21it/s]Processing groups:  23%|██▎       | 23/100 [01:04<01:03,  1.21it/s]Processing groups:  33%|███▎      | 33/100 [01:29<02:20,  2.09s/it]Processing groups:  35%|███▌      | 35/100 [01:32<02:10,  2.02s/it]Processing groups:  39%|███▉      | 39/100 [01:36<01:50,  1.82s/it]Processing groups:  61%|██████    | 61/100 [01:36<00:25,  1.53it/s]Processing groups:  61%|██████    | 61/100 [01:54<00:25,  1.53it/s]Processing groups:  65%|██████▌   | 65/100 [02:11<01:03,  1.80s/it]Processing groups:  66%|██████▌   | 66/100 [02:14<01:03,  1.86s/it]Processing groups:  71%|███████   | 71/100 [02:16<00:42,  1.45s/it]Processing groups:  75%|███████▌  | 75/100 [02:17<00:30,  1.21s/it]Processing groups:  81%|████████  | 81/100 [02:18<00:16,  1.18it/s]Processing groups:  95%|█████████▌| 95/100 [02:18<00:02,  2.40it/s]Processing groups:  98%|█████████▊| 98/100 [02:22<00:01,  1.84it/s]Processing groups: 100%|██████████| 100/100 [02:22<00:00,  1.43s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.19, 'mean_ap': 0.29, 'mean_ap_p_value': 0.36, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 46356.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:46, 42.89s/it]Processing groups:   2%|▏         | 2/100 [00:44<30:09, 18.46s/it]  Processing groups:   3%|▎         | 3/100 [00:45<16:51, 10.43s/it]Processing groups:   6%|▌         | 6/100 [00:46<05:57,  3.80s/it]Processing groups:  13%|█▎        | 13/100 [00:47<01:52,  1.29s/it]Processing groups:  14%|█▍        | 14/100 [00:48<01:45,  1.23s/it]Processing groups:  17%|█▋        | 17/100 [00:50<01:28,  1.07s/it]Processing groups:  33%|███▎      | 33/100 [01:30<02:21,  2.12s/it]Processing groups:  44%|████▍     | 44/100 [01:31<01:11,  1.28s/it]Processing groups:  53%|█████▎    | 53/100 [01:33<00:42,  1.10it/s]Processing groups:  54%|█████▍    | 54/100 [01:36<00:46,  1.01s/it]Processing groups:  65%|██████▌   | 65/100 [02:11<01:09,  1.98s/it]Processing groups:  67%|██████▋   | 67/100 [02:15<01:05,  1.98s/it]Processing groups:  80%|████████  | 80/100 [02:16<00:20,  1.03s/it]Processing groups:  82%|████████▏ | 82/100 [02:16<00:17,  1.03it/s]Processing groups:  95%|█████████▌| 95/100 [02:17<00:02,  1.91it/s]Processing groups:  98%|█████████▊| 98/100 [02:21<00:01,  1.54it/s]Processing groups: 100%|██████████| 100/100 [02:21<00:00,  1.42s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.49, 'mean_ap': 0.76, 'mean_ap_p_value': 0.89, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35659.79it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:15:14, 45.60s/it]Processing groups:   3%|▎         | 3/100 [00:47<20:32, 12.71s/it]  Processing groups:  12%|█▏        | 12/100 [00:49<03:28,  2.36s/it]Processing groups:  33%|███▎      | 33/100 [01:24<02:03,  1.84s/it]Processing groups:  34%|███▍      | 34/100 [01:28<02:09,  1.96s/it]Processing groups:  38%|███▊      | 38/100 [01:31<01:44,  1.69s/it]Processing groups:  39%|███▉      | 39/100 [01:32<01:41,  1.67s/it]Processing groups:  45%|████▌     | 45/100 [01:34<01:01,  1.12s/it]Processing groups:  60%|██████    | 60/100 [01:35<00:20,  1.94it/s]Processing groups:  61%|██████    | 61/100 [01:35<00:20,  1.95it/s]Processing groups:  64%|██████▍   | 64/100 [01:39<00:22,  1.60it/s]Processing groups:  65%|██████▌   | 65/100 [02:07<01:40,  2.87s/it]Processing groups:  66%|██████▌   | 66/100 [02:10<01:35,  2.80s/it]Processing groups:  67%|██████▋   | 67/100 [02:14<01:37,  2.97s/it]Processing groups:  71%|███████   | 71/100 [02:14<00:51,  1.76s/it]Processing groups:  74%|███████▍  | 74/100 [02:16<00:36,  1.39s/it]Processing groups:  80%|████████  | 80/100 [02:16<00:14,  1.35it/s]Processing groups:  85%|████████▌ | 85/100 [02:16<00:07,  1.99it/s]Processing groups:  89%|████████▉ | 89/100 [02:17<00:04,  2.54it/s]Processing groups:  94%|█████████▍| 94/100 [02:17<00:01,  3.32it/s]Processing groups:  97%|█████████▋| 97/100 [02:21<00:01,  1.95it/s]Processing groups:  98%|█████████▊| 98/100 [02:21<00:00,  2.11it/s]Processing groups: 100%|██████████| 100/100 [02:21<00:00,  1.42s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.45, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34967.10it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:38, 43.42s/it]Processing groups:   2%|▏         | 2/100 [00:46<32:25, 19.85s/it]  Processing groups:   3%|▎         | 3/100 [00:47<17:42, 10.95s/it]Processing groups:   9%|▉         | 9/100 [00:47<03:31,  2.33s/it]Processing groups:  15%|█▌        | 15/100 [00:48<01:39,  1.17s/it]Processing groups:  33%|███▎      | 33/100 [01:26<02:02,  1.82s/it]Processing groups:  35%|███▌      | 35/100 [01:27<01:50,  1.70s/it]Processing groups:  36%|███▌      | 36/100 [01:31<01:55,  1.80s/it]Processing groups:  37%|███▋      | 37/100 [01:33<01:56,  1.86s/it]Processing groups:  50%|█████     | 50/100 [01:37<00:43,  1.14it/s]Processing groups:  65%|██████▌   | 65/100 [02:11<00:56,  1.60s/it]Processing groups:  67%|██████▋   | 67/100 [02:14<00:52,  1.58s/it]Processing groups:  70%|███████   | 70/100 [02:15<00:42,  1.40s/it]Processing groups:  84%|████████▍ | 84/100 [02:16<00:11,  1.45it/s]Processing groups:  87%|████████▋ | 87/100 [02:17<00:08,  1.55it/s]Processing groups:  92%|█████████▏| 92/100 [02:17<00:03,  2.02it/s]Processing groups:  94%|█████████▍| 94/100 [02:17<00:02,  2.19it/s]Processing groups:  96%|█████████▌| 96/100 [02:18<00:01,  2.38it/s]Processing groups:  98%|█████████▊| 98/100 [02:21<00:01,  1.48it/s]Processing groups: 100%|██████████| 100/100 [02:21<00:00,  1.42s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}

Processing n_plates: 3

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37919.75it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<57:05, 34.61s/it]Processing groups:   4%|▍         | 4/100 [00:35<10:39,  6.66s/it]Processing groups:  10%|█         | 10/100 [00:35<03:02,  2.02s/it]Processing groups:  13%|█▎        | 13/100 [00:35<02:02,  1.41s/it]Processing groups:  20%|██        | 20/100 [00:36<00:56,  1.40it/s]Processing groups:  22%|██▏       | 22/100 [00:36<00:48,  1.61it/s]Processing groups:  32%|███▏      | 32/100 [00:36<00:19,  3.47it/s]Processing groups:  32%|███▏      | 32/100 [00:52<00:19,  3.47it/s]Processing groups:  33%|███▎      | 33/100 [00:59<02:07,  1.91s/it]Processing groups:  34%|███▍      | 34/100 [01:07<02:46,  2.53s/it]Processing groups:  37%|███▋      | 37/100 [01:09<02:04,  1.97s/it]Processing groups:  46%|████▌     | 46/100 [01:10<00:50,  1.07it/s]Processing groups:  54%|█████▍    | 54/100 [01:10<00:25,  1.77it/s]Processing groups:  60%|██████    | 60/100 [01:14<00:24,  1.64it/s]Processing groups:  60%|██████    | 60/100 [01:32<00:24,  1.64it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<00:56,  1.61s/it]Processing groups:  66%|██████▌   | 66/100 [01:40<00:59,  1.76s/it]Processing groups:  67%|██████▋   | 67/100 [01:40<00:53,  1.62s/it]Processing groups:  68%|██████▊   | 68/100 [01:40<00:47,  1.48s/it]Processing groups:  73%|███████▎  | 73/100 [01:43<00:28,  1.04s/it]Processing groups:  94%|█████████▍| 94/100 [01:43<00:01,  3.40it/s]Processing groups:  96%|█████████▌| 96/100 [01:44<00:01,  3.61it/s]Processing groups:  98%|█████████▊| 98/100 [01:46<00:00,  2.48it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  1.07s/it]
{'replicate_reproducibility': 0.043333333333333335, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34155.57it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:28<46:19, 28.07s/it]Processing groups:   2%|▏         | 2/100 [00:30<21:15, 13.02s/it]Processing groups:   3%|▎         | 3/100 [00:31<12:28,  7.72s/it]Processing groups:   4%|▍         | 4/100 [00:34<08:46,  5.48s/it]Processing groups:  16%|█▌        | 16/100 [00:35<01:08,  1.23it/s]Processing groups:  24%|██▍       | 24/100 [00:35<00:35,  2.13it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:38,  1.47s/it]Processing groups:  35%|███▌      | 35/100 [01:04<01:35,  1.46s/it]Processing groups:  36%|███▌      | 36/100 [01:05<01:32,  1.45s/it]Processing groups:  40%|████      | 40/100 [01:08<01:15,  1.26s/it]Processing groups:  50%|█████     | 50/100 [01:11<00:37,  1.34it/s]Processing groups:  53%|█████▎    | 53/100 [01:11<00:29,  1.62it/s]Processing groups:  64%|██████▍   | 64/100 [01:12<00:11,  3.06it/s]Processing groups:  64%|██████▍   | 64/100 [01:23<00:11,  3.06it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<01:02,  1.79s/it]Processing groups:  68%|██████▊   | 68/100 [01:37<00:46,  1.44s/it]Processing groups:  70%|███████   | 70/100 [01:38<00:39,  1.32s/it]Processing groups:  72%|███████▏  | 72/100 [01:39<00:31,  1.13s/it]Processing groups:  75%|███████▌  | 75/100 [01:40<00:23,  1.06it/s]Processing groups:  78%|███████▊  | 78/100 [01:41<00:17,  1.29it/s]Processing groups:  79%|███████▉  | 79/100 [01:41<00:14,  1.42it/s]Processing groups:  84%|████████▍ | 84/100 [01:42<00:07,  2.26it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:00,  3.32it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.06s/it]
{'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.07, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38557.68it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:36, 32.49s/it]Processing groups:   4%|▍         | 4/100 [00:33<10:24,  6.51s/it]Processing groups:  20%|██        | 20/100 [00:34<01:14,  1.07it/s]Processing groups:  22%|██▏       | 22/100 [00:34<01:04,  1.21it/s]Processing groups:  24%|██▍       | 24/100 [00:35<00:59,  1.27it/s]Processing groups:  26%|██▌       | 26/100 [00:37<01:01,  1.20it/s]Processing groups:  33%|███▎      | 33/100 [01:03<02:26,  2.18s/it]Processing groups:  34%|███▍      | 34/100 [01:06<02:31,  2.30s/it]Processing groups:  39%|███▉      | 39/100 [01:07<01:29,  1.47s/it]Processing groups:  42%|████▏     | 42/100 [01:07<01:05,  1.12s/it]Processing groups:  43%|████▎     | 43/100 [01:09<01:04,  1.14s/it]Processing groups:  51%|█████     | 51/100 [01:09<00:27,  1.76it/s]Processing groups:  54%|█████▍    | 54/100 [01:12<00:30,  1.50it/s]Processing groups:  64%|██████▍   | 64/100 [01:14<00:13,  2.65it/s]Processing groups:  65%|██████▌   | 65/100 [01:34<01:02,  1.80s/it]Processing groups:  66%|██████▌   | 66/100 [01:41<01:14,  2.18s/it]Processing groups:  73%|███████▎  | 73/100 [01:41<00:32,  1.20s/it]Processing groups:  81%|████████  | 81/100 [01:42<00:13,  1.46it/s]Processing groups:  84%|████████▍ | 84/100 [01:42<00:09,  1.69it/s]Processing groups:  88%|████████▊ | 88/100 [01:43<00:05,  2.10it/s]Processing groups:  90%|█████████ | 90/100 [01:43<00:04,  2.33it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:01,  2.54it/s]Processing groups:  98%|█████████▊| 98/100 [01:46<00:00,  2.67it/s]Processing groups:  99%|█████████▉| 99/100 [01:46<00:00,  2.89it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  1.06s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.28, 'mean_ap': 0.0, 'mean_ap_p_value': 0.11, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40067.86it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:01, 31.53s/it]Processing groups:   4%|▍         | 4/100 [00:32<09:50,  6.16s/it]Processing groups:   5%|▌         | 5/100 [00:32<07:08,  4.51s/it]Processing groups:   7%|▋         | 7/100 [00:33<04:23,  2.84s/it]Processing groups:   8%|▊         | 8/100 [00:36<04:06,  2.68s/it]Processing groups:   9%|▉         | 9/100 [00:36<03:08,  2.07s/it]Processing groups:  30%|███       | 30/100 [00:37<00:18,  3.70it/s]Processing groups:  30%|███       | 30/100 [00:48<00:18,  3.70it/s]Processing groups:  33%|███▎      | 33/100 [01:06<01:57,  1.75s/it]Processing groups:  39%|███▉      | 39/100 [01:09<01:21,  1.34s/it]Processing groups:  41%|████      | 41/100 [01:09<01:11,  1.20s/it]Processing groups:  58%|█████▊    | 58/100 [01:10<00:20,  2.08it/s]Processing groups:  62%|██████▏   | 62/100 [01:11<00:17,  2.23it/s]Processing groups:  62%|██████▏   | 62/100 [01:29<00:17,  2.23it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<00:57,  1.65s/it]Processing groups:  67%|██████▋   | 67/100 [01:39<00:54,  1.66s/it]Processing groups:  69%|██████▉   | 69/100 [01:40<00:45,  1.46s/it]Processing groups:  71%|███████   | 71/100 [01:40<00:36,  1.26s/it]Processing groups:  76%|███████▌  | 76/100 [01:41<00:18,  1.29it/s]Processing groups:  83%|████████▎ | 83/100 [01:42<00:09,  1.85it/s]Processing groups:  90%|█████████ | 90/100 [01:43<00:03,  2.92it/s]Processing groups:  95%|█████████▌| 95/100 [01:43<00:01,  3.69it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:01,  2.46it/s]Processing groups:  99%|█████████▉| 99/100 [01:46<00:00,  2.82it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  1.06s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.03, 'mean_ap': 0.12, 'mean_ap_p_value': 0.49, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31939.57it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:35<57:55, 35.10s/it]Processing groups:  14%|█▍        | 14/100 [00:35<02:36,  1.82s/it]Processing groups:  20%|██        | 20/100 [00:36<01:36,  1.21s/it]Processing groups:  22%|██▏       | 22/100 [00:37<01:20,  1.04s/it]Processing groups:  22%|██▏       | 22/100 [00:52<01:20,  1.04s/it]Processing groups:  33%|███▎      | 33/100 [01:03<01:58,  1.76s/it]Processing groups:  35%|███▌      | 35/100 [01:04<01:48,  1.66s/it]Processing groups:  36%|███▌      | 36/100 [01:06<01:44,  1.64s/it]Processing groups:  38%|███▊      | 38/100 [01:10<01:44,  1.68s/it]Processing groups:  52%|█████▏    | 52/100 [01:10<00:29,  1.65it/s]Processing groups:  57%|█████▋    | 57/100 [01:10<00:19,  2.16it/s]Processing groups:  59%|█████▉    | 59/100 [01:13<00:24,  1.68it/s]Processing groups:  59%|█████▉    | 59/100 [01:33<00:24,  1.68it/s]Processing groups:  65%|██████▌   | 65/100 [01:40<01:08,  1.97s/it]Processing groups:  74%|███████▍  | 74/100 [01:41<00:30,  1.17s/it]Processing groups:  80%|████████  | 80/100 [01:42<00:17,  1.16it/s]Processing groups:  88%|████████▊ | 88/100 [01:43<00:07,  1.70it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:01,  2.06it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.06s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 0.57, 'mean_ap_p_value': 0.99, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38753.62it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:35, 32.48s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:37, 14.46s/it]Processing groups:   6%|▌         | 6/100 [00:34<05:19,  3.40s/it]Processing groups:   7%|▋         | 7/100 [00:37<05:04,  3.28s/it]Processing groups:  21%|██        | 21/100 [00:38<00:51,  1.53it/s]Processing groups:  21%|██        | 21/100 [00:56<00:51,  1.53it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:28,  1.31s/it]Processing groups:  34%|███▍      | 34/100 [01:04<01:31,  1.38s/it]Processing groups:  35%|███▌      | 35/100 [01:07<01:35,  1.47s/it]Processing groups:  36%|███▌      | 36/100 [01:07<01:25,  1.34s/it]Processing groups:  40%|████      | 40/100 [01:10<01:11,  1.19s/it]Processing groups:  55%|█████▌    | 55/100 [01:11<00:20,  2.23it/s]Processing groups:  64%|██████▍   | 64/100 [01:12<00:11,  3.05it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<00:56,  1.60s/it]Processing groups:  66%|██████▌   | 66/100 [01:38<00:54,  1.60s/it]Processing groups:  67%|██████▋   | 67/100 [01:40<00:53,  1.63s/it]Processing groups:  69%|██████▉   | 69/100 [01:41<00:42,  1.38s/it]Processing groups:  70%|███████   | 70/100 [01:42<00:41,  1.38s/it]Processing groups:  80%|████████  | 80/100 [01:43<00:10,  1.90it/s]Processing groups:  83%|████████▎ | 83/100 [01:43<00:07,  2.28it/s]Processing groups:  86%|████████▌ | 86/100 [01:43<00:04,  2.85it/s]Processing groups:  91%|█████████ | 91/100 [01:43<00:02,  4.13it/s]Processing groups:  93%|█████████▎| 93/100 [01:44<00:01,  4.07it/s]Processing groups:  96%|█████████▌| 96/100 [01:44<00:00,  4.94it/s]Processing groups:  98%|█████████▊| 98/100 [01:47<00:00,  2.43it/s]Processing groups:  99%|█████████▉| 99/100 [01:47<00:00,  2.68it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.07s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.34, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39866.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:02, 33.36s/it]Processing groups:   2%|▏         | 2/100 [00:36<25:06, 15.37s/it]Processing groups:  17%|█▋        | 17/100 [00:38<01:44,  1.26s/it]Processing groups:  33%|███▎      | 33/100 [01:01<01:32,  1.38s/it]Processing groups:  35%|███▌      | 35/100 [01:03<01:27,  1.34s/it]Processing groups:  36%|███▌      | 36/100 [01:05<01:27,  1.37s/it]Processing groups:  37%|███▋      | 37/100 [01:06<01:24,  1.35s/it]Processing groups:  40%|████      | 40/100 [01:07<01:03,  1.06s/it]Processing groups:  45%|████▌     | 45/100 [01:07<00:37,  1.48it/s]Processing groups:  48%|████▊     | 48/100 [01:07<00:27,  1.89it/s]Processing groups:  50%|█████     | 50/100 [01:11<00:36,  1.37it/s]Processing groups:  57%|█████▋    | 57/100 [01:12<00:20,  2.13it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<00:55,  1.59s/it]Processing groups:  66%|██████▌   | 66/100 [01:36<00:51,  1.52s/it]Processing groups:  67%|██████▋   | 67/100 [01:37<00:48,  1.46s/it]Processing groups:  68%|██████▊   | 68/100 [01:39<00:49,  1.53s/it]Processing groups:  72%|███████▏  | 72/100 [01:40<00:27,  1.02it/s]Processing groups:  78%|███████▊  | 78/100 [01:40<00:11,  1.84it/s]Processing groups:  82%|████████▏ | 82/100 [01:41<00:07,  2.35it/s]Processing groups:  90%|█████████ | 90/100 [01:41<00:02,  4.21it/s]Processing groups:  92%|█████████▏| 92/100 [01:42<00:02,  3.96it/s]Processing groups:  94%|█████████▍| 94/100 [01:42<00:01,  3.83it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:01,  2.62it/s]Processing groups:  98%|█████████▊| 98/100 [01:45<00:00,  2.83it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.73, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40792.69it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:25, 43.28s/it]Processing groups:   2%|▏         | 2/100 [00:44<30:05, 18.42s/it]  Processing groups:   5%|▌         | 5/100 [00:44<08:20,  5.26s/it]Processing groups:   7%|▋         | 7/100 [00:45<05:11,  3.35s/it]Processing groups:  26%|██▌       | 26/100 [00:47<00:43,  1.69it/s]Processing groups:  33%|███▎      | 33/100 [01:12<01:43,  1.54s/it]Processing groups:  37%|███▋      | 37/100 [01:28<02:06,  2.00s/it]Processing groups:  41%|████      | 41/100 [01:28<01:32,  1.56s/it]Processing groups:  44%|████▍     | 44/100 [01:28<01:12,  1.29s/it]Processing groups:  46%|████▌     | 46/100 [01:30<01:07,  1.25s/it]Processing groups:  48%|████▊     | 48/100 [01:32<01:01,  1.19s/it]Processing groups:  65%|██████▌   | 65/100 [01:52<00:41,  1.18s/it]Processing groups:  66%|██████▌   | 66/100 [01:56<00:45,  1.34s/it]Processing groups:  70%|███████   | 70/100 [02:03<00:43,  1.45s/it]Processing groups:  71%|███████   | 71/100 [02:06<00:43,  1.51s/it]Processing groups:  73%|███████▎  | 73/100 [02:07<00:36,  1.35s/it]Processing groups:  74%|███████▍  | 74/100 [02:09<00:37,  1.44s/it]Processing groups:  76%|███████▌  | 76/100 [02:11<00:30,  1.27s/it]Processing groups:  93%|█████████▎| 93/100 [02:11<00:02,  3.05it/s]Processing groups:  96%|█████████▌| 96/100 [02:11<00:01,  3.49it/s]Processing groups:  99%|█████████▉| 99/100 [02:14<00:00,  2.59it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
{'replicate_reproducibility': 0.06, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37299.28it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:08:39, 41.61s/it]Processing groups:   3%|▎         | 3/100 [00:45<19:43, 12.20s/it]  Processing groups:   8%|▊         | 8/100 [00:47<05:39,  3.69s/it]Processing groups:  33%|███▎      | 33/100 [01:13<01:36,  1.44s/it]Processing groups:  34%|███▍      | 34/100 [01:21<01:56,  1.76s/it]Processing groups:  35%|███▌      | 35/100 [01:22<01:52,  1.73s/it]Processing groups:  36%|███▌      | 36/100 [01:23<01:47,  1.68s/it]Processing groups:  38%|███▊      | 38/100 [01:24<01:25,  1.38s/it]Processing groups:  39%|███▉      | 39/100 [01:25<01:22,  1.35s/it]Processing groups:  40%|████      | 40/100 [01:26<01:22,  1.37s/it]Processing groups:  43%|████▎     | 43/100 [01:28<00:58,  1.03s/it]Processing groups:  50%|█████     | 50/100 [01:28<00:25,  1.98it/s]Processing groups:  55%|█████▌    | 55/100 [01:28<00:14,  3.03it/s]Processing groups:  57%|█████▋    | 57/100 [01:29<00:12,  3.34it/s]Processing groups:  59%|█████▉    | 59/100 [01:29<00:10,  3.82it/s]Processing groups:  62%|██████▏   | 62/100 [01:30<00:11,  3.20it/s]Processing groups:  63%|██████▎   | 63/100 [01:31<00:12,  3.01it/s]Processing groups:  64%|██████▍   | 64/100 [01:33<00:23,  1.52it/s]Processing groups:  65%|██████▌   | 65/100 [01:55<02:33,  4.38s/it]Processing groups:  66%|██████▌   | 66/100 [02:04<03:05,  5.45s/it]Processing groups:  70%|███████   | 70/100 [02:07<01:26,  2.87s/it]Processing groups:  80%|████████  | 80/100 [02:09<00:21,  1.09s/it]Processing groups:  87%|████████▋ | 87/100 [02:09<00:08,  1.46it/s]Processing groups:  88%|████████▊ | 88/100 [02:09<00:07,  1.53it/s]Processing groups:  96%|█████████▌| 96/100 [02:10<00:01,  2.61it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:01,  1.90it/s]Processing groups:  98%|█████████▊| 98/100 [02:12<00:00,  2.04it/s]Processing groups:  99%|█████████▉| 99/100 [02:13<00:00,  2.10it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.33s/it]
{'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35677.99it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:39<1:05:17, 39.57s/it]Processing groups:   2%|▏         | 2/100 [00:42<29:02, 17.78s/it]  Processing groups:   3%|▎         | 3/100 [00:44<17:28, 10.81s/it]Processing groups:   5%|▌         | 5/100 [00:45<07:53,  4.99s/it]Processing groups:  21%|██        | 21/100 [00:46<00:55,  1.41it/s]Processing groups:  33%|███▎      | 33/100 [01:21<02:00,  1.79s/it]Processing groups:  34%|███▍      | 34/100 [01:25<02:04,  1.89s/it]Processing groups:  36%|███▌      | 36/100 [01:27<01:51,  1.74s/it]Processing groups:  47%|████▋     | 47/100 [01:30<00:53,  1.01s/it]Processing groups:  59%|█████▉    | 59/100 [01:31<00:23,  1.73it/s]Processing groups:  59%|█████▉    | 59/100 [01:42<00:23,  1.73it/s]Processing groups:  65%|██████▌   | 65/100 [02:00<00:57,  1.64s/it]Processing groups:  66%|██████▌   | 66/100 [02:03<00:57,  1.70s/it]Processing groups:  68%|██████▊   | 68/100 [02:04<00:48,  1.53s/it]Processing groups:  69%|██████▉   | 69/100 [02:07<00:50,  1.62s/it]Processing groups:  77%|███████▋  | 77/100 [02:08<00:20,  1.12it/s]Processing groups:  79%|███████▉  | 79/100 [02:08<00:16,  1.27it/s]Processing groups:  83%|████████▎ | 83/100 [02:09<00:10,  1.69it/s]Processing groups:  84%|████████▍ | 84/100 [02:09<00:09,  1.73it/s]Processing groups:  93%|█████████▎| 93/100 [02:10<00:01,  3.74it/s]Processing groups:  95%|█████████▌| 95/100 [02:10<00:01,  4.08it/s]Processing groups:  97%|█████████▋| 97/100 [02:13<00:01,  1.98it/s]Processing groups:  99%|█████████▉| 99/100 [02:13<00:00,  2.34it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.34s/it]
{'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.08, 'mean_ap': 0.01, 'mean_ap_p_value': 0.14, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41759.30it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:39<1:04:48, 39.28s/it]Processing groups:   2%|▏         | 2/100 [01:00<46:34, 28.52s/it]  Processing groups:  14%|█▍        | 14/100 [01:01<03:50,  2.69s/it]Processing groups:  33%|███▎      | 33/100 [01:12<01:25,  1.27s/it]Processing groups:  34%|███▍      | 34/100 [01:16<01:31,  1.38s/it]Processing groups:  35%|███▌      | 35/100 [01:18<01:30,  1.40s/it]Processing groups:  44%|████▍     | 44/100 [01:18<00:43,  1.29it/s]Processing groups:  46%|████▌     | 46/100 [01:18<00:38,  1.41it/s]Processing groups:  50%|█████     | 50/100 [01:19<00:27,  1.84it/s]Processing groups:  52%|█████▏    | 52/100 [01:21<00:31,  1.51it/s]Processing groups:  57%|█████▋    | 57/100 [01:41<01:19,  1.85s/it]Processing groups:  62%|██████▏   | 62/100 [01:44<00:53,  1.42s/it]Processing groups:  64%|██████▍   | 64/100 [01:59<01:27,  2.43s/it]Processing groups:  88%|████████▊ | 88/100 [02:05<00:09,  1.20it/s]Processing groups:  96%|█████████▌| 96/100 [02:06<00:02,  1.56it/s]Processing groups:  97%|█████████▋| 97/100 [02:06<00:01,  1.61it/s]Processing groups: 100%|██████████| 100/100 [02:06<00:00,  1.89it/s]Processing groups: 100%|██████████| 100/100 [02:06<00:00,  1.27s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.26, 'mean_ap': 0.05, 'mean_ap_p_value': 0.47, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  9.45it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 40776.82it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:09, 46.16s/it]Processing groups:  28%|██▊       | 28/100 [00:47<01:26,  1.20s/it] Processing groups:  28%|██▊       | 28/100 [00:59<01:26,  1.20s/it]Processing groups:  33%|███▎      | 33/100 [01:09<02:06,  1.89s/it]Processing groups:  34%|███▍      | 34/100 [01:14<02:12,  2.01s/it]Processing groups:  36%|███▌      | 36/100 [01:26<02:46,  2.61s/it]Processing groups:  37%|███▋      | 37/100 [01:29<02:44,  2.61s/it]Processing groups:  41%|████      | 41/100 [01:29<01:44,  1.77s/it]Processing groups:  45%|████▌     | 45/100 [01:30<01:10,  1.29s/it]Processing groups:  51%|█████     | 51/100 [01:33<00:46,  1.06it/s]Processing groups:  63%|██████▎   | 63/100 [01:35<00:19,  1.94it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<00:32,  1.08it/s]Processing groups:  66%|██████▌   | 66/100 [01:53<00:53,  1.56s/it]Processing groups:  67%|██████▋   | 67/100 [01:59<01:05,  1.99s/it]Processing groups:  69%|██████▉   | 69/100 [01:59<00:48,  1.57s/it]Processing groups:  70%|███████   | 70/100 [02:02<00:54,  1.82s/it]Processing groups:  71%|███████   | 71/100 [02:04<00:53,  1.83s/it]Processing groups:  73%|███████▎  | 73/100 [02:09<00:53,  1.98s/it]Processing groups:  76%|███████▌  | 76/100 [02:09<00:31,  1.30s/it]Processing groups:  78%|███████▊  | 78/100 [02:10<00:21,  1.04it/s]Processing groups:  89%|████████▉ | 89/100 [02:10<00:03,  2.97it/s]Processing groups:  92%|█████████▏| 92/100 [02:11<00:02,  3.17it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:00,  3.91it/s]Processing groups:  98%|█████████▊| 98/100 [02:13<00:00,  3.12it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.33s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 0.56, 'mean_ap_p_value': 0.98, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36618.68it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:40<1:06:47, 40.48s/it]Processing groups:   2%|▏         | 2/100 [00:45<31:49, 19.48s/it]  Processing groups:   9%|▉         | 9/100 [00:47<04:39,  3.07s/it]Processing groups:  26%|██▌       | 26/100 [00:47<00:57,  1.28it/s]Processing groups:  33%|███▎      | 33/100 [00:58<01:08,  1.03s/it]Processing groups:  34%|███▍      | 34/100 [01:17<02:16,  2.07s/it]Processing groups:  37%|███▋      | 37/100 [01:25<02:17,  2.18s/it]Processing groups:  41%|████      | 41/100 [01:30<01:56,  1.98s/it]Processing groups:  44%|████▍     | 44/100 [01:31<01:27,  1.57s/it]Processing groups:  51%|█████     | 51/100 [01:34<00:51,  1.06s/it]Processing groups:  62%|██████▏   | 62/100 [01:35<00:22,  1.69it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<00:34,  1.01it/s]Processing groups:  66%|██████▌   | 66/100 [01:58<01:04,  1.90s/it]Processing groups:  69%|██████▉   | 69/100 [02:01<00:52,  1.70s/it]Processing groups:  71%|███████   | 71/100 [02:03<00:45,  1.56s/it]Processing groups:  73%|███████▎  | 73/100 [02:03<00:33,  1.26s/it]Processing groups:  74%|███████▍  | 74/100 [02:07<00:43,  1.66s/it]Processing groups:  79%|███████▉  | 79/100 [02:10<00:22,  1.08s/it]Processing groups:  85%|████████▌ | 85/100 [02:10<00:09,  1.67it/s]Processing groups:  87%|████████▋ | 87/100 [02:11<00:07,  1.74it/s]Processing groups:  89%|████████▉ | 89/100 [02:11<00:05,  2.05it/s]Processing groups:  93%|█████████▎| 93/100 [02:11<00:02,  3.00it/s]Processing groups:  95%|█████████▌| 95/100 [02:11<00:01,  3.54it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:00,  3.66it/s]Processing groups: 100%|██████████| 100/100 [02:12<00:00,  1.32s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31891.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:00:34, 36.72s/it]Processing groups:   6%|▌         | 6/100 [00:54<12:00,  7.66s/it]  Processing groups:  12%|█▏        | 12/100 [00:58<05:02,  3.44s/it]Processing groups:  26%|██▌       | 26/100 [01:01<01:35,  1.29s/it]Processing groups:  33%|███▎      | 33/100 [01:13<01:36,  1.44s/it]Processing groups:  35%|███▌      | 35/100 [01:36<02:47,  2.58s/it]Processing groups:  41%|████      | 41/100 [01:37<01:45,  1.79s/it]Processing groups:  42%|████▏     | 42/100 [01:37<01:38,  1.69s/it]Processing groups:  59%|█████▉    | 59/100 [01:55<00:51,  1.26s/it]Processing groups:  79%|███████▉  | 79/100 [01:55<00:13,  1.61it/s]Processing groups:  82%|████████▏ | 82/100 [01:56<00:10,  1.69it/s]Processing groups:  86%|████████▌ | 86/100 [02:02<00:10,  1.39it/s]Processing groups:  87%|████████▋ | 87/100 [02:03<00:09,  1.36it/s]Processing groups:  88%|████████▊ | 88/100 [02:03<00:08,  1.43it/s]Processing groups:  90%|█████████ | 90/100 [02:04<00:06,  1.49it/s]Processing groups:  94%|█████████▍| 94/100 [02:06<00:03,  1.56it/s]Processing groups:  98%|█████████▊| 98/100 [02:07<00:00,  2.23it/s]Processing groups: 100%|██████████| 100/100 [02:07<00:00,  1.27s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.9, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.88it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37613.70it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:54<1:30:03, 54.58s/it]Processing groups:   2%|▏         | 2/100 [00:55<37:30, 22.96s/it]  Processing groups:  11%|█         | 11/100 [00:56<04:05,  2.76s/it]Processing groups:  21%|██        | 21/100 [00:56<01:32,  1.17s/it]Processing groups:  25%|██▌       | 25/100 [00:57<01:09,  1.08it/s]Processing groups:  25%|██▌       | 25/100 [01:12<01:09,  1.08it/s]Processing groups:  33%|███▎      | 33/100 [01:43<03:17,  2.95s/it]Processing groups:  34%|███▍      | 34/100 [01:46<03:14,  2.95s/it]Processing groups:  35%|███▌      | 35/100 [01:47<02:58,  2.74s/it]Processing groups:  36%|███▌      | 36/100 [01:47<02:38,  2.48s/it]Processing groups:  41%|████      | 41/100 [01:51<01:40,  1.70s/it]Processing groups:  44%|████▍     | 44/100 [01:51<01:10,  1.25s/it]Processing groups:  52%|█████▏    | 52/100 [01:52<00:30,  1.55it/s]Processing groups:  54%|█████▍    | 54/100 [01:52<00:26,  1.73it/s]Processing groups:  61%|██████    | 61/100 [01:53<00:14,  2.64it/s]Processing groups:  63%|██████▎   | 63/100 [01:53<00:12,  2.86it/s]Processing groups:  65%|██████▌   | 65/100 [02:35<02:20,  4.01s/it]Processing groups:  66%|██████▌   | 66/100 [02:39<02:14,  3.96s/it]Processing groups:  67%|██████▋   | 67/100 [02:43<02:11,  3.97s/it]Processing groups:  80%|████████  | 80/100 [02:43<00:22,  1.14s/it]Processing groups:  85%|████████▌ | 85/100 [02:43<00:12,  1.21it/s]Processing groups:  94%|█████████▍| 94/100 [02:44<00:03,  2.00it/s]Processing groups:  97%|█████████▋| 97/100 [02:49<00:02,  1.48it/s]Processing groups:  99%|█████████▉| 99/100 [02:49<00:00,  1.62it/s]Processing groups: 100%|██████████| 100/100 [02:49<00:00,  1.70s/it]
{'replicate_reproducibility': 0.03333333333333333, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.72it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37469.22it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:26:49, 52.62s/it]Processing groups:   3%|▎         | 3/100 [00:54<22:56, 14.19s/it]  Processing groups:   4%|▍         | 4/100 [00:56<16:26, 10.28s/it]Processing groups:  13%|█▎        | 13/100 [00:57<02:45,  1.90s/it]Processing groups:  13%|█▎        | 13/100 [01:11<02:45,  1.90s/it]Processing groups:  33%|███▎      | 33/100 [01:42<02:25,  2.18s/it]Processing groups:  34%|███▍      | 34/100 [01:45<02:26,  2.22s/it]Processing groups:  36%|███▌      | 36/100 [01:46<02:06,  1.98s/it]Processing groups:  38%|███▊      | 38/100 [01:46<01:47,  1.73s/it]Processing groups:  40%|████      | 40/100 [01:50<01:44,  1.75s/it]Processing groups:  43%|████▎     | 43/100 [01:51<01:18,  1.37s/it]Processing groups:  53%|█████▎    | 53/100 [01:52<00:29,  1.58it/s]Processing groups:  65%|██████▌   | 65/100 [02:36<01:14,  2.12s/it]Processing groups:  67%|██████▋   | 67/100 [02:39<01:07,  2.05s/it]Processing groups:  68%|██████▊   | 68/100 [02:41<01:05,  2.05s/it]Processing groups:  73%|███████▎  | 73/100 [02:41<00:37,  1.37s/it]Processing groups:  77%|███████▋  | 77/100 [02:43<00:26,  1.13s/it]Processing groups:  96%|█████████▌| 96/100 [02:43<00:01,  2.49it/s]Processing groups: 100%|██████████| 100/100 [02:48<00:00,  1.81it/s]Processing groups: 100%|██████████| 100/100 [02:48<00:00,  1.69s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.88it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39038.57it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:51<1:24:24, 51.15s/it]Processing groups:   2%|▏         | 2/100 [00:53<36:37, 22.42s/it]  Processing groups:   3%|▎         | 3/100 [00:53<20:01, 12.39s/it]Processing groups:   4%|▍         | 4/100 [00:54<12:05,  7.56s/it]Processing groups:   5%|▌         | 5/100 [00:54<07:57,  5.03s/it]Processing groups:   6%|▌         | 6/100 [00:55<05:28,  3.50s/it]Processing groups:   7%|▋         | 7/100 [00:57<04:43,  3.05s/it]Processing groups:  33%|███▎      | 33/100 [01:41<02:01,  1.81s/it]Processing groups:  34%|███▍      | 34/100 [01:44<02:03,  1.87s/it]Processing groups:  36%|███▌      | 36/100 [01:49<02:03,  1.93s/it]Processing groups:  46%|████▌     | 46/100 [01:49<00:56,  1.05s/it]Processing groups:  48%|████▊     | 48/100 [01:50<00:49,  1.05it/s]Processing groups:  59%|█████▉    | 59/100 [01:51<00:23,  1.75it/s]Processing groups:  65%|██████▌   | 65/100 [02:35<01:23,  2.38s/it]Processing groups:  67%|██████▋   | 67/100 [02:39<01:16,  2.33s/it]Processing groups:  68%|██████▊   | 68/100 [02:41<01:15,  2.36s/it]Processing groups:  82%|████████▏ | 82/100 [02:42<00:17,  1.05it/s]Processing groups:  84%|████████▍ | 84/100 [02:42<00:13,  1.17it/s]Processing groups:  93%|█████████▎| 93/100 [02:42<00:03,  1.89it/s]Processing groups:  96%|█████████▌| 96/100 [02:43<00:01,  2.20it/s]Processing groups:  98%|█████████▊| 98/100 [02:47<00:01,  1.40it/s]Processing groups: 100%|██████████| 100/100 [02:48<00:00,  1.59it/s]Processing groups: 100%|██████████| 100/100 [02:48<00:00,  1.68s/it]
{'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.17, 'mean_ap': 0.0, 'mean_ap_p_value': 0.18, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.65it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32987.05it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:56<1:32:26, 56.03s/it]Processing groups:   4%|▍         | 4/100 [00:56<17:20, 10.84s/it]  Processing groups:   7%|▋         | 7/100 [00:57<07:54,  5.10s/it]Processing groups:  14%|█▍        | 14/100 [00:58<02:42,  1.89s/it]Processing groups:  28%|██▊       | 28/100 [00:58<00:49,  1.46it/s]Processing groups:  28%|██▊       | 28/100 [01:11<00:49,  1.46it/s]Processing groups:  33%|███▎      | 33/100 [01:44<03:07,  2.80s/it]Processing groups:  34%|███▍      | 34/100 [01:44<02:53,  2.62s/it]Processing groups:  36%|███▌      | 36/100 [01:45<02:27,  2.30s/it]Processing groups:  38%|███▊      | 38/100 [01:50<02:20,  2.27s/it]Processing groups:  49%|████▉     | 49/100 [01:50<00:48,  1.06it/s]Processing groups:  51%|█████     | 51/100 [01:50<00:41,  1.19it/s]Processing groups:  53%|█████▎    | 53/100 [01:51<00:36,  1.30it/s]Processing groups:  57%|█████▋    | 57/100 [01:51<00:24,  1.77it/s]Processing groups:  61%|██████    | 61/100 [01:52<00:16,  2.33it/s]Processing groups:  65%|██████▌   | 65/100 [02:37<02:12,  3.78s/it]Processing groups:  66%|██████▌   | 66/100 [02:39<02:00,  3.54s/it]Processing groups:  68%|██████▊   | 68/100 [02:42<01:38,  3.07s/it]Processing groups:  76%|███████▌  | 76/100 [02:42<00:32,  1.37s/it]Processing groups:  78%|███████▊  | 78/100 [02:42<00:25,  1.18s/it]Processing groups:  86%|████████▌ | 86/100 [02:43<00:09,  1.52it/s]Processing groups:  97%|█████████▋| 97/100 [02:48<00:01,  1.75it/s]Processing groups: 100%|██████████| 100/100 [02:48<00:00,  1.69s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.24, 'mean_ap': 0.03, 'mean_ap_p_value': 0.57, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.63it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35069.43it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:51<1:25:14, 51.66s/it]Processing groups:   2%|▏         | 2/100 [00:54<37:10, 22.76s/it]  Processing groups:   4%|▍         | 4/100 [00:55<14:12,  8.88s/it]Processing groups:   7%|▋         | 7/100 [00:56<06:12,  4.00s/it]Processing groups:  16%|█▌        | 16/100 [00:56<01:39,  1.19s/it]Processing groups:  16%|█▌        | 16/100 [01:11<01:39,  1.19s/it]Processing groups:  33%|███▎      | 33/100 [01:42<02:24,  2.16s/it]Processing groups:  34%|███▍      | 34/100 [01:43<02:17,  2.09s/it]Processing groups:  35%|███▌      | 35/100 [01:46<02:23,  2.22s/it]Processing groups:  39%|███▉      | 39/100 [01:47<01:37,  1.60s/it]Processing groups:  41%|████      | 41/100 [01:47<01:20,  1.36s/it]Processing groups:  46%|████▌     | 46/100 [01:48<00:48,  1.12it/s]Processing groups:  47%|████▋     | 47/100 [01:50<00:53,  1.01s/it]Processing groups:  55%|█████▌    | 55/100 [01:51<00:24,  1.83it/s]Processing groups:  58%|█████▊    | 58/100 [01:51<00:19,  2.12it/s]Processing groups:  65%|██████▌   | 65/100 [02:39<01:49,  3.14s/it]Processing groups:  68%|██████▊   | 68/100 [02:40<01:21,  2.54s/it]Processing groups:  71%|███████   | 71/100 [02:41<00:59,  2.04s/it]Processing groups:  75%|███████▌  | 75/100 [02:42<00:37,  1.51s/it]Processing groups:  78%|███████▊  | 78/100 [02:42<00:25,  1.16s/it]Processing groups:  88%|████████▊ | 88/100 [02:42<00:06,  1.85it/s]Processing groups:  92%|█████████▏| 92/100 [02:42<00:03,  2.35it/s]Processing groups:  95%|█████████▌| 95/100 [02:42<00:01,  2.81it/s]Processing groups:  98%|█████████▊| 98/100 [02:48<00:01,  1.46it/s]Processing groups: 100%|██████████| 100/100 [02:48<00:00,  1.68s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.84, 'mean_ap': 0.44, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.89it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38223.86it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:26:56, 52.69s/it]Processing groups:   2%|▏         | 2/100 [00:54<37:14, 22.80s/it]  Processing groups:   5%|▌         | 5/100 [00:56<11:00,  6.95s/it]Processing groups:  10%|█         | 10/100 [00:57<04:03,  2.70s/it]Processing groups:  24%|██▍       | 24/100 [00:58<01:03,  1.20it/s]Processing groups:  33%|███▎      | 33/100 [01:46<02:53,  2.60s/it]Processing groups:  34%|███▍      | 34/100 [01:48<02:50,  2.58s/it]Processing groups:  37%|███▋      | 37/100 [01:49<02:13,  2.12s/it]Processing groups:  43%|████▎     | 43/100 [01:50<01:20,  1.42s/it]Processing groups:  46%|████▌     | 46/100 [01:51<01:03,  1.17s/it]Processing groups:  61%|██████    | 61/100 [01:51<00:18,  2.09it/s]Processing groups:  61%|██████    | 61/100 [02:11<00:18,  2.09it/s]Processing groups:  65%|██████▌   | 65/100 [02:39<01:30,  2.58s/it]Processing groups:  67%|██████▋   | 67/100 [02:39<01:17,  2.33s/it]Processing groups:  70%|███████   | 70/100 [02:41<00:59,  1.99s/it]Processing groups:  72%|███████▏  | 72/100 [02:43<00:50,  1.82s/it]Processing groups:  79%|███████▉  | 79/100 [02:43<00:21,  1.02s/it]Processing groups:  82%|████████▏ | 82/100 [02:44<00:15,  1.19it/s]Processing groups:  93%|█████████▎| 93/100 [02:44<00:02,  2.35it/s]Processing groups:  96%|█████████▌| 96/100 [02:45<00:01,  2.76it/s]Processing groups:  98%|█████████▊| 98/100 [02:50<00:01,  1.51it/s]Processing groups: 100%|██████████| 100/100 [02:50<00:00,  1.76it/s]Processing groups: 100%|██████████| 100/100 [02:50<00:00,  1.70s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.63it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41396.60it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:53<1:27:40, 53.14s/it]Processing groups:   2%|▏         | 2/100 [00:57<39:42, 24.31s/it]  Processing groups:   5%|▌         | 5/100 [00:57<11:05,  7.01s/it]Processing groups:  33%|███▎      | 33/100 [01:46<02:29,  2.23s/it]Processing groups:  34%|███▍      | 34/100 [01:46<02:20,  2.13s/it]Processing groups:  37%|███▋      | 37/100 [01:49<02:04,  1.97s/it]Processing groups:  41%|████      | 41/100 [01:50<01:31,  1.54s/it]Processing groups:  44%|████▍     | 44/100 [01:50<01:10,  1.26s/it]Processing groups:  48%|████▊     | 48/100 [01:51<00:51,  1.01it/s]Processing groups:  53%|█████▎    | 53/100 [01:54<00:39,  1.18it/s]Processing groups:  58%|█████▊    | 58/100 [01:54<00:24,  1.70it/s]Processing groups:  58%|█████▊    | 58/100 [02:09<00:24,  1.70it/s]Processing groups:  65%|██████▌   | 65/100 [02:39<01:41,  2.89s/it]Processing groups:  66%|██████▌   | 66/100 [02:41<01:35,  2.81s/it]Processing groups:  77%|███████▋  | 77/100 [02:43<00:31,  1.37s/it]Processing groups:  79%|███████▉  | 79/100 [02:43<00:25,  1.24s/it]Processing groups:  85%|████████▌ | 85/100 [02:44<00:12,  1.19it/s]Processing groups:  88%|████████▊ | 88/100 [02:44<00:08,  1.45it/s]Processing groups:  92%|█████████▏| 92/100 [02:44<00:04,  1.95it/s]Processing groups:  94%|█████████▍| 94/100 [02:44<00:02,  2.25it/s]Processing groups:  96%|█████████▌| 96/100 [02:45<00:01,  2.52it/s]Processing groups:  98%|█████████▊| 98/100 [02:50<00:01,  1.17it/s]Processing groups: 100%|██████████| 100/100 [02:50<00:00,  1.70s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}

Processing n_plates: 4

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 18114.03it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:18, 37.76s/it]Processing groups:  14%|█▍        | 14/100 [00:43<03:21,  2.34s/it] Processing groups:  33%|███▎      | 33/100 [01:10<01:57,  1.75s/it]Processing groups:  34%|███▍      | 34/100 [01:12<01:54,  1.74s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:33,  1.49s/it]Processing groups:  45%|████▌     | 45/100 [01:14<00:52,  1.04it/s]Processing groups:  48%|████▊     | 48/100 [01:17<00:50,  1.02it/s]Processing groups:  59%|█████▉    | 59/100 [01:18<00:21,  1.88it/s]Processing groups:  60%|██████    | 60/100 [01:18<00:22,  1.80it/s]Processing groups:  61%|██████    | 61/100 [01:19<00:20,  1.90it/s]Processing groups:  62%|██████▏   | 62/100 [01:22<00:29,  1.28it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:42,  2.93s/it]Processing groups:  68%|██████▊   | 68/100 [01:48<01:13,  2.29s/it]Processing groups:  71%|███████   | 71/100 [01:50<00:51,  1.76s/it]Processing groups:  77%|███████▋  | 77/100 [01:50<00:23,  1.01s/it]Processing groups:  80%|████████  | 80/100 [01:52<00:17,  1.17it/s]Processing groups:  89%|████████▉ | 89/100 [01:52<00:04,  2.37it/s]Processing groups:  92%|█████████▏| 92/100 [01:52<00:02,  2.86it/s]Processing groups:  95%|█████████▌| 95/100 [01:52<00:01,  3.45it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.03it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.08, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37479.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:38<1:03:16, 38.35s/it]Processing groups:  18%|█▊        | 18/100 [00:39<02:09,  1.58s/it] Processing groups:  27%|██▋       | 27/100 [00:43<01:19,  1.09s/it]Processing groups:  33%|███▎      | 33/100 [01:13<02:27,  2.20s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:49,  1.75s/it]Processing groups:  41%|████      | 41/100 [01:15<01:25,  1.44s/it]Processing groups:  44%|████▍     | 44/100 [01:16<01:07,  1.21s/it]Processing groups:  52%|█████▏    | 52/100 [01:16<00:33,  1.43it/s]Processing groups:  54%|█████▍    | 54/100 [01:17<00:33,  1.38it/s]Processing groups:  62%|██████▏   | 62/100 [01:18<00:16,  2.37it/s]Processing groups:  64%|██████▍   | 64/100 [01:18<00:14,  2.51it/s]Processing groups:  64%|██████▍   | 64/100 [01:31<00:14,  2.51it/s]Processing groups:  65%|██████▌   | 65/100 [01:42<01:24,  2.41s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<01:34,  2.78s/it]Processing groups:  67%|██████▋   | 67/100 [01:48<01:21,  2.46s/it]Processing groups:  69%|██████▉   | 69/100 [01:50<01:03,  2.03s/it]Processing groups:  77%|███████▋  | 77/100 [01:51<00:20,  1.15it/s]Processing groups:  80%|████████  | 80/100 [01:51<00:13,  1.49it/s]Processing groups:  81%|████████  | 81/100 [01:52<00:12,  1.52it/s]Processing groups:  94%|█████████▍| 94/100 [01:52<00:01,  4.17it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.86it/s]Processing groups:  99%|█████████▉| 99/100 [01:55<00:00,  3.13it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.15s/it]
{'replicate_reproducibility': 0.025, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 24836.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:00:37, 36.74s/it]Processing groups:   4%|▍         | 4/100 [00:37<11:16,  7.05s/it]  Processing groups:   5%|▌         | 5/100 [00:37<08:11,  5.18s/it]Processing groups:   7%|▋         | 7/100 [00:38<04:55,  3.18s/it]Processing groups:  12%|█▏        | 12/100 [00:39<02:00,  1.37s/it]Processing groups:  20%|██        | 20/100 [00:41<00:57,  1.40it/s]Processing groups:  33%|███▎      | 33/100 [01:12<01:51,  1.66s/it]Processing groups:  38%|███▊      | 38/100 [01:17<01:32,  1.50s/it]Processing groups:  55%|█████▌    | 55/100 [01:19<00:34,  1.32it/s]Processing groups:  59%|█████▉    | 59/100 [01:21<00:29,  1.40it/s]Processing groups:  60%|██████    | 60/100 [01:23<00:30,  1.32it/s]Processing groups:  61%|██████    | 61/100 [01:23<00:28,  1.39it/s]Processing groups:  65%|██████▌   | 65/100 [01:41<01:04,  1.83s/it]Processing groups:  66%|██████▌   | 66/100 [01:46<01:11,  2.10s/it]Processing groups:  67%|██████▋   | 67/100 [01:49<01:11,  2.16s/it]Processing groups:  69%|██████▉   | 69/100 [01:50<00:54,  1.75s/it]Processing groups:  72%|███████▏  | 72/100 [01:50<00:32,  1.17s/it]Processing groups:  74%|███████▍  | 74/100 [01:53<00:31,  1.20s/it]Processing groups:  94%|█████████▍| 94/100 [01:53<00:01,  3.53it/s]Processing groups:  96%|█████████▌| 96/100 [01:53<00:01,  3.63it/s]Processing groups:  98%|█████████▊| 98/100 [01:56<00:00,  2.64it/s]Processing groups:  99%|█████████▉| 99/100 [01:56<00:00,  2.72it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  1.16s/it]
{'replicate_reproducibility': 0.008333333333333333, 'mp_value': 0.28, 'mean_ap': 0.0, 'mean_ap_p_value': 0.11, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41564.80it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:40<1:06:18, 40.19s/it]Processing groups:   2%|▏         | 2/100 [00:43<30:00, 18.38s/it]  Processing groups:  33%|███▎      | 33/100 [01:07<01:34,  1.42s/it]Processing groups:  34%|███▍      | 34/100 [01:07<01:31,  1.38s/it]Processing groups:  35%|███▌      | 35/100 [01:11<01:39,  1.54s/it]Processing groups:  36%|███▌      | 36/100 [01:12<01:32,  1.45s/it]Processing groups:  37%|███▋      | 37/100 [01:15<01:42,  1.62s/it]Processing groups:  40%|████      | 40/100 [01:15<01:12,  1.21s/it]Processing groups:  43%|████▎     | 43/100 [01:17<00:58,  1.03s/it]Processing groups:  50%|█████     | 50/100 [01:18<00:29,  1.71it/s]Processing groups:  63%|██████▎   | 63/100 [01:20<00:12,  3.02it/s]Processing groups:  64%|██████▍   | 64/100 [01:24<00:19,  1.83it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<01:09,  1.99s/it]Processing groups:  66%|██████▌   | 66/100 [01:45<01:08,  2.01s/it]Processing groups:  67%|██████▋   | 67/100 [01:46<01:00,  1.83s/it]Processing groups:  69%|██████▉   | 69/100 [01:52<01:04,  2.09s/it]Processing groups:  80%|████████  | 80/100 [01:53<00:14,  1.34it/s]Processing groups:  92%|█████████▏| 92/100 [01:53<00:03,  2.58it/s]Processing groups:  96%|█████████▌| 96/100 [01:54<00:01,  2.85it/s]Processing groups:  97%|█████████▋| 97/100 [01:56<00:01,  2.09it/s]Processing groups:  98%|█████████▊| 98/100 [01:56<00:00,  2.23it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  1.17s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.03, 'mean_ap_p_value': 0.72, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 41846.79it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:38, 32.51s/it]Processing groups:   2%|▏         | 2/100 [00:33<22:48, 13.96s/it]Processing groups:   3%|▎         | 3/100 [00:34<13:03,  8.07s/it]Processing groups:   4%|▍         | 4/100 [00:36<08:48,  5.50s/it]Processing groups:   5%|▌         | 5/100 [00:36<05:44,  3.63s/it]Processing groups:   8%|▊         | 8/100 [00:36<02:19,  1.52s/it]Processing groups:  10%|█         | 10/100 [00:38<01:46,  1.18s/it]Processing groups:  15%|█▌        | 15/100 [00:40<01:05,  1.30it/s]Processing groups:  19%|█▉        | 19/100 [00:41<00:45,  1.78it/s]Processing groups:  33%|███▎      | 33/100 [01:10<01:46,  1.59s/it]Processing groups:  35%|███▌      | 35/100 [01:14<01:43,  1.59s/it]Processing groups:  39%|███▉      | 39/100 [01:15<01:18,  1.29s/it]Processing groups:  48%|████▊     | 48/100 [01:15<00:37,  1.39it/s]Processing groups:  50%|█████     | 50/100 [01:18<00:40,  1.24it/s]Processing groups:  58%|█████▊    | 58/100 [01:21<00:24,  1.70it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<00:52,  1.49s/it]Processing groups:  66%|██████▌   | 66/100 [01:48<00:58,  1.72s/it]Processing groups:  67%|██████▋   | 67/100 [01:49<00:55,  1.67s/it]Processing groups:  68%|██████▊   | 68/100 [01:49<00:48,  1.51s/it]Processing groups:  72%|███████▏  | 72/100 [01:52<00:32,  1.17s/it]Processing groups:  79%|███████▉  | 79/100 [01:53<00:13,  1.56it/s]Processing groups:  87%|████████▋ | 87/100 [01:53<00:04,  2.61it/s]Processing groups:  97%|█████████▋| 97/100 [01:56<00:01,  2.95it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  3.43it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.33, 'mean_ap': 0.36, 'mean_ap_p_value': 0.99, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 44935.76it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:01:23, 37.21s/it]Processing groups:  11%|█         | 11/100 [00:37<03:42,  2.51s/it] Processing groups:  13%|█▎        | 13/100 [00:38<02:57,  2.04s/it]Processing groups:  14%|█▍        | 14/100 [00:38<02:33,  1.79s/it]Processing groups:  15%|█▌        | 15/100 [00:40<02:38,  1.87s/it]Processing groups:  33%|███▎      | 33/100 [01:07<01:44,  1.56s/it]Processing groups:  34%|███▍      | 34/100 [01:10<01:48,  1.65s/it]Processing groups:  35%|███▌      | 35/100 [01:13<01:53,  1.75s/it]Processing groups:  40%|████      | 40/100 [01:13<01:08,  1.14s/it]Processing groups:  41%|████      | 41/100 [01:16<01:14,  1.26s/it]Processing groups:  53%|█████▎    | 53/100 [01:17<00:24,  1.92it/s]Processing groups:  58%|█████▊    | 58/100 [01:20<00:23,  1.79it/s]Processing groups:  63%|██████▎   | 63/100 [01:20<00:15,  2.41it/s]Processing groups:  63%|██████▎   | 63/100 [01:31<00:15,  2.41it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<01:07,  1.93s/it]Processing groups:  66%|██████▌   | 66/100 [01:46<01:08,  2.02s/it]Processing groups:  68%|██████▊   | 68/100 [01:47<00:54,  1.69s/it]Processing groups:  69%|██████▉   | 69/100 [01:48<00:50,  1.63s/it]Processing groups:  70%|███████   | 70/100 [01:49<00:45,  1.50s/it]Processing groups:  72%|███████▏  | 72/100 [01:50<00:32,  1.18s/it]Processing groups:  73%|███████▎  | 73/100 [01:50<00:26,  1.01it/s]Processing groups:  76%|███████▌  | 76/100 [01:51<00:17,  1.33it/s]Processing groups:  85%|████████▌ | 85/100 [01:52<00:04,  3.17it/s]Processing groups:  95%|█████████▌| 95/100 [01:52<00:00,  5.60it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.90it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.6, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38678.57it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<56:02, 33.96s/it]Processing groups:   2%|▏         | 2/100 [00:38<27:15, 16.68s/it]Processing groups:  14%|█▍        | 14/100 [00:39<02:17,  1.60s/it]Processing groups:  23%|██▎       | 23/100 [00:40<01:03,  1.21it/s]Processing groups:  25%|██▌       | 25/100 [00:40<00:55,  1.35it/s]Processing groups:  27%|██▋       | 27/100 [00:40<00:45,  1.59it/s]Processing groups:  27%|██▋       | 27/100 [00:53<00:45,  1.59it/s]Processing groups:  33%|███▎      | 33/100 [01:10<02:44,  2.45s/it]Processing groups:  34%|███▍      | 34/100 [01:12<02:33,  2.33s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:56,  1.84s/it]Processing groups:  42%|████▏     | 42/100 [01:14<01:10,  1.21s/it]Processing groups:  53%|█████▎    | 53/100 [01:17<00:30,  1.56it/s]Processing groups:  54%|█████▍    | 54/100 [01:18<00:32,  1.40it/s]Processing groups:  56%|█████▌    | 56/100 [01:20<00:34,  1.29it/s]Processing groups:  65%|██████▌   | 65/100 [01:41<00:53,  1.54s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<01:02,  1.85s/it]Processing groups:  67%|██████▋   | 67/100 [01:50<01:04,  1.95s/it]Processing groups:  70%|███████   | 70/100 [01:51<00:44,  1.49s/it]Processing groups:  81%|████████  | 81/100 [01:52<00:12,  1.56it/s]Processing groups:  85%|████████▌ | 85/100 [01:52<00:07,  1.99it/s]Processing groups:  92%|█████████▏| 92/100 [01:52<00:02,  3.11it/s]Processing groups:  95%|█████████▌| 95/100 [01:53<00:01,  3.27it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.30it/s]Processing groups:  99%|█████████▉| 99/100 [01:56<00:00,  2.48it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.78, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.30it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30058.08it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:19:11, 48.00s/it]Processing groups:   3%|▎         | 3/100 [00:48<20:37, 12.76s/it]  Processing groups:   6%|▌         | 6/100 [00:49<07:56,  5.07s/it]Processing groups:  10%|█         | 10/100 [00:49<03:35,  2.40s/it]Processing groups:  25%|██▌       | 25/100 [00:51<00:53,  1.40it/s]Processing groups:  33%|███▎      | 33/100 [01:26<02:16,  2.04s/it]Processing groups:  34%|███▍      | 34/100 [01:28<02:13,  2.02s/it]Processing groups:  35%|███▌      | 35/100 [01:30<02:10,  2.01s/it]Processing groups:  37%|███▋      | 37/100 [01:31<01:47,  1.71s/it]Processing groups:  42%|████▏     | 42/100 [01:34<01:15,  1.30s/it]Processing groups:  48%|████▊     | 48/100 [01:35<00:41,  1.25it/s]Processing groups:  53%|█████▎    | 53/100 [01:35<00:26,  1.80it/s]Processing groups:  54%|█████▍    | 54/100 [01:38<00:34,  1.34it/s]Processing groups:  59%|█████▉    | 59/100 [01:40<00:27,  1.50it/s]Processing groups:  65%|██████▌   | 65/100 [02:16<01:35,  2.74s/it]Processing groups:  68%|██████▊   | 68/100 [02:17<01:10,  2.20s/it]Processing groups:  70%|███████   | 70/100 [02:20<01:03,  2.12s/it]Processing groups:  89%|████████▉ | 89/100 [02:21<00:07,  1.55it/s]Processing groups:  91%|█████████ | 91/100 [02:21<00:05,  1.69it/s]Processing groups:  95%|█████████▌| 95/100 [02:21<00:02,  1.98it/s]Processing groups:  97%|█████████▋| 97/100 [02:25<00:02,  1.47it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  1.46s/it]
{'replicate_reproducibility': 0.015, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.55it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39509.27it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:18:21, 47.49s/it]Processing groups:   2%|▏         | 2/100 [00:50<34:38, 21.21s/it]  Processing groups:  18%|█▊        | 18/100 [00:50<02:02,  1.49s/it]Processing groups:  23%|██▎       | 23/100 [00:51<01:24,  1.10s/it]Processing groups:  23%|██▎       | 23/100 [01:09<01:24,  1.10s/it]Processing groups:  33%|███▎      | 33/100 [01:24<02:20,  2.10s/it]Processing groups:  34%|███▍      | 34/100 [01:32<02:43,  2.48s/it]Processing groups:  35%|███▌      | 35/100 [01:33<02:30,  2.32s/it]Processing groups:  37%|███▋      | 37/100 [01:34<02:05,  2.00s/it]Processing groups:  41%|████      | 41/100 [01:34<01:18,  1.33s/it]Processing groups:  42%|████▏     | 42/100 [01:35<01:16,  1.32s/it]Processing groups:  58%|█████▊    | 58/100 [01:37<00:19,  2.20it/s]Processing groups:  60%|██████    | 60/100 [01:42<00:26,  1.50it/s]Processing groups:  65%|██████▌   | 65/100 [02:09<01:11,  2.03s/it]Processing groups:  66%|██████▌   | 66/100 [02:17<01:25,  2.53s/it]Processing groups:  68%|██████▊   | 68/100 [02:19<01:09,  2.18s/it]Processing groups:  76%|███████▌  | 76/100 [02:21<00:28,  1.20s/it]Processing groups:  84%|████████▍ | 84/100 [02:21<00:11,  1.42it/s]Processing groups:  88%|████████▊ | 88/100 [02:21<00:06,  1.78it/s]Processing groups:  90%|█████████ | 90/100 [02:21<00:04,  2.04it/s]Processing groups:  92%|█████████▏| 92/100 [02:22<00:03,  2.26it/s]Processing groups:  94%|█████████▍| 94/100 [02:22<00:02,  2.61it/s]Processing groups:  96%|█████████▌| 96/100 [02:23<00:01,  2.64it/s]Processing groups:  97%|█████████▋| 97/100 [02:26<00:02,  1.35it/s]Processing groups:  98%|█████████▊| 98/100 [02:26<00:01,  1.46it/s]Processing groups: 100%|██████████| 100/100 [02:26<00:00,  2.05it/s]Processing groups: 100%|██████████| 100/100 [02:26<00:00,  1.47s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.30it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35302.62it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:30, 42.73s/it]Processing groups:   2%|▏         | 2/100 [00:44<30:50, 18.88s/it]  Processing groups:   3%|▎         | 3/100 [00:48<19:03, 11.79s/it]Processing groups:   8%|▊         | 8/100 [00:49<04:31,  2.95s/it]Processing groups:  10%|█         | 10/100 [00:49<03:07,  2.08s/it]Processing groups:  15%|█▌        | 15/100 [00:50<01:31,  1.08s/it]Processing groups:  33%|███▎      | 33/100 [01:25<01:54,  1.71s/it]Processing groups:  34%|███▍      | 34/100 [01:27<01:54,  1.73s/it]Processing groups:  35%|███▌      | 35/100 [01:31<02:01,  1.86s/it]Processing groups:  36%|███▌      | 36/100 [01:35<02:15,  2.12s/it]Processing groups:  44%|████▍     | 44/100 [01:37<01:02,  1.11s/it]Processing groups:  46%|████▌     | 46/100 [01:39<00:59,  1.10s/it]Processing groups:  58%|█████▊    | 58/100 [01:41<00:24,  1.74it/s]Processing groups:  63%|██████▎   | 63/100 [01:43<00:19,  1.94it/s]Processing groups:  65%|██████▌   | 65/100 [02:13<01:23,  2.39s/it]Processing groups:  66%|██████▌   | 66/100 [02:16<01:21,  2.39s/it]Processing groups:  67%|██████▋   | 67/100 [02:19<01:21,  2.46s/it]Processing groups:  69%|██████▉   | 69/100 [02:19<01:00,  1.95s/it]Processing groups:  82%|████████▏ | 82/100 [02:20<00:11,  1.54it/s]Processing groups:  84%|████████▍ | 84/100 [02:21<00:09,  1.61it/s]Processing groups:  85%|████████▌ | 85/100 [02:21<00:09,  1.66it/s]Processing groups:  93%|█████████▎| 93/100 [02:21<00:02,  3.01it/s]Processing groups:  95%|█████████▌| 95/100 [02:22<00:01,  3.07it/s]Processing groups:  96%|█████████▌| 96/100 [02:22<00:01,  2.99it/s]Processing groups:  97%|█████████▋| 97/100 [02:26<00:02,  1.38it/s]Processing groups: 100%|██████████| 100/100 [02:26<00:00,  1.46s/it]
{'replicate_reproducibility': 0.005, 'mp_value': 0.12, 'mean_ap': 0.0, 'mean_ap_p_value': 0.14, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.53it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32446.07it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:09:37, 42.20s/it]Processing groups:   2%|▏         | 2/100 [00:47<33:03, 20.24s/it]  Processing groups:   4%|▍         | 4/100 [00:48<12:48,  8.01s/it]Processing groups:   5%|▌         | 5/100 [00:49<09:13,  5.83s/it]Processing groups:  10%|█         | 10/100 [00:50<02:50,  1.89s/it]Processing groups:  20%|██        | 20/100 [00:50<00:55,  1.43it/s]Processing groups:  33%|███▎      | 33/100 [01:25<01:59,  1.78s/it]Processing groups:  34%|███▍      | 34/100 [01:29<02:05,  1.89s/it]Processing groups:  35%|███▌      | 35/100 [01:31<02:02,  1.89s/it]Processing groups:  38%|███▊      | 38/100 [01:31<01:30,  1.46s/it]Processing groups:  41%|████      | 41/100 [01:31<01:05,  1.11s/it]Processing groups:  42%|████▏     | 42/100 [01:36<01:28,  1.53s/it]Processing groups:  43%|████▎     | 43/100 [01:39<01:32,  1.62s/it]Processing groups:  65%|██████▌   | 65/100 [02:14<00:56,  1.63s/it]Processing groups:  67%|██████▋   | 67/100 [02:17<00:53,  1.61s/it]Processing groups:  68%|██████▊   | 68/100 [02:18<00:49,  1.54s/it]Processing groups:  69%|██████▉   | 69/100 [02:18<00:44,  1.43s/it]Processing groups:  71%|███████   | 71/100 [02:18<00:33,  1.17s/it]Processing groups:  72%|███████▏  | 72/100 [02:20<00:35,  1.28s/it]Processing groups:  79%|███████▉  | 79/100 [02:21<00:13,  1.51it/s]Processing groups:  87%|████████▋ | 87/100 [02:21<00:04,  2.76it/s]Processing groups:  97%|█████████▋| 97/100 [02:25<00:01,  2.63it/s]Processing groups:  99%|█████████▉| 99/100 [02:26<00:00,  2.86it/s]Processing groups: 100%|██████████| 100/100 [02:26<00:00,  1.46s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.61, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.28it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34317.66it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:56, 43.60s/it]Processing groups:   2%|▏         | 2/100 [00:50<36:25, 22.30s/it]  Processing groups:  15%|█▌        | 15/100 [00:51<02:40,  1.89s/it]Processing groups:  15%|█▌        | 15/100 [01:06<02:40,  1.89s/it]Processing groups:  33%|███▎      | 33/100 [01:27<02:10,  1.95s/it]Processing groups:  34%|███▍      | 34/100 [01:32<02:19,  2.11s/it]Processing groups:  36%|███▌      | 36/100 [01:32<02:00,  1.88s/it]Processing groups:  42%|████▏     | 42/100 [01:33<01:15,  1.30s/it]Processing groups:  44%|████▍     | 44/100 [01:34<01:06,  1.18s/it]Processing groups:  47%|████▋     | 47/100 [01:35<00:49,  1.06it/s]Processing groups:  48%|████▊     | 48/100 [01:36<00:48,  1.07it/s]Processing groups:  50%|█████     | 50/100 [01:36<00:37,  1.34it/s]Processing groups:  52%|█████▏    | 52/100 [01:38<00:38,  1.26it/s]Processing groups:  54%|█████▍    | 54/100 [01:39<00:33,  1.37it/s]Processing groups:  63%|██████▎   | 63/100 [01:44<00:22,  1.64it/s]Processing groups:  65%|██████▌   | 65/100 [02:13<01:42,  2.93s/it]Processing groups:  66%|██████▌   | 66/100 [02:14<01:34,  2.79s/it]Processing groups:  67%|██████▋   | 67/100 [02:20<01:43,  3.14s/it]Processing groups:  80%|████████  | 80/100 [02:22<00:20,  1.03s/it]Processing groups:  91%|█████████ | 91/100 [02:22<00:05,  1.77it/s]Processing groups:  96%|█████████▌| 96/100 [02:23<00:01,  2.19it/s]Processing groups:  98%|█████████▊| 98/100 [02:26<00:01,  1.62it/s]Processing groups: 100%|██████████| 100/100 [02:26<00:00,  1.47s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 0.14, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.43it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37140.74it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:14:45, 45.31s/it]Processing groups:   2%|▏         | 2/100 [00:48<33:37, 20.59s/it]  Processing groups:  15%|█▌        | 15/100 [00:50<02:37,  1.85s/it]Processing groups:  22%|██▏       | 22/100 [00:52<01:35,  1.22s/it]Processing groups:  33%|███▎      | 33/100 [01:30<02:34,  2.31s/it]Processing groups:  34%|███▍      | 34/100 [01:32<02:30,  2.28s/it]Processing groups:  37%|███▋      | 37/100 [01:35<02:05,  1.99s/it]Processing groups:  44%|████▍     | 44/100 [01:35<01:08,  1.21s/it]Processing groups:  47%|████▋     | 47/100 [01:38<01:02,  1.17s/it]Processing groups:  51%|█████     | 51/100 [01:39<00:45,  1.08it/s]Processing groups:  64%|██████▍   | 64/100 [01:40<00:15,  2.31it/s]Processing groups:  64%|██████▍   | 64/100 [01:57<00:15,  2.31it/s]Processing groups:  65%|██████▌   | 65/100 [02:09<01:13,  2.09s/it]Processing groups:  66%|██████▌   | 66/100 [02:12<01:14,  2.19s/it]Processing groups:  67%|██████▋   | 67/100 [02:16<01:15,  2.30s/it]Processing groups:  68%|██████▊   | 68/100 [02:16<01:05,  2.03s/it]Processing groups:  69%|██████▉   | 69/100 [02:20<01:13,  2.36s/it]Processing groups:  79%|███████▉  | 79/100 [02:20<00:16,  1.29it/s]Processing groups:  84%|████████▍ | 84/100 [02:21<00:08,  1.78it/s]Processing groups:  86%|████████▌ | 86/100 [02:21<00:06,  2.02it/s]Processing groups:  92%|█████████▏| 92/100 [02:21<00:02,  3.27it/s]Processing groups:  96%|█████████▌| 96/100 [02:22<00:00,  4.09it/s]Processing groups:  98%|█████████▊| 98/100 [02:25<00:00,  2.04it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  2.35it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  1.46s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.8, 'mean_ap': 0.96, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.40it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35517.86it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:31, 43.35s/it]Processing groups:   2%|▏         | 2/100 [00:46<31:54, 19.54s/it]  Processing groups:   9%|▉         | 9/100 [00:48<04:40,  3.08s/it]Processing groups:  16%|█▌        | 16/100 [00:49<02:03,  1.46s/it]Processing groups:  30%|███       | 30/100 [00:50<00:42,  1.63it/s]Processing groups:  33%|███▎      | 33/100 [01:31<03:00,  2.70s/it]Processing groups:  36%|███▌      | 36/100 [01:34<02:32,  2.38s/it]Processing groups:  48%|████▊     | 48/100 [01:35<01:02,  1.20s/it]Processing groups:  57%|█████▋    | 57/100 [01:36<00:34,  1.26it/s]Processing groups:  59%|█████▉    | 59/100 [01:36<00:30,  1.33it/s]Processing groups:  60%|██████    | 60/100 [01:37<00:30,  1.33it/s]Processing groups:  61%|██████    | 61/100 [01:38<00:29,  1.30it/s]Processing groups:  64%|██████▍   | 64/100 [01:39<00:24,  1.48it/s]Processing groups:  65%|██████▌   | 65/100 [02:15<02:45,  4.72s/it]Processing groups:  70%|███████   | 70/100 [02:16<01:20,  2.69s/it]Processing groups:  71%|███████   | 71/100 [02:16<01:09,  2.41s/it]Processing groups:  72%|███████▏  | 72/100 [02:17<01:00,  2.15s/it]Processing groups:  74%|███████▍  | 74/100 [02:18<00:43,  1.68s/it]Processing groups:  80%|████████  | 80/100 [02:20<00:18,  1.10it/s]Processing groups:  82%|████████▏ | 82/100 [02:20<00:14,  1.28it/s]Processing groups:  89%|████████▉ | 89/100 [02:20<00:04,  2.54it/s]Processing groups:  95%|█████████▌| 95/100 [02:21<00:01,  3.96it/s]Processing groups:  98%|█████████▊| 98/100 [02:25<00:00,  2.05it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  1.45s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.48, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 5, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00,  6.82it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33890.63it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:06<1:50:06, 66.73s/it]Processing groups:   3%|▎         | 3/100 [01:06<28:05, 17.37s/it]  Processing groups:  22%|██▏       | 22/100 [01:07<02:02,  1.58s/it]Processing groups:  22%|██▏       | 22/100 [01:22<02:02,  1.58s/it]Processing groups:  33%|███▎      | 33/100 [02:06<03:35,  3.21s/it]Processing groups:  35%|███▌      | 35/100 [02:07<03:13,  2.97s/it]Processing groups:  42%|████▏     | 42/100 [02:08<01:55,  1.99s/it]Processing groups:  47%|████▋     | 47/100 [02:10<01:25,  1.61s/it]Processing groups:  56%|█████▌    | 56/100 [02:12<00:47,  1.07s/it]Processing groups:  63%|██████▎   | 63/100 [02:13<00:27,  1.33it/s]Processing groups:  63%|██████▎   | 63/100 [02:32<00:27,  1.33it/s]Processing groups:  65%|██████▌   | 65/100 [03:08<02:11,  3.76s/it]Processing groups:  66%|██████▌   | 66/100 [03:09<01:59,  3.52s/it]Processing groups:  68%|██████▊   | 68/100 [03:09<01:34,  2.95s/it]Processing groups:  70%|███████   | 70/100 [03:10<01:12,  2.41s/it]Processing groups:  72%|███████▏  | 72/100 [03:12<00:58,  2.08s/it]Processing groups:  77%|███████▋  | 77/100 [03:12<00:27,  1.20s/it]Processing groups:  78%|███████▊  | 78/100 [03:12<00:24,  1.10s/it]Processing groups:  82%|████████▏ | 82/100 [03:13<00:12,  1.40it/s]Processing groups:  88%|████████▊ | 88/100 [03:13<00:04,  2.46it/s]Processing groups:  90%|█████████ | 90/100 [03:13<00:03,  2.84it/s]Processing groups:  95%|█████████▌| 95/100 [03:14<00:01,  4.12it/s]Processing groups:  97%|█████████▋| 97/100 [03:20<00:02,  1.25it/s]Processing groups: 100%|██████████| 100/100 [03:20<00:00,  2.01s/it]
{'replicate_reproducibility': 0.028333333333333332, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 5, 'differ_params': 1}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00,  6.69it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37718.56it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:02<1:42:38, 62.21s/it]Processing groups:   2%|▏         | 2/100 [01:04<43:49, 26.83s/it]  Processing groups:   3%|▎         | 3/100 [01:04<23:49, 14.74s/it]Processing groups:   4%|▍         | 4/100 [01:04<14:27,  9.04s/it]Processing groups:  10%|█         | 10/100 [01:06<03:29,  2.33s/it]Processing groups:  25%|██▌       | 25/100 [01:07<00:47,  1.59it/s]Processing groups:  25%|██▌       | 25/100 [01:20<00:47,  1.59it/s]Processing groups:  33%|███▎      | 33/100 [02:03<03:14,  2.91s/it]Processing groups:  34%|███▍      | 34/100 [02:07<03:17,  2.99s/it]Processing groups:  37%|███▋      | 37/100 [02:08<02:33,  2.43s/it]Processing groups:  48%|████▊     | 48/100 [02:10<01:05,  1.26s/it]Processing groups:  50%|█████     | 50/100 [02:10<00:56,  1.13s/it]Processing groups:  52%|█████▏    | 52/100 [02:10<00:47,  1.01it/s]Processing groups:  55%|█████▌    | 55/100 [02:10<00:34,  1.31it/s]Processing groups:  64%|██████▍   | 64/100 [02:11<00:16,  2.25it/s]Processing groups:  64%|██████▍   | 64/100 [02:30<00:16,  2.25it/s]Processing groups:  65%|██████▌   | 65/100 [03:09<02:43,  4.67s/it]Processing groups:  67%|██████▋   | 67/100 [03:09<02:08,  3.89s/it]Processing groups:  73%|███████▎  | 73/100 [03:10<01:00,  2.26s/it]Processing groups:  75%|███████▌  | 75/100 [03:11<00:48,  1.95s/it]Processing groups:  85%|████████▌ | 85/100 [03:11<00:13,  1.12it/s]Processing groups:  88%|████████▊ | 88/100 [03:11<00:08,  1.34it/s]Processing groups:  92%|█████████▏| 92/100 [03:11<00:04,  1.79it/s]Processing groups:  95%|█████████▌| 95/100 [03:12<00:02,  2.24it/s]Processing groups:  98%|█████████▊| 98/100 [03:18<00:01,  1.15it/s]Processing groups: 100%|██████████| 100/100 [03:18<00:00,  1.99s/it]
{'replicate_reproducibility': 0.011666666666666667, 'mp_value': 0.13, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00,  6.53it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43695.22it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:00<1:39:48, 60.49s/it]Processing groups:   2%|▏         | 2/100 [01:03<43:16, 26.50s/it]  Processing groups:   3%|▎         | 3/100 [01:04<23:56, 14.81s/it]Processing groups:   5%|▌         | 5/100 [01:05<10:37,  6.71s/it]Processing groups:  26%|██▌       | 26/100 [01:05<00:53,  1.38it/s]Processing groups:  26%|██▌       | 26/100 [01:19<00:53,  1.38it/s]Processing groups:  33%|███▎      | 33/100 [02:04<03:22,  3.03s/it]Processing groups:  35%|███▌      | 35/100 [02:05<02:59,  2.77s/it]Processing groups:  37%|███▋      | 37/100 [02:08<02:43,  2.60s/it]Processing groups:  39%|███▉      | 39/100 [02:11<02:25,  2.38s/it]Processing groups:  58%|█████▊    | 58/100 [02:12<00:32,  1.28it/s]Processing groups:  58%|█████▊    | 58/100 [02:29<00:32,  1.28it/s]Processing groups:  65%|██████▌   | 65/100 [03:08<01:35,  2.72s/it]Processing groups:  68%|██████▊   | 68/100 [03:10<01:17,  2.42s/it]Processing groups:  69%|██████▉   | 69/100 [03:11<01:12,  2.34s/it]Processing groups:  70%|███████   | 70/100 [03:12<01:06,  2.21s/it]Processing groups:  78%|███████▊  | 78/100 [03:12<00:25,  1.16s/it]Processing groups:  80%|████████  | 80/100 [03:13<00:20,  1.01s/it]Processing groups:  92%|█████████▏| 92/100 [03:13<00:03,  2.17it/s]Processing groups:  97%|█████████▋| 97/100 [03:19<00:01,  1.54it/s]Processing groups:  99%|█████████▉| 99/100 [03:19<00:00,  1.69it/s]Processing groups: 100%|██████████| 100/100 [03:19<00:00,  2.00s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.18, 'mean_ap': 0.0, 'mean_ap_p_value': 0.09, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00,  6.50it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35867.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:03<1:44:17, 63.21s/it]Processing groups:   2%|▏         | 2/100 [01:03<42:52, 26.25s/it]  Processing groups:   6%|▌         | 6/100 [01:06<10:14,  6.54s/it]Processing groups:  11%|█         | 11/100 [01:06<04:08,  2.79s/it]Processing groups:  19%|█▉        | 19/100 [01:06<01:38,  1.22s/it]Processing groups:  19%|█▉        | 19/100 [01:17<01:38,  1.22s/it]Processing groups:  33%|███▎      | 33/100 [02:07<03:23,  3.04s/it]Processing groups:  36%|███▌      | 36/100 [02:08<02:49,  2.65s/it]Processing groups:  41%|████      | 41/100 [02:09<01:56,  1.97s/it]Processing groups:  44%|████▍     | 44/100 [02:10<01:34,  1.68s/it]Processing groups:  48%|████▊     | 48/100 [02:11<01:07,  1.29s/it]Processing groups:  53%|█████▎    | 53/100 [02:12<00:44,  1.06it/s]Processing groups:  57%|█████▋    | 57/100 [02:13<00:32,  1.34it/s]Processing groups:  61%|██████    | 61/100 [02:13<00:23,  1.66it/s]Processing groups:  65%|██████▌   | 65/100 [03:10<02:35,  4.44s/it]Processing groups:  66%|██████▌   | 66/100 [03:10<02:18,  4.06s/it]Processing groups:  67%|██████▋   | 67/100 [03:11<01:59,  3.63s/it]Processing groups:  70%|███████   | 70/100 [03:12<01:15,  2.50s/it]Processing groups:  71%|███████   | 71/100 [03:13<01:07,  2.33s/it]Processing groups:  80%|████████  | 80/100 [03:13<00:17,  1.15it/s]Processing groups:  82%|████████▏ | 82/100 [03:14<00:14,  1.24it/s]Processing groups:  85%|████████▌ | 85/100 [03:14<00:09,  1.64it/s]Processing groups:  97%|█████████▋| 97/100 [03:21<00:01,  1.75it/s]Processing groups:  99%|█████████▉| 99/100 [03:21<00:00,  1.94it/s]Processing groups: 100%|██████████| 100/100 [03:21<00:00,  2.02s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.59, 'mean_ap': 0.0, 'mean_ap_p_value': 0.62, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00,  6.64it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 39809.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:01<1:40:48, 61.10s/it]Processing groups:   2%|▏         | 2/100 [01:03<43:16, 26.50s/it]  Processing groups:   3%|▎         | 3/100 [01:03<23:31, 14.56s/it]Processing groups:   4%|▍         | 4/100 [01:05<15:16,  9.54s/it]Processing groups:   7%|▋         | 7/100 [01:05<05:34,  3.59s/it]Processing groups:   8%|▊         | 8/100 [01:06<04:21,  2.85s/it]Processing groups:  10%|█         | 10/100 [01:07<02:54,  1.94s/it]Processing groups:  12%|█▏        | 12/100 [01:07<01:55,  1.31s/it]Processing groups:  33%|███▎      | 33/100 [02:03<02:43,  2.43s/it]Processing groups:  34%|███▍      | 34/100 [02:06<02:42,  2.46s/it]Processing groups:  36%|███▌      | 36/100 [02:07<02:23,  2.23s/it]Processing groups:  39%|███▉      | 39/100 [02:09<01:56,  1.91s/it]Processing groups:  51%|█████     | 51/100 [02:10<00:42,  1.16it/s]Processing groups:  55%|█████▌    | 55/100 [02:12<00:34,  1.30it/s]Processing groups:  59%|█████▉    | 59/100 [02:12<00:24,  1.64it/s]Processing groups:  60%|██████    | 60/100 [02:13<00:26,  1.48it/s]Processing groups:  63%|██████▎   | 63/100 [02:14<00:19,  1.86it/s]Processing groups:  65%|██████▌   | 65/100 [03:07<03:10,  5.45s/it]Processing groups:  66%|██████▌   | 66/100 [03:07<02:46,  4.90s/it]Processing groups:  67%|██████▋   | 67/100 [03:11<02:37,  4.79s/it]Processing groups:  70%|███████   | 70/100 [03:12<01:28,  2.96s/it]Processing groups:  73%|███████▎  | 73/100 [03:12<00:52,  1.94s/it]Processing groups:  76%|███████▌  | 76/100 [03:12<00:31,  1.33s/it]Processing groups:  81%|████████  | 81/100 [03:12<00:14,  1.32it/s]Processing groups:  85%|████████▌ | 85/100 [03:13<00:08,  1.87it/s]Processing groups:  87%|████████▋ | 87/100 [03:13<00:06,  2.09it/s]Processing groups:  89%|████████▉ | 89/100 [03:14<00:04,  2.45it/s]Processing groups:  92%|█████████▏| 92/100 [03:14<00:02,  3.21it/s]Processing groups:  96%|█████████▌| 96/100 [03:14<00:00,  4.87it/s]Processing groups:  98%|█████████▊| 98/100 [03:20<00:01,  1.22it/s]Processing groups: 100%|██████████| 100/100 [03:20<00:00,  2.01s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.73, 'mean_ap': 0.14, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00,  6.40it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 43740.79it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:02<1:43:15, 62.58s/it]Processing groups:   2%|▏         | 2/100 [01:04<43:45, 26.79s/it]  Processing groups:   7%|▋         | 7/100 [01:05<08:21,  5.39s/it]Processing groups:  26%|██▌       | 26/100 [01:06<01:15,  1.02s/it]Processing groups:  26%|██▌       | 26/100 [01:21<01:15,  1.02s/it]Processing groups:  33%|███▎      | 33/100 [02:02<03:30,  3.15s/it]Processing groups:  35%|███▌      | 35/100 [02:05<03:09,  2.92s/it]Processing groups:  37%|███▋      | 37/100 [02:07<02:50,  2.71s/it]Processing groups:  42%|████▏     | 42/100 [02:08<01:48,  1.87s/it]Processing groups:  43%|████▎     | 43/100 [02:09<01:42,  1.79s/it]Processing groups:  50%|█████     | 50/100 [02:11<00:54,  1.09s/it]Processing groups:  54%|█████▍    | 54/100 [02:11<00:38,  1.21it/s]Processing groups:  59%|█████▉    | 59/100 [02:13<00:27,  1.49it/s]Processing groups:  65%|██████▌   | 65/100 [03:05<02:04,  3.55s/it]Processing groups:  66%|██████▌   | 66/100 [03:06<01:52,  3.30s/it]Processing groups:  67%|██████▋   | 67/100 [03:06<01:39,  3.01s/it]Processing groups:  68%|██████▊   | 68/100 [03:07<01:30,  2.82s/it]Processing groups:  69%|██████▉   | 69/100 [03:10<01:24,  2.72s/it]Processing groups:  70%|███████   | 70/100 [03:11<01:13,  2.44s/it]Processing groups:  74%|███████▍  | 74/100 [03:12<00:35,  1.35s/it]Processing groups:  75%|███████▌  | 75/100 [03:12<00:29,  1.20s/it]Processing groups:  76%|███████▌  | 76/100 [03:12<00:23,  1.00it/s]Processing groups:  81%|████████  | 81/100 [03:12<00:08,  2.22it/s]Processing groups:  84%|████████▍ | 84/100 [03:13<00:05,  3.09it/s]Processing groups:  87%|████████▋ | 87/100 [03:13<00:03,  3.85it/s]Processing groups:  92%|█████████▏| 92/100 [03:13<00:01,  6.19it/s]Processing groups:  94%|█████████▍| 94/100 [03:13<00:00,  6.62it/s]Processing groups:  97%|█████████▋| 97/100 [03:20<00:02,  1.38it/s]Processing groups: 100%|██████████| 100/100 [03:20<00:00,  2.00s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 0.97, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 500 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00,  6.66it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37824.01it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:02<1:42:56, 62.39s/it]Processing groups:   3%|▎         | 3/100 [01:06<28:31, 17.65s/it]  Processing groups:   8%|▊         | 8/100 [01:07<07:41,  5.02s/it]Processing groups:  33%|███▎      | 33/100 [02:03<02:58,  2.67s/it]Processing groups:  34%|███▍      | 34/100 [02:05<02:54,  2.64s/it]Processing groups:  35%|███▌      | 35/100 [02:07<02:50,  2.63s/it]Processing groups:  41%|████      | 41/100 [02:08<01:45,  1.79s/it]Processing groups:  44%|████▍     | 44/100 [02:09<01:22,  1.47s/it]Processing groups:  49%|████▉     | 49/100 [02:09<00:52,  1.03s/it]Processing groups:  50%|█████     | 50/100 [02:10<00:52,  1.05s/it]Processing groups:  63%|██████▎   | 63/100 [02:12<00:18,  1.96it/s]Processing groups:  64%|██████▍   | 64/100 [02:14<00:20,  1.79it/s]Processing groups:  65%|██████▌   | 65/100 [03:04<02:42,  4.65s/it]Processing groups:  66%|██████▌   | 66/100 [03:05<02:24,  4.26s/it]Processing groups:  67%|██████▋   | 67/100 [03:10<02:23,  4.35s/it]Processing groups:  75%|███████▌  | 75/100 [03:11<00:45,  1.81s/it]Processing groups:  80%|████████  | 80/100 [03:11<00:24,  1.22s/it]Processing groups:  84%|████████▍ | 84/100 [03:12<00:14,  1.13it/s]Processing groups:  90%|█████████ | 90/100 [03:12<00:05,  1.79it/s]Processing groups:  93%|█████████▎| 93/100 [03:12<00:03,  2.15it/s]Processing groups:  95%|█████████▌| 95/100 [03:12<00:02,  2.41it/s]Processing groups:  97%|█████████▋| 97/100 [03:18<00:02,  1.10it/s]Processing groups:  98%|█████████▊| 98/100 [03:18<00:01,  1.23it/s]Processing groups:  99%|█████████▉| 99/100 [03:19<00:00,  1.38it/s]Processing groups: 100%|██████████| 100/100 [03:19<00:00,  1.99s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}

Processing n_feats: 1000

Processing n_plates: 2

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1233.09it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:24, 31.16s/it]Processing groups:   2%|▏         | 2/100 [00:31<21:42, 13.29s/it]Processing groups:   3%|▎         | 3/100 [00:34<13:18,  8.24s/it]Processing groups:   5%|▌         | 5/100 [00:34<05:57,  3.77s/it]Processing groups:   6%|▌         | 6/100 [00:35<04:19,  2.76s/it]Processing groups:  13%|█▎        | 13/100 [00:38<01:34,  1.09s/it]Processing groups:  33%|███▎      | 33/100 [01:03<01:21,  1.21s/it]Processing groups:  35%|███▌      | 35/100 [01:06<01:19,  1.22s/it]Processing groups:  43%|████▎     | 43/100 [01:08<00:50,  1.12it/s]Processing groups:  50%|█████     | 50/100 [01:13<00:41,  1.22it/s]Processing groups:  63%|██████▎   | 63/100 [01:13<00:17,  2.13it/s]Processing groups:  63%|██████▎   | 63/100 [01:29<00:17,  2.13it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<00:48,  1.38s/it]Processing groups:  68%|██████▊   | 68/100 [01:39<00:45,  1.42s/it]Processing groups:  77%|███████▋  | 77/100 [01:40<00:19,  1.16it/s]Processing groups:  79%|███████▉  | 79/100 [01:40<00:16,  1.30it/s]Processing groups:  81%|████████  | 81/100 [01:40<00:12,  1.47it/s]Processing groups:  89%|████████▉ | 89/100 [01:40<00:04,  2.60it/s]Processing groups:  92%|█████████▏| 92/100 [01:42<00:03,  2.44it/s]Processing groups:  95%|█████████▌| 95/100 [01:42<00:01,  2.87it/s]Processing groups:  97%|█████████▋| 97/100 [01:44<00:01,  2.36it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  3.07it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.05s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.07, 'mean_ap': 0.05, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27806.31it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:28<47:25, 28.74s/it]Processing groups:   2%|▏         | 2/100 [00:31<21:46, 13.33s/it]Processing groups:   3%|▎         | 3/100 [00:37<16:17, 10.08s/it]Processing groups:  19%|█▉        | 19/100 [00:39<01:20,  1.00it/s]Processing groups:  33%|███▎      | 33/100 [00:59<01:21,  1.21s/it]Processing groups:  34%|███▍      | 34/100 [01:05<01:39,  1.50s/it]Processing groups:  38%|███▊      | 38/100 [01:08<01:19,  1.29s/it]Processing groups:  45%|████▌     | 45/100 [01:09<00:48,  1.14it/s]Processing groups:  57%|█████▋    | 57/100 [01:09<00:21,  2.04it/s]Processing groups:  60%|██████    | 60/100 [01:12<00:22,  1.77it/s]Processing groups:  63%|██████▎   | 63/100 [01:14<00:19,  1.89it/s]Processing groups:  65%|██████▌   | 65/100 [01:27<00:49,  1.42s/it]Processing groups:  66%|██████▌   | 66/100 [01:33<01:02,  1.84s/it]Processing groups:  67%|██████▋   | 67/100 [01:35<01:00,  1.84s/it]Processing groups:  70%|███████   | 70/100 [01:40<00:53,  1.79s/it]Processing groups:  86%|████████▌ | 86/100 [01:40<00:07,  1.94it/s]Processing groups:  92%|█████████▏| 92/100 [01:41<00:03,  2.53it/s]Processing groups:  96%|█████████▌| 96/100 [01:41<00:01,  3.04it/s]Processing groups:  99%|█████████▉| 99/100 [01:43<00:00,  2.62it/s]Processing groups: 100%|██████████| 100/100 [01:43<00:00,  1.04s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.06, 'mean_ap': 0.19, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38342.66it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<49:58, 30.29s/it]Processing groups:   2%|▏         | 2/100 [00:35<25:31, 15.63s/it]Processing groups:  27%|██▋       | 27/100 [00:37<00:58,  1.26it/s]Processing groups:  33%|███▎      | 33/100 [01:02<01:48,  1.62s/it]Processing groups:  36%|███▌      | 36/100 [01:03<01:29,  1.40s/it]Processing groups:  38%|███▊      | 38/100 [01:12<01:50,  1.79s/it]Processing groups:  60%|██████    | 60/100 [01:12<00:24,  1.63it/s]Processing groups:  60%|██████    | 60/100 [01:29<00:24,  1.63it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<00:41,  1.19s/it]Processing groups:  66%|██████▌   | 66/100 [01:36<00:45,  1.35s/it]Processing groups:  68%|██████▊   | 68/100 [01:38<00:41,  1.30s/it]Processing groups:  70%|███████   | 70/100 [01:38<00:34,  1.15s/it]Processing groups:  72%|███████▏  | 72/100 [01:39<00:27,  1.04it/s]Processing groups:  76%|███████▌  | 76/100 [01:39<00:17,  1.38it/s]Processing groups:  79%|███████▉  | 79/100 [01:41<00:13,  1.60it/s]Processing groups:  81%|████████  | 81/100 [01:41<00:09,  1.95it/s]Processing groups:  83%|████████▎ | 83/100 [01:41<00:07,  2.18it/s]Processing groups:  96%|█████████▌| 96/100 [01:42<00:00,  5.84it/s]Processing groups:  98%|█████████▊| 98/100 [01:44<00:00,  3.38it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  3.84it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.05s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.04, 'mean_ap': 0.25, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36326.90it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:35, 31.88s/it]Processing groups:   4%|▍         | 4/100 [00:33<10:23,  6.49s/it]Processing groups:  11%|█         | 11/100 [00:34<02:43,  1.84s/it]Processing groups:  13%|█▎        | 13/100 [00:36<02:22,  1.63s/it]Processing groups:  15%|█▌        | 15/100 [00:36<01:45,  1.25s/it]Processing groups:  23%|██▎       | 23/100 [00:36<00:41,  1.87it/s]Processing groups:  28%|██▊       | 28/100 [00:38<00:32,  2.19it/s]Processing groups:  28%|██▊       | 28/100 [00:53<00:32,  2.19it/s]Processing groups:  33%|███▎      | 33/100 [00:56<01:40,  1.50s/it]Processing groups:  34%|███▍      | 34/100 [00:59<01:48,  1.64s/it]Processing groups:  35%|███▌      | 35/100 [01:04<02:11,  2.03s/it]Processing groups:  37%|███▋      | 37/100 [01:09<02:14,  2.14s/it]Processing groups:  43%|████▎     | 43/100 [01:10<01:02,  1.10s/it]Processing groups:  49%|████▉     | 49/100 [01:10<00:34,  1.46it/s]Processing groups:  52%|█████▏    | 52/100 [01:15<00:40,  1.17it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<00:38,  1.10s/it]Processing groups:  66%|██████▌   | 66/100 [01:36<00:44,  1.32s/it]Processing groups:  68%|██████▊   | 68/100 [01:37<00:39,  1.23s/it]Processing groups:  70%|███████   | 70/100 [01:39<00:35,  1.19s/it]Processing groups:  73%|███████▎  | 73/100 [01:42<00:29,  1.08s/it]Processing groups:  86%|████████▌ | 86/100 [01:42<00:05,  2.35it/s]Processing groups:  94%|█████████▍| 94/100 [01:43<00:01,  3.03it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:01,  2.89it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.65, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31881.30it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:16, 33.50s/it]Processing groups:   2%|▏         | 2/100 [00:37<25:55, 15.88s/it]Processing groups:  24%|██▍       | 24/100 [00:39<01:09,  1.10it/s]Processing groups:  29%|██▉       | 29/100 [00:40<00:52,  1.36it/s]Processing groups:  33%|███▎      | 33/100 [01:00<01:49,  1.64s/it]Processing groups:  34%|███▍      | 34/100 [01:05<02:04,  1.89s/it]Processing groups:  38%|███▊      | 38/100 [01:07<01:35,  1.54s/it]Processing groups:  40%|████      | 40/100 [01:09<01:23,  1.38s/it]Processing groups:  58%|█████▊    | 58/100 [01:10<00:19,  2.15it/s]Processing groups:  59%|█████▉    | 59/100 [01:10<00:19,  2.14it/s]Processing groups:  60%|██████    | 60/100 [01:10<00:17,  2.25it/s]Processing groups:  62%|██████▏   | 62/100 [01:11<00:16,  2.28it/s]Processing groups:  63%|██████▎   | 63/100 [01:14<00:24,  1.50it/s]Processing groups:  64%|██████▍   | 64/100 [01:14<00:21,  1.68it/s]Processing groups:  65%|██████▌   | 65/100 [01:29<01:41,  2.91s/it]Processing groups:  66%|██████▌   | 66/100 [01:33<01:48,  3.18s/it]Processing groups:  67%|██████▋   | 67/100 [01:35<01:35,  2.90s/it]Processing groups:  69%|██████▉   | 69/100 [01:37<01:05,  2.11s/it]Processing groups:  72%|███████▏  | 72/100 [01:40<00:44,  1.58s/it]Processing groups:  77%|███████▋  | 77/100 [01:40<00:19,  1.21it/s]Processing groups:  84%|████████▍ | 84/100 [01:40<00:06,  2.32it/s]Processing groups:  88%|████████▊ | 88/100 [01:41<00:04,  2.68it/s]Processing groups:  96%|█████████▌| 96/100 [01:42<00:00,  4.41it/s]Processing groups:  98%|█████████▊| 98/100 [01:44<00:00,  3.05it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.07, 'mean_ap': 0.99, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31667.07it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:44, 34.38s/it]Processing groups:   5%|▌         | 5/100 [00:35<08:20,  5.27s/it]Processing groups:  15%|█▌        | 15/100 [00:35<01:55,  1.36s/it]Processing groups:  20%|██        | 20/100 [00:38<01:27,  1.09s/it]Processing groups:  28%|██▊       | 28/100 [00:39<00:46,  1.56it/s]Processing groups:  33%|███▎      | 33/100 [00:59<01:48,  1.63s/it]Processing groups:  34%|███▍      | 34/100 [01:00<01:43,  1.57s/it]Processing groups:  35%|███▌      | 35/100 [01:04<01:56,  1.78s/it]Processing groups:  39%|███▉      | 39/100 [01:05<01:15,  1.24s/it]Processing groups:  41%|████      | 41/100 [01:10<01:27,  1.49s/it]Processing groups:  49%|████▉     | 49/100 [01:10<00:36,  1.39it/s]Processing groups:  61%|██████    | 61/100 [01:11<00:13,  2.80it/s]Processing groups:  63%|██████▎   | 63/100 [01:14<00:17,  2.13it/s]Processing groups:  64%|██████▍   | 64/100 [01:16<00:20,  1.74it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<01:09,  1.97s/it]Processing groups:  66%|██████▌   | 66/100 [01:38<01:30,  2.67s/it]Processing groups:  67%|██████▋   | 67/100 [01:39<01:17,  2.34s/it]Processing groups:  70%|███████   | 70/100 [01:40<00:46,  1.54s/it]Processing groups:  77%|███████▋  | 77/100 [01:40<00:15,  1.47it/s]Processing groups:  80%|████████  | 80/100 [01:41<00:12,  1.58it/s]Processing groups:  87%|████████▋ | 87/100 [01:42<00:04,  2.78it/s]Processing groups:  96%|█████████▌| 96/100 [01:42<00:00,  4.67it/s]Processing groups:  98%|█████████▊| 98/100 [01:44<00:00,  2.87it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34172.27it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:18, 31.70s/it]Processing groups:   2%|▏         | 2/100 [00:34<24:24, 14.95s/it]Processing groups:   6%|▌         | 6/100 [00:39<06:52,  4.39s/it]Processing groups:  33%|███▎      | 33/100 [01:02<01:24,  1.26s/it]Processing groups:  34%|███▍      | 34/100 [01:04<01:23,  1.27s/it]Processing groups:  35%|███▌      | 35/100 [01:04<01:19,  1.23s/it]Processing groups:  36%|███▌      | 36/100 [01:08<01:30,  1.41s/it]Processing groups:  46%|████▌     | 46/100 [01:09<00:40,  1.34it/s]Processing groups:  54%|█████▍    | 54/100 [01:09<00:22,  2.09it/s]Processing groups:  56%|█████▌    | 56/100 [01:13<00:28,  1.57it/s]Processing groups:  63%|██████▎   | 63/100 [01:14<00:16,  2.28it/s]Processing groups:  64%|██████▍   | 64/100 [01:15<00:17,  2.06it/s]Processing groups:  65%|██████▌   | 65/100 [01:31<01:08,  1.95s/it]Processing groups:  66%|██████▌   | 66/100 [01:35<01:10,  2.08s/it]Processing groups:  67%|██████▋   | 67/100 [01:35<01:00,  1.83s/it]Processing groups:  68%|██████▊   | 68/100 [01:38<01:05,  2.03s/it]Processing groups:  69%|██████▉   | 69/100 [01:39<00:56,  1.83s/it]Processing groups:  73%|███████▎  | 73/100 [01:39<00:25,  1.08it/s]Processing groups:  75%|███████▌  | 75/100 [01:40<00:19,  1.29it/s]Processing groups:  80%|████████  | 80/100 [01:42<00:11,  1.73it/s]Processing groups:  93%|█████████▎| 93/100 [01:42<00:01,  4.54it/s]Processing groups:  95%|█████████▌| 95/100 [01:42<00:01,  4.90it/s]Processing groups:  97%|█████████▋| 97/100 [01:44<00:00,  3.03it/s]Processing groups:  98%|█████████▊| 98/100 [01:45<00:00,  2.88it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.37, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 640, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36561.23it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:56, 32.69s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:42, 15.13s/it]Processing groups:   4%|▍         | 4/100 [00:39<10:47,  6.74s/it]Processing groups:  10%|█         | 10/100 [00:40<02:56,  1.96s/it]Processing groups:  27%|██▋       | 27/100 [00:40<00:38,  1.90it/s]Processing groups:  29%|██▉       | 29/100 [00:40<00:33,  2.10it/s]Processing groups:  29%|██▉       | 29/100 [01:00<00:33,  2.10it/s]Processing groups:  33%|███▎      | 33/100 [01:10<02:23,  2.14s/it]Processing groups:  38%|███▊      | 38/100 [01:19<02:05,  2.02s/it]Processing groups:  54%|█████▍    | 54/100 [01:20<00:40,  1.13it/s]Processing groups:  54%|█████▍    | 54/100 [01:31<00:40,  1.13it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<00:47,  1.36s/it]Processing groups:  67%|██████▋   | 67/100 [01:48<00:47,  1.44s/it]Processing groups:  72%|███████▏  | 72/100 [01:49<00:31,  1.14s/it]Processing groups:  73%|███████▎  | 73/100 [01:50<00:29,  1.10s/it]Processing groups:  79%|███████▉  | 79/100 [01:50<00:15,  1.38it/s]Processing groups:  86%|████████▌ | 86/100 [01:50<00:06,  2.12it/s]Processing groups:  88%|████████▊ | 88/100 [01:51<00:05,  2.17it/s]Processing groups:  95%|█████████▌| 95/100 [01:51<00:01,  3.44it/s]Processing groups:  97%|█████████▋| 97/100 [01:53<00:01,  2.50it/s]Processing groups:  99%|█████████▉| 99/100 [01:54<00:00,  2.56it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.08, 'mean_ap': 0.06, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1203.11it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:19, 37.77s/it]Processing groups:   4%|▍         | 4/100 [00:39<12:13,  7.64s/it]  Processing groups:  12%|█▏        | 12/100 [00:40<02:51,  1.95s/it]Processing groups:  33%|███▎      | 33/100 [01:11<01:48,  1.61s/it]Processing groups:  38%|███▊      | 38/100 [01:15<01:28,  1.43s/it]Processing groups:  40%|████      | 40/100 [01:15<01:17,  1.29s/it]Processing groups:  41%|████      | 41/100 [01:16<01:14,  1.27s/it]Processing groups:  50%|█████     | 50/100 [01:16<00:34,  1.43it/s]Processing groups:  55%|█████▌    | 55/100 [01:18<00:27,  1.64it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<00:52,  1.49s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<00:52,  1.54s/it]Processing groups:  67%|██████▋   | 67/100 [01:48<00:50,  1.54s/it]Processing groups:  68%|██████▊   | 68/100 [01:49<00:44,  1.40s/it]Processing groups:  69%|██████▉   | 69/100 [01:49<00:41,  1.33s/it]Processing groups:  76%|███████▌  | 76/100 [01:50<00:16,  1.48it/s]Processing groups:  85%|████████▌ | 85/100 [01:51<00:05,  2.74it/s]Processing groups:  95%|█████████▌| 95/100 [01:51<00:01,  4.67it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  2.74it/s]Processing groups:  99%|█████████▉| 99/100 [01:54<00:00,  3.09it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 0.07, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28565.72it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:01:41, 37.39s/it]Processing groups:   7%|▋         | 7/100 [00:38<06:17,  4.06s/it]  Processing groups:   8%|▊         | 8/100 [00:40<05:40,  3.70s/it]Processing groups:  11%|█         | 11/100 [00:40<03:12,  2.17s/it]Processing groups:  33%|███▎      | 33/100 [01:10<01:41,  1.51s/it]Processing groups:  35%|███▌      | 35/100 [01:13<01:37,  1.51s/it]Processing groups:  39%|███▉      | 39/100 [01:14<01:13,  1.21s/it]Processing groups:  47%|████▋     | 47/100 [01:14<00:41,  1.28it/s]Processing groups:  48%|████▊     | 48/100 [01:15<00:38,  1.36it/s]Processing groups:  53%|█████▎    | 53/100 [01:18<00:32,  1.44it/s]Processing groups:  57%|█████▋    | 57/100 [01:18<00:23,  1.84it/s]Processing groups:  61%|██████    | 61/100 [01:20<00:20,  1.87it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:16,  2.19s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<01:12,  2.12s/it]Processing groups:  68%|██████▊   | 68/100 [01:48<00:56,  1.75s/it]Processing groups:  71%|███████   | 71/100 [01:49<00:39,  1.36s/it]Processing groups:  74%|███████▍  | 74/100 [01:50<00:25,  1.00it/s]Processing groups:  81%|████████  | 81/100 [01:51<00:10,  1.78it/s]Processing groups:  84%|████████▍ | 84/100 [01:51<00:07,  2.21it/s]Processing groups:  89%|████████▉ | 89/100 [01:52<00:03,  3.12it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:00,  3.04it/s]Processing groups:  98%|█████████▊| 98/100 [01:55<00:00,  3.10it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.21, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27065.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:09, 37.67s/it]Processing groups:   2%|▏         | 2/100 [00:38<26:15, 16.08s/it]  Processing groups:   6%|▌         | 6/100 [00:40<06:25,  4.10s/it]Processing groups:  30%|███       | 30/100 [00:42<00:41,  1.68it/s]Processing groups:  33%|███▎      | 33/100 [01:06<01:47,  1.60s/it]Processing groups:  35%|███▌      | 35/100 [01:10<01:47,  1.65s/it]Processing groups:  36%|███▌      | 36/100 [01:10<01:38,  1.54s/it]Processing groups:  37%|███▋      | 37/100 [01:11<01:33,  1.48s/it]Processing groups:  40%|████      | 40/100 [01:15<01:25,  1.42s/it]Processing groups:  46%|████▌     | 46/100 [01:18<00:51,  1.04it/s]Processing groups:  49%|████▉     | 49/100 [01:19<00:42,  1.20it/s]Processing groups:  61%|██████    | 61/100 [01:19<00:13,  2.79it/s]Processing groups:  61%|██████    | 61/100 [01:33<00:13,  2.79it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<00:55,  1.58s/it]Processing groups:  66%|██████▌   | 66/100 [01:48<01:02,  1.84s/it]Processing groups:  72%|███████▏  | 72/100 [01:49<00:32,  1.17s/it]Processing groups:  74%|███████▍  | 74/100 [01:49<00:26,  1.00s/it]Processing groups:  76%|███████▌  | 76/100 [01:50<00:22,  1.06it/s]Processing groups:  82%|████████▏ | 82/100 [01:51<00:10,  1.69it/s]Processing groups:  92%|█████████▏| 92/100 [01:52<00:02,  2.92it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.61it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.65, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32770.56it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:01:23, 37.20s/it]Processing groups:   2%|▏         | 2/100 [00:39<27:35, 16.90s/it]  Processing groups:   6%|▌         | 6/100 [00:41<06:35,  4.21s/it]Processing groups:  24%|██▍       | 24/100 [00:41<00:54,  1.38it/s]Processing groups:  24%|██▍       | 24/100 [00:56<00:54,  1.38it/s]Processing groups:  33%|███▎      | 33/100 [01:07<01:41,  1.52s/it]Processing groups:  34%|███▍      | 34/100 [01:07<01:35,  1.45s/it]Processing groups:  36%|███▌      | 36/100 [01:13<01:44,  1.63s/it]Processing groups:  38%|███▊      | 38/100 [01:14<01:28,  1.42s/it]Processing groups:  45%|████▌     | 45/100 [01:15<00:47,  1.16it/s]Processing groups:  52%|█████▏    | 52/100 [01:16<00:27,  1.77it/s]Processing groups:  55%|█████▌    | 55/100 [01:16<00:21,  2.12it/s]Processing groups:  59%|█████▉    | 59/100 [01:18<00:18,  2.22it/s]Processing groups:  64%|██████▍   | 64/100 [01:19<00:13,  2.67it/s]Processing groups:  65%|██████▌   | 65/100 [01:47<01:37,  2.79s/it]Processing groups:  67%|██████▋   | 67/100 [01:48<01:15,  2.30s/it]Processing groups:  68%|██████▊   | 68/100 [01:48<01:05,  2.04s/it]Processing groups:  76%|███████▌  | 76/100 [01:49<00:22,  1.08it/s]Processing groups:  78%|███████▊  | 78/100 [01:51<00:19,  1.11it/s]Processing groups:  88%|████████▊ | 88/100 [01:51<00:04,  2.44it/s]Processing groups:  92%|█████████▏| 92/100 [01:51<00:02,  2.89it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  2.47it/s]Processing groups:  99%|█████████▉| 99/100 [01:54<00:00,  2.80it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 0.99, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30792.92it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:38<1:03:57, 38.76s/it]Processing groups:   2%|▏         | 2/100 [00:38<26:12, 16.05s/it]  Processing groups:   3%|▎         | 3/100 [00:39<14:10,  8.77s/it]Processing groups:   7%|▋         | 7/100 [00:39<03:57,  2.56s/it]Processing groups:  33%|███▎      | 33/100 [01:08<01:27,  1.30s/it]Processing groups:  35%|███▌      | 35/100 [01:09<01:18,  1.21s/it]Processing groups:  36%|███▌      | 36/100 [01:09<01:14,  1.16s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:27,  1.39s/it]Processing groups:  49%|████▉     | 49/100 [01:13<00:30,  1.65it/s]Processing groups:  52%|█████▏    | 52/100 [01:17<00:35,  1.37it/s]Processing groups:  61%|██████    | 61/100 [01:18<00:17,  2.20it/s]Processing groups:  61%|██████    | 61/100 [01:30<00:17,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<00:59,  1.69s/it]Processing groups:  66%|██████▌   | 66/100 [01:44<00:54,  1.60s/it]Processing groups:  68%|██████▊   | 68/100 [01:47<00:52,  1.65s/it]Processing groups:  75%|███████▌  | 75/100 [01:49<00:24,  1.00it/s]Processing groups:  78%|███████▊  | 78/100 [01:50<00:19,  1.15it/s]Processing groups:  82%|████████▏ | 82/100 [01:50<00:11,  1.58it/s]Processing groups:  92%|█████████▏| 92/100 [01:51<00:02,  3.17it/s]Processing groups:  96%|█████████▌| 96/100 [01:51<00:01,  3.88it/s]Processing groups:  99%|█████████▉| 99/100 [01:54<00:00,  2.50it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.15, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29524.88it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:01:57, 37.55s/it]Processing groups:   2%|▏         | 2/100 [00:39<26:44, 16.37s/it]  Processing groups:  25%|██▌       | 25/100 [00:41<01:08,  1.10it/s]Processing groups:  33%|███▎      | 33/100 [01:04<01:43,  1.54s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:54,  1.73s/it]Processing groups:  36%|███▌      | 36/100 [01:10<01:37,  1.52s/it]Processing groups:  37%|███▋      | 37/100 [01:11<01:33,  1.48s/it]Processing groups:  39%|███▉      | 39/100 [01:13<01:27,  1.44s/it]Processing groups:  42%|████▏     | 42/100 [01:14<01:04,  1.11s/it]Processing groups:  43%|████▎     | 43/100 [01:14<00:57,  1.01s/it]Processing groups:  46%|████▌     | 46/100 [01:15<00:37,  1.44it/s]Processing groups:  48%|████▊     | 48/100 [01:17<00:40,  1.28it/s]Processing groups:  53%|█████▎    | 53/100 [01:18<00:24,  1.88it/s]Processing groups:  63%|██████▎   | 63/100 [01:19<00:11,  3.35it/s]Processing groups:  65%|██████▌   | 65/100 [01:40<01:00,  1.73s/it]Processing groups:  66%|██████▌   | 66/100 [01:48<01:16,  2.25s/it]Processing groups:  67%|██████▋   | 67/100 [01:48<01:06,  2.02s/it]Processing groups:  70%|███████   | 70/100 [01:49<00:42,  1.43s/it]Processing groups:  73%|███████▎  | 73/100 [01:50<00:29,  1.07s/it]Processing groups:  74%|███████▍  | 74/100 [01:50<00:25,  1.02it/s]Processing groups:  86%|████████▌ | 86/100 [01:51<00:05,  2.66it/s]Processing groups:  87%|████████▋ | 87/100 [01:52<00:05,  2.58it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:00,  3.51it/s]Processing groups:  98%|█████████▊| 98/100 [01:54<00:00,  3.45it/s]Processing groups:  99%|█████████▉| 99/100 [01:54<00:00,  3.53it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.37, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 640, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.18it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 25222.83it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:14:47, 45.33s/it]Processing groups:   2%|▏         | 2/100 [00:47<32:52, 20.13s/it]  Processing groups:   4%|▍         | 4/100 [00:49<12:43,  7.96s/it]Processing groups:  16%|█▌        | 16/100 [00:49<01:48,  1.29s/it]Processing groups:  27%|██▋       | 27/100 [00:50<00:47,  1.55it/s]Processing groups:  32%|███▏      | 32/100 [00:51<00:36,  1.87it/s]Processing groups:  33%|███▎      | 33/100 [01:28<03:22,  3.02s/it]Processing groups:  34%|███▍      | 34/100 [01:36<03:47,  3.44s/it]Processing groups:  57%|█████▋    | 57/100 [01:38<00:41,  1.05it/s]Processing groups:  65%|██████▌   | 65/100 [02:14<01:06,  1.89s/it]Processing groups:  67%|██████▋   | 67/100 [02:16<01:00,  1.82s/it]Processing groups:  68%|██████▊   | 68/100 [02:18<00:58,  1.84s/it]Processing groups:  69%|██████▉   | 69/100 [02:18<00:53,  1.71s/it]Processing groups:  71%|███████   | 71/100 [02:19<00:41,  1.43s/it]Processing groups:  74%|███████▍  | 74/100 [02:20<00:29,  1.12s/it]Processing groups:  76%|███████▌  | 76/100 [02:20<00:23,  1.04it/s]Processing groups:  80%|████████  | 80/100 [02:21<00:13,  1.48it/s]Processing groups:  81%|████████  | 81/100 [02:22<00:12,  1.53it/s]Processing groups:  94%|█████████▍| 94/100 [02:22<00:01,  4.69it/s]Processing groups:  97%|█████████▋| 97/100 [02:26<00:01,  2.47it/s]Processing groups:  99%|█████████▉| 99/100 [02:26<00:00,  2.74it/s]Processing groups: 100%|██████████| 100/100 [02:26<00:00,  1.46s/it]
{'replicate_reproducibility': 0.04, 'mp_value': 0.07, 'mean_ap': 0.02, 'mean_ap_p_value': 0.03, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.08it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34116.67it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:19:26, 48.15s/it]Processing groups:  12%|█▏        | 12/100 [00:50<04:28,  3.05s/it] Processing groups:  20%|██        | 20/100 [00:50<02:05,  1.57s/it]Processing groups:  20%|██        | 20/100 [01:00<02:05,  1.57s/it]Processing groups:  33%|███▎      | 33/100 [01:27<02:31,  2.26s/it]Processing groups:  34%|███▍      | 34/100 [01:28<02:23,  2.17s/it]Processing groups:  36%|███▌      | 36/100 [01:37<02:41,  2.52s/it]Processing groups:  47%|████▋     | 47/100 [01:38<01:05,  1.24s/it]Processing groups:  63%|██████▎   | 63/100 [01:38<00:22,  1.66it/s]Processing groups:  63%|██████▎   | 63/100 [01:50<00:22,  1.66it/s]Processing groups:  65%|██████▌   | 65/100 [02:12<01:08,  1.97s/it]Processing groups:  66%|██████▌   | 66/100 [02:12<01:04,  1.90s/it]Processing groups:  70%|███████   | 70/100 [02:17<00:51,  1.72s/it]Processing groups:  75%|███████▌  | 75/100 [02:18<00:32,  1.29s/it]Processing groups:  77%|███████▋  | 77/100 [02:19<00:25,  1.12s/it]Processing groups:  84%|████████▍ | 84/100 [02:20<00:11,  1.44it/s]Processing groups:  87%|████████▋ | 87/100 [02:20<00:07,  1.76it/s]Processing groups:  91%|█████████ | 91/100 [02:20<00:03,  2.40it/s]Processing groups:  93%|█████████▎| 93/100 [02:21<00:02,  2.55it/s]Processing groups:  97%|█████████▋| 97/100 [02:24<00:01,  1.72it/s]Processing groups: 100%|██████████| 100/100 [02:24<00:00,  1.45s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.12, 'mean_ap': 0.05, 'mean_ap_p_value': 0.08, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.95it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 35674.95it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:19, 46.26s/it]Processing groups:   2%|▏         | 2/100 [00:48<33:44, 20.66s/it]  Processing groups:  21%|██        | 21/100 [00:50<01:41,  1.28s/it]Processing groups:  33%|███▎      | 33/100 [01:31<02:32,  2.28s/it]Processing groups:  41%|████      | 41/100 [01:37<01:45,  1.79s/it]Processing groups:  61%|██████    | 61/100 [01:37<00:33,  1.15it/s]Processing groups:  64%|██████▍   | 64/100 [01:38<00:28,  1.25it/s]Processing groups:  64%|██████▍   | 64/100 [01:54<00:28,  1.25it/s]Processing groups:  65%|██████▌   | 65/100 [02:09<01:17,  2.21s/it]Processing groups:  66%|██████▌   | 66/100 [02:18<01:29,  2.63s/it]Processing groups:  70%|███████   | 70/100 [02:19<00:58,  1.96s/it]Processing groups:  73%|███████▎  | 73/100 [02:19<00:41,  1.54s/it]Processing groups:  78%|███████▊  | 78/100 [02:20<00:23,  1.08s/it]Processing groups:  86%|████████▌ | 86/100 [02:20<00:08,  1.59it/s]Processing groups:  90%|█████████ | 90/100 [02:20<00:05,  1.99it/s]Processing groups:  92%|█████████▏| 92/100 [02:21<00:03,  2.26it/s]Processing groups:  96%|█████████▌| 96/100 [02:21<00:01,  3.11it/s]Processing groups:  98%|█████████▊| 98/100 [02:25<00:01,  1.65it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  2.01it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  1.45s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.14, 'mean_ap': 0.17, 'mean_ap_p_value': 0.28, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.46it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29259.18it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:17:49, 47.17s/it]Processing groups:   3%|▎         | 3/100 [00:48<20:22, 12.61s/it]  Processing groups:   8%|▊         | 8/100 [00:48<05:28,  3.57s/it]Processing groups:  11%|█         | 11/100 [00:50<03:34,  2.41s/it]Processing groups:  22%|██▏       | 22/100 [00:51<01:06,  1.17it/s]Processing groups:  33%|███▎      | 33/100 [01:26<02:13,  1.99s/it]Processing groups:  34%|███▍      | 34/100 [01:31<02:22,  2.16s/it]Processing groups:  35%|███▌      | 35/100 [01:31<02:12,  2.03s/it]Processing groups:  41%|████      | 41/100 [01:32<01:14,  1.26s/it]Processing groups:  43%|████▎     | 43/100 [01:32<01:01,  1.07s/it]Processing groups:  45%|████▌     | 45/100 [01:35<01:01,  1.11s/it]Processing groups:  46%|████▌     | 46/100 [01:35<00:56,  1.05s/it]Processing groups:  59%|█████▉    | 59/100 [01:37<00:17,  2.31it/s]Processing groups:  61%|██████    | 61/100 [01:39<00:18,  2.17it/s]Processing groups:  65%|██████▌   | 65/100 [02:17<01:43,  2.96s/it]Processing groups:  67%|██████▋   | 67/100 [02:17<01:22,  2.51s/it]Processing groups:  70%|███████   | 70/100 [02:18<00:57,  1.92s/it]Processing groups:  73%|███████▎  | 73/100 [02:18<00:38,  1.43s/it]Processing groups:  75%|███████▌  | 75/100 [02:19<00:29,  1.19s/it]Processing groups:  81%|████████  | 81/100 [02:20<00:13,  1.45it/s]Processing groups:  84%|████████▍ | 84/100 [02:20<00:08,  1.86it/s]Processing groups:  85%|████████▌ | 85/100 [02:20<00:07,  1.99it/s]Processing groups:  88%|████████▊ | 88/100 [02:21<00:04,  2.52it/s]Processing groups:  92%|█████████▏| 92/100 [02:21<00:02,  3.29it/s]Processing groups:  97%|█████████▋| 97/100 [02:25<00:01,  2.22it/s]Processing groups:  98%|█████████▊| 98/100 [02:25<00:00,  2.16it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  1.46s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.39, 'mean_ap': 0.52, 'mean_ap_p_value': 0.67, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.18it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32234.12it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:13:59, 44.84s/it]Processing groups:   2%|▏         | 2/100 [00:45<30:28, 18.66s/it]  Processing groups:   4%|▍         | 4/100 [00:47<12:25,  7.77s/it]Processing groups:   7%|▋         | 7/100 [00:48<05:30,  3.55s/it]Processing groups:  13%|█▎        | 13/100 [00:49<01:58,  1.36s/it]Processing groups:  17%|█▋        | 17/100 [00:51<01:27,  1.06s/it]Processing groups:  17%|█▋        | 17/100 [01:10<01:27,  1.06s/it]Processing groups:  33%|███▎      | 33/100 [01:26<02:02,  1.83s/it]Processing groups:  34%|███▍      | 34/100 [01:32<02:16,  2.07s/it]Processing groups:  38%|███▊      | 38/100 [01:33<01:40,  1.61s/it]Processing groups:  41%|████      | 41/100 [01:34<01:19,  1.35s/it]Processing groups:  42%|████▏     | 42/100 [01:40<01:41,  1.75s/it]Processing groups:  65%|██████▌   | 65/100 [02:11<00:51,  1.47s/it]Processing groups:  66%|██████▌   | 66/100 [02:14<00:51,  1.51s/it]Processing groups:  67%|██████▋   | 67/100 [02:18<00:55,  1.68s/it]Processing groups:  73%|███████▎  | 73/100 [02:21<00:34,  1.27s/it]Processing groups:  80%|████████  | 80/100 [02:21<00:16,  1.22it/s]Processing groups:  92%|█████████▏| 92/100 [02:21<00:03,  2.28it/s]Processing groups:  97%|█████████▋| 97/100 [02:25<00:01,  1.92it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  1.46s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.32, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.41it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28079.96it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:47, 42.90s/it]Processing groups:   2%|▏         | 2/100 [00:43<28:58, 17.74s/it]  Processing groups:   3%|▎         | 3/100 [00:43<16:17, 10.07s/it]Processing groups:   4%|▍         | 4/100 [00:45<10:58,  6.86s/it]Processing groups:   6%|▌         | 6/100 [00:47<05:41,  3.63s/it]Processing groups:  14%|█▍        | 14/100 [00:48<01:28,  1.03s/it]Processing groups:  29%|██▉       | 29/100 [00:49<00:27,  2.62it/s]Processing groups:  30%|███       | 30/100 [00:49<00:25,  2.70it/s]Processing groups:  33%|███▎      | 33/100 [01:28<03:15,  2.91s/it]Processing groups:  34%|███▍      | 34/100 [01:33<03:22,  3.07s/it]Processing groups:  44%|████▍     | 44/100 [01:35<01:22,  1.47s/it]Processing groups:  54%|█████▍    | 54/100 [01:36<00:40,  1.13it/s]Processing groups:  62%|██████▏   | 62/100 [01:36<00:22,  1.67it/s]Processing groups:  62%|██████▏   | 62/100 [01:53<00:22,  1.67it/s]Processing groups:  65%|██████▌   | 65/100 [02:15<01:26,  2.46s/it]Processing groups:  67%|██████▋   | 67/100 [02:15<01:11,  2.17s/it]Processing groups:  68%|██████▊   | 68/100 [02:15<01:04,  2.01s/it]Processing groups:  69%|██████▉   | 69/100 [02:17<00:59,  1.93s/it]Processing groups:  72%|███████▏  | 72/100 [02:17<00:38,  1.36s/it]Processing groups:  73%|███████▎  | 73/100 [02:17<00:33,  1.23s/it]Processing groups:  78%|███████▊  | 78/100 [02:18<00:14,  1.50it/s]Processing groups:  80%|████████  | 80/100 [02:19<00:13,  1.47it/s]Processing groups:  88%|████████▊ | 88/100 [02:20<00:04,  2.79it/s]Processing groups:  91%|█████████ | 91/100 [02:20<00:02,  3.39it/s]Processing groups:  97%|█████████▋| 97/100 [02:24<00:01,  2.23it/s]Processing groups:  99%|█████████▉| 99/100 [02:24<00:00,  2.59it/s]Processing groups: 100%|██████████| 100/100 [02:24<00:00,  1.45s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.82, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.44it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28824.85it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:02, 42.45s/it]Processing groups:   2%|▏         | 2/100 [00:44<30:12, 18.50s/it]  Processing groups:   3%|▎         | 3/100 [00:47<18:38, 11.53s/it]Processing groups:   6%|▌         | 6/100 [00:49<06:41,  4.27s/it]Processing groups:  20%|██        | 20/100 [00:49<01:04,  1.24it/s]Processing groups:  25%|██▌       | 25/100 [00:50<00:48,  1.55it/s]Processing groups:  25%|██▌       | 25/100 [01:07<00:48,  1.55it/s]Processing groups:  33%|███▎      | 33/100 [01:26<02:26,  2.18s/it]Processing groups:  34%|███▍      | 34/100 [01:28<02:24,  2.19s/it]Processing groups:  35%|███▌      | 35/100 [01:28<02:11,  2.02s/it]Processing groups:  36%|███▌      | 36/100 [01:29<02:00,  1.88s/it]Processing groups:  37%|███▋      | 37/100 [01:30<01:45,  1.67s/it]Processing groups:  40%|████      | 40/100 [01:33<01:26,  1.45s/it]Processing groups:  41%|████      | 41/100 [01:36<01:42,  1.74s/it]Processing groups:  52%|█████▏    | 52/100 [01:37<00:27,  1.75it/s]Processing groups:  56%|█████▌    | 56/100 [01:37<00:19,  2.23it/s]Processing groups:  59%|█████▉    | 59/100 [01:39<00:17,  2.30it/s]Processing groups:  65%|██████▌   | 65/100 [02:09<01:18,  2.23s/it]Processing groups:  66%|██████▌   | 66/100 [02:12<01:17,  2.29s/it]Processing groups:  68%|██████▊   | 68/100 [02:13<01:02,  1.97s/it]Processing groups:  69%|██████▉   | 69/100 [02:15<00:58,  1.90s/it]Processing groups:  70%|███████   | 70/100 [02:15<00:50,  1.69s/it]Processing groups:  71%|███████   | 71/100 [02:18<00:56,  1.94s/it]Processing groups:  72%|███████▏  | 72/100 [02:19<00:47,  1.70s/it]Processing groups:  74%|███████▍  | 74/100 [02:19<00:28,  1.10s/it]Processing groups:  78%|███████▊  | 78/100 [02:19<00:12,  1.79it/s]Processing groups:  83%|████████▎ | 83/100 [02:20<00:05,  2.90it/s]Processing groups:  85%|████████▌ | 85/100 [02:20<00:04,  3.39it/s]Processing groups:  90%|█████████ | 90/100 [02:20<00:01,  5.54it/s]Processing groups:  92%|█████████▏| 92/100 [02:20<00:01,  5.78it/s]Processing groups:  97%|█████████▋| 97/100 [02:24<00:01,  2.37it/s]Processing groups:  99%|█████████▉| 99/100 [02:24<00:00,  2.83it/s]Processing groups: 100%|██████████| 100/100 [02:24<00:00,  1.45s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 640, 'differ_params': 1}

Processing n_plates: 3

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30380.30it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:09, 31.01s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:50, 14.60s/it]Processing groups:   3%|▎         | 3/100 [00:35<13:57,  8.64s/it]Processing groups:   4%|▍         | 4/100 [00:36<08:39,  5.41s/it]Processing groups:  11%|█         | 11/100 [00:37<01:54,  1.28s/it]Processing groups:  27%|██▋       | 27/100 [00:39<00:31,  2.31it/s]Processing groups:  33%|███▎      | 33/100 [01:05<01:41,  1.51s/it]Processing groups:  34%|███▍      | 34/100 [01:08<01:48,  1.64s/it]Processing groups:  35%|███▌      | 35/100 [01:13<02:04,  1.91s/it]Processing groups:  52%|█████▏    | 52/100 [01:14<00:31,  1.53it/s]Processing groups:  54%|█████▍    | 54/100 [01:19<00:39,  1.17it/s]Processing groups:  54%|█████▍    | 54/100 [01:30<00:39,  1.17it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<00:45,  1.29s/it]Processing groups:  66%|██████▌   | 66/100 [01:40<00:42,  1.26s/it]Processing groups:  68%|██████▊   | 68/100 [01:40<00:35,  1.12s/it]Processing groups:  71%|███████   | 71/100 [01:43<00:30,  1.05s/it]Processing groups:  73%|███████▎  | 73/100 [01:43<00:23,  1.13it/s]Processing groups:  74%|███████▍  | 74/100 [01:45<00:27,  1.04s/it]Processing groups:  77%|███████▋  | 77/100 [01:47<00:20,  1.14it/s]Processing groups:  82%|████████▏ | 82/100 [01:48<00:09,  1.84it/s]Processing groups:  91%|█████████ | 91/100 [01:48<00:02,  3.71it/s]Processing groups:  96%|█████████▌| 96/100 [01:49<00:00,  4.11it/s]Processing groups:  98%|█████████▊| 98/100 [01:51<00:00,  2.91it/s]Processing groups: 100%|██████████| 100/100 [01:51<00:00,  1.11s/it]
{'replicate_reproducibility': 0.05, 'mp_value': 0.13, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34535.23it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:56, 31.48s/it]Processing groups:   2%|▏         | 2/100 [00:38<27:46, 17.00s/it]Processing groups:   5%|▌         | 5/100 [00:38<07:51,  4.96s/it]Processing groups:  26%|██▌       | 26/100 [00:41<00:52,  1.42it/s]Processing groups:  33%|███▎      | 33/100 [01:06<01:44,  1.56s/it]Processing groups:  35%|███▌      | 35/100 [01:08<01:37,  1.51s/it]Processing groups:  38%|███▊      | 38/100 [01:12<01:30,  1.46s/it]Processing groups:  40%|████      | 40/100 [01:14<01:26,  1.44s/it]Processing groups:  56%|█████▌    | 56/100 [01:16<00:25,  1.69it/s]Processing groups:  60%|██████    | 60/100 [01:18<00:23,  1.71it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<00:51,  1.47s/it]Processing groups:  67%|██████▋   | 67/100 [01:40<00:44,  1.34s/it]Processing groups:  68%|██████▊   | 68/100 [01:41<00:42,  1.32s/it]Processing groups:  70%|███████   | 70/100 [01:47<00:47,  1.59s/it]Processing groups:  75%|███████▌  | 75/100 [01:47<00:24,  1.03it/s]Processing groups:  82%|████████▏ | 82/100 [01:47<00:09,  1.82it/s]Processing groups:  89%|████████▉ | 89/100 [01:47<00:03,  2.88it/s]Processing groups:  94%|█████████▍| 94/100 [01:47<00:01,  3.80it/s]Processing groups:  97%|█████████▋| 97/100 [01:50<00:01,  2.49it/s]Processing groups:  99%|█████████▉| 99/100 [01:50<00:00,  2.89it/s]Processing groups: 100%|██████████| 100/100 [01:50<00:00,  1.11s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23806.92it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:56, 32.69s/it]Processing groups:   2%|▏         | 2/100 [00:34<24:05, 14.75s/it]Processing groups:   5%|▌         | 5/100 [00:38<07:53,  4.98s/it]Processing groups:   6%|▌         | 6/100 [00:38<06:00,  3.84s/it]Processing groups:   7%|▋         | 7/100 [00:38<04:25,  2.86s/it]Processing groups:  19%|█▉        | 19/100 [00:40<00:52,  1.54it/s]Processing groups:  33%|███▎      | 33/100 [01:05<01:27,  1.31s/it]Processing groups:  35%|███▌      | 35/100 [01:10<01:32,  1.42s/it]Processing groups:  37%|███▋      | 37/100 [01:14<01:34,  1.50s/it]Processing groups:  56%|█████▌    | 56/100 [01:17<00:28,  1.56it/s]Processing groups:  63%|██████▎   | 63/100 [01:20<00:21,  1.71it/s]Processing groups:  65%|██████▌   | 65/100 [01:41<00:52,  1.50s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<00:52,  1.54s/it]Processing groups:  67%|██████▋   | 67/100 [01:45<00:50,  1.54s/it]Processing groups:  68%|██████▊   | 68/100 [01:45<00:45,  1.43s/it]Processing groups:  71%|███████   | 71/100 [01:46<00:32,  1.12s/it]Processing groups:  75%|███████▌  | 75/100 [01:48<00:20,  1.22it/s]Processing groups:  87%|████████▋ | 87/100 [01:48<00:04,  2.99it/s]Processing groups:  96%|█████████▌| 96/100 [01:49<00:00,  4.18it/s]Processing groups:  98%|█████████▊| 98/100 [01:51<00:00,  2.86it/s]Processing groups: 100%|██████████| 100/100 [01:51<00:00,  1.12s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.05, 'mean_ap': 0.01, 'mean_ap_p_value': 0.24, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23877.40it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<52:50, 32.03s/it]Processing groups:   2%|▏         | 2/100 [00:32<22:23, 13.71s/it]Processing groups:   3%|▎         | 3/100 [00:37<15:28,  9.58s/it]Processing groups:   4%|▍         | 4/100 [00:39<10:28,  6.54s/it]Processing groups:  33%|███▎      | 33/100 [01:05<01:22,  1.23s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:19,  1.21s/it]Processing groups:  35%|███▌      | 35/100 [01:09<01:25,  1.31s/it]Processing groups:  36%|███▌      | 36/100 [01:11<01:27,  1.37s/it]Processing groups:  43%|████▎     | 43/100 [01:12<00:46,  1.24it/s]Processing groups:  52%|█████▏    | 52/100 [01:16<00:31,  1.52it/s]Processing groups:  57%|█████▋    | 57/100 [01:16<00:21,  1.98it/s]Processing groups:  61%|██████    | 61/100 [01:17<00:17,  2.29it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<00:57,  1.65s/it]Processing groups:  66%|██████▌   | 66/100 [01:41<00:59,  1.75s/it]Processing groups:  68%|██████▊   | 68/100 [01:45<00:56,  1.77s/it]Processing groups:  69%|██████▉   | 69/100 [01:46<00:53,  1.73s/it]Processing groups:  79%|███████▉  | 79/100 [01:47<00:13,  1.53it/s]Processing groups:  82%|████████▏ | 82/100 [01:47<00:09,  1.87it/s]Processing groups:  89%|████████▉ | 89/100 [01:48<00:03,  2.75it/s]Processing groups:  97%|█████████▋| 97/100 [01:51<00:01,  2.73it/s]Processing groups: 100%|██████████| 100/100 [01:51<00:00,  1.11s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.36, 'mean_ap_p_value': 0.83, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]                                     /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31018.37it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:00:10, 36.47s/it]Processing groups:   2%|▏         | 2/100 [00:37<25:25, 15.57s/it]  Processing groups:  16%|█▌        | 16/100 [00:37<01:44,  1.24s/it]Processing groups:  26%|██▌       | 26/100 [00:38<00:49,  1.49it/s]Processing groups:  26%|██▌       | 26/100 [00:49<00:49,  1.49it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:43,  1.54s/it]Processing groups:  34%|███▍      | 34/100 [01:05<01:51,  1.68s/it]Processing groups:  36%|███▌      | 36/100 [01:07<01:40,  1.56s/it]Processing groups:  37%|███▋      | 37/100 [01:07<01:32,  1.46s/it]Processing groups:  38%|███▊      | 38/100 [01:09<01:33,  1.51s/it]Processing groups:  40%|████      | 40/100 [01:12<01:29,  1.49s/it]Processing groups:  41%|████      | 41/100 [01:14<01:32,  1.56s/it]Processing groups:  57%|█████▋    | 57/100 [01:15<00:15,  2.69it/s]Processing groups:  59%|█████▉    | 59/100 [01:16<00:15,  2.58it/s]Processing groups:  64%|██████▍   | 64/100 [01:17<00:11,  3.06it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<01:12,  2.07s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<01:17,  2.28s/it]Processing groups:  70%|███████   | 70/100 [01:44<00:47,  1.58s/it]Processing groups:  77%|███████▋  | 77/100 [01:46<00:20,  1.11it/s]Processing groups:  78%|███████▊  | 78/100 [01:47<00:20,  1.08it/s]Processing groups:  87%|████████▋ | 87/100 [01:47<00:05,  2.26it/s]Processing groups:  90%|█████████ | 90/100 [01:47<00:03,  2.71it/s]Processing groups:  95%|█████████▌| 95/100 [01:48<00:01,  3.57it/s]Processing groups:  97%|█████████▋| 97/100 [01:50<00:01,  2.25it/s]Processing groups: 100%|██████████| 100/100 [01:50<00:00,  1.11s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.29, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.78it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29959.31it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:30, 31.22s/it]Processing groups:   2%|▏         | 2/100 [00:36<26:05, 15.98s/it]Processing groups:   3%|▎         | 3/100 [00:36<14:08,  8.75s/it]Processing groups:   5%|▌         | 5/100 [00:37<06:11,  3.91s/it]Processing groups:  33%|███▎      | 33/100 [01:02<01:18,  1.17s/it]Processing groups:  34%|███▍      | 34/100 [01:04<01:17,  1.18s/it]Processing groups:  36%|███▌      | 36/100 [01:05<01:10,  1.10s/it]Processing groups:  37%|███▋      | 37/100 [01:06<01:10,  1.13s/it]Processing groups:  38%|███▊      | 38/100 [01:07<01:05,  1.06s/it]Processing groups:  39%|███▉      | 39/100 [01:09<01:10,  1.16s/it]Processing groups:  40%|████      | 40/100 [01:13<01:35,  1.59s/it]Processing groups:  41%|████      | 41/100 [01:13<01:21,  1.39s/it]Processing groups:  46%|████▌     | 46/100 [01:14<00:40,  1.35it/s]Processing groups:  51%|█████     | 51/100 [01:16<00:29,  1.66it/s]Processing groups:  52%|█████▏    | 52/100 [01:17<00:27,  1.73it/s]Processing groups:  60%|██████    | 60/100 [01:17<00:10,  3.71it/s]Processing groups:  63%|██████▎   | 63/100 [01:18<00:11,  3.35it/s]Processing groups:  65%|██████▌   | 65/100 [01:38<01:11,  2.03s/it]Processing groups:  66%|██████▌   | 66/100 [01:42<01:18,  2.31s/it]Processing groups:  69%|██████▉   | 69/100 [01:43<00:49,  1.60s/it]Processing groups:  74%|███████▍  | 74/100 [01:43<00:24,  1.05it/s]Processing groups:  76%|███████▌  | 76/100 [01:46<00:23,  1.00it/s]Processing groups:  77%|███████▋  | 77/100 [01:46<00:21,  1.07it/s]Processing groups:  81%|████████  | 81/100 [01:47<00:11,  1.65it/s]Processing groups:  88%|████████▊ | 88/100 [01:48<00:04,  2.85it/s]Processing groups:  93%|█████████▎| 93/100 [01:48<00:01,  3.87it/s]Processing groups:  96%|█████████▌| 96/100 [01:48<00:00,  4.65it/s]Processing groups:  98%|█████████▊| 98/100 [01:51<00:00,  2.62it/s]Processing groups: 100%|██████████| 100/100 [01:51<00:00,  1.11s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.31, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  9.53it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 37289.33it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<59:32, 36.08s/it]Processing groups:   2%|▏         | 2/100 [00:37<25:49, 15.81s/it]Processing groups:  21%|██        | 21/100 [00:38<01:14,  1.06it/s]Processing groups:  25%|██▌       | 25/100 [00:39<01:01,  1.21it/s]Processing groups:  25%|██▌       | 25/100 [00:55<01:01,  1.21it/s]Processing groups:  33%|███▎      | 33/100 [01:05<01:58,  1.77s/it]Processing groups:  35%|███▌      | 35/100 [01:07<01:47,  1.66s/it]Processing groups:  37%|███▋      | 37/100 [01:11<01:47,  1.71s/it]Processing groups:  44%|████▍     | 44/100 [01:11<00:55,  1.00it/s]Processing groups:  52%|█████▏    | 52/100 [01:13<00:31,  1.50it/s]Processing groups:  54%|█████▍    | 54/100 [01:15<00:32,  1.42it/s]Processing groups:  60%|██████    | 60/100 [01:15<00:18,  2.13it/s]Processing groups:  60%|██████    | 60/100 [01:25<00:18,  2.13it/s]Processing groups:  65%|██████▌   | 65/100 [01:41<01:05,  1.88s/it]Processing groups:  66%|██████▌   | 66/100 [01:41<00:59,  1.75s/it]Processing groups:  68%|██████▊   | 68/100 [01:43<00:50,  1.59s/it]Processing groups:  72%|███████▏  | 72/100 [01:45<00:33,  1.21s/it]Processing groups:  74%|███████▍  | 74/100 [01:45<00:26,  1.02s/it]Processing groups:  80%|████████  | 80/100 [01:46<00:12,  1.66it/s]Processing groups:  86%|████████▌ | 86/100 [01:46<00:05,  2.51it/s]Processing groups:  97%|█████████▋| 97/100 [01:49<00:00,  3.19it/s]Processing groups:  98%|█████████▊| 98/100 [01:49<00:00,  3.16it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.10s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 640, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.67it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30055.92it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:11:16, 43.20s/it]Processing groups:  10%|█         | 10/100 [00:44<04:56,  3.29s/it] Processing groups:  18%|█▊        | 18/100 [00:45<02:07,  1.56s/it]Processing groups:  33%|███▎      | 33/100 [01:19<02:12,  1.98s/it]Processing groups:  34%|███▍      | 34/100 [01:23<02:17,  2.08s/it]Processing groups:  35%|███▌      | 35/100 [01:23<02:07,  1.96s/it]Processing groups:  38%|███▊      | 38/100 [01:25<01:41,  1.63s/it]Processing groups:  44%|████▍     | 44/100 [01:27<01:01,  1.11s/it]Processing groups:  48%|████▊     | 48/100 [01:28<00:43,  1.19it/s]Processing groups:  49%|████▉     | 49/100 [01:29<00:44,  1.15it/s]Processing groups:  63%|██████▎   | 63/100 [01:30<00:13,  2.66it/s]Processing groups:  65%|██████▌   | 65/100 [02:01<01:15,  2.14s/it]Processing groups:  66%|██████▌   | 66/100 [02:03<01:12,  2.13s/it]Processing groups:  67%|██████▋   | 67/100 [02:08<01:19,  2.40s/it]Processing groups:  81%|████████  | 81/100 [02:08<00:15,  1.23it/s]Processing groups:  88%|████████▊ | 88/100 [02:09<00:06,  1.79it/s]Processing groups:  92%|█████████▏| 92/100 [02:09<00:03,  2.16it/s]Processing groups:  95%|█████████▌| 95/100 [02:09<00:01,  2.57it/s]Processing groups:  98%|█████████▊| 98/100 [02:13<00:01,  1.69it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.34s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.78it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32174.78it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:14:51, 45.36s/it]Processing groups:   2%|▏         | 2/100 [00:45<31:05, 19.03s/it]  Processing groups:  33%|███▎      | 33/100 [01:26<02:10,  1.95s/it]Processing groups:  36%|███▌      | 36/100 [01:26<01:51,  1.74s/it]Processing groups:  48%|████▊     | 48/100 [01:26<00:54,  1.05s/it]Processing groups:  51%|█████     | 51/100 [01:29<00:49,  1.02s/it]Processing groups:  53%|█████▎    | 53/100 [01:29<00:43,  1.08it/s]Processing groups:  62%|██████▏   | 62/100 [01:30<00:22,  1.66it/s]Processing groups:  62%|██████▏   | 62/100 [01:49<00:22,  1.66it/s]Processing groups:  65%|██████▌   | 65/100 [02:02<01:18,  2.24s/it]Processing groups:  66%|██████▌   | 66/100 [02:07<01:22,  2.42s/it]Processing groups:  70%|███████   | 70/100 [02:07<00:52,  1.75s/it]Processing groups:  74%|███████▍  | 74/100 [02:08<00:33,  1.30s/it]Processing groups:  79%|███████▉  | 79/100 [02:09<00:18,  1.13it/s]Processing groups:  83%|████████▎ | 83/100 [02:09<00:11,  1.53it/s]Processing groups:  89%|████████▉ | 89/100 [02:10<00:04,  2.27it/s]Processing groups:  97%|█████████▋| 97/100 [02:13<00:01,  2.20it/s]Processing groups:  98%|█████████▊| 98/100 [02:14<00:00,  2.31it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  2.68it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
{'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.11, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.73it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27216.30it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:15, 42.58s/it]Processing groups:   4%|▍         | 4/100 [00:44<13:46,  8.61s/it]  Processing groups:   7%|▋         | 7/100 [00:45<06:19,  4.08s/it]Processing groups:  25%|██▌       | 25/100 [00:45<00:57,  1.31it/s]Processing groups:  30%|███       | 30/100 [00:46<00:42,  1.66it/s]Processing groups:  30%|███       | 30/100 [01:03<00:42,  1.66it/s]Processing groups:  33%|███▎      | 33/100 [01:21<02:48,  2.52s/it]Processing groups:  34%|███▍      | 34/100 [01:24<02:48,  2.55s/it]Processing groups:  38%|███▊      | 38/100 [01:25<01:57,  1.90s/it]Processing groups:  40%|████      | 40/100 [01:26<01:35,  1.59s/it]Processing groups:  44%|████▍     | 44/100 [01:28<01:10,  1.26s/it]Processing groups:  49%|████▉     | 49/100 [01:28<00:41,  1.24it/s]Processing groups:  51%|█████     | 51/100 [01:29<00:34,  1.42it/s]Processing groups:  54%|█████▍    | 54/100 [01:30<00:28,  1.62it/s]Processing groups:  65%|██████▌   | 65/100 [02:02<01:09,  1.99s/it]Processing groups:  66%|██████▌   | 66/100 [02:05<01:08,  2.01s/it]Processing groups:  67%|██████▋   | 67/100 [02:05<01:01,  1.85s/it]Processing groups:  68%|██████▊   | 68/100 [02:06<00:56,  1.78s/it]Processing groups:  71%|███████   | 71/100 [02:07<00:38,  1.32s/it]Processing groups:  72%|███████▏  | 72/100 [02:08<00:34,  1.25s/it]Processing groups:  75%|███████▌  | 75/100 [02:08<00:19,  1.25it/s]Processing groups:  77%|███████▋  | 77/100 [02:09<00:14,  1.57it/s]Processing groups:  84%|████████▍ | 84/100 [02:09<00:04,  3.25it/s]Processing groups:  86%|████████▌ | 86/100 [02:09<00:03,  3.56it/s]Processing groups:  97%|█████████▋| 97/100 [02:13<00:00,  3.09it/s]Processing groups:  98%|█████████▊| 98/100 [02:13<00:00,  3.18it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.15, 'mean_ap': 0.01, 'mean_ap_p_value': 0.26, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.67it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29456.45it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:03, 42.46s/it]Processing groups:   3%|▎         | 3/100 [00:45<19:28, 12.05s/it]  Processing groups:   7%|▋         | 7/100 [00:45<06:02,  3.89s/it]Processing groups:  13%|█▎        | 13/100 [00:46<02:25,  1.68s/it]Processing groups:  13%|█▎        | 13/100 [00:57<02:25,  1.68s/it]Processing groups:  33%|███▎      | 33/100 [01:19<01:50,  1.65s/it]Processing groups:  34%|███▍      | 34/100 [01:21<01:52,  1.70s/it]Processing groups:  37%|███▋      | 37/100 [01:24<01:36,  1.53s/it]Processing groups:  39%|███▉      | 39/100 [01:25<01:25,  1.40s/it]Processing groups:  41%|████      | 41/100 [01:27<01:18,  1.34s/it]Processing groups:  54%|█████▍    | 54/100 [01:28<00:25,  1.79it/s]Processing groups:  58%|█████▊    | 58/100 [01:29<00:21,  1.96it/s]Processing groups:  59%|█████▉    | 59/100 [01:30<00:22,  1.82it/s]Processing groups:  60%|██████    | 60/100 [01:33<00:29,  1.37it/s]Processing groups:  65%|██████▌   | 65/100 [02:02<01:36,  2.75s/it]Processing groups:  67%|██████▋   | 67/100 [02:05<01:24,  2.56s/it]Processing groups:  72%|███████▏  | 72/100 [02:06<00:44,  1.59s/it]Processing groups:  74%|███████▍  | 74/100 [02:06<00:33,  1.31s/it]Processing groups:  75%|███████▌  | 75/100 [02:06<00:30,  1.21s/it]Processing groups:  78%|███████▊  | 78/100 [02:07<00:18,  1.21it/s]Processing groups:  79%|███████▉  | 79/100 [02:07<00:17,  1.23it/s]Processing groups:  83%|████████▎ | 83/100 [02:08<00:08,  2.01it/s]Processing groups:  86%|████████▌ | 86/100 [02:08<00:05,  2.57it/s]Processing groups:  90%|█████████ | 90/100 [02:08<00:02,  3.98it/s]Processing groups:  92%|█████████▏| 92/100 [02:09<00:01,  4.58it/s]Processing groups:  94%|█████████▍| 94/100 [02:09<00:01,  4.98it/s]Processing groups:  97%|█████████▋| 97/100 [02:13<00:01,  1.79it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.33s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.21, 'mean_ap_p_value': 0.87, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.85it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28906.30it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:12:05, 43.69s/it]Processing groups:   5%|▌         | 5/100 [00:45<10:51,  6.85s/it]  Processing groups:   7%|▋         | 7/100 [00:46<07:03,  4.55s/it]Processing groups:  23%|██▎       | 23/100 [00:48<01:10,  1.09it/s]Processing groups:  33%|███▎      | 33/100 [01:20<02:07,  1.90s/it]Processing groups:  35%|███▌      | 35/100 [01:22<01:55,  1.77s/it]Processing groups:  36%|███▌      | 36/100 [01:25<01:59,  1.87s/it]Processing groups:  39%|███▉      | 39/100 [01:26<01:33,  1.53s/it]Processing groups:  40%|████      | 40/100 [01:26<01:24,  1.41s/it]Processing groups:  43%|████▎     | 43/100 [01:27<00:57,  1.01s/it]Processing groups:  47%|████▋     | 47/100 [01:27<00:38,  1.37it/s]Processing groups:  59%|█████▉    | 59/100 [01:30<00:17,  2.35it/s]Processing groups:  64%|██████▍   | 64/100 [01:32<00:15,  2.38it/s]Processing groups:  65%|██████▌   | 65/100 [02:03<01:29,  2.56s/it]Processing groups:  66%|██████▌   | 66/100 [02:05<01:25,  2.52s/it]Processing groups:  69%|██████▉   | 69/100 [02:08<01:03,  2.05s/it]Processing groups:  77%|███████▋  | 77/100 [02:09<00:25,  1.09s/it]Processing groups:  88%|████████▊ | 88/100 [02:09<00:06,  1.81it/s]Processing groups:  92%|█████████▏| 92/100 [02:10<00:03,  2.14it/s]Processing groups:  97%|█████████▋| 97/100 [02:14<00:01,  1.84it/s]Processing groups:  99%|█████████▉| 99/100 [02:14<00:00,  2.08it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.35s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.16, 'mean_ap': 0.93, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.62it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29040.39it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:08:24, 41.46s/it]Processing groups:   2%|▏         | 2/100 [00:43<29:57, 18.34s/it]  Processing groups:   8%|▊         | 8/100 [00:43<04:43,  3.08s/it]Processing groups:  12%|█▏        | 12/100 [00:44<02:35,  1.76s/it]Processing groups:  14%|█▍        | 14/100 [00:45<02:07,  1.48s/it]Processing groups:  19%|█▉        | 19/100 [00:46<01:12,  1.12it/s]Processing groups:  25%|██▌       | 25/100 [00:47<00:41,  1.80it/s]Processing groups:  33%|███▎      | 33/100 [01:25<02:45,  2.47s/it]Processing groups:  42%|████▏     | 42/100 [01:26<01:24,  1.46s/it]Processing groups:  44%|████▍     | 44/100 [01:27<01:15,  1.35s/it]Processing groups:  47%|████▋     | 47/100 [01:28<01:02,  1.17s/it]Processing groups:  60%|██████    | 60/100 [01:29<00:22,  1.78it/s]Processing groups:  61%|██████    | 61/100 [01:32<00:28,  1.39it/s]Processing groups:  65%|██████▌   | 65/100 [02:07<01:33,  2.68s/it]Processing groups:  72%|███████▏  | 72/100 [02:07<00:47,  1.68s/it]Processing groups:  73%|███████▎  | 73/100 [02:07<00:42,  1.57s/it]Processing groups:  84%|████████▍ | 84/100 [02:08<00:12,  1.27it/s]Processing groups:  93%|█████████▎| 93/100 [02:09<00:03,  2.01it/s]Processing groups:  95%|█████████▌| 95/100 [02:09<00:02,  2.20it/s]Processing groups:  97%|█████████▋| 97/100 [02:13<00:01,  1.51it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.89it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.34s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.34, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.88it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36239.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:09:56, 42.39s/it]Processing groups:   4%|▍         | 4/100 [00:44<13:40,  8.55s/it]  Processing groups:  11%|█         | 11/100 [00:45<03:38,  2.45s/it]Processing groups:  16%|█▌        | 16/100 [00:47<02:10,  1.55s/it]Processing groups:  33%|███▎      | 33/100 [01:22<02:05,  1.88s/it]Processing groups:  34%|███▍      | 34/100 [01:22<01:57,  1.79s/it]Processing groups:  35%|███▌      | 35/100 [01:23<01:52,  1.72s/it]Processing groups:  39%|███▉      | 39/100 [01:26<01:27,  1.44s/it]Processing groups:  40%|████      | 40/100 [01:26<01:19,  1.32s/it]Processing groups:  41%|████      | 41/100 [01:27<01:17,  1.32s/it]Processing groups:  43%|████▎     | 43/100 [01:28<01:01,  1.09s/it]Processing groups:  45%|████▌     | 45/100 [01:31<01:09,  1.26s/it]Processing groups:  61%|██████    | 61/100 [01:32<00:13,  2.79it/s]Processing groups:  65%|██████▌   | 65/100 [02:05<01:10,  2.01s/it]Processing groups:  66%|██████▌   | 66/100 [02:05<01:03,  1.88s/it]Processing groups:  68%|██████▊   | 68/100 [02:07<00:55,  1.74s/it]Processing groups:  73%|███████▎  | 73/100 [02:07<00:29,  1.11s/it]Processing groups:  75%|███████▌  | 75/100 [02:09<00:25,  1.03s/it]Processing groups:  78%|███████▊  | 78/100 [02:10<00:17,  1.22it/s]Processing groups:  80%|████████  | 80/100 [02:10<00:13,  1.46it/s]Processing groups:  85%|████████▌ | 85/100 [02:10<00:06,  2.33it/s]Processing groups:  95%|█████████▌| 95/100 [02:10<00:01,  4.90it/s]Processing groups:  98%|█████████▊| 98/100 [02:15<00:00,  2.38it/s]Processing groups: 100%|██████████| 100/100 [02:15<00:00,  1.35s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 640, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.29it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 24869.87it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:54<1:30:05, 54.60s/it]Processing groups:   3%|▎         | 3/100 [00:57<24:31, 15.17s/it]  Processing groups:  17%|█▋        | 17/100 [00:58<02:36,  1.89s/it]Processing groups:  23%|██▎       | 23/100 [00:59<01:38,  1.28s/it]Processing groups:  33%|███▎      | 33/100 [01:44<03:02,  2.72s/it]Processing groups:  34%|███▍      | 34/100 [01:47<03:03,  2.78s/it]Processing groups:  35%|███▌      | 35/100 [01:48<02:51,  2.64s/it]Processing groups:  36%|███▌      | 36/100 [01:49<02:35,  2.42s/it]Processing groups:  39%|███▉      | 39/100 [01:52<02:03,  2.03s/it]Processing groups:  50%|█████     | 50/100 [01:53<00:39,  1.26it/s]Processing groups:  58%|█████▊    | 58/100 [01:53<00:21,  1.98it/s]Processing groups:  62%|██████▏   | 62/100 [01:53<00:15,  2.39it/s]Processing groups:  64%|██████▍   | 64/100 [01:55<00:17,  2.03it/s]Processing groups:  65%|██████▌   | 65/100 [02:38<02:25,  4.17s/it]Processing groups:  66%|██████▌   | 66/100 [02:40<02:14,  3.95s/it]Processing groups:  67%|██████▋   | 67/100 [02:43<02:07,  3.85s/it]Processing groups:  70%|███████   | 70/100 [02:43<01:13,  2.46s/it]Processing groups:  72%|███████▏  | 72/100 [02:44<00:51,  1.84s/it]Processing groups:  77%|███████▋  | 77/100 [02:44<00:23,  1.00s/it]Processing groups:  78%|███████▊  | 78/100 [02:44<00:19,  1.11it/s]Processing groups:  81%|████████  | 81/100 [02:45<00:12,  1.58it/s]Processing groups:  83%|████████▎ | 83/100 [02:45<00:09,  1.82it/s]Processing groups:  88%|████████▊ | 88/100 [02:45<00:03,  3.15it/s]Processing groups:  90%|█████████ | 90/100 [02:46<00:02,  3.69it/s]Processing groups:  97%|█████████▋| 97/100 [02:51<00:01,  1.97it/s]Processing groups:  98%|█████████▊| 98/100 [02:51<00:00,  2.06it/s]Processing groups: 100%|██████████| 100/100 [02:51<00:00,  1.72s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.29it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34438.82it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:55<1:31:55, 55.71s/it]Processing groups:   3%|▎         | 3/100 [00:56<23:54, 14.79s/it]  Processing groups:   4%|▍         | 4/100 [00:58<16:27, 10.28s/it]Processing groups:  33%|███▎      | 33/100 [01:45<02:27,  2.20s/it]Processing groups:  34%|███▍      | 34/100 [01:49<02:29,  2.27s/it]Processing groups:  39%|███▉      | 39/100 [01:52<01:52,  1.84s/it]Processing groups:  50%|█████     | 50/100 [01:52<00:53,  1.06s/it]Processing groups:  52%|█████▏    | 52/100 [01:54<00:50,  1.05s/it]Processing groups:  64%|██████▍   | 64/100 [01:54<00:21,  1.70it/s]Processing groups:  64%|██████▍   | 64/100 [02:11<00:21,  1.70it/s]Processing groups:  65%|██████▌   | 65/100 [02:38<01:38,  2.82s/it]Processing groups:  66%|██████▌   | 66/100 [02:42<01:39,  2.93s/it]Processing groups:  72%|███████▏  | 72/100 [02:43<00:52,  1.87s/it]Processing groups:  73%|███████▎  | 73/100 [02:45<00:50,  1.88s/it]Processing groups:  77%|███████▋  | 77/100 [02:45<00:30,  1.32s/it]Processing groups:  79%|███████▉  | 79/100 [02:46<00:23,  1.13s/it]Processing groups:  96%|█████████▌| 96/100 [02:46<00:01,  2.80it/s]Processing groups:  99%|█████████▉| 99/100 [02:51<00:00,  1.78it/s]Processing groups: 100%|██████████| 100/100 [02:51<00:00,  1.72s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.08, 'mean_ap': 0.01, 'mean_ap_p_value': 0.09, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.35it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 34158.35it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:54<1:29:35, 54.29s/it]Processing groups:   2%|▏         | 2/100 [00:54<36:55, 22.61s/it]  Processing groups:   3%|▎         | 3/100 [00:54<19:58, 12.36s/it]Processing groups:   4%|▍         | 4/100 [00:55<12:20,  7.71s/it]Processing groups:   8%|▊         | 8/100 [00:56<04:00,  2.62s/it]Processing groups:  14%|█▍        | 14/100 [00:57<01:37,  1.14s/it]Processing groups:  19%|█▉        | 19/100 [00:58<00:59,  1.37it/s]Processing groups:  32%|███▏      | 32/100 [00:59<00:21,  3.11it/s]Processing groups:  33%|███▎      | 33/100 [01:44<03:30,  3.14s/it]Processing groups:  35%|███▌      | 35/100 [01:47<03:07,  2.89s/it]Processing groups:  38%|███▊      | 38/100 [01:49<02:24,  2.34s/it]Processing groups:  39%|███▉      | 39/100 [01:52<02:25,  2.39s/it]Processing groups:  56%|█████▌    | 56/100 [01:53<00:31,  1.41it/s]Processing groups:  62%|██████▏   | 62/100 [01:57<00:26,  1.45it/s]Processing groups:  63%|██████▎   | 63/100 [01:57<00:25,  1.44it/s]Processing groups:  65%|██████▌   | 65/100 [02:34<01:55,  3.30s/it]Processing groups:  66%|██████▌   | 66/100 [02:42<02:05,  3.70s/it]Processing groups:  69%|██████▉   | 69/100 [02:42<01:22,  2.67s/it]Processing groups:  73%|███████▎  | 73/100 [02:43<00:48,  1.78s/it]Processing groups:  78%|███████▊  | 78/100 [02:44<00:25,  1.14s/it]Processing groups:  80%|████████  | 80/100 [02:44<00:19,  1.01it/s]Processing groups:  84%|████████▍ | 84/100 [02:44<00:10,  1.50it/s]Processing groups:  86%|████████▌ | 86/100 [02:45<00:07,  1.81it/s]Processing groups:  89%|████████▉ | 89/100 [02:45<00:04,  2.24it/s]Processing groups:  92%|█████████▏| 92/100 [02:45<00:02,  2.99it/s]Processing groups:  95%|█████████▌| 95/100 [02:46<00:01,  3.20it/s]Processing groups:  97%|█████████▋| 97/100 [02:51<00:02,  1.39it/s]Processing groups:  98%|█████████▊| 98/100 [02:51<00:01,  1.54it/s]Processing groups:  99%|█████████▉| 99/100 [02:51<00:00,  1.74it/s]Processing groups: 100%|██████████| 100/100 [02:51<00:00,  1.71s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.33, 'mean_ap': 0.0, 'mean_ap_p_value': 0.3, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.31it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29922.98it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:24:08, 51.00s/it]Processing groups:   2%|▏         | 2/100 [00:57<40:06, 24.56s/it]  Processing groups:   8%|▊         | 8/100 [00:58<06:27,  4.22s/it]Processing groups:  18%|█▊        | 18/100 [00:58<01:56,  1.42s/it]Processing groups:  22%|██▏       | 22/100 [01:00<01:30,  1.17s/it]Processing groups:  22%|██▏       | 22/100 [01:14<01:30,  1.17s/it]Processing groups:  33%|███▎      | 33/100 [01:47<03:08,  2.81s/it]Processing groups:  37%|███▋      | 37/100 [01:50<02:29,  2.38s/it]Processing groups:  49%|████▉     | 49/100 [01:54<01:09,  1.37s/it]Processing groups:  55%|█████▌    | 55/100 [01:54<00:46,  1.03s/it]Processing groups:  62%|██████▏   | 62/100 [01:56<00:30,  1.25it/s]Processing groups:  64%|██████▍   | 64/100 [01:58<00:29,  1.23it/s]Processing groups:  65%|██████▌   | 65/100 [02:37<02:05,  3.57s/it]Processing groups:  66%|██████▌   | 66/100 [02:43<02:10,  3.84s/it]Processing groups:  73%|███████▎  | 73/100 [02:44<00:54,  2.02s/it]Processing groups:  75%|███████▌  | 75/100 [02:45<00:45,  1.83s/it]Processing groups:  90%|█████████ | 90/100 [02:46<00:06,  1.49it/s]Processing groups:  95%|█████████▌| 95/100 [02:46<00:02,  1.89it/s]Processing groups:  98%|█████████▊| 98/100 [02:51<00:01,  1.40it/s]Processing groups: 100%|██████████| 100/100 [02:51<00:00,  1.59it/s]Processing groups: 100%|██████████| 100/100 [02:51<00:00,  1.72s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.35, 'mean_ap': 0.12, 'mean_ap_p_value': 0.91, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.35it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31338.19it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:51<1:24:40, 51.32s/it]Processing groups:   2%|▏         | 2/100 [00:55<38:33, 23.60s/it]  Processing groups:   8%|▊         | 8/100 [00:56<06:07,  4.00s/it]Processing groups:  17%|█▋        | 17/100 [00:58<02:10,  1.57s/it]Processing groups:  33%|███▎      | 33/100 [01:43<02:38,  2.36s/it]Processing groups:  34%|███▍      | 34/100 [01:45<02:32,  2.32s/it]Processing groups:  36%|███▌      | 36/100 [01:48<02:24,  2.26s/it]Processing groups:  39%|███▉      | 39/100 [01:51<01:57,  1.93s/it]Processing groups:  43%|████▎     | 43/100 [01:53<01:28,  1.55s/it]Processing groups:  64%|██████▍   | 64/100 [01:54<00:18,  1.94it/s]Processing groups:  65%|██████▌   | 65/100 [02:38<01:25,  2.44s/it]Processing groups:  66%|██████▌   | 66/100 [02:39<01:20,  2.38s/it]Processing groups:  67%|██████▋   | 67/100 [02:42<01:19,  2.40s/it]Processing groups:  70%|███████   | 70/100 [02:43<00:55,  1.86s/it]Processing groups:  71%|███████   | 71/100 [02:43<00:49,  1.70s/it]Processing groups:  73%|███████▎  | 73/100 [02:43<00:36,  1.35s/it]Processing groups:  74%|███████▍  | 74/100 [02:44<00:32,  1.26s/it]Processing groups:  79%|███████▉  | 79/100 [02:44<00:13,  1.57it/s]Processing groups:  81%|████████  | 81/100 [02:45<00:10,  1.76it/s]Processing groups:  87%|████████▋ | 87/100 [02:45<00:03,  3.33it/s]Processing groups:  90%|█████████ | 90/100 [02:45<00:02,  4.21it/s]Processing groups:  94%|█████████▍| 94/100 [02:46<00:01,  4.77it/s]Processing groups:  97%|█████████▋| 97/100 [02:51<00:01,  1.71it/s]Processing groups:  99%|█████████▉| 99/100 [02:51<00:00,  2.06it/s]Processing groups: 100%|██████████| 100/100 [02:51<00:00,  1.71s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.87, 'mean_ap': 0.88, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.40it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28587.13it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:26:03, 52.15s/it]Processing groups:   2%|▏         | 2/100 [00:54<37:37, 23.03s/it]  Processing groups:   3%|▎         | 3/100 [00:57<22:31, 13.93s/it]Processing groups:  33%|███▎      | 33/100 [01:45<02:26,  2.19s/it]Processing groups:  35%|███▌      | 35/100 [01:50<02:22,  2.19s/it]Processing groups:  43%|████▎     | 43/100 [01:50<01:25,  1.50s/it]Processing groups:  44%|████▍     | 44/100 [01:51<01:22,  1.47s/it]Processing groups:  58%|█████▊    | 58/100 [01:51<00:29,  1.41it/s]Processing groups:  61%|██████    | 61/100 [01:53<00:27,  1.42it/s]Processing groups:  64%|██████▍   | 64/100 [01:54<00:23,  1.56it/s]Processing groups:  64%|██████▍   | 64/100 [02:07<00:23,  1.56it/s]Processing groups:  65%|██████▌   | 65/100 [02:40<02:17,  3.91s/it]Processing groups:  66%|██████▌   | 66/100 [02:41<02:05,  3.69s/it]Processing groups:  68%|██████▊   | 68/100 [02:44<01:44,  3.25s/it]Processing groups:  74%|███████▍  | 74/100 [02:46<00:47,  1.84s/it]Processing groups:  83%|████████▎ | 83/100 [02:46<00:15,  1.08it/s]Processing groups:  88%|████████▊ | 88/100 [02:47<00:08,  1.47it/s]Processing groups:  97%|█████████▋| 97/100 [02:52<00:01,  1.54it/s]Processing groups:  99%|█████████▉| 99/100 [02:52<00:00,  1.73it/s]Processing groups: 100%|██████████| 100/100 [02:52<00:00,  1.73s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.27it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27166.94it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:53<1:28:34, 53.69s/it]Processing groups:   2%|▏         | 2/100 [00:54<36:29, 22.34s/it]  Processing groups:   3%|▎         | 3/100 [00:55<20:40, 12.79s/it]Processing groups:   4%|▍         | 4/100 [00:55<12:40,  7.92s/it]Processing groups:   6%|▌         | 6/100 [00:57<06:34,  4.20s/it]Processing groups:  11%|█         | 11/100 [00:58<02:23,  1.61s/it]Processing groups:  33%|███▎      | 33/100 [01:47<02:18,  2.07s/it]Processing groups:  34%|███▍      | 34/100 [01:49<02:18,  2.10s/it]Processing groups:  36%|███▌      | 36/100 [01:50<01:59,  1.86s/it]Processing groups:  37%|███▋      | 37/100 [01:51<01:53,  1.80s/it]Processing groups:  39%|███▉      | 39/100 [01:52<01:37,  1.60s/it]Processing groups:  40%|████      | 40/100 [01:53<01:31,  1.52s/it]Processing groups:  43%|████▎     | 43/100 [01:54<01:00,  1.07s/it]Processing groups:  51%|█████     | 51/100 [01:55<00:27,  1.80it/s]Processing groups:  57%|█████▋    | 57/100 [01:56<00:16,  2.56it/s]Processing groups:  64%|██████▍   | 64/100 [01:58<00:13,  2.75it/s]Processing groups:  65%|██████▌   | 65/100 [02:42<02:04,  3.55s/it]Processing groups:  66%|██████▌   | 66/100 [02:44<01:56,  3.43s/it]Processing groups:  69%|██████▉   | 69/100 [02:44<01:16,  2.45s/it]Processing groups:  71%|███████   | 71/100 [02:47<01:03,  2.17s/it]Processing groups:  78%|███████▊  | 78/100 [02:48<00:24,  1.12s/it]Processing groups:  83%|████████▎ | 83/100 [02:48<00:13,  1.26it/s]Processing groups:  96%|█████████▌| 96/100 [02:49<00:01,  2.79it/s]Processing groups:  98%|█████████▊| 98/100 [02:54<00:01,  1.65it/s]Processing groups: 100%|██████████| 100/100 [02:54<00:00,  1.74s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 640, 'differ_params': 1}

Processing n_plates: 4

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.33it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38757.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:14, 37.72s/it]Processing groups:  11%|█         | 11/100 [00:38<03:46,  2.55s/it] Processing groups:  16%|█▌        | 16/100 [00:40<02:22,  1.69s/it]Processing groups:  22%|██▏       | 22/100 [00:41<01:20,  1.04s/it]Processing groups:  33%|███▎      | 33/100 [01:10<02:06,  1.89s/it]Processing groups:  34%|███▍      | 34/100 [01:11<02:02,  1.85s/it]Processing groups:  35%|███▌      | 35/100 [01:12<01:51,  1.72s/it]Processing groups:  38%|███▊      | 38/100 [01:14<01:32,  1.49s/it]Processing groups:  39%|███▉      | 39/100 [01:15<01:23,  1.37s/it]Processing groups:  47%|████▋     | 47/100 [01:17<00:38,  1.36it/s]Processing groups:  55%|█████▌    | 55/100 [01:18<00:23,  1.94it/s]Processing groups:  56%|█████▌    | 56/100 [01:19<00:23,  1.85it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<00:57,  1.63s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<00:58,  1.73s/it]Processing groups:  67%|██████▋   | 67/100 [01:48<00:52,  1.58s/it]Processing groups:  68%|██████▊   | 68/100 [01:49<00:51,  1.60s/it]Processing groups:  75%|███████▌  | 75/100 [01:51<00:22,  1.13it/s]Processing groups:  84%|████████▍ | 84/100 [01:51<00:07,  2.18it/s]Processing groups:  87%|████████▋ | 87/100 [01:52<00:05,  2.59it/s]Processing groups:  93%|█████████▎| 93/100 [01:52<00:01,  3.59it/s]Processing groups:  96%|█████████▌| 96/100 [01:53<00:01,  3.95it/s]Processing groups:  98%|█████████▊| 98/100 [01:55<00:00,  2.33it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.01, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.25it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32291.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:12, 37.70s/it]Processing groups:   2%|▏         | 2/100 [00:41<28:36, 17.52s/it]  Processing groups:  17%|█▋        | 17/100 [00:41<01:48,  1.30s/it]Processing groups:  21%|██        | 21/100 [00:42<01:23,  1.05s/it]Processing groups:  21%|██        | 21/100 [00:59<01:23,  1.05s/it]Processing groups:  33%|███▎      | 33/100 [01:13<02:02,  1.83s/it]Processing groups:  39%|███▉      | 39/100 [01:14<01:24,  1.38s/it]Processing groups:  41%|████      | 41/100 [01:17<01:23,  1.42s/it]Processing groups:  51%|█████     | 51/100 [01:18<00:39,  1.25it/s]Processing groups:  54%|█████▍    | 54/100 [01:20<00:35,  1.29it/s]Processing groups:  63%|██████▎   | 63/100 [01:22<00:20,  1.78it/s]Processing groups:  65%|██████▌   | 65/100 [01:48<01:09,  2.00s/it]Processing groups:  68%|██████▊   | 68/100 [01:51<00:58,  1.81s/it]Processing groups:  71%|███████   | 71/100 [01:53<00:44,  1.55s/it]Processing groups:  77%|███████▋  | 77/100 [01:53<00:22,  1.03it/s]Processing groups:  82%|████████▏ | 82/100 [01:54<00:13,  1.37it/s]Processing groups:  95%|█████████▌| 95/100 [01:55<00:01,  2.81it/s]Processing groups:  97%|█████████▋| 97/100 [01:57<00:01,  2.26it/s]Processing groups:  98%|█████████▊| 98/100 [01:57<00:00,  2.37it/s]Processing groups:  99%|█████████▉| 99/100 [01:57<00:00,  2.49it/s]Processing groups: 100%|██████████| 100/100 [01:57<00:00,  1.18s/it]
{'replicate_reproducibility': 0.011666666666666667, 'mp_value': 0.2, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.10it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 25001.81it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:39<1:04:46, 39.26s/it]Processing groups:  10%|█         | 10/100 [00:40<04:25,  2.96s/it] Processing groups:  29%|██▉       | 29/100 [00:41<00:58,  1.22it/s]Processing groups:  29%|██▉       | 29/100 [00:59<00:58,  1.22it/s]Processing groups:  33%|███▎      | 33/100 [01:07<02:02,  1.83s/it]Processing groups:  34%|███▍      | 34/100 [01:08<02:00,  1.83s/it]Processing groups:  36%|███▌      | 36/100 [01:11<01:51,  1.74s/it]Processing groups:  40%|████      | 40/100 [01:13<01:22,  1.37s/it]Processing groups:  42%|████▏     | 42/100 [01:16<01:19,  1.36s/it]Processing groups:  45%|████▌     | 45/100 [01:17<01:01,  1.12s/it]Processing groups:  48%|████▊     | 48/100 [01:19<00:51,  1.01it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<00:49,  1.41s/it]Processing groups:  68%|██████▊   | 68/100 [01:47<00:39,  1.25s/it]Processing groups:  69%|██████▉   | 69/100 [01:48<00:39,  1.27s/it]Processing groups:  70%|███████   | 70/100 [01:49<00:36,  1.23s/it]Processing groups:  72%|███████▏  | 72/100 [01:50<00:28,  1.02s/it]Processing groups:  73%|███████▎  | 73/100 [01:50<00:24,  1.09it/s]Processing groups:  76%|███████▌  | 76/100 [01:50<00:15,  1.52it/s]Processing groups:  77%|███████▋  | 77/100 [01:50<00:13,  1.71it/s]Processing groups:  78%|███████▊  | 78/100 [01:51<00:11,  1.88it/s]Processing groups:  79%|███████▉  | 79/100 [01:52<00:14,  1.46it/s]Processing groups:  82%|████████▏ | 82/100 [01:52<00:07,  2.40it/s]Processing groups:  84%|████████▍ | 84/100 [01:53<00:05,  2.99it/s]Processing groups:  89%|████████▉ | 89/100 [01:53<00:01,  5.65it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:00,  4.19it/s]Processing groups:  99%|█████████▉| 99/100 [01:56<00:00,  4.18it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.15, 'mean_ap': 0.0, 'mean_ap_p_value': 0.22, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.13it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32653.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:57, 34.52s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:10, 14.80s/it]Processing groups:   4%|▍         | 4/100 [00:36<09:17,  5.80s/it]Processing groups:   5%|▌         | 5/100 [00:39<07:48,  4.93s/it]Processing groups:  16%|█▌        | 16/100 [00:42<01:30,  1.08s/it]Processing groups:  33%|███▎      | 33/100 [01:08<01:32,  1.38s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:27,  1.32s/it]Processing groups:  36%|███▌      | 36/100 [01:12<01:26,  1.35s/it]Processing groups:  39%|███▉      | 39/100 [01:15<01:17,  1.27s/it]Processing groups:  45%|████▌     | 45/100 [01:16<00:49,  1.12it/s]Processing groups:  48%|████▊     | 48/100 [01:17<00:39,  1.33it/s]Processing groups:  56%|█████▌    | 56/100 [01:18<00:21,  2.06it/s]Processing groups:  57%|█████▋    | 57/100 [01:20<00:24,  1.76it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<01:01,  1.75s/it]Processing groups:  68%|██████▊   | 68/100 [01:45<00:45,  1.41s/it]Processing groups:  69%|██████▉   | 69/100 [01:48<00:48,  1.57s/it]Processing groups:  70%|███████   | 70/100 [01:51<00:49,  1.65s/it]Processing groups:  72%|███████▏  | 72/100 [01:52<00:40,  1.44s/it]Processing groups:  84%|████████▍ | 84/100 [01:52<00:07,  2.06it/s]Processing groups:  87%|████████▋ | 87/100 [01:53<00:05,  2.33it/s]Processing groups:  89%|████████▉ | 89/100 [01:54<00:04,  2.46it/s]Processing groups:  97%|█████████▋| 97/100 [01:56<00:01,  2.98it/s]Processing groups:  98%|█████████▊| 98/100 [01:56<00:00,  2.97it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 0.14, 'mean_ap_p_value': 0.9, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.34it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33140.83it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<57:06, 34.61s/it]Processing groups:   3%|▎         | 3/100 [00:38<16:47, 10.39s/it]Processing groups:  22%|██▏       | 22/100 [00:39<01:16,  1.01it/s]Processing groups:  29%|██▉       | 29/100 [00:41<00:55,  1.29it/s]Processing groups:  33%|███▎      | 33/100 [01:10<02:20,  2.09s/it]Processing groups:  35%|███▌      | 35/100 [01:13<02:11,  2.02s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:47,  1.71s/it]Processing groups:  42%|████▏     | 42/100 [01:14<01:07,  1.16s/it]Processing groups:  47%|████▋     | 47/100 [01:15<00:45,  1.17it/s]Processing groups:  48%|████▊     | 48/100 [01:15<00:42,  1.23it/s]Processing groups:  50%|█████     | 50/100 [01:15<00:33,  1.49it/s]Processing groups:  51%|█████     | 51/100 [01:16<00:30,  1.61it/s]Processing groups:  53%|█████▎    | 53/100 [01:17<00:30,  1.55it/s]Processing groups:  56%|█████▌    | 56/100 [01:19<00:27,  1.61it/s]Processing groups:  63%|██████▎   | 63/100 [01:20<00:13,  2.71it/s]Processing groups:  65%|██████▌   | 65/100 [01:48<01:40,  2.88s/it]Processing groups:  71%|███████   | 71/100 [01:48<00:47,  1.63s/it]Processing groups:  74%|███████▍  | 74/100 [01:51<00:37,  1.45s/it]Processing groups:  84%|████████▍ | 84/100 [01:52<00:11,  1.36it/s]Processing groups:  88%|████████▊ | 88/100 [01:52<00:06,  1.76it/s]Processing groups:  96%|█████████▌| 96/100 [01:52<00:01,  2.81it/s]Processing groups:  99%|█████████▉| 99/100 [01:55<00:00,  2.19it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 0.89, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.30it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28299.74it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:38<1:03:59, 38.78s/it]Processing groups:   7%|▋         | 7/100 [00:40<06:41,  4.32s/it]  Processing groups:  27%|██▋       | 27/100 [00:41<01:03,  1.14it/s]Processing groups:  27%|██▋       | 27/100 [00:56<01:03,  1.14it/s]Processing groups:  33%|███▎      | 33/100 [01:09<02:02,  1.83s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:54,  1.73s/it]Processing groups:  36%|███▌      | 36/100 [01:10<01:39,  1.55s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:45,  1.67s/it]Processing groups:  39%|███▉      | 39/100 [01:15<01:33,  1.53s/it]Processing groups:  45%|████▌     | 45/100 [01:17<00:55,  1.00s/it]Processing groups:  53%|█████▎    | 53/100 [01:19<00:29,  1.61it/s]Processing groups:  55%|█████▌    | 55/100 [01:19<00:25,  1.79it/s]Processing groups:  60%|██████    | 60/100 [01:20<00:15,  2.52it/s]Processing groups:  61%|██████    | 61/100 [01:21<00:20,  1.94it/s]Processing groups:  64%|██████▍   | 64/100 [01:22<00:15,  2.26it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:52,  3.22s/it]Processing groups:  66%|██████▌   | 66/100 [01:48<01:40,  2.96s/it]Processing groups:  69%|██████▉   | 69/100 [01:49<01:00,  1.94s/it]Processing groups:  72%|███████▏  | 72/100 [01:50<00:41,  1.47s/it]Processing groups:  79%|███████▉  | 79/100 [01:51<00:15,  1.39it/s]Processing groups:  82%|████████▏ | 82/100 [01:52<00:10,  1.69it/s]Processing groups:  83%|████████▎ | 83/100 [01:52<00:09,  1.82it/s]Processing groups:  89%|████████▉ | 89/100 [01:52<00:03,  3.05it/s]Processing groups:  90%|█████████ | 90/100 [01:53<00:03,  2.93it/s]Processing groups:  94%|█████████▍| 94/100 [01:53<00:01,  4.14it/s]Processing groups:  96%|█████████▌| 96/100 [01:53<00:00,  4.39it/s]Processing groups:  97%|█████████▋| 97/100 [01:56<00:01,  1.86it/s]Processing groups:  98%|█████████▊| 98/100 [01:56<00:00,  2.11it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  1.17s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.5, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.17it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29324.65it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:53, 33.87s/it]Processing groups:   2%|▏         | 2/100 [00:40<29:22, 17.99s/it]Processing groups:  33%|███▎      | 33/100 [01:07<01:40,  1.50s/it]Processing groups:  34%|███▍      | 34/100 [01:10<01:44,  1.58s/it]Processing groups:  38%|███▊      | 38/100 [01:12<01:24,  1.36s/it]Processing groups:  39%|███▉      | 39/100 [01:13<01:21,  1.33s/it]Processing groups:  40%|████      | 40/100 [01:15<01:22,  1.37s/it]Processing groups:  42%|████▏     | 42/100 [01:16<01:09,  1.20s/it]Processing groups:  53%|█████▎    | 53/100 [01:17<00:24,  1.94it/s]Processing groups:  54%|█████▍    | 54/100 [01:17<00:22,  2.06it/s]Processing groups:  62%|██████▏   | 62/100 [01:17<00:10,  3.52it/s]Processing groups:  64%|██████▍   | 64/100 [01:19<00:13,  2.76it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:36,  2.75s/it]Processing groups:  67%|██████▋   | 67/100 [01:46<01:14,  2.25s/it]Processing groups:  68%|██████▊   | 68/100 [01:50<01:17,  2.41s/it]Processing groups:  75%|███████▌  | 75/100 [01:50<00:27,  1.11s/it]Processing groups:  87%|████████▋ | 87/100 [01:51<00:06,  2.07it/s]Processing groups:  90%|█████████ | 90/100 [01:51<00:04,  2.34it/s]Processing groups:  92%|█████████▏| 92/100 [01:52<00:03,  2.57it/s]Processing groups:  96%|█████████▌| 96/100 [01:52<00:01,  3.34it/s]Processing groups:  98%|█████████▊| 98/100 [01:55<00:00,  2.02it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.78, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 640, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.56it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31900.70it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:21:17, 49.26s/it]Processing groups:   2%|▏         | 2/100 [00:51<35:03, 21.46s/it]  Processing groups:  22%|██▏       | 22/100 [00:51<01:35,  1.22s/it]Processing groups:  32%|███▏      | 32/100 [00:52<00:51,  1.32it/s]Processing groups:  32%|███▏      | 32/100 [01:11<00:51,  1.32it/s]Processing groups:  33%|███▎      | 33/100 [01:27<02:56,  2.63s/it]Processing groups:  34%|███▍      | 34/100 [01:30<02:55,  2.66s/it]Processing groups:  36%|███▌      | 36/100 [01:37<02:58,  2.80s/it]Processing groups:  50%|█████     | 50/100 [01:38<00:54,  1.10s/it]Processing groups:  59%|█████▉    | 59/100 [01:39<00:29,  1.37it/s]Processing groups:  61%|██████    | 61/100 [01:40<00:27,  1.41it/s]Processing groups:  62%|██████▏   | 62/100 [01:41<00:25,  1.47it/s]Processing groups:  64%|██████▍   | 64/100 [01:41<00:20,  1.73it/s]Processing groups:  65%|██████▌   | 65/100 [02:14<02:22,  4.08s/it]Processing groups:  67%|██████▋   | 67/100 [02:19<02:01,  3.68s/it]Processing groups:  70%|███████   | 70/100 [02:21<01:20,  2.69s/it]Processing groups:  74%|███████▍  | 74/100 [02:22<00:45,  1.75s/it]Processing groups:  78%|███████▊  | 78/100 [02:23<00:26,  1.22s/it]Processing groups:  81%|████████  | 81/100 [02:24<00:17,  1.12it/s]Processing groups:  90%|█████████ | 90/100 [02:25<00:04,  2.05it/s]Processing groups:  97%|█████████▋| 97/100 [02:29<00:01,  1.96it/s]Processing groups: 100%|██████████| 100/100 [02:29<00:00,  1.49s/it]
{'replicate_reproducibility': 0.03166666666666667, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.75it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 21350.49it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:18:20, 47.48s/it]Processing groups:   4%|▍         | 4/100 [00:48<14:41,  9.18s/it]  Processing groups:   6%|▌         | 6/100 [00:50<08:44,  5.58s/it]Processing groups:  12%|█▏        | 12/100 [00:50<02:55,  1.99s/it]Processing groups:  23%|██▎       | 23/100 [00:51<01:00,  1.27it/s]Processing groups:  26%|██▌       | 26/100 [00:53<00:54,  1.35it/s]Processing groups:  33%|███▎      | 33/100 [01:31<02:54,  2.60s/it]Processing groups:  35%|███▌      | 35/100 [01:34<02:42,  2.50s/it]Processing groups:  37%|███▋      | 37/100 [01:35<02:12,  2.11s/it]Processing groups:  42%|████▏     | 42/100 [01:36<01:23,  1.43s/it]Processing groups:  47%|████▋     | 47/100 [01:38<00:57,  1.08s/it]Processing groups:  55%|█████▌    | 55/100 [01:39<00:29,  1.53it/s]Processing groups:  61%|██████    | 61/100 [01:40<00:18,  2.08it/s]Processing groups:  63%|██████▎   | 63/100 [01:42<00:21,  1.75it/s]Processing groups:  64%|██████▍   | 64/100 [01:47<00:34,  1.03it/s]Processing groups:  65%|██████▌   | 65/100 [02:17<02:23,  4.09s/it]Processing groups:  66%|██████▌   | 66/100 [02:17<02:04,  3.66s/it]Processing groups:  67%|██████▋   | 67/100 [02:20<01:54,  3.48s/it]Processing groups:  70%|███████   | 70/100 [02:20<01:03,  2.10s/it]Processing groups:  71%|███████   | 71/100 [02:21<00:54,  1.89s/it]Processing groups:  77%|███████▋  | 77/100 [02:22<00:18,  1.23it/s]Processing groups:  79%|███████▉  | 79/100 [02:22<00:15,  1.36it/s]Processing groups:  82%|████████▏ | 82/100 [02:23<00:09,  1.93it/s]Processing groups:  91%|█████████ | 91/100 [02:23<00:02,  4.34it/s]Processing groups:  94%|█████████▍| 94/100 [02:23<00:01,  4.36it/s]Processing groups:  96%|█████████▌| 96/100 [02:25<00:01,  3.42it/s]Processing groups:  98%|█████████▊| 98/100 [02:28<00:01,  1.77it/s]Processing groups: 100%|██████████| 100/100 [02:28<00:00,  1.49s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.06, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.58it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1296.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:22:58, 50.29s/it]Processing groups:   7%|▋         | 7/100 [00:51<08:26,  5.45s/it]  Processing groups:   9%|▉         | 9/100 [00:52<05:53,  3.88s/it]Processing groups:  33%|███▎      | 33/100 [01:32<02:17,  2.05s/it]Processing groups:  34%|███▍      | 34/100 [01:33<02:11,  1.99s/it]Processing groups:  35%|███▌      | 35/100 [01:34<02:04,  1.91s/it]Processing groups:  37%|███▋      | 37/100 [01:36<01:54,  1.82s/it]Processing groups:  45%|████▌     | 45/100 [01:36<00:54,  1.02it/s]Processing groups:  48%|████▊     | 48/100 [01:38<00:46,  1.12it/s]Processing groups:  50%|█████     | 50/100 [01:39<00:39,  1.27it/s]Processing groups:  55%|█████▌    | 55/100 [01:41<00:29,  1.54it/s]Processing groups:  63%|██████▎   | 63/100 [01:41<00:14,  2.59it/s]Processing groups:  65%|██████▌   | 65/100 [02:19<01:44,  2.98s/it]Processing groups:  67%|██████▋   | 67/100 [02:23<01:32,  2.79s/it]Processing groups:  81%|████████  | 81/100 [02:24<00:21,  1.11s/it]Processing groups:  90%|█████████ | 90/100 [02:24<00:07,  1.40it/s]Processing groups:  93%|█████████▎| 93/100 [02:25<00:04,  1.61it/s]Processing groups:  97%|█████████▋| 97/100 [02:29<00:02,  1.38it/s]Processing groups: 100%|██████████| 100/100 [02:29<00:00,  1.50s/it]
{'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.36, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.69it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29547.76it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:21:38, 49.48s/it]Processing groups:  12%|█▏        | 12/100 [00:50<04:28,  3.05s/it] Processing groups:  21%|██        | 21/100 [00:51<02:00,  1.52s/it]Processing groups:  33%|███▎      | 33/100 [01:30<02:38,  2.36s/it]Processing groups:  34%|███▍      | 34/100 [01:33<02:39,  2.42s/it]Processing groups:  36%|███▌      | 36/100 [01:34<02:15,  2.12s/it]Processing groups:  37%|███▋      | 37/100 [01:35<02:08,  2.04s/it]Processing groups:  38%|███▊      | 38/100 [01:36<02:01,  1.95s/it]Processing groups:  48%|████▊     | 48/100 [01:38<00:44,  1.17it/s]Processing groups:  52%|█████▏    | 52/100 [01:39<00:33,  1.45it/s]Processing groups:  58%|█████▊    | 58/100 [01:41<00:23,  1.77it/s]Processing groups:  62%|██████▏   | 62/100 [01:41<00:17,  2.23it/s]Processing groups:  64%|██████▍   | 64/100 [01:43<00:17,  2.02it/s]Processing groups:  65%|██████▌   | 65/100 [02:13<02:00,  3.44s/it]Processing groups:  66%|██████▌   | 66/100 [02:22<02:22,  4.18s/it]Processing groups:  69%|██████▉   | 69/100 [02:23<01:25,  2.77s/it]Processing groups:  79%|███████▉  | 79/100 [02:24<00:23,  1.10s/it]Processing groups:  83%|████████▎ | 83/100 [02:24<00:14,  1.16it/s]Processing groups:  92%|█████████▏| 92/100 [02:25<00:03,  2.11it/s]Processing groups:  95%|█████████▌| 95/100 [02:25<00:02,  2.40it/s]Processing groups:  97%|█████████▋| 97/100 [02:29<00:01,  1.63it/s]Processing groups:  99%|█████████▉| 99/100 [02:29<00:00,  1.81it/s]Processing groups: 100%|██████████| 100/100 [02:29<00:00,  1.50s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.01, 'mean_ap_p_value': 0.96, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.47it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30532.90it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:21:11, 49.21s/it]Processing groups:   5%|▌         | 5/100 [00:50<12:10,  7.69s/it]  Processing groups:  11%|█         | 11/100 [00:52<04:14,  2.86s/it]Processing groups:  33%|███▎      | 33/100 [01:28<02:09,  1.93s/it]Processing groups:  34%|███▍      | 34/100 [01:35<02:22,  2.16s/it]Processing groups:  39%|███▉      | 39/100 [01:36<01:40,  1.65s/it]Processing groups:  41%|████      | 41/100 [01:37<01:29,  1.53s/it]Processing groups:  42%|████▏     | 42/100 [01:40<01:34,  1.62s/it]Processing groups:  49%|████▉     | 49/100 [01:41<00:49,  1.04it/s]Processing groups:  57%|█████▋    | 57/100 [01:42<00:25,  1.68it/s]Processing groups:  63%|██████▎   | 63/100 [01:42<00:16,  2.28it/s]Processing groups:  65%|██████▌   | 65/100 [02:15<01:27,  2.50s/it]Processing groups:  66%|██████▌   | 66/100 [02:22<01:38,  2.90s/it]Processing groups:  73%|███████▎  | 73/100 [02:22<00:43,  1.60s/it]Processing groups:  74%|███████▍  | 74/100 [02:23<00:38,  1.47s/it]Processing groups:  76%|███████▌  | 76/100 [02:23<00:30,  1.25s/it]Processing groups:  77%|███████▋  | 77/100 [02:25<00:29,  1.29s/it]Processing groups:  84%|████████▍ | 84/100 [02:25<00:09,  1.61it/s]Processing groups:  97%|█████████▋| 97/100 [02:29<00:01,  2.38it/s]Processing groups:  98%|█████████▊| 98/100 [02:30<00:00,  2.36it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  1.50s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.84, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.76it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28922.25it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:12, 46.19s/it]Processing groups:   2%|▏         | 2/100 [00:50<34:45, 21.29s/it]  Processing groups:   6%|▌         | 6/100 [00:52<08:16,  5.28s/it]Processing groups:  33%|███▎      | 33/100 [01:20<01:43,  1.54s/it]Processing groups:  34%|███▍      | 34/100 [01:24<01:50,  1.67s/it]Processing groups:  35%|███▌      | 35/100 [01:33<02:15,  2.08s/it]Processing groups:  40%|████      | 40/100 [01:35<01:36,  1.60s/it]Processing groups:  43%|████▎     | 43/100 [01:37<01:21,  1.43s/it]Processing groups:  52%|█████▏    | 52/100 [01:39<00:40,  1.18it/s]Processing groups:  56%|█████▌    | 56/100 [01:40<00:32,  1.36it/s]Processing groups:  59%|█████▉    | 59/100 [01:42<00:28,  1.46it/s]Processing groups:  65%|██████▌   | 65/100 [02:08<01:10,  2.02s/it]Processing groups:  66%|██████▌   | 66/100 [02:15<01:20,  2.36s/it]Processing groups:  67%|██████▋   | 67/100 [02:16<01:15,  2.30s/it]Processing groups:  68%|██████▊   | 68/100 [02:18<01:11,  2.22s/it]Processing groups:  69%|██████▉   | 69/100 [02:20<01:08,  2.20s/it]Processing groups:  71%|███████   | 71/100 [02:22<00:54,  1.87s/it]Processing groups:  74%|███████▍  | 74/100 [02:23<00:32,  1.25s/it]Processing groups:  89%|████████▉ | 89/100 [02:24<00:03,  2.81it/s]Processing groups:  97%|█████████▋| 97/100 [02:27<00:01,  2.65it/s]Processing groups:  98%|█████████▊| 98/100 [02:28<00:00,  2.51it/s]Processing groups: 100%|██████████| 100/100 [02:28<00:00,  1.48s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.54it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23612.59it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:14:13, 44.98s/it]Processing groups:   2%|▏         | 2/100 [00:46<31:37, 19.36s/it]  Processing groups:   4%|▍         | 4/100 [00:47<12:15,  7.66s/it]Processing groups:   5%|▌         | 5/100 [00:48<08:46,  5.54s/it]Processing groups:   8%|▊         | 8/100 [00:52<04:48,  3.14s/it]Processing groups:  33%|███▎      | 33/100 [01:29<01:52,  1.68s/it]Processing groups:  34%|███▍      | 34/100 [01:33<01:59,  1.80s/it]Processing groups:  44%|████▍     | 44/100 [01:33<01:01,  1.09s/it]Processing groups:  45%|████▌     | 45/100 [01:37<01:06,  1.20s/it]Processing groups:  53%|█████▎    | 53/100 [01:39<00:39,  1.19it/s]Processing groups:  58%|█████▊    | 58/100 [01:40<00:30,  1.40it/s]Processing groups:  65%|██████▌   | 65/100 [02:13<01:11,  2.03s/it]Processing groups:  67%|██████▋   | 67/100 [02:15<01:04,  1.96s/it]Processing groups:  68%|██████▊   | 68/100 [02:16<00:58,  1.82s/it]Processing groups:  69%|██████▉   | 69/100 [02:17<00:54,  1.76s/it]Processing groups:  73%|███████▎  | 73/100 [02:19<00:34,  1.27s/it]Processing groups:  74%|███████▍  | 74/100 [02:19<00:31,  1.21s/it]Processing groups:  76%|███████▌  | 76/100 [02:21<00:26,  1.11s/it]Processing groups:  81%|████████  | 81/100 [02:21<00:11,  1.66it/s]Processing groups:  86%|████████▌ | 86/100 [02:21<00:05,  2.69it/s]Processing groups:  91%|█████████ | 91/100 [02:22<00:02,  3.60it/s]Processing groups:  97%|█████████▋| 97/100 [02:26<00:01,  2.38it/s]Processing groups: 100%|██████████| 100/100 [02:26<00:00,  1.46s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.97, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 640, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 10, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  5.97it/s]100%|██████████| 2/2 [00:00<00:00,  3.14it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27687.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:05<1:47:16, 65.01s/it]Processing groups:   2%|▏         | 2/100 [01:07<45:59, 28.16s/it]  Processing groups:   6%|▌         | 6/100 [01:08<10:32,  6.73s/it]Processing groups:  29%|██▉       | 29/100 [01:09<01:07,  1.05it/s]Processing groups:  32%|███▏      | 32/100 [01:10<00:57,  1.18it/s]Processing groups:  32%|███▏      | 32/100 [01:27<00:57,  1.18it/s]Processing groups:  33%|███▎      | 33/100 [02:08<04:56,  4.42s/it]Processing groups:  34%|███▍      | 34/100 [02:11<04:42,  4.28s/it]Processing groups:  37%|███▋      | 37/100 [02:12<03:27,  3.30s/it]Processing groups:  44%|████▍     | 44/100 [02:14<01:43,  1.85s/it]Processing groups:  45%|████▌     | 45/100 [02:14<01:35,  1.73s/it]Processing groups:  52%|█████▏    | 52/100 [02:15<00:46,  1.03it/s]Processing groups:  64%|██████▍   | 64/100 [02:16<00:18,  1.91it/s]Processing groups:  65%|██████▌   | 65/100 [03:11<02:11,  3.76s/it]Processing groups:  67%|██████▋   | 67/100 [03:14<01:53,  3.42s/it]Processing groups:  69%|██████▉   | 69/100 [03:16<01:31,  2.96s/it]Processing groups:  77%|███████▋  | 77/100 [03:17<00:36,  1.59s/it]Processing groups:  78%|███████▊  | 78/100 [03:17<00:32,  1.48s/it]Processing groups:  94%|█████████▍| 94/100 [03:18<00:03,  1.87it/s]Processing groups:  97%|█████████▋| 97/100 [03:24<00:02,  1.30it/s]Processing groups:  98%|█████████▊| 98/100 [03:24<00:01,  1.37it/s]Processing groups: 100%|██████████| 100/100 [03:24<00:00,  2.05s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}

Processing features_differ: {'gaussian': 20, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  5.67it/s]100%|██████████| 2/2 [00:00<00:00,  3.18it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 36412.05it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:04<1:45:45, 64.10s/it]Processing groups:   2%|▏         | 2/100 [01:05<44:08, 27.03s/it]  Processing groups:   3%|▎         | 3/100 [01:06<24:21, 15.07s/it]Processing groups:   4%|▍         | 4/100 [01:07<15:29,  9.68s/it]Processing groups:  10%|█         | 10/100 [01:07<03:21,  2.24s/it]Processing groups:  13%|█▎        | 13/100 [01:10<02:33,  1.77s/it]Processing groups:  33%|███▎      | 33/100 [02:05<02:50,  2.55s/it]Processing groups:  35%|███▌      | 35/100 [02:08<02:37,  2.42s/it]Processing groups:  37%|███▋      | 37/100 [02:10<02:22,  2.26s/it]Processing groups:  38%|███▊      | 38/100 [02:12<02:15,  2.18s/it]Processing groups:  42%|████▏     | 42/100 [02:12<01:29,  1.54s/it]Processing groups:  52%|█████▏    | 52/100 [02:13<00:35,  1.34it/s]Processing groups:  58%|█████▊    | 58/100 [02:14<00:24,  1.68it/s]Processing groups:  59%|█████▉    | 59/100 [02:15<00:25,  1.58it/s]Processing groups:  63%|██████▎   | 63/100 [02:16<00:18,  2.04it/s]Processing groups:  65%|██████▌   | 65/100 [03:12<02:59,  5.12s/it]Processing groups:  67%|██████▋   | 67/100 [03:13<02:19,  4.22s/it]Processing groups:  68%|██████▊   | 68/100 [03:14<02:02,  3.84s/it]Processing groups:  71%|███████   | 71/100 [03:15<01:17,  2.68s/it]Processing groups:  77%|███████▋  | 77/100 [03:16<00:32,  1.41s/it]Processing groups:  81%|████████  | 81/100 [03:17<00:19,  1.02s/it]Processing groups:  90%|█████████ | 90/100 [03:17<00:05,  1.86it/s]Processing groups:  94%|█████████▍| 94/100 [03:18<00:02,  2.40it/s]Processing groups:  96%|█████████▌| 96/100 [03:18<00:01,  2.74it/s]Processing groups:  98%|█████████▊| 98/100 [03:24<00:01,  1.14it/s]Processing groups: 100%|██████████| 100/100 [03:24<00:00,  2.05s/it]
{'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}

Processing features_differ: {'gaussian': 40, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  6.20it/s]100%|██████████| 2/2 [00:00<00:00,  3.03it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29694.19it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:07<1:52:08, 67.96s/it]Processing groups:   3%|▎         | 3/100 [01:08<28:50, 17.84s/it]  Processing groups:  33%|███▎      | 33/100 [02:08<03:15,  2.92s/it]Processing groups:  34%|███▍      | 34/100 [02:09<03:07,  2.84s/it]Processing groups:  35%|███▌      | 35/100 [02:11<03:01,  2.79s/it]Processing groups:  37%|███▋      | 37/100 [02:12<02:38,  2.51s/it]Processing groups:  44%|████▍     | 44/100 [02:13<01:23,  1.49s/it]Processing groups:  48%|████▊     | 48/100 [02:13<01:00,  1.17s/it]Processing groups:  53%|█████▎    | 53/100 [02:14<00:39,  1.19it/s]Processing groups:  55%|█████▌    | 55/100 [02:15<00:35,  1.26it/s]Processing groups:  57%|█████▋    | 57/100 [02:16<00:32,  1.31it/s]Processing groups:  65%|██████▌   | 65/100 [03:13<02:17,  3.93s/it]Processing groups:  66%|██████▌   | 66/100 [03:16<02:11,  3.86s/it]Processing groups:  70%|███████   | 70/100 [03:16<01:20,  2.67s/it]Processing groups:  79%|███████▉  | 79/100 [03:17<00:28,  1.34s/it]Processing groups:  80%|████████  | 80/100 [03:18<00:25,  1.29s/it]Processing groups:  91%|█████████ | 91/100 [03:18<00:05,  1.66it/s]Processing groups:  94%|█████████▍| 94/100 [03:18<00:03,  1.96it/s]Processing groups:  97%|█████████▋| 97/100 [03:25<00:02,  1.14it/s]Processing groups:  99%|█████████▉| 99/100 [03:25<00:00,  1.33it/s]Processing groups: 100%|██████████| 100/100 [03:25<00:00,  2.06s/it]
{'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.24, 'mean_ap': 0.0, 'mean_ap_p_value': 0.35, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}

Processing features_differ: {'gaussian': 80, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  5.95it/s]100%|██████████| 2/2 [00:00<00:00,  3.07it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30025.80it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:07<1:51:08, 67.36s/it]Processing groups:   4%|▍         | 4/100 [01:09<21:08, 13.22s/it]  Processing groups:  13%|█▎        | 13/100 [01:09<04:22,  3.02s/it]Processing groups:  26%|██▌       | 26/100 [01:10<01:28,  1.19s/it]Processing groups:  26%|██▌       | 26/100 [01:24<01:28,  1.19s/it]Processing groups:  33%|███▎      | 33/100 [02:13<04:07,  3.69s/it]Processing groups:  40%|████      | 40/100 [02:16<02:41,  2.69s/it]Processing groups:  45%|████▌     | 45/100 [02:18<01:56,  2.12s/it]Processing groups:  63%|██████▎   | 63/100 [02:19<00:35,  1.04it/s]Processing groups:  63%|██████▎   | 63/100 [02:34<00:35,  1.04it/s]Processing groups:  65%|██████▌   | 65/100 [03:19<01:55,  3.31s/it]Processing groups:  70%|███████   | 70/100 [03:20<01:19,  2.65s/it]Processing groups:  74%|███████▍  | 74/100 [03:21<00:55,  2.14s/it]Processing groups:  78%|███████▊  | 78/100 [03:22<00:37,  1.69s/it]Processing groups:  82%|████████▏ | 82/100 [03:22<00:23,  1.30s/it]Processing groups:  86%|████████▌ | 86/100 [03:22<00:13,  1.03it/s]Processing groups:  93%|█████████▎| 93/100 [03:22<00:04,  1.65it/s]Processing groups:  95%|█████████▌| 95/100 [03:23<00:02,  1.86it/s]Processing groups:  97%|█████████▋| 97/100 [03:29<00:03,  1.01s/it]Processing groups: 100%|██████████| 100/100 [03:30<00:00,  2.10s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.82, 'mean_ap': 0.01, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}

Processing features_differ: {'gaussian': 160, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  5.95it/s]100%|██████████| 2/2 [00:00<00:00,  3.09it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31027.55it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:08<1:52:57, 68.46s/it]Processing groups:   8%|▊         | 8/100 [01:08<09:36,  6.27s/it]  Processing groups:  12%|█▏        | 12/100 [01:09<05:18,  3.62s/it]Processing groups:  15%|█▌        | 15/100 [01:09<03:35,  2.53s/it]Processing groups:  18%|█▊        | 18/100 [01:09<02:26,  1.78s/it]Processing groups:  30%|███       | 30/100 [01:10<00:47,  1.49it/s]Processing groups:  30%|███       | 30/100 [01:22<00:47,  1.49it/s]Processing groups:  33%|███▎      | 33/100 [02:11<04:51,  4.35s/it]Processing groups:  35%|███▌      | 35/100 [02:15<04:20,  4.01s/it]Processing groups:  41%|████      | 41/100 [02:16<02:24,  2.45s/it]Processing groups:  45%|████▌     | 45/100 [02:17<01:44,  1.90s/it]Processing groups:  62%|██████▏   | 62/100 [02:19<00:29,  1.29it/s]Processing groups:  62%|██████▏   | 62/100 [02:32<00:29,  1.29it/s]Processing groups:  65%|██████▌   | 65/100 [03:18<01:56,  3.34s/it]Processing groups:  66%|██████▌   | 66/100 [03:21<01:52,  3.31s/it]Processing groups:  68%|██████▊   | 68/100 [03:21<01:30,  2.84s/it]Processing groups:  71%|███████   | 71/100 [03:21<01:03,  2.17s/it]Processing groups:  73%|███████▎  | 73/100 [03:22<00:50,  1.87s/it]Processing groups:  77%|███████▋  | 77/100 [03:23<00:28,  1.24s/it]Processing groups:  95%|█████████▌| 95/100 [03:23<00:02,  2.48it/s]Processing groups:  97%|█████████▋| 97/100 [03:30<00:02,  1.42it/s]Processing groups: 100%|██████████| 100/100 [03:30<00:00,  2.11s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 0.78, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}

Processing features_differ: {'gaussian': 320, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  6.07it/s]100%|██████████| 2/2 [00:00<00:00,  3.48it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 38391.80it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:06<1:48:56, 66.03s/it]Processing groups:   2%|▏         | 2/100 [01:06<45:08, 27.63s/it]  Processing groups:   6%|▌         | 6/100 [01:06<09:59,  6.37s/it]Processing groups:   9%|▉         | 9/100 [01:08<05:34,  3.68s/it]Processing groups:  11%|█         | 11/100 [01:08<03:58,  2.68s/it]Processing groups:  13%|█▎        | 13/100 [01:09<02:50,  1.96s/it]Processing groups:  17%|█▋        | 17/100 [01:10<01:37,  1.18s/it]Processing groups:  33%|███▎      | 33/100 [02:11<03:27,  3.10s/it]Processing groups:  36%|███▌      | 36/100 [02:14<02:54,  2.73s/it]Processing groups:  39%|███▉      | 39/100 [02:14<02:16,  2.23s/it]Processing groups:  47%|████▋     | 47/100 [02:16<01:13,  1.38s/it]Processing groups:  61%|██████    | 61/100 [02:16<00:26,  1.45it/s]Processing groups:  63%|██████▎   | 63/100 [02:17<00:24,  1.51it/s]Processing groups:  63%|██████▎   | 63/100 [02:29<00:24,  1.51it/s]Processing groups:  65%|██████▌   | 65/100 [03:14<02:18,  3.97s/it]Processing groups:  66%|██████▌   | 66/100 [03:18<02:14,  3.96s/it]Processing groups:  67%|██████▋   | 67/100 [03:18<01:59,  3.63s/it]Processing groups:  68%|██████▊   | 68/100 [03:20<01:48,  3.39s/it]Processing groups:  70%|███████   | 70/100 [03:20<01:15,  2.53s/it]Processing groups:  91%|█████████ | 91/100 [03:21<00:04,  1.91it/s]Processing groups:  95%|█████████▌| 95/100 [03:21<00:02,  2.17it/s]Processing groups:  97%|█████████▋| 97/100 [03:28<00:02,  1.30it/s]Processing groups:  99%|█████████▉| 99/100 [03:28<00:00,  1.45it/s]Processing groups: 100%|██████████| 100/100 [03:28<00:00,  2.09s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}

Processing features_differ: {'gaussian': 640, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 1000 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  6.14it/s]100%|██████████| 2/2 [00:00<00:00,  3.13it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32251.47it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:05<1:47:26, 65.11s/it]Processing groups:   2%|▏         | 2/100 [01:07<46:05, 28.22s/it]  Processing groups:   4%|▍         | 4/100 [01:08<17:33, 10.98s/it]Processing groups:  19%|█▉        | 19/100 [01:10<02:03,  1.53s/it]Processing groups:  33%|███▎      | 33/100 [02:09<03:18,  2.96s/it]Processing groups:  34%|███▍      | 34/100 [02:14<03:23,  3.09s/it]Processing groups:  37%|███▋      | 37/100 [02:15<02:42,  2.58s/it]Processing groups:  49%|████▉     | 49/100 [02:16<01:06,  1.31s/it]Processing groups:  52%|█████▏    | 52/100 [02:17<00:54,  1.13s/it]Processing groups:  54%|█████▍    | 54/100 [02:17<00:47,  1.02s/it]Processing groups:  58%|█████▊    | 58/100 [02:19<00:35,  1.19it/s]Processing groups:  65%|██████▌   | 65/100 [03:15<02:11,  3.75s/it]Processing groups:  66%|██████▌   | 66/100 [03:20<02:09,  3.81s/it]Processing groups:  68%|██████▊   | 68/100 [03:20<01:41,  3.17s/it]Processing groups:  77%|███████▋  | 77/100 [03:21<00:35,  1.53s/it]Processing groups:  84%|████████▍ | 84/100 [03:22<00:15,  1.02it/s]Processing groups:  88%|████████▊ | 88/100 [03:22<00:09,  1.29it/s]Processing groups:  94%|█████████▍| 94/100 [03:22<00:03,  1.87it/s]Processing groups:  97%|█████████▋| 97/100 [03:29<00:02,  1.19it/s]Processing groups:  98%|█████████▊| 98/100 [03:29<00:01,  1.25it/s]Processing groups:  99%|█████████▉| 99/100 [03:29<00:00,  1.37it/s]Processing groups: 100%|██████████| 100/100 [03:29<00:00,  2.10s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 640, 'differ_params': 1}

Processing n_feats: 2500

Processing n_plates: 2

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  9.33it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 24995.85it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:45, 31.97s/it]Processing groups:   2%|▏         | 2/100 [00:36<25:56, 15.88s/it]Processing groups:  14%|█▍        | 14/100 [00:38<02:14,  1.56s/it]Processing groups:  15%|█▌        | 15/100 [00:38<02:00,  1.42s/it]Processing groups:  27%|██▋       | 27/100 [00:40<00:45,  1.59it/s]Processing groups:  33%|███▎      | 33/100 [00:59<01:35,  1.42s/it]Processing groups:  35%|███▌      | 35/100 [01:05<01:44,  1.61s/it]Processing groups:  38%|███▊      | 38/100 [01:06<01:22,  1.34s/it]Processing groups:  40%|████      | 40/100 [01:09<01:23,  1.40s/it]Processing groups:  42%|████▏     | 42/100 [01:11<01:15,  1.30s/it]Processing groups:  53%|█████▎    | 53/100 [01:18<00:42,  1.11it/s]Processing groups:  65%|██████▌   | 65/100 [01:26<00:27,  1.27it/s]Processing groups:  66%|██████▌   | 66/100 [01:31<00:34,  1.00s/it]Processing groups:  67%|██████▋   | 67/100 [01:41<00:54,  1.66s/it]Processing groups:  70%|███████   | 70/100 [01:43<00:43,  1.46s/it]Processing groups:  85%|████████▌ | 85/100 [01:44<00:08,  1.77it/s]Processing groups:  90%|█████████ | 90/100 [01:44<00:04,  2.27it/s]Processing groups:  95%|█████████▌| 95/100 [01:44<00:01,  2.82it/s]Processing groups:  97%|█████████▋| 97/100 [01:46<00:01,  2.47it/s]Processing groups:  99%|█████████▉| 99/100 [01:46<00:00,  2.63it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  2.82it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.07s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.12, 'mean_ap': 0.19, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.79it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 22831.11it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<54:25, 32.98s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:50, 14.60s/it]Processing groups:   3%|▎         | 3/100 [00:35<13:45,  8.51s/it]Processing groups:   4%|▍         | 4/100 [00:36<08:44,  5.46s/it]Processing groups:  13%|█▎        | 13/100 [00:39<01:43,  1.19s/it]Processing groups:  33%|███▎      | 33/100 [01:03<01:19,  1.19s/it]Processing groups:  34%|███▍      | 34/100 [01:07<01:28,  1.33s/it]Processing groups:  35%|███▌      | 35/100 [01:08<01:22,  1.27s/it]Processing groups:  38%|███▊      | 38/100 [01:11<01:14,  1.20s/it]Processing groups:  52%|█████▏    | 52/100 [01:11<00:24,  1.98it/s]Processing groups:  59%|█████▉    | 59/100 [01:14<00:19,  2.10it/s]Processing groups:  60%|██████    | 60/100 [01:15<00:21,  1.90it/s]Processing groups:  64%|██████▍   | 64/100 [01:15<00:14,  2.42it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<01:09,  1.99s/it]Processing groups:  66%|██████▌   | 66/100 [01:40<01:17,  2.28s/it]Processing groups:  68%|██████▊   | 68/100 [01:41<00:59,  1.87s/it]Processing groups:  80%|████████  | 80/100 [01:42<00:13,  1.52it/s]Processing groups:  84%|████████▍ | 84/100 [01:42<00:08,  1.81it/s]Processing groups:  88%|████████▊ | 88/100 [01:43<00:05,  2.23it/s]Processing groups:  89%|████████▉ | 89/100 [01:43<00:04,  2.30it/s]Processing groups:  95%|█████████▌| 95/100 [01:44<00:01,  3.56it/s]Processing groups:  97%|█████████▋| 97/100 [01:46<00:01,  2.43it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  3.15it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  1.06s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.0, 'mean_ap': 0.2, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.86it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 22495.60it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:05, 30.36s/it]Processing groups:   3%|▎         | 3/100 [00:34<15:28,  9.57s/it]Processing groups:   8%|▊         | 8/100 [00:35<04:14,  2.76s/it]Processing groups:  11%|█         | 11/100 [00:36<02:38,  1.78s/it]Processing groups:  18%|█▊        | 18/100 [00:37<01:12,  1.13it/s]Processing groups:  33%|███▎      | 33/100 [00:59<01:23,  1.25s/it]Processing groups:  35%|███▌      | 35/100 [01:00<01:15,  1.17s/it]Processing groups:  36%|███▌      | 36/100 [01:06<01:33,  1.47s/it]Processing groups:  37%|███▋      | 37/100 [01:06<01:25,  1.35s/it]Processing groups:  38%|███▊      | 38/100 [01:07<01:22,  1.34s/it]Processing groups:  43%|████▎     | 43/100 [01:09<00:50,  1.12it/s]Processing groups:  45%|████▌     | 45/100 [01:11<00:49,  1.11it/s]Processing groups:  46%|████▌     | 46/100 [01:11<00:43,  1.24it/s]Processing groups:  58%|█████▊    | 58/100 [01:12<00:12,  3.36it/s]Processing groups:  64%|██████▍   | 64/100 [01:13<00:09,  3.92it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<01:05,  1.87s/it]Processing groups:  66%|██████▌   | 66/100 [01:37<01:03,  1.86s/it]Processing groups:  70%|███████   | 70/100 [01:39<00:41,  1.37s/it]Processing groups:  71%|███████   | 71/100 [01:39<00:35,  1.23s/it]Processing groups:  72%|███████▏  | 72/100 [01:40<00:32,  1.16s/it]Processing groups:  73%|███████▎  | 73/100 [01:40<00:29,  1.11s/it]Processing groups:  79%|███████▉  | 79/100 [01:41<00:10,  2.07it/s]Processing groups:  88%|████████▊ | 88/100 [01:41<00:03,  3.81it/s]Processing groups:  90%|█████████ | 90/100 [01:42<00:02,  3.93it/s]Processing groups:  96%|█████████▌| 96/100 [01:42<00:00,  5.57it/s]Processing groups:  98%|█████████▊| 98/100 [01:45<00:00,  2.90it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.65, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.61it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27390.48it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<52:42, 31.95s/it]Processing groups:   2%|▏         | 2/100 [00:32<21:50, 13.37s/it]Processing groups:   4%|▍         | 4/100 [00:33<08:43,  5.45s/it]Processing groups:   9%|▉         | 9/100 [00:33<02:35,  1.71s/it]Processing groups:  14%|█▍        | 14/100 [00:34<01:15,  1.14it/s]Processing groups:  16%|█▌        | 16/100 [00:34<00:58,  1.43it/s]Processing groups:  26%|██▌       | 26/100 [00:36<00:29,  2.51it/s]Processing groups:  28%|██▊       | 28/100 [00:37<00:30,  2.37it/s]Processing groups:  33%|███▎      | 33/100 [01:01<02:11,  1.97s/it]Processing groups:  35%|███▌      | 35/100 [01:04<01:59,  1.83s/it]Processing groups:  36%|███▌      | 36/100 [01:05<01:55,  1.80s/it]Processing groups:  37%|███▋      | 37/100 [01:11<02:25,  2.30s/it]Processing groups:  55%|█████▌    | 55/100 [01:11<00:24,  1.82it/s]Processing groups:  64%|██████▍   | 64/100 [01:12<00:13,  2.64it/s]Processing groups:  64%|██████▍   | 64/100 [01:24<00:13,  2.64it/s]Processing groups:  65%|██████▌   | 65/100 [01:33<00:52,  1.49s/it]Processing groups:  67%|██████▋   | 67/100 [01:38<00:53,  1.63s/it]Processing groups:  70%|███████   | 70/100 [01:39<00:40,  1.35s/it]Processing groups:  78%|███████▊  | 78/100 [01:41<00:17,  1.25it/s]Processing groups:  80%|████████  | 80/100 [01:41<00:13,  1.43it/s]Processing groups:  92%|█████████▏| 92/100 [01:41<00:02,  3.09it/s]Processing groups:  96%|█████████▌| 96/100 [01:41<00:01,  3.70it/s]Processing groups:  99%|█████████▉| 99/100 [01:44<00:00,  2.61it/s]Processing groups: 100%|██████████| 100/100 [01:44<00:00,  1.04s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.95, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.69it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23769.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<48:18, 29.27s/it]Processing groups:   3%|▎         | 3/100 [00:33<14:55,  9.24s/it]Processing groups:   6%|▌         | 6/100 [00:35<06:01,  3.85s/it]Processing groups:  13%|█▎        | 13/100 [00:35<01:53,  1.30s/it]Processing groups:  14%|█▍        | 14/100 [00:35<01:40,  1.16s/it]Processing groups:  23%|██▎       | 23/100 [00:37<00:44,  1.72it/s]Processing groups:  33%|███▎      | 33/100 [00:59<01:31,  1.37s/it]Processing groups:  34%|███▍      | 34/100 [01:01<01:32,  1.40s/it]Processing groups:  36%|███▌      | 36/100 [01:03<01:25,  1.34s/it]Processing groups:  37%|███▋      | 37/100 [01:04<01:24,  1.34s/it]Processing groups:  38%|███▊      | 38/100 [01:07<01:32,  1.50s/it]Processing groups:  39%|███▉      | 39/100 [01:07<01:18,  1.29s/it]Processing groups:  42%|████▏     | 42/100 [01:10<01:12,  1.25s/it]Processing groups:  54%|█████▍    | 54/100 [01:12<00:22,  2.08it/s]Processing groups:  65%|██████▌   | 65/100 [01:29<00:34,  1.02it/s]Processing groups:  66%|██████▌   | 66/100 [01:30<00:34,  1.01s/it]Processing groups:  67%|██████▋   | 67/100 [01:36<00:45,  1.39s/it]Processing groups:  72%|███████▏  | 72/100 [01:39<00:29,  1.06s/it]Processing groups:  73%|███████▎  | 73/100 [01:39<00:26,  1.02it/s]Processing groups:  80%|████████  | 80/100 [01:39<00:10,  1.83it/s]Processing groups:  95%|█████████▌| 95/100 [01:40<00:01,  3.89it/s]Processing groups:  97%|█████████▋| 97/100 [01:42<00:00,  3.06it/s]Processing groups:  98%|█████████▊| 98/100 [01:42<00:00,  3.19it/s]Processing groups: 100%|██████████| 100/100 [01:42<00:00,  1.03s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.66it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 24720.36it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<54:26, 33.00s/it]Processing groups:   7%|▋         | 7/100 [00:34<05:45,  3.72s/it]Processing groups:   9%|▉         | 9/100 [00:38<04:47,  3.16s/it]Processing groups:  33%|███▎      | 33/100 [01:02<01:29,  1.34s/it]Processing groups:  35%|███▌      | 35/100 [01:03<01:23,  1.28s/it]Processing groups:  36%|███▌      | 36/100 [01:05<01:25,  1.33s/it]Processing groups:  39%|███▉      | 39/100 [01:06<01:07,  1.11s/it]Processing groups:  40%|████      | 40/100 [01:07<01:07,  1.12s/it]Processing groups:  52%|█████▏    | 52/100 [01:10<00:28,  1.68it/s]Processing groups:  58%|█████▊    | 58/100 [01:14<00:26,  1.61it/s]Processing groups:  64%|██████▍   | 64/100 [01:15<00:16,  2.22it/s]Processing groups:  65%|██████▌   | 65/100 [01:30<00:50,  1.43s/it]Processing groups:  66%|██████▌   | 66/100 [01:34<00:56,  1.67s/it]Processing groups:  67%|██████▋   | 67/100 [01:36<00:56,  1.72s/it]Processing groups:  68%|██████▊   | 68/100 [01:37<00:53,  1.66s/it]Processing groups:  73%|███████▎  | 73/100 [01:38<00:24,  1.12it/s]Processing groups:  75%|███████▌  | 75/100 [01:38<00:18,  1.32it/s]Processing groups:  81%|████████  | 81/100 [01:39<00:08,  2.33it/s]Processing groups:  85%|████████▌ | 85/100 [01:40<00:05,  2.85it/s]Processing groups:  91%|█████████ | 91/100 [01:40<00:02,  3.98it/s]Processing groups:  95%|█████████▌| 95/100 [01:41<00:01,  4.65it/s]Processing groups:  97%|█████████▋| 97/100 [01:43<00:01,  2.88it/s]Processing groups:  98%|█████████▊| 98/100 [01:43<00:00,  2.94it/s]Processing groups: 100%|██████████| 100/100 [01:43<00:00,  1.03s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.45it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23231.99it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:27, 31.19s/it]Processing groups:   3%|▎         | 3/100 [00:36<16:07,  9.98s/it]Processing groups:   6%|▌         | 6/100 [00:36<06:15,  4.00s/it]Processing groups:  14%|█▍        | 14/100 [00:39<02:01,  1.42s/it]Processing groups:  33%|███▎      | 33/100 [00:58<01:14,  1.11s/it]Processing groups:  34%|███▍      | 34/100 [01:03<01:28,  1.35s/it]Processing groups:  37%|███▋      | 37/100 [01:05<01:14,  1.18s/it]Processing groups:  38%|███▊      | 38/100 [01:06<01:13,  1.18s/it]Processing groups:  39%|███▉      | 39/100 [01:08<01:19,  1.30s/it]Processing groups:  48%|████▊     | 48/100 [01:09<00:33,  1.57it/s]Processing groups:  57%|█████▋    | 57/100 [01:11<00:18,  2.37it/s]Processing groups:  58%|█████▊    | 58/100 [01:12<00:18,  2.21it/s]Processing groups:  61%|██████    | 61/100 [01:12<00:16,  2.43it/s]Processing groups:  65%|██████▌   | 65/100 [01:32<00:59,  1.71s/it]Processing groups:  66%|██████▌   | 66/100 [01:36<01:08,  2.01s/it]Processing groups:  67%|██████▋   | 67/100 [01:38<01:05,  1.99s/it]Processing groups:  68%|██████▊   | 68/100 [01:39<00:56,  1.77s/it]Processing groups:  69%|██████▉   | 69/100 [01:39<00:45,  1.48s/it]Processing groups:  77%|███████▋  | 77/100 [01:40<00:13,  1.76it/s]Processing groups:  78%|███████▊  | 78/100 [01:41<00:14,  1.53it/s]Processing groups:  82%|████████▏ | 82/100 [01:41<00:07,  2.37it/s]Processing groups:  87%|████████▋ | 87/100 [01:42<00:03,  3.62it/s]Processing groups:  93%|█████████▎| 93/100 [01:42<00:01,  5.24it/s]Processing groups:  97%|█████████▋| 97/100 [01:44<00:00,  3.33it/s]Processing groups:  99%|█████████▉| 99/100 [01:45<00:00,  3.68it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.05s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.30it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23738.21it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<1:00:43, 36.81s/it]Processing groups:   2%|▏         | 2/100 [00:37<25:11, 15.42s/it]  Processing groups:  13%|█▎        | 13/100 [00:37<02:14,  1.54s/it]Processing groups:  21%|██        | 21/100 [00:39<01:13,  1.07it/s]Processing groups:  26%|██▌       | 26/100 [00:44<01:06,  1.11it/s]Processing groups:  33%|███▎      | 33/100 [01:08<02:06,  1.89s/it]Processing groups:  36%|███▌      | 36/100 [01:12<01:53,  1.77s/it]Processing groups:  45%|████▌     | 45/100 [01:13<00:57,  1.04s/it]Processing groups:  52%|█████▏    | 52/100 [01:16<00:40,  1.19it/s]Processing groups:  57%|█████▋    | 57/100 [01:18<00:30,  1.42it/s]Processing groups:  60%|██████    | 60/100 [01:18<00:24,  1.66it/s]Processing groups:  64%|██████▍   | 64/100 [01:21<00:22,  1.57it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<01:25,  2.45s/it]Processing groups:  68%|██████▊   | 68/100 [01:46<01:04,  2.02s/it]Processing groups:  70%|███████   | 70/100 [01:47<00:51,  1.72s/it]Processing groups:  75%|███████▌  | 75/100 [01:49<00:28,  1.15s/it]Processing groups:  88%|████████▊ | 88/100 [01:50<00:05,  2.02it/s]Processing groups:  94%|█████████▍| 94/100 [01:50<00:02,  2.68it/s]Processing groups:  96%|█████████▌| 96/100 [01:51<00:01,  2.86it/s]Processing groups:  97%|█████████▋| 97/100 [01:53<00:01,  2.05it/s]Processing groups:  98%|█████████▊| 98/100 [01:53<00:00,  2.19it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.13s/it]
{'replicate_reproducibility': 0.03, 'mp_value': 0.01, 'mean_ap': 0.06, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.24it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30949.70it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:08, 33.42s/it]Processing groups:   3%|▎         | 3/100 [00:38<17:00, 10.52s/it]Processing groups:   8%|▊         | 8/100 [00:38<04:30,  2.94s/it]Processing groups:  10%|█         | 10/100 [00:40<03:27,  2.30s/it]Processing groups:  25%|██▌       | 25/100 [00:41<00:46,  1.62it/s]Processing groups:  26%|██▌       | 26/100 [00:41<00:44,  1.67it/s]Processing groups:  33%|███▎      | 33/100 [01:04<01:49,  1.64s/it]Processing groups:  34%|███▍      | 34/100 [01:06<01:49,  1.67s/it]Processing groups:  35%|███▌      | 35/100 [01:08<01:55,  1.78s/it]Processing groups:  37%|███▋      | 37/100 [01:10<01:36,  1.53s/it]Processing groups:  40%|████      | 40/100 [01:11<01:09,  1.16s/it]Processing groups:  41%|████      | 41/100 [01:11<01:03,  1.07s/it]Processing groups:  42%|████▏     | 42/100 [01:14<01:12,  1.26s/it]Processing groups:  45%|████▌     | 45/100 [01:18<01:14,  1.35s/it]Processing groups:  62%|██████▏   | 62/100 [01:21<00:16,  2.34it/s]Processing groups:  65%|██████▌   | 65/100 [01:40<00:48,  1.38s/it]Processing groups:  66%|██████▌   | 66/100 [01:42<00:50,  1.48s/it]Processing groups:  67%|██████▋   | 67/100 [01:45<00:52,  1.60s/it]Processing groups:  68%|██████▊   | 68/100 [01:46<00:50,  1.57s/it]Processing groups:  70%|███████   | 70/100 [01:47<00:38,  1.29s/it]Processing groups:  75%|███████▌  | 75/100 [01:50<00:24,  1.03it/s]Processing groups:  84%|████████▍ | 84/100 [01:51<00:07,  2.13it/s]Processing groups:  88%|████████▊ | 88/100 [01:51<00:04,  2.69it/s]Processing groups:  95%|█████████▌| 95/100 [01:52<00:01,  3.78it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  2.78it/s]Processing groups:  98%|█████████▊| 98/100 [01:54<00:00,  2.80it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.01, 'mean_ap': 0.18, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.30it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29084.70it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:00, 30.31s/it]Processing groups:   2%|▏         | 2/100 [00:36<26:04, 15.97s/it]Processing groups:  10%|█         | 10/100 [00:37<03:19,  2.22s/it]Processing groups:  17%|█▋        | 17/100 [00:40<01:47,  1.30s/it]Processing groups:  33%|███▎      | 33/100 [01:07<01:43,  1.54s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:41,  1.53s/it]Processing groups:  36%|███▌      | 36/100 [01:10<01:30,  1.42s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:37,  1.55s/it]Processing groups:  41%|████      | 41/100 [01:16<01:14,  1.26s/it]Processing groups:  47%|████▋     | 47/100 [01:17<00:44,  1.20it/s]Processing groups:  55%|█████▌    | 55/100 [01:17<00:21,  2.10it/s]Processing groups:  64%|██████▍   | 64/100 [01:17<00:10,  3.51it/s]Processing groups:  64%|██████▍   | 64/100 [01:33<00:10,  3.51it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<01:04,  1.84s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<01:08,  2.01s/it]Processing groups:  74%|███████▍  | 74/100 [01:50<00:32,  1.23s/it]Processing groups:  95%|█████████▌| 95/100 [01:50<00:02,  2.24it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  2.08it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.48, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.28it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33476.77it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:01:12, 37.10s/it]Processing groups:   5%|▌         | 5/100 [00:39<09:32,  6.03s/it]  Processing groups:   6%|▌         | 6/100 [00:39<07:17,  4.65s/it]Processing groups:   7%|▋         | 7/100 [00:39<05:27,  3.52s/it]Processing groups:  22%|██▏       | 22/100 [00:40<00:46,  1.67it/s]Processing groups:  22%|██▏       | 22/100 [00:58<00:46,  1.67it/s]Processing groups:  33%|███▎      | 33/100 [01:06<01:36,  1.44s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:38,  1.49s/it]Processing groups:  35%|███▌      | 35/100 [01:09<01:30,  1.39s/it]Processing groups:  36%|███▌      | 36/100 [01:09<01:23,  1.31s/it]Processing groups:  37%|███▋      | 37/100 [01:12<01:31,  1.45s/it]Processing groups:  38%|███▊      | 38/100 [01:12<01:19,  1.29s/it]Processing groups:  40%|████      | 40/100 [01:13<01:05,  1.09s/it]Processing groups:  42%|████▏     | 42/100 [01:15<01:01,  1.05s/it]Processing groups:  50%|█████     | 50/100 [01:16<00:23,  2.17it/s]Processing groups:  51%|█████     | 51/100 [01:18<00:30,  1.60it/s]Processing groups:  56%|█████▌    | 56/100 [01:19<00:16,  2.63it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<01:00,  1.74s/it]Processing groups:  68%|██████▊   | 68/100 [01:46<00:45,  1.43s/it]Processing groups:  72%|███████▏  | 72/100 [01:48<00:33,  1.18s/it]Processing groups:  74%|███████▍  | 74/100 [01:50<00:28,  1.10s/it]Processing groups:  77%|███████▋  | 77/100 [01:51<00:21,  1.08it/s]Processing groups:  83%|████████▎ | 83/100 [01:51<00:09,  1.84it/s]Processing groups:  96%|█████████▌| 96/100 [01:51<00:00,  4.16it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  3.03it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 0.94, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.71it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 26296.58it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:55, 32.69s/it]Processing groups:   2%|▏         | 2/100 [00:39<28:29, 17.44s/it]Processing groups:  21%|██        | 21/100 [00:40<01:24,  1.06s/it]Processing groups:  25%|██▌       | 25/100 [00:40<01:03,  1.18it/s]Processing groups:  27%|██▋       | 27/100 [00:41<00:58,  1.24it/s]Processing groups:  33%|███▎      | 33/100 [01:04<02:08,  1.92s/it]Processing groups:  34%|███▍      | 34/100 [01:08<02:18,  2.10s/it]Processing groups:  35%|███▌      | 35/100 [01:12<02:29,  2.31s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:53,  1.81s/it]Processing groups:  43%|████▎     | 43/100 [01:17<01:13,  1.30s/it]Processing groups:  57%|█████▋    | 57/100 [01:18<00:22,  1.93it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<00:49,  1.41s/it]Processing groups:  66%|██████▌   | 66/100 [01:46<00:51,  1.52s/it]Processing groups:  67%|██████▋   | 67/100 [01:47<00:47,  1.45s/it]Processing groups:  74%|███████▍  | 74/100 [01:49<00:24,  1.05it/s]Processing groups:  76%|███████▌  | 76/100 [01:50<00:20,  1.17it/s]Processing groups:  87%|████████▋ | 87/100 [01:50<00:05,  2.47it/s]Processing groups:  94%|█████████▍| 94/100 [01:50<00:01,  3.55it/s]Processing groups:  97%|█████████▋| 97/100 [01:53<00:01,  2.49it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.17it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 25021.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:38<1:03:57, 38.77s/it]Processing groups:   6%|▌         | 6/100 [00:39<07:47,  4.97s/it]  Processing groups:  32%|███▏      | 32/100 [00:42<00:51,  1.33it/s]Processing groups:  33%|███▎      | 33/100 [01:07<02:02,  1.83s/it]Processing groups:  34%|███▍      | 34/100 [01:10<02:06,  1.92s/it]Processing groups:  36%|███▌      | 36/100 [01:11<01:48,  1.69s/it]Processing groups:  38%|███▊      | 38/100 [01:12<01:31,  1.48s/it]Processing groups:  39%|███▉      | 39/100 [01:12<01:21,  1.33s/it]Processing groups:  44%|████▍     | 44/100 [01:13<00:46,  1.20it/s]Processing groups:  45%|████▌     | 45/100 [01:13<00:41,  1.32it/s]Processing groups:  48%|████▊     | 48/100 [01:14<00:32,  1.61it/s]Processing groups:  49%|████▉     | 49/100 [01:15<00:31,  1.64it/s]Processing groups:  50%|█████     | 50/100 [01:17<00:42,  1.19it/s]Processing groups:  51%|█████     | 51/100 [01:20<01:00,  1.23s/it]Processing groups:  58%|█████▊    | 58/100 [01:20<00:21,  1.95it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<01:05,  1.87s/it]Processing groups:  67%|██████▋   | 67/100 [01:47<01:00,  1.84s/it]Processing groups:  68%|██████▊   | 68/100 [01:48<00:56,  1.78s/it]Processing groups:  72%|███████▏  | 72/100 [01:50<00:36,  1.29s/it]Processing groups:  73%|███████▎  | 73/100 [01:51<00:31,  1.17s/it]Processing groups:  85%|████████▌ | 85/100 [01:51<00:06,  2.41it/s]Processing groups:  94%|█████████▍| 94/100 [01:52<00:01,  3.66it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  2.73it/s]Processing groups:  99%|█████████▉| 99/100 [01:54<00:00,  3.08it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.18it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 28844.67it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<59:59, 36.36s/it]Processing groups:   2%|▏         | 2/100 [00:38<26:41, 16.34s/it]Processing groups:  17%|█▋        | 17/100 [00:39<01:44,  1.26s/it]Processing groups:  17%|█▋        | 17/100 [00:51<01:44,  1.26s/it]Processing groups:  33%|███▎      | 33/100 [01:04<01:35,  1.42s/it]Processing groups:  34%|███▍      | 34/100 [01:07<01:38,  1.49s/it]Processing groups:  35%|███▌      | 35/100 [01:08<01:35,  1.47s/it]Processing groups:  37%|███▋      | 37/100 [01:16<01:59,  1.89s/it]Processing groups:  61%|██████    | 61/100 [01:17<00:20,  1.90it/s]Processing groups:  61%|██████    | 61/100 [01:31<00:20,  1.90it/s]Processing groups:  65%|██████▌   | 65/100 [01:38<00:43,  1.25s/it]Processing groups:  66%|██████▌   | 66/100 [01:45<00:51,  1.53s/it]Processing groups:  68%|██████▊   | 68/100 [01:47<00:45,  1.44s/it]Processing groups:  72%|███████▏  | 72/100 [01:48<00:32,  1.16s/it]Processing groups:  81%|████████  | 81/100 [01:49<00:12,  1.52it/s]Processing groups:  92%|█████████▏| 92/100 [01:49<00:03,  2.57it/s]Processing groups:  94%|█████████▍| 94/100 [01:50<00:02,  2.71it/s]Processing groups:  97%|█████████▋| 97/100 [01:52<00:01,  2.21it/s]Processing groups:  99%|█████████▉| 99/100 [01:52<00:00,  2.52it/s]Processing groups: 100%|██████████| 100/100 [01:52<00:00,  1.13s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.29, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.11it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16865.59it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:17:36, 47.04s/it]Processing groups:   3%|▎         | 3/100 [00:48<20:43, 12.82s/it]  Processing groups:   6%|▌         | 6/100 [00:50<08:22,  5.34s/it]Processing groups:  10%|█         | 10/100 [00:51<03:54,  2.60s/it]Processing groups:  11%|█         | 11/100 [00:51<03:18,  2.23s/it]Processing groups:  33%|███▎      | 33/100 [01:29<02:00,  1.80s/it]Processing groups:  34%|███▍      | 34/100 [01:32<02:02,  1.85s/it]Processing groups:  37%|███▋      | 37/100 [01:33<01:38,  1.56s/it]Processing groups:  41%|████      | 41/100 [01:35<01:18,  1.34s/it]Processing groups:  54%|█████▍    | 54/100 [01:37<00:31,  1.47it/s]Processing groups:  57%|█████▋    | 57/100 [01:38<00:27,  1.58it/s]Processing groups:  63%|██████▎   | 63/100 [01:39<00:17,  2.15it/s]Processing groups:  64%|██████▍   | 64/100 [01:42<00:24,  1.46it/s]Processing groups:  65%|██████▌   | 65/100 [02:18<02:11,  3.76s/it]Processing groups:  66%|██████▌   | 66/100 [02:20<01:59,  3.53s/it]Processing groups:  81%|████████  | 81/100 [02:20<00:20,  1.05s/it]Processing groups:  91%|█████████ | 91/100 [02:20<00:05,  1.55it/s]Processing groups:  94%|█████████▍| 94/100 [02:21<00:03,  1.70it/s]Processing groups:  97%|█████████▋| 97/100 [02:25<00:02,  1.38it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  1.46s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.04, 'mean_ap': 0.02, 'mean_ap_p_value': 0.07, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.02it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 20060.76it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:17:58, 47.26s/it]Processing groups:   2%|▏         | 2/100 [00:48<33:03, 20.24s/it]  Processing groups:   6%|▌         | 6/100 [00:52<08:21,  5.33s/it]Processing groups:  33%|███▎      | 33/100 [01:22<01:49,  1.63s/it]Processing groups:  34%|███▍      | 34/100 [01:28<01:58,  1.79s/it]Processing groups:  35%|███▌      | 35/100 [01:29<01:54,  1.76s/it]Processing groups:  36%|███▌      | 36/100 [01:29<01:44,  1.64s/it]Processing groups:  38%|███▊      | 38/100 [01:35<01:54,  1.84s/it]Processing groups:  47%|████▋     | 47/100 [01:36<00:49,  1.08it/s]Processing groups:  54%|█████▍    | 54/100 [01:37<00:28,  1.59it/s]Processing groups:  58%|█████▊    | 58/100 [01:37<00:21,  1.95it/s]Processing groups:  59%|█████▉    | 59/100 [01:38<00:22,  1.83it/s]Processing groups:  64%|██████▍   | 64/100 [01:42<00:22,  1.63it/s]Processing groups:  65%|██████▌   | 65/100 [02:10<01:49,  3.14s/it]Processing groups:  66%|██████▌   | 66/100 [02:12<01:42,  3.03s/it]Processing groups:  67%|██████▋   | 67/100 [02:15<01:40,  3.05s/it]Processing groups:  68%|██████▊   | 68/100 [02:16<01:23,  2.61s/it]Processing groups:  70%|███████   | 70/100 [02:17<00:56,  1.89s/it]Processing groups:  73%|███████▎  | 73/100 [02:17<00:32,  1.22s/it]Processing groups:  77%|███████▋  | 77/100 [02:18<00:18,  1.28it/s]Processing groups:  79%|███████▉  | 79/100 [02:19<00:15,  1.38it/s]Processing groups:  84%|████████▍ | 84/100 [02:20<00:07,  2.17it/s]Processing groups:  85%|████████▌ | 85/100 [02:20<00:06,  2.28it/s]Processing groups:  88%|████████▊ | 88/100 [02:21<00:04,  2.80it/s]Processing groups:  95%|█████████▌| 95/100 [02:21<00:00,  5.08it/s]Processing groups:  96%|█████████▌| 96/100 [02:22<00:00,  4.48it/s]Processing groups:  97%|█████████▋| 97/100 [02:25<00:01,  1.73it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  2.45it/s]Processing groups: 100%|██████████| 100/100 [02:25<00:00,  1.46s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.13, 'mean_ap': 0.13, 'mean_ap_p_value': 0.21, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.36it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 26751.09it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:19:30, 48.19s/it]Processing groups:   8%|▊         | 8/100 [00:50<07:12,  4.70s/it]  Processing groups:  33%|███▎      | 33/100 [01:25<02:12,  1.98s/it]Processing groups:  34%|███▍      | 34/100 [01:30<02:18,  2.10s/it]Processing groups:  37%|███▋      | 37/100 [01:31<01:55,  1.84s/it]Processing groups:  42%|████▏     | 42/100 [01:34<01:26,  1.49s/it]Processing groups:  44%|████▍     | 44/100 [01:34<01:13,  1.31s/it]Processing groups:  50%|█████     | 50/100 [01:37<00:48,  1.03it/s]Processing groups:  64%|██████▍   | 64/100 [01:37<00:16,  2.20it/s]Processing groups:  64%|██████▍   | 64/100 [01:51<00:16,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [02:10<01:16,  2.18s/it]Processing groups:  66%|██████▌   | 66/100 [02:15<01:20,  2.36s/it]Processing groups:  69%|██████▉   | 69/100 [02:16<00:58,  1.89s/it]Processing groups:  79%|███████▉  | 79/100 [02:16<00:19,  1.09it/s]Processing groups:  81%|████████  | 81/100 [02:17<00:16,  1.15it/s]Processing groups:  89%|████████▉ | 89/100 [02:17<00:05,  1.98it/s]Processing groups:  92%|█████████▏| 92/100 [02:18<00:03,  2.26it/s]Processing groups:  95%|█████████▌| 95/100 [02:18<00:01,  2.61it/s]Processing groups:  97%|█████████▋| 97/100 [02:22<00:01,  1.56it/s]Processing groups:  99%|█████████▉| 99/100 [02:22<00:00,  1.85it/s]Processing groups: 100%|██████████| 100/100 [02:22<00:00,  1.43s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.34, 'mean_ap_p_value': 0.51, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.15it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27496.42it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:12:13, 43.77s/it]Processing groups:   2%|▏         | 2/100 [00:46<31:36, 19.35s/it]  Processing groups:   3%|▎         | 3/100 [00:47<18:03, 11.17s/it]Processing groups:   9%|▉         | 9/100 [00:49<03:51,  2.54s/it]Processing groups:  23%|██▎       | 23/100 [00:50<00:56,  1.37it/s]Processing groups:  23%|██▎       | 23/100 [01:07<00:56,  1.37it/s]Processing groups:  33%|███▎      | 33/100 [01:29<02:19,  2.09s/it]Processing groups:  37%|███▋      | 37/100 [01:32<01:54,  1.81s/it]Processing groups:  39%|███▉      | 39/100 [01:32<01:38,  1.62s/it]Processing groups:  43%|████▎     | 43/100 [01:32<01:08,  1.21s/it]Processing groups:  48%|████▊     | 48/100 [01:34<00:49,  1.04it/s]Processing groups:  49%|████▉     | 49/100 [01:37<00:54,  1.07s/it]Processing groups:  62%|██████▏   | 62/100 [01:38<00:17,  2.12it/s]Processing groups:  64%|██████▍   | 64/100 [01:38<00:15,  2.36it/s]Processing groups:  64%|██████▍   | 64/100 [01:57<00:15,  2.36it/s]Processing groups:  65%|██████▌   | 65/100 [02:11<01:43,  2.95s/it]Processing groups:  68%|██████▊   | 68/100 [02:12<01:14,  2.32s/it]Processing groups:  69%|██████▉   | 69/100 [02:14<01:10,  2.26s/it]Processing groups:  71%|███████   | 71/100 [02:15<00:54,  1.86s/it]Processing groups:  74%|███████▍  | 74/100 [02:16<00:34,  1.32s/it]Processing groups:  82%|████████▏ | 82/100 [02:16<00:11,  1.58it/s]Processing groups:  83%|████████▎ | 83/100 [02:17<00:10,  1.61it/s]Processing groups:  84%|████████▍ | 84/100 [02:17<00:09,  1.68it/s]Processing groups:  89%|████████▉ | 89/100 [02:18<00:04,  2.59it/s]Processing groups:  95%|█████████▌| 95/100 [02:19<00:01,  3.73it/s]Processing groups:  97%|█████████▋| 97/100 [02:22<00:01,  1.92it/s]Processing groups:  99%|█████████▉| 99/100 [02:22<00:00,  2.32it/s]Processing groups: 100%|██████████| 100/100 [02:22<00:00,  1.43s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 0.87, 'mean_ap_p_value': 0.93, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.40it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 33436.73it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:13:40, 44.65s/it]Processing groups:   2%|▏         | 2/100 [00:46<32:16, 19.76s/it]  Processing groups:   6%|▌         | 6/100 [00:48<07:28,  4.77s/it]Processing groups:  22%|██▏       | 22/100 [00:48<01:10,  1.10it/s]Processing groups:  30%|███       | 30/100 [00:49<00:43,  1.62it/s]Processing groups:  30%|███       | 30/100 [01:02<00:43,  1.62it/s]Processing groups:  33%|███▎      | 33/100 [01:24<02:43,  2.44s/it]Processing groups:  34%|███▍      | 34/100 [01:29<02:50,  2.59s/it]Processing groups:  35%|███▌      | 35/100 [01:30<02:38,  2.44s/it]Processing groups:  38%|███▊      | 38/100 [01:30<01:51,  1.80s/it]Processing groups:  40%|████      | 40/100 [01:32<01:33,  1.56s/it]Processing groups:  41%|████      | 41/100 [01:33<01:27,  1.48s/it]Processing groups:  45%|████▌     | 45/100 [01:33<00:49,  1.10it/s]Processing groups:  48%|████▊     | 48/100 [01:34<00:36,  1.41it/s]Processing groups:  53%|█████▎    | 53/100 [01:36<00:25,  1.88it/s]Processing groups:  62%|██████▏   | 62/100 [01:37<00:12,  2.98it/s]Processing groups:  64%|██████▍   | 64/100 [01:37<00:11,  3.16it/s]Processing groups:  65%|██████▌   | 65/100 [02:13<02:04,  3.55s/it]Processing groups:  67%|██████▋   | 67/100 [02:13<01:33,  2.85s/it]Processing groups:  68%|██████▊   | 68/100 [02:16<01:30,  2.84s/it]Processing groups:  72%|███████▏  | 72/100 [02:17<00:50,  1.79s/it]Processing groups:  79%|███████▉  | 79/100 [02:18<00:18,  1.12it/s]Processing groups:  90%|█████████ | 90/100 [02:18<00:04,  2.37it/s]Processing groups:  93%|█████████▎| 93/100 [02:18<00:02,  2.69it/s]Processing groups:  97%|█████████▋| 97/100 [02:22<00:01,  1.88it/s]Processing groups:  99%|█████████▉| 99/100 [02:23<00:00,  2.13it/s]Processing groups: 100%|██████████| 100/100 [02:23<00:00,  1.43s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.86, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.10it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 31767.81it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:15:27, 45.73s/it]Processing groups:   5%|▌         | 5/100 [00:47<11:29,  7.26s/it]  Processing groups:   9%|▉         | 9/100 [00:48<05:07,  3.38s/it]Processing groups:  15%|█▌        | 15/100 [00:48<02:13,  1.57s/it]Processing groups:  19%|█▉        | 19/100 [00:49<01:27,  1.08s/it]Processing groups:  29%|██▉       | 29/100 [00:50<00:39,  1.80it/s]Processing groups:  29%|██▉       | 29/100 [01:07<00:39,  1.80it/s]Processing groups:  33%|███▎      | 33/100 [01:32<03:14,  2.90s/it]Processing groups:  42%|████▏     | 42/100 [01:34<01:42,  1.76s/it]Processing groups:  45%|████▌     | 45/100 [01:35<01:23,  1.52s/it]Processing groups:  48%|████▊     | 48/100 [01:36<01:06,  1.27s/it]Processing groups:  62%|██████▏   | 62/100 [01:38<00:23,  1.61it/s]Processing groups:  64%|██████▍   | 64/100 [01:38<00:20,  1.75it/s]Processing groups:  65%|██████▌   | 65/100 [02:14<01:45,  3.03s/it]Processing groups:  71%|███████   | 71/100 [02:16<00:58,  2.00s/it]Processing groups:  72%|███████▏  | 72/100 [02:18<00:57,  2.05s/it]Processing groups:  90%|█████████ | 90/100 [02:18<00:06,  1.50it/s]Processing groups:  95%|█████████▌| 95/100 [02:19<00:02,  1.81it/s]Processing groups:  99%|█████████▉| 99/100 [02:23<00:00,  1.54it/s]Processing groups: 100%|██████████| 100/100 [02:23<00:00,  1.44s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.96, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.12it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 32862.99it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:19:35, 48.23s/it]Processing groups:  10%|█         | 10/100 [00:49<05:24,  3.60s/it] Processing groups:  12%|█▏        | 12/100 [00:51<04:22,  2.99s/it]Processing groups:  33%|███▎      | 33/100 [01:29<02:19,  2.08s/it]Processing groups:  36%|███▌      | 36/100 [01:31<02:00,  1.88s/it]Processing groups:  38%|███▊      | 38/100 [01:32<01:47,  1.74s/it]Processing groups:  45%|████▌     | 45/100 [01:34<01:05,  1.20s/it]Processing groups:  47%|████▋     | 47/100 [01:35<00:58,  1.10s/it]Processing groups:  58%|█████▊    | 58/100 [01:35<00:23,  1.76it/s]Processing groups:  60%|██████    | 60/100 [01:35<00:20,  1.91it/s]Processing groups:  61%|██████    | 61/100 [01:36<00:19,  1.96it/s]Processing groups:  64%|██████▍   | 64/100 [01:40<00:27,  1.32it/s]Processing groups:  65%|██████▌   | 65/100 [02:09<02:07,  3.64s/it]Processing groups:  66%|██████▌   | 66/100 [02:12<02:04,  3.65s/it]Processing groups:  67%|██████▋   | 67/100 [02:13<01:44,  3.16s/it]Processing groups:  68%|██████▊   | 68/100 [02:14<01:26,  2.71s/it]Processing groups:  69%|██████▉   | 69/100 [02:17<01:26,  2.78s/it]Processing groups:  76%|███████▌  | 76/100 [02:17<00:21,  1.09it/s]Processing groups:  78%|███████▊  | 78/100 [02:18<00:18,  1.17it/s]Processing groups:  87%|████████▋ | 87/100 [02:19<00:05,  2.53it/s]Processing groups:  96%|█████████▌| 96/100 [02:19<00:00,  4.18it/s]Processing groups:  98%|█████████▊| 98/100 [02:23<00:00,  2.28it/s]Processing groups: 100%|██████████| 100/100 [02:23<00:00,  1.43s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}

Processing n_plates: 3

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.26it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 17302.52it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:32, 31.24s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:43, 15.14s/it]Processing groups:   5%|▌         | 5/100 [00:35<07:06,  4.49s/it]Processing groups:   6%|▌         | 6/100 [00:37<05:56,  3.79s/it]Processing groups:  18%|█▊        | 18/100 [00:38<01:01,  1.33it/s]Processing groups:  28%|██▊       | 28/100 [00:42<00:42,  1.70it/s]Processing groups:  33%|███▎      | 33/100 [01:09<02:02,  1.83s/it]Processing groups:  40%|████      | 40/100 [01:11<01:18,  1.30s/it]Processing groups:  41%|████      | 41/100 [01:11<01:12,  1.23s/it]Processing groups:  42%|████▏     | 42/100 [01:11<01:07,  1.16s/it]Processing groups:  47%|████▋     | 47/100 [01:14<00:46,  1.14it/s]Processing groups:  51%|█████     | 51/100 [01:15<00:34,  1.42it/s]Processing groups:  58%|█████▊    | 58/100 [01:16<00:20,  2.09it/s]Processing groups:  64%|██████▍   | 64/100 [01:19<00:18,  1.96it/s]Processing groups:  65%|██████▌   | 65/100 [01:40<01:12,  2.07s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<01:10,  2.07s/it]Processing groups:  69%|██████▉   | 69/100 [01:45<00:51,  1.66s/it]Processing groups:  70%|███████   | 70/100 [01:45<00:45,  1.51s/it]Processing groups:  74%|███████▍  | 74/100 [01:47<00:28,  1.08s/it]Processing groups:  82%|████████▏ | 82/100 [01:47<00:09,  1.94it/s]Processing groups:  86%|████████▌ | 86/100 [01:48<00:06,  2.28it/s]Processing groups:  92%|█████████▏| 92/100 [01:48<00:02,  3.54it/s]Processing groups:  95%|█████████▌| 95/100 [01:49<00:01,  4.17it/s]Processing groups:  97%|█████████▋| 97/100 [01:51<00:01,  2.45it/s]Processing groups:  99%|█████████▉| 99/100 [01:51<00:00,  2.73it/s]Processing groups: 100%|██████████| 100/100 [01:51<00:00,  1.12s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  3.67it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 15373.32it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:28<47:18, 28.67s/it]Processing groups:   2%|▏         | 2/100 [00:34<25:04, 15.35s/it]Processing groups:   4%|▍         | 4/100 [00:38<10:51,  6.79s/it]Processing groups:  20%|██        | 20/100 [00:41<01:22,  1.03s/it]Processing groups:  33%|███▎      | 33/100 [01:05<01:34,  1.42s/it]Processing groups:  36%|███▌      | 36/100 [01:07<01:23,  1.31s/it]Processing groups:  37%|███▋      | 37/100 [01:08<01:25,  1.35s/it]Processing groups:  41%|████      | 41/100 [01:09<00:59,  1.00s/it]Processing groups:  42%|████▏     | 42/100 [01:09<00:55,  1.05it/s]Processing groups:  44%|████▍     | 44/100 [01:10<00:49,  1.13it/s]Processing groups:  50%|█████     | 50/100 [01:16<00:44,  1.11it/s]Processing groups:  62%|██████▏   | 62/100 [01:19<00:20,  1.85it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<00:55,  1.57s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<00:59,  1.76s/it]Processing groups:  71%|███████   | 71/100 [01:45<00:38,  1.31s/it]Processing groups:  74%|███████▍  | 74/100 [01:46<00:27,  1.04s/it]Processing groups:  82%|████████▏ | 82/100 [01:46<00:10,  1.74it/s]Processing groups:  84%|████████▍ | 84/100 [01:47<00:08,  1.92it/s]Processing groups:  87%|████████▋ | 87/100 [01:47<00:05,  2.28it/s]Processing groups:  89%|████████▉ | 89/100 [01:48<00:04,  2.47it/s]Processing groups:  92%|█████████▏| 92/100 [01:48<00:02,  3.27it/s]Processing groups:  95%|█████████▌| 95/100 [01:48<00:01,  3.67it/s]Processing groups:  96%|█████████▌| 96/100 [01:49<00:01,  3.51it/s]Processing groups:  97%|█████████▋| 97/100 [01:51<00:01,  1.87it/s]Processing groups:  99%|█████████▉| 99/100 [01:51<00:00,  2.50it/s]Processing groups: 100%|██████████| 100/100 [01:51<00:00,  1.11s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 0.02, 'mean_ap_p_value': 0.23, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  3.98it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23489.61it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:28, 33.62s/it]Processing groups:   3%|▎         | 3/100 [00:37<16:29, 10.20s/it]Processing groups:  27%|██▋       | 27/100 [00:37<00:54,  1.33it/s]Processing groups:  27%|██▋       | 27/100 [00:50<00:54,  1.33it/s]Processing groups:  33%|███▎      | 33/100 [01:05<01:54,  1.70s/it]Processing groups:  34%|███▍      | 34/100 [01:08<01:57,  1.79s/it]Processing groups:  40%|████      | 40/100 [01:10<01:19,  1.33s/it]Processing groups:  44%|████▍     | 44/100 [01:12<01:01,  1.10s/it]Processing groups:  49%|████▉     | 49/100 [01:14<00:47,  1.07it/s]Processing groups:  54%|█████▍    | 54/100 [01:17<00:38,  1.19it/s]Processing groups:  54%|█████▍    | 54/100 [01:31<00:38,  1.19it/s]Processing groups:  65%|██████▌   | 65/100 [01:37<00:45,  1.30s/it]Processing groups:  66%|██████▌   | 66/100 [01:41<00:49,  1.47s/it]Processing groups:  68%|██████▊   | 68/100 [01:44<00:46,  1.45s/it]Processing groups:  69%|██████▉   | 69/100 [01:45<00:42,  1.38s/it]Processing groups:  72%|███████▏  | 72/100 [01:45<00:29,  1.05s/it]Processing groups:  76%|███████▌  | 76/100 [01:46<00:16,  1.42it/s]Processing groups:  81%|████████  | 81/100 [01:47<00:09,  1.94it/s]Processing groups:  83%|████████▎ | 83/100 [01:47<00:07,  2.15it/s]Processing groups:  94%|█████████▍| 94/100 [01:48<00:01,  4.57it/s]Processing groups:  97%|█████████▋| 97/100 [01:50<00:00,  3.18it/s]Processing groups:  98%|█████████▊| 98/100 [01:50<00:00,  3.02it/s]Processing groups: 100%|██████████| 100/100 [01:50<00:00,  1.11s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 0.12, 'mean_ap_p_value': 0.63, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  3.75it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 21972.36it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<54:37, 33.11s/it]Processing groups:   3%|▎         | 3/100 [00:36<15:39,  9.68s/it]Processing groups:   4%|▍         | 4/100 [00:36<10:31,  6.58s/it]Processing groups:   6%|▌         | 6/100 [00:38<05:49,  3.72s/it]Processing groups:  23%|██▎       | 23/100 [00:40<00:47,  1.62it/s]Processing groups:  33%|███▎      | 33/100 [01:03<01:29,  1.33s/it]Processing groups:  34%|███▍      | 34/100 [01:03<01:23,  1.27s/it]Processing groups:  35%|███▌      | 35/100 [01:06<01:29,  1.38s/it]Processing groups:  36%|███▌      | 36/100 [01:06<01:21,  1.27s/it]Processing groups:  37%|███▋      | 37/100 [01:08<01:25,  1.35s/it]Processing groups:  39%|███▉      | 39/100 [01:11<01:23,  1.36s/it]Processing groups:  40%|████      | 40/100 [01:11<01:10,  1.17s/it]Processing groups:  47%|████▋     | 47/100 [01:11<00:25,  2.10it/s]Processing groups:  51%|█████     | 51/100 [01:15<00:32,  1.50it/s]Processing groups:  55%|█████▌    | 55/100 [01:19<00:32,  1.39it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<00:48,  1.39s/it]Processing groups:  66%|██████▌   | 66/100 [01:40<00:48,  1.43s/it]Processing groups:  67%|██████▋   | 67/100 [01:41<00:43,  1.33s/it]Processing groups:  69%|██████▉   | 69/100 [01:45<00:44,  1.44s/it]Processing groups:  77%|███████▋  | 77/100 [01:45<00:15,  1.48it/s]Processing groups:  79%|███████▉  | 79/100 [01:45<00:12,  1.64it/s]Processing groups:  81%|████████  | 81/100 [01:46<00:09,  1.91it/s]Processing groups:  87%|████████▋ | 87/100 [01:46<00:03,  3.30it/s]Processing groups:  89%|████████▉ | 89/100 [01:46<00:02,  3.85it/s]Processing groups:  91%|█████████ | 91/100 [01:47<00:02,  3.07it/s]Processing groups:  97%|█████████▋| 97/100 [01:50<00:01,  2.68it/s]Processing groups:  99%|█████████▉| 99/100 [01:50<00:00,  3.13it/s]Processing groups: 100%|██████████| 100/100 [01:50<00:00,  1.10s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.85, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  3.70it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23788.02it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:31, 33.65s/it]Processing groups:   6%|▌         | 6/100 [00:33<06:30,  4.16s/it]Processing groups:  10%|█         | 10/100 [00:34<03:20,  2.22s/it]Processing groups:  12%|█▏        | 12/100 [00:36<02:42,  1.85s/it]Processing groups:  16%|█▌        | 16/100 [00:37<01:34,  1.13s/it]Processing groups:  18%|█▊        | 18/100 [00:37<01:13,  1.12it/s]Processing groups:  23%|██▎       | 23/100 [00:39<00:47,  1.61it/s]Processing groups:  33%|███▎      | 33/100 [01:08<02:10,  1.95s/it]Processing groups:  39%|███▉      | 39/100 [01:09<01:21,  1.33s/it]Processing groups:  42%|████▏     | 42/100 [01:14<01:21,  1.41s/it]Processing groups:  54%|█████▍    | 54/100 [01:16<00:36,  1.27it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<00:41,  1.17s/it]Processing groups:  66%|██████▌   | 66/100 [01:39<00:43,  1.27s/it]Processing groups:  67%|██████▋   | 67/100 [01:42<00:46,  1.40s/it]Processing groups:  68%|██████▊   | 68/100 [01:43<00:43,  1.37s/it]Processing groups:  71%|███████   | 71/100 [01:43<00:29,  1.02s/it]Processing groups:  72%|███████▏  | 72/100 [01:44<00:28,  1.01s/it]Processing groups:  80%|████████  | 80/100 [01:45<00:10,  1.99it/s]Processing groups:  84%|████████▍ | 84/100 [01:46<00:06,  2.43it/s]Processing groups:  88%|████████▊ | 88/100 [01:46<00:04,  2.95it/s]Processing groups:  97%|█████████▋| 97/100 [01:49<00:00,  3.12it/s]Processing groups:  98%|█████████▊| 98/100 [01:49<00:00,  3.19it/s]Processing groups:  99%|█████████▉| 99/100 [01:49<00:00,  3.36it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.10s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.05it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 22599.84it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<56:04, 33.98s/it]Processing groups:   3%|▎         | 3/100 [00:37<16:21, 10.12s/it]Processing groups:  21%|██        | 21/100 [00:39<01:23,  1.05s/it]Processing groups:  33%|███▎      | 33/100 [01:03<01:40,  1.50s/it]Processing groups:  36%|███▌      | 36/100 [01:03<01:22,  1.29s/it]Processing groups:  38%|███▊      | 38/100 [01:09<01:33,  1.50s/it]Processing groups:  39%|███▉      | 39/100 [01:11<01:30,  1.49s/it]Processing groups:  51%|█████     | 51/100 [01:13<00:37,  1.32it/s]Processing groups:  56%|█████▌    | 56/100 [01:14<00:27,  1.62it/s]Processing groups:  64%|██████▍   | 64/100 [01:15<00:15,  2.39it/s]Processing groups:  65%|██████▌   | 65/100 [01:33<00:53,  1.54s/it]Processing groups:  66%|██████▌   | 66/100 [01:36<00:56,  1.66s/it]Processing groups:  68%|██████▊   | 68/100 [01:38<00:48,  1.52s/it]Processing groups:  71%|███████   | 71/100 [01:40<00:35,  1.24s/it]Processing groups:  72%|███████▏  | 72/100 [01:41<00:33,  1.18s/it]Processing groups:  73%|███████▎  | 73/100 [01:42<00:30,  1.14s/it]Processing groups:  78%|███████▊  | 78/100 [01:44<00:17,  1.24it/s]Processing groups:  84%|████████▍ | 84/100 [01:44<00:07,  2.23it/s]Processing groups:  88%|████████▊ | 88/100 [01:45<00:04,  2.89it/s]Processing groups:  90%|█████████ | 90/100 [01:45<00:03,  3.32it/s]Processing groups:  94%|█████████▍| 94/100 [01:45<00:01,  4.64it/s]Processing groups:  96%|█████████▌| 96/100 [01:45<00:00,  5.40it/s]Processing groups:  98%|█████████▊| 98/100 [01:47<00:00,  2.75it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.08s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.05it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23315.94it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<54:34, 33.08s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:53, 14.63s/it]Processing groups:   4%|▍         | 4/100 [00:35<09:00,  5.63s/it]Processing groups:  10%|█         | 10/100 [00:36<02:34,  1.72s/it]Processing groups:  28%|██▊       | 28/100 [00:40<00:40,  1.80it/s]Processing groups:  33%|███▎      | 33/100 [00:58<01:24,  1.26s/it]Processing groups:  34%|███▍      | 34/100 [01:04<01:44,  1.59s/it]Processing groups:  36%|███▌      | 36/100 [01:09<01:51,  1.74s/it]Processing groups:  39%|███▉      | 39/100 [01:13<01:35,  1.57s/it]Processing groups:  54%|█████▍    | 54/100 [01:14<00:29,  1.57it/s]Processing groups:  59%|█████▉    | 59/100 [01:15<00:21,  1.89it/s]Processing groups:  62%|██████▏   | 62/100 [01:15<00:17,  2.15it/s]Processing groups:  63%|██████▎   | 63/100 [01:18<00:23,  1.57it/s]Processing groups:  65%|██████▌   | 65/100 [01:33<01:03,  1.83s/it]Processing groups:  66%|██████▌   | 66/100 [01:38<01:12,  2.14s/it]Processing groups:  67%|██████▋   | 67/100 [01:38<01:03,  1.91s/it]Processing groups:  68%|██████▊   | 68/100 [01:41<01:03,  1.98s/it]Processing groups:  69%|██████▉   | 69/100 [01:43<01:02,  2.00s/it]Processing groups:  70%|███████   | 70/100 [01:44<00:55,  1.86s/it]Processing groups:  72%|███████▏  | 72/100 [01:45<00:36,  1.32s/it]Processing groups:  83%|████████▎ | 83/100 [01:45<00:06,  2.80it/s]Processing groups:  88%|████████▊ | 88/100 [01:46<00:03,  3.91it/s]Processing groups:  91%|█████████ | 91/100 [01:46<00:02,  4.42it/s]Processing groups:  93%|█████████▎| 93/100 [01:47<00:01,  4.12it/s]Processing groups:  94%|█████████▍| 94/100 [01:47<00:01,  3.96it/s]Processing groups:  97%|█████████▋| 97/100 [01:49<00:01,  2.83it/s]Processing groups:  98%|█████████▊| 98/100 [01:49<00:00,  2.77it/s]Processing groups: 100%|██████████| 100/100 [01:49<00:00,  1.10s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.01, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.84it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27109.00it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:39<1:04:44, 39.24s/it]Processing groups:   2%|▏         | 2/100 [00:40<27:21, 16.75s/it]  Processing groups:   3%|▎         | 3/100 [00:46<19:16, 11.93s/it]Processing groups:  24%|██▍       | 24/100 [00:47<01:04,  1.17it/s]Processing groups:  24%|██▍       | 24/100 [01:05<01:04,  1.17it/s]Processing groups:  33%|███▎      | 33/100 [01:22<02:11,  1.96s/it]Processing groups:  34%|███▍      | 34/100 [01:26<02:16,  2.06s/it]Processing groups:  41%|████      | 41/100 [01:28<01:24,  1.44s/it]Processing groups:  59%|█████▉    | 59/100 [01:28<00:26,  1.56it/s]Processing groups:  64%|██████▍   | 64/100 [01:30<00:21,  1.71it/s]Processing groups:  64%|██████▍   | 64/100 [01:45<00:21,  1.71it/s]Processing groups:  65%|██████▌   | 65/100 [02:01<01:12,  2.08s/it]Processing groups:  66%|██████▌   | 66/100 [02:04<01:14,  2.19s/it]Processing groups:  73%|███████▎  | 73/100 [02:05<00:35,  1.33s/it]Processing groups:  75%|███████▌  | 75/100 [02:06<00:30,  1.23s/it]Processing groups:  77%|███████▋  | 77/100 [02:06<00:24,  1.07s/it]Processing groups:  88%|████████▊ | 88/100 [02:07<00:05,  2.12it/s]Processing groups:  91%|█████████ | 91/100 [02:07<00:03,  2.38it/s]Processing groups:  96%|█████████▌| 96/100 [02:07<00:01,  3.24it/s]Processing groups:  98%|█████████▊| 98/100 [02:11<00:01,  1.87it/s]Processing groups: 100%|██████████| 100/100 [02:11<00:00,  1.32s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.88it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 27501.83it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:38<1:03:47, 38.66s/it]Processing groups:   2%|▏         | 2/100 [00:42<29:42, 18.19s/it]  Processing groups:   3%|▎         | 3/100 [00:42<16:09, 10.00s/it]Processing groups:   5%|▌         | 5/100 [00:43<07:23,  4.67s/it]Processing groups:   6%|▌         | 6/100 [00:44<05:31,  3.53s/it]Processing groups:  20%|██        | 20/100 [00:46<00:49,  1.60it/s]Processing groups:  33%|███▎      | 33/100 [01:20<01:52,  1.68s/it]Processing groups:  34%|███▍      | 34/100 [01:20<01:45,  1.60s/it]Processing groups:  35%|███▌      | 35/100 [01:24<01:55,  1.78s/it]Processing groups:  37%|███▋      | 37/100 [01:24<01:34,  1.51s/it]Processing groups:  38%|███▊      | 38/100 [01:27<01:38,  1.59s/it]Processing groups:  53%|█████▎    | 53/100 [01:28<00:26,  1.80it/s]Processing groups:  62%|██████▏   | 62/100 [01:30<00:15,  2.43it/s]Processing groups:  63%|██████▎   | 63/100 [01:31<00:16,  2.22it/s]Processing groups:  65%|██████▌   | 65/100 [02:03<01:30,  2.60s/it]Processing groups:  66%|██████▌   | 66/100 [02:03<01:21,  2.40s/it]Processing groups:  68%|██████▊   | 68/100 [02:05<01:06,  2.08s/it]Processing groups:  69%|██████▉   | 69/100 [02:06<00:59,  1.91s/it]Processing groups:  71%|███████   | 71/100 [02:07<00:43,  1.49s/it]Processing groups:  74%|███████▍  | 74/100 [02:07<00:25,  1.00it/s]Processing groups:  78%|███████▊  | 78/100 [02:07<00:13,  1.60it/s]Processing groups:  79%|███████▉  | 79/100 [02:08<00:12,  1.63it/s]Processing groups:  88%|████████▊ | 88/100 [02:08<00:02,  4.15it/s]Processing groups:  93%|█████████▎| 93/100 [02:08<00:01,  5.50it/s]Processing groups:  96%|█████████▌| 96/100 [02:09<00:00,  6.10it/s]Processing groups:  98%|█████████▊| 98/100 [02:12<00:00,  2.08it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.33s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.22, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.86it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 26316.38it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:39<1:04:53, 39.33s/it]Processing groups:   2%|▏         | 2/100 [00:43<30:41, 18.79s/it]  Processing groups:   7%|▋         | 7/100 [00:44<05:52,  3.79s/it]Processing groups:  12%|█▏        | 12/100 [00:46<02:50,  1.93s/it]Processing groups:  27%|██▋       | 27/100 [00:47<00:47,  1.52it/s]Processing groups:  33%|███▎      | 33/100 [01:26<02:34,  2.31s/it]Processing groups:  38%|███▊      | 38/100 [01:29<01:56,  1.88s/it]Processing groups:  61%|██████    | 61/100 [01:32<00:30,  1.28it/s]Processing groups:  64%|██████▍   | 64/100 [01:32<00:25,  1.40it/s]Processing groups:  65%|██████▌   | 65/100 [02:04<01:16,  2.19s/it]Processing groups:  66%|██████▌   | 66/100 [02:05<01:11,  2.11s/it]Processing groups:  67%|██████▋   | 67/100 [02:06<01:05,  1.99s/it]Processing groups:  68%|██████▊   | 68/100 [02:07<01:00,  1.90s/it]Processing groups:  69%|██████▉   | 69/100 [02:08<00:52,  1.71s/it]Processing groups:  74%|███████▍  | 74/100 [02:08<00:25,  1.03it/s]Processing groups:  80%|████████  | 80/100 [02:09<00:10,  1.85it/s]Processing groups:  88%|████████▊ | 88/100 [02:09<00:03,  3.11it/s]Processing groups:  93%|█████████▎| 93/100 [02:10<00:01,  3.76it/s]Processing groups:  95%|█████████▌| 95/100 [02:10<00:01,  4.07it/s]Processing groups:  97%|█████████▋| 97/100 [02:13<00:01,  2.04it/s]Processing groups:  98%|█████████▊| 98/100 [02:14<00:00,  2.20it/s]Processing groups: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 0.09, 'mean_ap_p_value': 0.71, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.95it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 22568.22it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:08:25, 41.47s/it]Processing groups:   2%|▏         | 2/100 [00:45<31:24, 19.23s/it]  Processing groups:  12%|█▏        | 12/100 [00:47<03:19,  2.26s/it]Processing groups:  33%|███▎      | 33/100 [01:20<01:57,  1.76s/it]Processing groups:  34%|███▍      | 34/100 [01:22<01:57,  1.79s/it]Processing groups:  35%|███▌      | 35/100 [01:24<01:55,  1.77s/it]Processing groups:  37%|███▋      | 37/100 [01:26<01:43,  1.65s/it]Processing groups:  45%|████▌     | 45/100 [01:27<00:52,  1.05it/s]Processing groups:  50%|█████     | 50/100 [01:28<00:35,  1.40it/s]Processing groups:  59%|█████▉    | 59/100 [01:28<00:17,  2.34it/s]Processing groups:  60%|██████    | 60/100 [01:29<00:17,  2.32it/s]Processing groups:  63%|██████▎   | 63/100 [01:29<00:13,  2.74it/s]Processing groups:  64%|██████▍   | 64/100 [01:31<00:17,  2.02it/s]Processing groups:  65%|██████▌   | 65/100 [02:00<02:16,  3.90s/it]Processing groups:  66%|██████▌   | 66/100 [02:03<02:08,  3.78s/it]Processing groups:  67%|██████▋   | 67/100 [02:06<01:55,  3.49s/it]Processing groups:  68%|██████▊   | 68/100 [02:06<01:33,  2.91s/it]Processing groups:  74%|███████▍  | 74/100 [02:07<00:31,  1.21s/it]Processing groups:  81%|████████  | 81/100 [02:08<00:12,  1.53it/s]Processing groups:  87%|████████▋ | 87/100 [02:08<00:05,  2.35it/s]Processing groups:  92%|█████████▏| 92/100 [02:09<00:02,  3.27it/s]Processing groups:  96%|█████████▌| 96/100 [02:09<00:00,  4.30it/s]Processing groups:  98%|█████████▊| 98/100 [02:13<00:00,  2.00it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  2.39it/s]Processing groups: 100%|██████████| 100/100 [02:13<00:00,  1.33s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.72, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.07it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 26372.64it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:49<1:20:59, 49.09s/it]Processing groups:  33%|███▎      | 33/100 [01:22<02:19,  2.08s/it] Processing groups:  34%|███▍      | 34/100 [01:23<02:13,  2.02s/it]Processing groups:  35%|███▌      | 35/100 [01:24<02:09,  1.99s/it]Processing groups:  43%|████▎     | 43/100 [01:25<01:10,  1.23s/it]Processing groups:  55%|█████▌    | 55/100 [01:26<00:31,  1.42it/s]Processing groups:  57%|█████▋    | 57/100 [01:28<00:31,  1.38it/s]Processing groups:  62%|██████▏   | 62/100 [01:29<00:23,  1.61it/s]Processing groups:  63%|██████▎   | 63/100 [01:31<00:24,  1.49it/s]Processing groups:  64%|██████▍   | 64/100 [01:33<00:28,  1.25it/s]Processing groups:  65%|██████▌   | 65/100 [02:05<02:32,  4.37s/it]Processing groups:  67%|██████▋   | 67/100 [02:05<01:51,  3.37s/it]Processing groups:  69%|██████▉   | 69/100 [02:06<01:20,  2.59s/it]Processing groups:  81%|████████  | 81/100 [02:07<00:16,  1.18it/s]Processing groups:  93%|█████████▎| 93/100 [02:07<00:03,  2.28it/s]Processing groups:  95%|█████████▌| 95/100 [02:08<00:02,  2.44it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:01,  1.61it/s]Processing groups:  99%|█████████▉| 99/100 [02:12<00:00,  1.85it/s]Processing groups: 100%|██████████| 100/100 [02:12<00:00,  1.32s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.12it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 26531.12it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:39<1:05:40, 39.80s/it]Processing groups:   2%|▏         | 2/100 [00:43<30:04, 18.42s/it]  Processing groups:   5%|▌         | 5/100 [00:45<09:12,  5.81s/it]Processing groups:  31%|███       | 31/100 [00:46<00:42,  1.63it/s]Processing groups:  31%|███       | 31/100 [01:01<00:42,  1.63it/s]Processing groups:  33%|███▎      | 33/100 [01:21<02:23,  2.14s/it]Processing groups:  34%|███▍      | 34/100 [01:22<02:15,  2.05s/it]Processing groups:  36%|███▌      | 36/100 [01:22<01:52,  1.76s/it]Processing groups:  38%|███▊      | 38/100 [01:22<01:32,  1.49s/it]Processing groups:  41%|████      | 41/100 [01:28<01:31,  1.56s/it]Processing groups:  42%|████▏     | 42/100 [01:28<01:26,  1.49s/it]Processing groups:  62%|██████▏   | 62/100 [01:29<00:13,  2.83it/s]Processing groups:  62%|██████▏   | 62/100 [01:41<00:13,  2.83it/s]Processing groups:  65%|██████▌   | 65/100 [02:04<01:08,  1.97s/it]Processing groups:  66%|██████▌   | 66/100 [02:06<01:06,  1.95s/it]Processing groups:  74%|███████▍  | 74/100 [02:06<00:30,  1.16s/it]Processing groups:  78%|███████▊  | 78/100 [02:06<00:19,  1.11it/s]Processing groups:  81%|████████  | 81/100 [02:07<00:14,  1.31it/s]Processing groups:  84%|████████▍ | 84/100 [02:07<00:09,  1.63it/s]Processing groups:  89%|████████▉ | 89/100 [02:08<00:04,  2.24it/s]Processing groups:  97%|█████████▋| 97/100 [02:12<00:01,  2.10it/s]Processing groups: 100%|██████████| 100/100 [02:12<00:00,  1.32s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.52, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.88it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 26135.99it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:39<1:04:57, 39.37s/it]Processing groups:   2%|▏         | 2/100 [00:43<30:23, 18.60s/it]  Processing groups:   8%|▊         | 8/100 [00:46<05:17,  3.45s/it]Processing groups:  33%|███▎      | 33/100 [01:21<01:57,  1.75s/it]Processing groups:  35%|███▌      | 35/100 [01:23<01:50,  1.69s/it]Processing groups:  41%|████      | 41/100 [01:24<01:15,  1.28s/it]Processing groups:  44%|████▍     | 44/100 [01:25<01:02,  1.12s/it]Processing groups:  46%|████▌     | 46/100 [01:27<00:58,  1.08s/it]Processing groups:  49%|████▉     | 49/100 [01:27<00:46,  1.11it/s]Processing groups:  63%|██████▎   | 63/100 [01:29<00:15,  2.34it/s]Processing groups:  65%|██████▌   | 65/100 [02:03<01:19,  2.26s/it]Processing groups:  66%|██████▌   | 66/100 [02:04<01:13,  2.17s/it]Processing groups:  68%|██████▊   | 68/100 [02:06<01:00,  1.90s/it]Processing groups:  71%|███████   | 71/100 [02:07<00:42,  1.48s/it]Processing groups:  78%|███████▊  | 78/100 [02:07<00:17,  1.24it/s]Processing groups:  90%|█████████ | 90/100 [02:07<00:03,  2.61it/s]Processing groups:  96%|█████████▌| 96/100 [02:08<00:01,  3.35it/s]Processing groups:  98%|█████████▊| 98/100 [02:12<00:00,  2.01it/s]Processing groups: 100%|██████████| 100/100 [02:12<00:00,  1.32s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.74, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.08s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 24579.84it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:57<1:34:43, 57.41s/it]Processing groups:  10%|█         | 10/100 [00:59<06:28,  4.31s/it] Processing groups:  33%|███▎      | 33/100 [01:45<02:51,  2.56s/it]Processing groups:  34%|███▍      | 34/100 [01:49<02:51,  2.60s/it]Processing groups:  40%|████      | 40/100 [01:50<01:54,  1.91s/it]Processing groups:  43%|████▎     | 43/100 [01:50<01:30,  1.60s/it]Processing groups:  45%|████▌     | 45/100 [01:53<01:25,  1.56s/it]Processing groups:  63%|██████▎   | 63/100 [01:54<00:22,  1.68it/s]Processing groups:  63%|██████▎   | 63/100 [02:12<00:22,  1.68it/s]Processing groups:  65%|██████▌   | 65/100 [02:38<01:30,  2.60s/it]Processing groups:  66%|██████▌   | 66/100 [02:41<01:28,  2.61s/it]Processing groups:  68%|██████▊   | 68/100 [02:42<01:14,  2.31s/it]Processing groups:  71%|███████   | 71/100 [02:43<00:51,  1.79s/it]Processing groups:  74%|███████▍  | 74/100 [02:43<00:35,  1.38s/it]Processing groups:  79%|███████▉  | 79/100 [02:44<00:18,  1.14it/s]Processing groups:  82%|████████▏ | 82/100 [02:44<00:12,  1.49it/s]Processing groups:  84%|████████▍ | 84/100 [02:44<00:09,  1.77it/s]Processing groups:  86%|████████▌ | 86/100 [02:45<00:07,  1.94it/s]Processing groups:  90%|█████████ | 90/100 [02:45<00:03,  2.87it/s]Processing groups:  97%|█████████▋| 97/100 [02:50<00:01,  1.83it/s]Processing groups: 100%|██████████| 100/100 [02:50<00:00,  1.71s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.07, 'mean_ap': 0.0, 'mean_ap_p_value': 0.06, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.01s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 29587.36it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:53<1:28:10, 53.44s/it]Processing groups:   2%|▏         | 2/100 [00:57<39:44, 24.33s/it]  Processing groups:  20%|██        | 20/100 [00:58<02:05,  1.57s/it]Processing groups:  33%|███▎      | 33/100 [01:47<02:57,  2.65s/it]Processing groups:  34%|███▍      | 34/100 [01:51<02:59,  2.72s/it]Processing groups:  44%|████▍     | 44/100 [01:53<01:32,  1.65s/it]Processing groups:  45%|████▌     | 45/100 [01:53<01:26,  1.57s/it]Processing groups:  59%|█████▉    | 59/100 [01:54<00:31,  1.30it/s]Processing groups:  60%|██████    | 60/100 [01:54<00:29,  1.35it/s]Processing groups:  61%|██████    | 61/100 [01:56<00:31,  1.25it/s]Processing groups:  63%|██████▎   | 63/100 [01:57<00:27,  1.32it/s]Processing groups:  65%|██████▌   | 65/100 [02:42<02:49,  4.84s/it]Processing groups:  66%|██████▌   | 66/100 [02:42<02:25,  4.29s/it]Processing groups:  67%|██████▋   | 67/100 [02:43<02:08,  3.90s/it]Processing groups:  68%|██████▊   | 68/100 [02:45<01:50,  3.46s/it]Processing groups:  70%|███████   | 70/100 [02:45<01:12,  2.41s/it]Processing groups:  74%|███████▍  | 74/100 [02:46<00:33,  1.27s/it]Processing groups:  77%|███████▋  | 77/100 [02:48<00:25,  1.10s/it]Processing groups:  80%|████████  | 80/100 [02:48<00:15,  1.33it/s]Processing groups:  82%|████████▏ | 82/100 [02:48<00:11,  1.63it/s]Processing groups:  89%|████████▉ | 89/100 [02:49<00:03,  3.01it/s]Processing groups:  94%|█████████▍| 94/100 [02:49<00:01,  4.48it/s]Processing groups:  97%|█████████▋| 97/100 [02:54<00:01,  1.77it/s]Processing groups:  99%|█████████▉| 99/100 [02:54<00:00,  2.10it/s]Processing groups: 100%|██████████| 100/100 [02:54<00:00,  1.75s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.14, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.09s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 24449.45it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:55<1:31:56, 55.72s/it]Processing groups:   2%|▏         | 2/100 [00:58<40:17, 24.67s/it]  Processing groups:   6%|▌         | 6/100 [01:00<09:19,  5.95s/it]Processing groups:  16%|█▌        | 16/100 [01:01<02:18,  1.65s/it]Processing groups:  33%|███▎      | 33/100 [01:47<02:38,  2.36s/it]Processing groups:  34%|███▍      | 34/100 [01:52<02:44,  2.49s/it]Processing groups:  36%|███▌      | 36/100 [01:55<02:30,  2.36s/it]Processing groups:  49%|████▉     | 49/100 [01:55<00:55,  1.08s/it]Processing groups:  53%|█████▎    | 53/100 [01:59<00:49,  1.06s/it]Processing groups:  58%|█████▊    | 58/100 [01:59<00:33,  1.26it/s]Processing groups:  63%|██████▎   | 63/100 [02:00<00:23,  1.59it/s]Processing groups:  63%|██████▎   | 63/100 [02:20<00:23,  1.59it/s]Processing groups:  65%|██████▌   | 65/100 [02:44<01:59,  3.42s/it]Processing groups:  66%|██████▌   | 66/100 [02:48<01:58,  3.49s/it]Processing groups:  69%|██████▉   | 69/100 [02:48<01:19,  2.56s/it]Processing groups:  71%|███████   | 71/100 [02:50<01:04,  2.22s/it]Processing groups:  72%|███████▏  | 72/100 [02:50<00:55,  1.98s/it]Processing groups:  76%|███████▌  | 76/100 [02:51<00:28,  1.19s/it]Processing groups:  77%|███████▋  | 77/100 [02:51<00:24,  1.08s/it]Processing groups:  80%|████████  | 80/100 [02:51<00:14,  1.41it/s]Processing groups:  82%|████████▏ | 82/100 [02:51<00:09,  1.80it/s]Processing groups:  84%|████████▍ | 84/100 [02:52<00:07,  2.01it/s]Processing groups:  93%|█████████▎| 93/100 [02:52<00:01,  5.23it/s]Processing groups:  96%|█████████▌| 96/100 [02:52<00:00,  5.60it/s]Processing groups:  99%|█████████▉| 99/100 [02:58<00:00,  1.75it/s]Processing groups: 100%|██████████| 100/100 [02:58<00:00,  1.78s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.47, 'mean_ap': 0.02, 'mean_ap_p_value': 0.75, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.09s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 19498.41it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:26:41, 52.54s/it]Processing groups:   2%|▏         | 2/100 [00:57<40:22, 24.72s/it]  Processing groups:   3%|▎         | 3/100 [01:00<23:35, 14.60s/it]Processing groups:  33%|███▎      | 33/100 [01:48<02:29,  2.23s/it]Processing groups:  35%|███▌      | 35/100 [01:49<02:17,  2.11s/it]Processing groups:  36%|███▌      | 36/100 [01:51<02:13,  2.09s/it]Processing groups:  37%|███▋      | 37/100 [01:53<02:09,  2.05s/it]Processing groups:  38%|███▊      | 38/100 [01:55<02:10,  2.11s/it]Processing groups:  59%|█████▉    | 59/100 [01:57<00:25,  1.64it/s]Processing groups:  65%|██████▌   | 65/100 [02:43<01:18,  2.25s/it]Processing groups:  66%|██████▌   | 66/100 [02:44<01:13,  2.17s/it]Processing groups:  67%|██████▋   | 67/100 [02:47<01:13,  2.21s/it]Processing groups:  68%|██████▊   | 68/100 [02:47<01:05,  2.04s/it]Processing groups:  71%|███████   | 71/100 [02:48<00:45,  1.57s/it]Processing groups:  72%|███████▏  | 72/100 [02:49<00:43,  1.54s/it]Processing groups:  78%|███████▊  | 78/100 [02:50<00:17,  1.23it/s]Processing groups:  86%|████████▌ | 86/100 [02:51<00:06,  2.18it/s]Processing groups:  94%|█████████▍| 94/100 [02:51<00:01,  3.60it/s]Processing groups:  97%|█████████▋| 97/100 [02:56<00:01,  1.79it/s]Processing groups:  99%|█████████▉| 99/100 [02:56<00:00,  2.06it/s]Processing groups: 100%|██████████| 100/100 [02:56<00:00,  1.77s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.46, 'mean_ap': 0.69, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.03s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 26334.55it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:57<1:34:10, 57.08s/it]Processing groups:   4%|▍         | 4/100 [00:57<17:20, 10.84s/it]  Processing groups:   7%|▋         | 7/100 [00:57<07:58,  5.15s/it]Processing groups:  12%|█▏        | 12/100 [00:59<03:35,  2.45s/it]Processing groups:  30%|███       | 30/100 [01:01<00:49,  1.42it/s]Processing groups:  33%|███▎      | 33/100 [01:46<03:13,  2.88s/it]Processing groups:  34%|███▍      | 34/100 [01:51<03:18,  3.00s/it]Processing groups:  35%|███▌      | 35/100 [01:56<03:23,  3.14s/it]Processing groups:  44%|████▍     | 44/100 [01:56<01:23,  1.49s/it]Processing groups:  46%|████▌     | 46/100 [01:57<01:14,  1.38s/it]Processing groups:  57%|█████▋    | 57/100 [01:58<00:29,  1.44it/s]Processing groups:  63%|██████▎   | 63/100 [01:59<00:18,  1.98it/s]Processing groups:  63%|██████▎   | 63/100 [02:18<00:18,  1.98it/s]Processing groups:  65%|██████▌   | 65/100 [02:43<01:50,  3.16s/it]Processing groups:  66%|██████▌   | 66/100 [02:49<01:55,  3.39s/it]Processing groups:  70%|███████   | 70/100 [02:51<01:13,  2.45s/it]Processing groups:  74%|███████▍  | 74/100 [02:51<00:44,  1.70s/it]Processing groups:  76%|███████▌  | 76/100 [02:52<00:34,  1.46s/it]Processing groups:  84%|████████▍ | 84/100 [02:52<00:11,  1.36it/s]Processing groups:  87%|████████▋ | 87/100 [02:52<00:07,  1.70it/s]Processing groups:  90%|█████████ | 90/100 [02:52<00:04,  2.06it/s]Processing groups:  92%|█████████▏| 92/100 [02:53<00:03,  2.45it/s]Processing groups:  94%|█████████▍| 94/100 [02:53<00:02,  2.78it/s]Processing groups:  97%|█████████▋| 97/100 [02:58<00:02,  1.34it/s]Processing groups:  98%|█████████▊| 98/100 [02:58<00:01,  1.44it/s]Processing groups: 100%|██████████| 100/100 [02:58<00:00,  1.79s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.92, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.10s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 20322.22it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:54<1:30:23, 54.78s/it]Processing groups:   2%|▏         | 2/100 [00:55<37:53, 23.20s/it]  Processing groups:   3%|▎         | 3/100 [00:59<22:58, 14.21s/it]Processing groups:   6%|▌         | 6/100 [00:59<07:34,  4.84s/it]Processing groups:   6%|▌         | 6/100 [01:16<07:34,  4.84s/it]Processing groups:  33%|███▎      | 33/100 [01:50<02:27,  2.20s/it]Processing groups:  34%|███▍      | 34/100 [01:52<02:24,  2.19s/it]Processing groups:  37%|███▋      | 37/100 [01:52<01:56,  1.85s/it]Processing groups:  39%|███▉      | 39/100 [01:56<01:53,  1.86s/it]Processing groups:  58%|█████▊    | 58/100 [01:56<00:28,  1.49it/s]Processing groups:  62%|██████▏   | 62/100 [01:58<00:24,  1.56it/s]Processing groups:  64%|██████▍   | 64/100 [01:59<00:21,  1.64it/s]Processing groups:  64%|██████▍   | 64/100 [02:16<00:21,  1.64it/s]Processing groups:  65%|██████▌   | 65/100 [02:47<02:15,  3.88s/it]Processing groups:  66%|██████▌   | 66/100 [02:49<02:04,  3.67s/it]Processing groups:  70%|███████   | 70/100 [02:50<01:15,  2.53s/it]Processing groups:  74%|███████▍  | 74/100 [02:50<00:44,  1.73s/it]Processing groups:  75%|███████▌  | 75/100 [02:51<00:40,  1.63s/it]Processing groups:  79%|███████▉  | 79/100 [02:51<00:22,  1.06s/it]Processing groups:  93%|█████████▎| 93/100 [02:51<00:02,  2.67it/s]Processing groups:  97%|█████████▋| 97/100 [02:57<00:01,  1.65it/s]Processing groups: 100%|██████████| 100/100 [02:57<00:00,  1.78s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.01it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 30881.34it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:27:12, 52.86s/it]Processing groups:   2%|▏         | 2/100 [01:01<43:29, 26.62s/it]  Processing groups:   9%|▉         | 9/100 [01:02<06:04,  4.00s/it]Processing groups:  33%|███▎      | 33/100 [01:52<02:44,  2.45s/it]Processing groups:  34%|███▍      | 34/100 [01:52<02:34,  2.34s/it]Processing groups:  36%|███▌      | 36/100 [01:52<02:13,  2.08s/it]Processing groups:  38%|███▊      | 38/100 [01:54<02:00,  1.94s/it]Processing groups:  39%|███▉      | 39/100 [01:56<01:55,  1.90s/it]Processing groups:  41%|████      | 41/100 [01:56<01:30,  1.53s/it]Processing groups:  54%|█████▍    | 54/100 [01:57<00:26,  1.76it/s]Processing groups:  55%|█████▌    | 55/100 [01:58<00:26,  1.69it/s]Processing groups:  61%|██████    | 61/100 [01:59<00:18,  2.16it/s]Processing groups:  62%|██████▏   | 62/100 [01:59<00:16,  2.25it/s]Processing groups:  64%|██████▍   | 64/100 [02:00<00:15,  2.39it/s]Processing groups:  65%|██████▌   | 65/100 [02:46<03:21,  5.75s/it]Processing groups:  66%|██████▌   | 66/100 [02:48<02:59,  5.27s/it]Processing groups:  67%|██████▋   | 67/100 [02:49<02:30,  4.56s/it]Processing groups:  69%|██████▉   | 69/100 [02:49<01:36,  3.11s/it]Processing groups:  75%|███████▌  | 75/100 [02:51<00:35,  1.41s/it]Processing groups:  78%|███████▊  | 78/100 [02:51<00:23,  1.05s/it]Processing groups:  79%|███████▉  | 79/100 [02:52<00:20,  1.03it/s]Processing groups:  89%|████████▉ | 89/100 [02:52<00:04,  2.69it/s]Processing groups:  91%|█████████ | 91/100 [02:52<00:03,  2.91it/s]Processing groups:  93%|█████████▎| 93/100 [02:53<00:02,  3.22it/s]Processing groups:  97%|█████████▋| 97/100 [02:58<00:01,  1.54it/s]Processing groups:  98%|█████████▊| 98/100 [02:58<00:01,  1.67it/s]Processing groups: 100%|██████████| 100/100 [02:58<00:00,  1.79s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}

Processing n_plates: 4

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.11it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14806.21it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:40<1:06:06, 40.07s/it]Processing groups:   7%|▋         | 7/100 [00:40<06:35,  4.25s/it]  Processing groups:  14%|█▍        | 14/100 [00:42<02:41,  1.88s/it]Processing groups:  33%|███▎      | 33/100 [01:14<01:55,  1.73s/it]Processing groups:  38%|███▊      | 38/100 [01:15<01:28,  1.42s/it]Processing groups:  43%|████▎     | 43/100 [01:17<01:08,  1.20s/it]Processing groups:  47%|████▋     | 47/100 [01:18<00:53,  1.01s/it]Processing groups:  57%|█████▋    | 57/100 [01:19<00:25,  1.66it/s]Processing groups:  59%|█████▉    | 59/100 [01:20<00:25,  1.62it/s]Processing groups:  61%|██████    | 61/100 [01:20<00:21,  1.85it/s]Processing groups:  63%|██████▎   | 63/100 [01:21<00:17,  2.13it/s]Processing groups:  64%|██████▍   | 64/100 [01:23<00:23,  1.50it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<01:57,  3.36s/it]Processing groups:  66%|██████▌   | 66/100 [01:46<01:42,  3.00s/it]Processing groups:  67%|██████▋   | 67/100 [01:49<01:39,  3.03s/it]Processing groups:  68%|██████▊   | 68/100 [01:51<01:30,  2.81s/it]Processing groups:  69%|██████▉   | 69/100 [01:51<01:08,  2.21s/it]Processing groups:  70%|███████   | 70/100 [01:52<00:56,  1.87s/it]Processing groups:  74%|███████▍  | 74/100 [01:55<00:30,  1.18s/it]Processing groups:  83%|████████▎ | 83/100 [01:55<00:07,  2.33it/s]Processing groups:  92%|█████████▏| 92/100 [01:55<00:02,  3.96it/s]Processing groups:  96%|█████████▌| 96/100 [01:56<00:00,  4.95it/s]Processing groups:  98%|█████████▊| 98/100 [01:59<00:00,  2.57it/s]Processing groups: 100%|██████████| 100/100 [01:59<00:00,  1.19s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.08it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16783.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<54:35, 33.08s/it]Processing groups:   2%|▏         | 2/100 [00:36<25:24, 15.55s/it]Processing groups:   3%|▎         | 3/100 [00:36<13:44,  8.50s/it]Processing groups:   5%|▌         | 5/100 [00:38<06:40,  4.22s/it]Processing groups:  16%|█▌        | 16/100 [00:38<01:08,  1.23it/s]Processing groups:  19%|█▉        | 19/100 [00:39<00:50,  1.59it/s]Processing groups:  21%|██        | 21/100 [00:40<00:50,  1.56it/s]Processing groups:  30%|███       | 30/100 [00:40<00:21,  3.30it/s]Processing groups:  30%|███       | 30/100 [00:53<00:21,  3.30it/s]Processing groups:  33%|███▎      | 33/100 [01:08<02:23,  2.14s/it]Processing groups:  34%|███▍      | 34/100 [01:12<02:36,  2.36s/it]Processing groups:  38%|███▊      | 38/100 [01:17<02:01,  1.97s/it]Processing groups:  53%|█████▎    | 53/100 [01:19<00:36,  1.29it/s]Processing groups:  55%|█████▌    | 55/100 [01:19<00:32,  1.39it/s]Processing groups:  64%|██████▍   | 64/100 [01:21<00:17,  2.05it/s]Processing groups:  65%|██████▌   | 65/100 [01:51<01:19,  2.29s/it]Processing groups:  75%|███████▌  | 75/100 [01:52<00:32,  1.29s/it]Processing groups:  77%|███████▋  | 77/100 [01:52<00:26,  1.15s/it]Processing groups:  78%|███████▊  | 78/100 [01:53<00:24,  1.11s/it]Processing groups:  81%|████████  | 81/100 [01:54<00:16,  1.14it/s]Processing groups:  89%|████████▉ | 89/100 [01:54<00:05,  2.11it/s]Processing groups:  96%|█████████▌| 96/100 [01:54<00:01,  3.13it/s]Processing groups:  98%|█████████▊| 98/100 [01:57<00:00,  2.13it/s]Processing groups: 100%|██████████| 100/100 [01:57<00:00,  1.18s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 0.0, 'mean_ap_p_value': 0.19, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.08it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16952.85it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:58, 34.53s/it]Processing groups:   2%|▏         | 2/100 [00:35<23:59, 14.69s/it]Processing groups:   3%|▎         | 3/100 [00:35<13:01,  8.05s/it]Processing groups:   6%|▌         | 6/100 [00:38<05:27,  3.48s/it]Processing groups:   7%|▋         | 7/100 [00:40<04:40,  3.01s/it]Processing groups:   8%|▊         | 8/100 [00:40<03:29,  2.28s/it]Processing groups:  13%|█▎        | 13/100 [00:40<01:12,  1.20it/s]Processing groups:  23%|██▎       | 23/100 [00:41<00:24,  3.17it/s]Processing groups:  26%|██▌       | 26/100 [00:41<00:19,  3.78it/s]Processing groups:  26%|██▌       | 26/100 [00:54<00:19,  3.78it/s]Processing groups:  33%|███▎      | 33/100 [01:12<02:14,  2.01s/it]Processing groups:  34%|███▍      | 34/100 [01:16<02:24,  2.20s/it]Processing groups:  43%|████▎     | 43/100 [01:16<01:02,  1.10s/it]Processing groups:  46%|████▌     | 46/100 [01:17<00:48,  1.11it/s]Processing groups:  50%|█████     | 50/100 [01:17<00:34,  1.43it/s]Processing groups:  52%|█████▏    | 52/100 [01:17<00:28,  1.68it/s]Processing groups:  60%|██████    | 60/100 [01:21<00:21,  1.89it/s]Processing groups:  64%|██████▍   | 64/100 [01:21<00:14,  2.44it/s]Processing groups:  64%|██████▍   | 64/100 [01:34<00:14,  2.44it/s]Processing groups:  65%|██████▌   | 65/100 [01:48<01:30,  2.58s/it]Processing groups:  66%|██████▌   | 66/100 [01:51<01:31,  2.69s/it]Processing groups:  67%|██████▋   | 67/100 [01:51<01:17,  2.35s/it]Processing groups:  70%|███████   | 70/100 [01:54<00:53,  1.78s/it]Processing groups:  79%|███████▉  | 79/100 [01:54<00:14,  1.41it/s]Processing groups:  82%|████████▏ | 82/100 [01:54<00:10,  1.66it/s]Processing groups:  94%|█████████▍| 94/100 [01:55<00:01,  3.73it/s]Processing groups:  99%|█████████▉| 99/100 [01:58<00:00,  2.70it/s]Processing groups: 100%|██████████| 100/100 [01:58<00:00,  1.18s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 0.02, 'mean_ap_p_value': 0.75, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.12it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 18106.21it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:40<1:07:16, 40.77s/it]Processing groups:  33%|███▎      | 33/100 [01:09<01:57,  1.75s/it] Processing groups:  34%|███▍      | 34/100 [01:10<01:54,  1.73s/it]Processing groups:  35%|███▌      | 35/100 [01:16<02:07,  1.96s/it]Processing groups:  37%|███▋      | 37/100 [01:16<01:47,  1.71s/it]Processing groups:  50%|█████     | 50/100 [01:18<00:40,  1.25it/s]Processing groups:  57%|█████▋    | 57/100 [01:18<00:24,  1.75it/s]Processing groups:  59%|█████▉    | 59/100 [01:18<00:21,  1.86it/s]Processing groups:  61%|██████    | 61/100 [01:19<00:18,  2.07it/s]Processing groups:  62%|██████▏   | 62/100 [01:20<00:21,  1.78it/s]Processing groups:  63%|██████▎   | 63/100 [01:20<00:19,  1.94it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<01:59,  3.40s/it]Processing groups:  66%|██████▌   | 66/100 [01:52<02:10,  3.85s/it]Processing groups:  71%|███████   | 71/100 [01:52<00:55,  1.90s/it]Processing groups:  73%|███████▎  | 73/100 [01:52<00:41,  1.54s/it]Processing groups:  78%|███████▊  | 78/100 [01:53<00:20,  1.08it/s]Processing groups:  88%|████████▊ | 88/100 [01:54<00:05,  2.21it/s]Processing groups:  97%|█████████▋| 97/100 [01:57<00:01,  2.57it/s]Processing groups:  98%|█████████▊| 98/100 [01:57<00:00,  2.63it/s]Processing groups: 100%|██████████| 100/100 [01:57<00:00,  1.18s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.69, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.10it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1019.92it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<59:47, 36.24s/it]Processing groups:   6%|▌         | 6/100 [00:37<07:20,  4.69s/it]Processing groups:  11%|█         | 11/100 [00:41<03:39,  2.47s/it]Processing groups:  29%|██▉       | 29/100 [00:41<00:46,  1.52it/s]Processing groups:  29%|██▉       | 29/100 [00:54<00:46,  1.52it/s]Processing groups:  33%|███▎      | 33/100 [01:09<02:05,  1.87s/it]Processing groups:  34%|███▍      | 34/100 [01:12<02:08,  1.94s/it]Processing groups:  37%|███▋      | 37/100 [01:13<01:40,  1.59s/it]Processing groups:  38%|███▊      | 38/100 [01:17<01:51,  1.79s/it]Processing groups:  42%|████▏     | 42/100 [01:20<01:23,  1.43s/it]Processing groups:  62%|██████▏   | 62/100 [01:20<00:15,  2.40it/s]Processing groups:  62%|██████▏   | 62/100 [01:34<00:15,  2.40it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<00:51,  1.47s/it]Processing groups:  66%|██████▌   | 66/100 [01:46<00:49,  1.46s/it]Processing groups:  70%|███████   | 70/100 [01:53<00:46,  1.54s/it]Processing groups:  78%|███████▊  | 78/100 [01:54<00:20,  1.08it/s]Processing groups:  81%|████████  | 81/100 [01:54<00:14,  1.30it/s]Processing groups:  83%|████████▎ | 83/100 [01:55<00:11,  1.47it/s]Processing groups:  85%|████████▌ | 85/100 [01:55<00:08,  1.75it/s]Processing groups:  94%|█████████▍| 94/100 [01:55<00:01,  3.58it/s]Processing groups:  97%|█████████▋| 97/100 [01:58<00:01,  2.39it/s]Processing groups:  99%|█████████▉| 99/100 [01:58<00:00,  2.75it/s]Processing groups: 100%|██████████| 100/100 [01:58<00:00,  1.18s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.18, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.10it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 24808.09it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<53:29, 32.42s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:28, 14.38s/it]Processing groups:   4%|▍         | 4/100 [00:37<10:28,  6.54s/it]Processing groups:   6%|▌         | 6/100 [00:39<05:49,  3.72s/it]Processing groups:  20%|██        | 20/100 [00:40<00:56,  1.41it/s]Processing groups:  22%|██▏       | 22/100 [00:41<00:53,  1.47it/s]Processing groups:  33%|███▎      | 33/100 [01:08<01:50,  1.65s/it]Processing groups:  34%|███▍      | 34/100 [01:09<01:44,  1.59s/it]Processing groups:  35%|███▌      | 35/100 [01:10<01:42,  1.58s/it]Processing groups:  36%|███▌      | 36/100 [01:11<01:37,  1.52s/it]Processing groups:  38%|███▊      | 38/100 [01:12<01:17,  1.25s/it]Processing groups:  39%|███▉      | 39/100 [01:12<01:06,  1.09s/it]Processing groups:  41%|████      | 41/100 [01:14<00:59,  1.01s/it]Processing groups:  45%|████▌     | 45/100 [01:15<00:38,  1.44it/s]Processing groups:  46%|████▌     | 46/100 [01:16<00:37,  1.43it/s]Processing groups:  48%|████▊     | 48/100 [01:19<00:51,  1.01it/s]Processing groups:  56%|█████▌    | 56/100 [01:19<00:17,  2.55it/s]Processing groups:  56%|█████▌    | 56/100 [01:33<00:17,  2.55it/s]Processing groups:  65%|██████▌   | 65/100 [01:48<01:01,  1.76s/it]Processing groups:  66%|██████▌   | 66/100 [01:51<01:02,  1.84s/it]Processing groups:  71%|███████   | 71/100 [01:52<00:37,  1.29s/it]Processing groups:  77%|███████▋  | 77/100 [01:53<00:19,  1.15it/s]Processing groups:  86%|████████▌ | 86/100 [01:53<00:07,  1.92it/s]Processing groups:  87%|████████▋ | 87/100 [01:54<00:06,  1.99it/s]Processing groups:  89%|████████▉ | 89/100 [01:54<00:04,  2.30it/s]Processing groups:  97%|█████████▋| 97/100 [01:56<00:01,  2.57it/s]Processing groups:  98%|█████████▊| 98/100 [01:57<00:00,  2.69it/s]Processing groups:  99%|█████████▉| 99/100 [01:57<00:00,  2.82it/s]Processing groups: 100%|██████████| 100/100 [01:57<00:00,  1.17s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.08it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 15998.41it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:31, 34.25s/it]Processing groups:   2%|▏         | 2/100 [00:36<24:51, 15.22s/it]Processing groups:   3%|▎         | 3/100 [00:37<14:02,  8.69s/it]Processing groups:   4%|▍         | 4/100 [00:38<09:23,  5.87s/it]Processing groups:   8%|▊         | 8/100 [00:40<03:21,  2.19s/it]Processing groups:  27%|██▋       | 27/100 [00:41<00:30,  2.39it/s]Processing groups:  33%|███▎      | 33/100 [01:12<01:53,  1.70s/it]Processing groups:  34%|███▍      | 34/100 [01:13<01:49,  1.65s/it]Processing groups:  36%|███▌      | 36/100 [01:14<01:33,  1.46s/it]Processing groups:  40%|████      | 40/100 [01:15<01:08,  1.14s/it]Processing groups:  47%|████▋     | 47/100 [01:16<00:38,  1.36it/s]Processing groups:  50%|█████     | 50/100 [01:18<00:34,  1.47it/s]Processing groups:  58%|█████▊    | 58/100 [01:19<00:19,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<00:54,  1.57s/it]Processing groups:  66%|██████▌   | 66/100 [01:49<01:00,  1.78s/it]Processing groups:  71%|███████   | 71/100 [01:52<00:41,  1.42s/it]Processing groups:  84%|████████▍ | 84/100 [01:53<00:10,  1.52it/s]Processing groups:  86%|████████▌ | 86/100 [01:53<00:08,  1.63it/s]Processing groups:  93%|█████████▎| 93/100 [01:54<00:02,  2.35it/s]Processing groups:  97%|█████████▋| 97/100 [01:56<00:01,  2.13it/s]Processing groups:  98%|█████████▊| 98/100 [01:57<00:00,  2.22it/s]Processing groups:  99%|█████████▉| 99/100 [01:57<00:00,  2.37it/s]Processing groups: 100%|██████████| 100/100 [01:57<00:00,  1.17s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.66, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.06it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 20255.49it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:12:11, 43.75s/it]Processing groups:   2%|▏         | 2/100 [00:44<30:34, 18.72s/it]  Processing groups:   3%|▎         | 3/100 [00:46<17:49, 11.02s/it]Processing groups:   4%|▍         | 4/100 [00:48<11:58,  7.48s/it]Processing groups:   5%|▌         | 5/100 [00:49<07:40,  4.84s/it]Processing groups:   7%|▋         | 7/100 [00:49<03:45,  2.43s/it]Processing groups:  12%|█▏        | 12/100 [00:50<01:25,  1.03it/s]Processing groups:  16%|█▌        | 16/100 [00:50<00:55,  1.52it/s]Processing groups:  23%|██▎       | 23/100 [00:51<00:25,  3.02it/s]Processing groups:  26%|██▌       | 26/100 [00:51<00:21,  3.50it/s]Processing groups:  29%|██▉       | 29/100 [00:52<00:18,  3.87it/s]Processing groups:  29%|██▉       | 29/100 [01:04<00:18,  3.87it/s]Processing groups:  33%|███▎      | 33/100 [01:32<03:51,  3.45s/it]Processing groups:  34%|███▍      | 34/100 [01:36<03:53,  3.53s/it]Processing groups:  39%|███▉      | 39/100 [01:37<02:07,  2.09s/it]Processing groups:  41%|████      | 41/100 [01:38<01:44,  1.76s/it]Processing groups:  45%|████▌     | 45/100 [01:41<01:17,  1.41s/it]Processing groups:  54%|█████▍    | 54/100 [01:41<00:31,  1.46it/s]Processing groups:  56%|█████▌    | 56/100 [01:43<00:32,  1.37it/s]Processing groups:  65%|██████▌   | 65/100 [02:19<01:20,  2.29s/it]Processing groups:  66%|██████▌   | 66/100 [02:22<01:20,  2.36s/it]Processing groups:  69%|██████▉   | 69/100 [02:22<00:56,  1.82s/it]Processing groups:  70%|███████   | 70/100 [02:22<00:49,  1.66s/it]Processing groups:  71%|███████   | 71/100 [02:24<00:49,  1.69s/it]Processing groups:  79%|███████▉  | 79/100 [02:26<00:16,  1.26it/s]Processing groups:  90%|█████████ | 90/100 [02:26<00:03,  2.65it/s]Processing groups:  93%|█████████▎| 93/100 [02:26<00:02,  3.06it/s]Processing groups:  95%|█████████▌| 95/100 [02:26<00:01,  3.44it/s]Processing groups:  97%|█████████▋| 97/100 [02:30<00:01,  1.82it/s]Processing groups:  99%|█████████▉| 99/100 [02:30<00:00,  2.10it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  1.51s/it]
{'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.01it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 21407.16it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:24:06, 50.98s/it]Processing groups:  19%|█▉        | 19/100 [00:51<02:38,  1.96s/it] Processing groups:  26%|██▌       | 26/100 [00:53<01:40,  1.35s/it]Processing groups:  26%|██▌       | 26/100 [01:10<01:40,  1.35s/it]Processing groups:  33%|███▎      | 33/100 [01:33<03:06,  2.78s/it]Processing groups:  35%|███▌      | 35/100 [01:34<02:45,  2.54s/it]Processing groups:  36%|███▌      | 36/100 [01:36<02:40,  2.50s/it]Processing groups:  40%|████      | 40/100 [01:36<01:44,  1.75s/it]Processing groups:  42%|████▏     | 42/100 [01:38<01:31,  1.58s/it]Processing groups:  53%|█████▎    | 53/100 [01:38<00:31,  1.50it/s]Processing groups:  55%|█████▌    | 55/100 [01:39<00:29,  1.54it/s]Processing groups:  57%|█████▋    | 57/100 [01:41<00:27,  1.57it/s]Processing groups:  61%|██████    | 61/100 [01:41<00:18,  2.16it/s]Processing groups:  64%|██████▍   | 64/100 [01:43<00:18,  1.91it/s]Processing groups:  65%|██████▌   | 65/100 [02:16<02:18,  3.95s/it]Processing groups:  66%|██████▌   | 66/100 [02:22<02:23,  4.21s/it]Processing groups:  68%|██████▊   | 68/100 [02:24<01:46,  3.33s/it]Processing groups:  69%|██████▉   | 69/100 [02:24<01:27,  2.83s/it]Processing groups:  70%|███████   | 70/100 [02:24<01:09,  2.33s/it]Processing groups:  75%|███████▌  | 75/100 [02:25<00:27,  1.08s/it]Processing groups:  83%|████████▎ | 83/100 [02:25<00:08,  2.08it/s]Processing groups:  85%|████████▌ | 85/100 [02:26<00:07,  2.07it/s]Processing groups:  97%|█████████▋| 97/100 [02:30<00:01,  2.50it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  2.95it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  1.51s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.14, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.03it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 21546.82it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:19, 46.25s/it]Processing groups:   2%|▏         | 2/100 [00:49<33:55, 20.77s/it]  Processing groups:  14%|█▍        | 14/100 [00:53<03:06,  2.16s/it]Processing groups:  33%|███▎      | 33/100 [01:32<02:20,  2.09s/it]Processing groups:  34%|███▍      | 34/100 [01:34<02:17,  2.09s/it]Processing groups:  36%|███▌      | 36/100 [01:35<02:01,  1.91s/it]Processing groups:  39%|███▉      | 39/100 [01:36<01:39,  1.62s/it]Processing groups:  43%|████▎     | 43/100 [01:37<01:08,  1.21s/it]Processing groups:  44%|████▍     | 44/100 [01:38<01:07,  1.20s/it]Processing groups:  47%|████▋     | 47/100 [01:39<00:52,  1.02it/s]Processing groups:  54%|█████▍    | 54/100 [01:40<00:26,  1.72it/s]Processing groups:  57%|█████▋    | 57/100 [01:41<00:20,  2.12it/s]Processing groups:  60%|██████    | 60/100 [01:44<00:23,  1.67it/s]Processing groups:  63%|██████▎   | 63/100 [01:44<00:17,  2.12it/s]Processing groups:  65%|██████▌   | 65/100 [02:19<02:13,  3.81s/it]Processing groups:  66%|██████▌   | 66/100 [02:20<02:00,  3.53s/it]Processing groups:  69%|██████▉   | 69/100 [02:24<01:24,  2.73s/it]Processing groups:  73%|███████▎  | 73/100 [02:27<00:52,  1.94s/it]Processing groups:  89%|████████▉ | 89/100 [02:27<00:06,  1.66it/s]Processing groups:  95%|█████████▌| 95/100 [02:28<00:02,  2.13it/s]Processing groups:  97%|█████████▋| 97/100 [02:31<00:01,  1.64it/s]Processing groups:  99%|█████████▉| 99/100 [02:31<00:00,  1.84it/s]Processing groups: 100%|██████████| 100/100 [02:32<00:00,  1.52s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.01, 'mean_ap_p_value': 0.82, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.03it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 19437.87it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:15:24, 45.71s/it]Processing groups:   2%|▏         | 2/100 [00:48<33:44, 20.66s/it]  Processing groups:   4%|▍         | 4/100 [00:49<12:31,  7.83s/it]Processing groups:   7%|▋         | 7/100 [00:50<05:27,  3.52s/it]Processing groups:  10%|█         | 10/100 [00:51<03:12,  2.14s/it]Processing groups:  15%|█▌        | 15/100 [00:53<01:41,  1.20s/it]Processing groups:  18%|█▊        | 18/100 [00:53<01:14,  1.10it/s]Processing groups:  27%|██▋       | 27/100 [00:54<00:32,  2.26it/s]Processing groups:  33%|███▎      | 33/100 [01:34<02:55,  2.62s/it]Processing groups:  36%|███▌      | 36/100 [01:39<02:36,  2.45s/it]Processing groups:  51%|█████     | 51/100 [01:40<00:51,  1.05s/it]Processing groups:  53%|█████▎    | 53/100 [01:43<00:49,  1.05s/it]Processing groups:  64%|██████▍   | 64/100 [01:46<00:25,  1.39it/s]Processing groups:  65%|██████▌   | 65/100 [02:20<01:28,  2.52s/it]Processing groups:  67%|██████▋   | 67/100 [02:23<01:18,  2.39s/it]Processing groups:  68%|██████▊   | 68/100 [02:24<01:13,  2.30s/it]Processing groups:  70%|███████   | 70/100 [02:25<00:59,  1.97s/it]Processing groups:  73%|███████▎  | 73/100 [02:27<00:40,  1.49s/it]Processing groups:  77%|███████▋  | 77/100 [02:28<00:24,  1.07s/it]Processing groups:  89%|████████▉ | 89/100 [02:28<00:04,  2.28it/s]Processing groups:  93%|█████████▎| 93/100 [02:29<00:02,  2.76it/s]Processing groups:  97%|█████████▋| 97/100 [02:33<00:01,  1.98it/s]Processing groups:  98%|█████████▊| 98/100 [02:33<00:00,  2.07it/s]Processing groups: 100%|██████████| 100/100 [02:33<00:00,  2.47it/s]Processing groups: 100%|██████████| 100/100 [02:33<00:00,  1.53s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 0.67, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.04it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 19686.95it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:22, 46.29s/it]Processing groups:   2%|▏         | 2/100 [00:47<32:09, 19.69s/it]  Processing groups:   3%|▎         | 3/100 [00:48<18:29, 11.44s/it]Processing groups:   8%|▊         | 8/100 [00:52<04:53,  3.19s/it]Processing groups:  20%|██        | 20/100 [00:52<01:11,  1.12it/s]Processing groups:  23%|██▎       | 23/100 [00:54<01:06,  1.15it/s]Processing groups:  23%|██▎       | 23/100 [01:06<01:06,  1.15it/s]Processing groups:  33%|███▎      | 33/100 [01:36<02:46,  2.49s/it]Processing groups:  36%|███▌      | 36/100 [01:36<02:12,  2.07s/it]Processing groups:  38%|███▊      | 38/100 [01:40<02:06,  2.05s/it]Processing groups:  44%|████▍     | 44/100 [01:42<01:18,  1.41s/it]Processing groups:  62%|██████▏   | 62/100 [01:42<00:20,  1.85it/s]Processing groups:  62%|██████▏   | 62/100 [01:56<00:20,  1.85it/s]Processing groups:  65%|██████▌   | 65/100 [02:26<01:22,  2.34s/it]Processing groups:  71%|███████   | 71/100 [02:27<00:51,  1.77s/it]Processing groups:  83%|████████▎ | 83/100 [02:27<00:17,  1.01s/it]Processing groups:  88%|████████▊ | 88/100 [02:28<00:09,  1.22it/s]Processing groups:  92%|█████████▏| 92/100 [02:28<00:05,  1.45it/s]Processing groups:  96%|█████████▌| 96/100 [02:29<00:02,  1.72it/s]Processing groups:  98%|█████████▊| 98/100 [02:33<00:01,  1.31it/s]Processing groups: 100%|██████████| 100/100 [02:33<00:00,  1.53s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.26, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.02it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 19810.62it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:19:33, 48.22s/it]Processing groups:   3%|▎         | 3/100 [00:49<20:41, 12.80s/it]  Processing groups:  11%|█         | 11/100 [00:50<03:46,  2.55s/it]Processing groups:  23%|██▎       | 23/100 [00:52<01:21,  1.06s/it]Processing groups:  33%|███▎      | 33/100 [01:33<02:39,  2.38s/it]Processing groups:  34%|███▍      | 34/100 [01:37<02:41,  2.44s/it]Processing groups:  42%|████▏     | 42/100 [01:40<01:34,  1.63s/it]Processing groups:  45%|████▌     | 45/100 [01:42<01:20,  1.46s/it]Processing groups:  58%|█████▊    | 58/100 [01:42<00:29,  1.41it/s]Processing groups:  64%|██████▍   | 64/100 [01:43<00:19,  1.81it/s]Processing groups:  64%|██████▍   | 64/100 [01:59<00:19,  1.81it/s]Processing groups:  65%|██████▌   | 65/100 [02:24<01:40,  2.87s/it]Processing groups:  66%|██████▌   | 66/100 [02:25<01:33,  2.75s/it]Processing groups:  72%|███████▏  | 72/100 [02:26<00:47,  1.71s/it]Processing groups:  79%|███████▉  | 79/100 [02:27<00:22,  1.09s/it]Processing groups:  87%|████████▋ | 87/100 [02:27<00:08,  1.45it/s]Processing groups:  89%|████████▉ | 89/100 [02:27<00:06,  1.63it/s]Processing groups:  97%|█████████▋| 97/100 [02:32<00:01,  1.70it/s]Processing groups:  98%|█████████▊| 98/100 [02:32<00:01,  1.79it/s]Processing groups: 100%|██████████| 100/100 [02:32<00:00,  1.52s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.23, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.01it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 20866.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:23:10, 50.41s/it]Processing groups:  14%|█▍        | 14/100 [00:51<03:47,  2.64s/it] Processing groups:  25%|██▌       | 25/100 [00:52<01:37,  1.30s/it]Processing groups:  25%|██▌       | 25/100 [01:04<01:37,  1.30s/it]Processing groups:  33%|███▎      | 33/100 [01:30<02:49,  2.54s/it]Processing groups:  34%|███▍      | 34/100 [01:35<02:56,  2.68s/it]Processing groups:  38%|███▊      | 38/100 [01:36<02:04,  2.01s/it]Processing groups:  42%|████▏     | 42/100 [01:37<01:32,  1.59s/it]Processing groups:  44%|████▍     | 44/100 [01:39<01:24,  1.51s/it]Processing groups:  56%|█████▌    | 56/100 [01:42<00:32,  1.35it/s]Processing groups:  64%|██████▍   | 64/100 [01:42<00:18,  1.94it/s]Processing groups:  65%|██████▌   | 65/100 [02:21<01:37,  2.78s/it]Processing groups:  70%|███████   | 70/100 [02:22<01:00,  2.01s/it]Processing groups:  72%|███████▏  | 72/100 [02:23<00:49,  1.78s/it]Processing groups:  75%|███████▌  | 75/100 [02:24<00:36,  1.44s/it]Processing groups:  79%|███████▉  | 79/100 [02:24<00:21,  1.03s/it]Processing groups:  81%|████████  | 81/100 [02:25<00:17,  1.08it/s]Processing groups:  89%|████████▉ | 89/100 [02:26<00:05,  2.14it/s]Processing groups:  97%|█████████▋| 97/100 [02:30<00:01,  2.08it/s]Processing groups:  98%|█████████▊| 98/100 [02:30<00:00,  2.14it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  1.50s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.72, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 25, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.28it/s]100%|██████████| 2/2 [00:01<00:00,  1.24it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 18879.65it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:12<2:00:06, 72.79s/it]Processing groups:   4%|▍         | 4/100 [01:13<22:26, 14.02s/it]  Processing groups:  10%|█         | 10/100 [01:14<06:30,  4.33s/it]Processing groups:  33%|███▎      | 33/100 [02:16<03:22,  3.02s/it]Processing groups:  35%|███▌      | 35/100 [02:17<03:01,  2.80s/it]Processing groups:  36%|███▌      | 36/100 [02:19<02:58,  2.79s/it]Processing groups:  37%|███▋      | 37/100 [02:22<02:52,  2.74s/it]Processing groups:  53%|█████▎    | 53/100 [02:23<00:48,  1.03s/it]Processing groups:  54%|█████▍    | 54/100 [02:26<00:51,  1.13s/it]Processing groups:  64%|██████▍   | 64/100 [02:26<00:23,  1.53it/s]Processing groups:  65%|██████▌   | 65/100 [03:25<02:22,  4.08s/it]Processing groups:  68%|██████▊   | 68/100 [03:26<01:47,  3.35s/it]Processing groups:  69%|██████▉   | 69/100 [03:27<01:35,  3.09s/it]Processing groups:  73%|███████▎  | 73/100 [03:27<00:55,  2.07s/it]Processing groups:  75%|███████▌  | 75/100 [03:29<00:46,  1.86s/it]Processing groups:  78%|███████▊  | 78/100 [03:29<00:29,  1.36s/it]Processing groups:  84%|████████▍ | 84/100 [03:30<00:12,  1.33it/s]Processing groups:  86%|████████▌ | 86/100 [03:30<00:08,  1.59it/s]Processing groups:  89%|████████▉ | 89/100 [03:31<00:05,  1.88it/s]Processing groups:  94%|█████████▍| 94/100 [03:31<00:01,  3.01it/s]Processing groups:  97%|█████████▋| 97/100 [03:37<00:02,  1.25it/s]Processing groups:  99%|█████████▉| 99/100 [03:37<00:00,  1.50it/s]Processing groups: 100%|██████████| 100/100 [03:37<00:00,  2.18s/it]
{'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 25, 'differ_params': 1}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.33it/s]100%|██████████| 2/2 [00:01<00:00,  1.25it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 9724.12it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:07<1:51:40, 67.68s/it]Processing groups:   2%|▏         | 2/100 [01:08<45:59, 28.16s/it]  Processing groups:   3%|▎         | 3/100 [01:09<25:27, 15.75s/it]Processing groups:   5%|▌         | 5/100 [01:09<11:00,  6.95s/it]Processing groups:   6%|▌         | 6/100 [01:12<09:12,  5.87s/it]Processing groups:   8%|▊         | 8/100 [01:13<05:05,  3.32s/it]Processing groups:  33%|███▎      | 33/100 [02:18<02:59,  2.67s/it]Processing groups:  37%|███▋      | 37/100 [02:23<02:34,  2.46s/it]Processing groups:  58%|█████▊    | 58/100 [02:25<00:47,  1.12s/it]Processing groups:  62%|██████▏   | 62/100 [02:27<00:40,  1.07s/it]Processing groups:  65%|██████▌   | 65/100 [03:29<02:01,  3.48s/it]Processing groups:  68%|██████▊   | 68/100 [03:30<01:36,  3.00s/it]Processing groups:  70%|███████   | 70/100 [03:31<01:20,  2.68s/it]Processing groups:  73%|███████▎  | 73/100 [03:31<00:57,  2.13s/it]Processing groups:  75%|███████▌  | 75/100 [03:32<00:45,  1.83s/it]Processing groups:  85%|████████▌ | 85/100 [03:32<00:12,  1.17it/s]Processing groups:  96%|█████████▌| 96/100 [03:33<00:01,  2.07it/s]Processing groups:  98%|█████████▊| 98/100 [03:39<00:01,  1.27it/s]Processing groups:  99%|█████████▉| 99/100 [03:39<00:00,  1.35it/s]Processing groups: 100%|██████████| 100/100 [03:39<00:00,  2.20s/it]
{'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.21, 'mean_ap': 0.0, 'mean_ap_p_value': 0.25, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.33it/s]100%|██████████| 2/2 [00:01<00:00,  1.25it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 10953.76it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:09<1:54:46, 69.56s/it]Processing groups:   3%|▎         | 3/100 [01:10<29:29, 18.24s/it]  Processing groups:   4%|▍         | 4/100 [01:13<20:44, 12.97s/it]Processing groups:  13%|█▎        | 13/100 [01:14<03:35,  2.48s/it]Processing groups:  15%|█▌        | 15/100 [01:14<02:50,  2.01s/it]Processing groups:  32%|███▏      | 32/100 [01:14<00:40,  1.70it/s]Processing groups:  32%|███▏      | 32/100 [01:33<00:40,  1.70it/s]Processing groups:  33%|███▎      | 33/100 [02:14<04:24,  3.95s/it]Processing groups:  34%|███▍      | 34/100 [02:20<04:30,  4.10s/it]Processing groups:  38%|███▊      | 38/100 [02:21<03:03,  2.96s/it]Processing groups:  44%|████▍     | 44/100 [02:23<01:46,  1.91s/it]Processing groups:  49%|████▉     | 49/100 [02:24<01:08,  1.35s/it]Processing groups:  52%|█████▏    | 52/100 [02:25<00:54,  1.15s/it]Processing groups:  65%|██████▌   | 65/100 [03:19<01:40,  2.86s/it]Processing groups:  66%|██████▌   | 66/100 [03:23<01:39,  2.92s/it]Processing groups:  67%|██████▋   | 67/100 [03:25<01:33,  2.83s/it]Processing groups:  68%|██████▊   | 68/100 [03:26<01:25,  2.68s/it]Processing groups:  69%|██████▉   | 69/100 [03:27<01:16,  2.46s/it]Processing groups:  75%|███████▌  | 75/100 [03:27<00:30,  1.20s/it]Processing groups:  77%|███████▋  | 77/100 [03:28<00:25,  1.10s/it]Processing groups:  87%|████████▋ | 87/100 [03:29<00:06,  2.16it/s]Processing groups:  90%|█████████ | 90/100 [03:29<00:03,  2.64it/s]Processing groups:  96%|█████████▌| 96/100 [03:29<00:01,  3.94it/s]Processing groups:  99%|█████████▉| 99/100 [03:36<00:00,  1.50it/s]Processing groups: 100%|██████████| 100/100 [03:36<00:00,  2.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.53, 'mean_ap': 0.0, 'mean_ap_p_value': 0.89, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.64it/s]100%|██████████| 2/2 [00:01<00:00,  1.21it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values:  86%|████████▌ | 86/100 [00:00<00:00, 651.50it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 754.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:04<1:46:14, 64.39s/it]Processing groups:   2%|▏         | 2/100 [01:10<49:34, 30.35s/it]  Processing groups:   4%|▍         | 4/100 [01:12<18:41, 11.68s/it]Processing groups:   9%|▉         | 9/100 [01:12<05:36,  3.70s/it]Processing groups:  33%|███▎      | 33/100 [02:15<03:08,  2.82s/it]Processing groups:  35%|███▌      | 35/100 [02:20<02:59,  2.75s/it]Processing groups:  46%|████▌     | 46/100 [02:21<01:30,  1.68s/it]Processing groups:  51%|█████     | 51/100 [02:23<01:08,  1.39s/it]Processing groups:  61%|██████    | 61/100 [02:23<00:34,  1.12it/s]Processing groups:  63%|██████▎   | 63/100 [02:24<00:30,  1.23it/s]Processing groups:  64%|██████▍   | 64/100 [02:24<00:28,  1.27it/s]Processing groups:  65%|██████▌   | 65/100 [03:27<03:32,  6.07s/it]Processing groups:  69%|██████▉   | 69/100 [03:27<02:07,  4.11s/it]Processing groups:  79%|███████▉  | 79/100 [03:28<00:40,  1.91s/it]Processing groups:  82%|████████▏ | 82/100 [03:28<00:28,  1.58s/it]Processing groups:  88%|████████▊ | 88/100 [03:29<00:12,  1.05s/it]Processing groups:  91%|█████████ | 91/100 [03:29<00:07,  1.17it/s]Processing groups:  93%|█████████▎| 93/100 [03:29<00:05,  1.36it/s]Processing groups:  97%|█████████▋| 97/100 [03:36<00:03,  1.02s/it]Processing groups: 100%|██████████| 100/100 [03:36<00:00,  2.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.94, 'mean_ap': 0.41, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.62it/s]100%|██████████| 2/2 [00:01<00:00,  1.36it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 20904.63it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:09<1:54:53, 69.63s/it]Processing groups:   2%|▏         | 2/100 [01:12<49:51, 30.53s/it]  Processing groups:   7%|▋         | 7/100 [01:14<09:30,  6.14s/it]Processing groups:  33%|███▎      | 33/100 [02:13<03:09,  2.83s/it]Processing groups:  34%|███▍      | 34/100 [02:14<02:59,  2.72s/it]Processing groups:  35%|███▌      | 35/100 [02:17<02:58,  2.74s/it]Processing groups:  48%|████▊     | 48/100 [02:17<01:08,  1.32s/it]Processing groups:  51%|█████     | 51/100 [02:20<01:01,  1.25s/it]Processing groups:  55%|█████▌    | 55/100 [02:20<00:45,  1.00s/it]Processing groups:  57%|█████▋    | 57/100 [02:21<00:38,  1.12it/s]Processing groups:  58%|█████▊    | 58/100 [02:21<00:36,  1.16it/s]Processing groups:  65%|██████▌   | 65/100 [03:21<02:34,  4.43s/it]Processing groups:  66%|██████▌   | 66/100 [03:23<02:23,  4.22s/it]Processing groups:  74%|███████▍  | 74/100 [03:24<00:57,  2.20s/it]Processing groups:  75%|███████▌  | 75/100 [03:24<00:51,  2.04s/it]Processing groups:  80%|████████  | 80/100 [03:25<00:26,  1.30s/it]Processing groups:  85%|████████▌ | 85/100 [03:25<00:13,  1.14it/s]Processing groups:  90%|█████████ | 90/100 [03:25<00:06,  1.62it/s]Processing groups:  97%|█████████▋| 97/100 [03:33<00:02,  1.28it/s]Processing groups:  98%|█████████▊| 98/100 [03:33<00:01,  1.36it/s]Processing groups: 100%|██████████| 100/100 [03:33<00:00,  2.13s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.94, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.31it/s]100%|██████████| 2/2 [00:01<00:00,  1.41it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 23252.60it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:09<1:54:38, 69.48s/it]Processing groups:   6%|▌         | 6/100 [01:10<13:41,  8.73s/it]  Processing groups:  17%|█▋        | 17/100 [01:11<03:20,  2.41s/it]Processing groups:  33%|███▎      | 33/100 [02:11<03:34,  3.21s/it]Processing groups:  35%|███▌      | 35/100 [02:12<03:10,  2.93s/it]Processing groups:  36%|███▌      | 36/100 [02:15<03:10,  2.97s/it]Processing groups:  46%|████▌     | 46/100 [02:18<01:29,  1.65s/it]Processing groups:  60%|██████    | 60/100 [02:18<00:33,  1.18it/s]Processing groups:  64%|██████▍   | 64/100 [02:21<00:30,  1.18it/s]Processing groups:  64%|██████▍   | 64/100 [02:37<00:30,  1.18it/s]Processing groups:  65%|██████▌   | 65/100 [03:16<02:16,  3.89s/it]Processing groups:  67%|██████▋   | 67/100 [03:17<01:52,  3.41s/it]Processing groups:  69%|██████▉   | 69/100 [03:18<01:31,  2.95s/it]Processing groups:  71%|███████   | 71/100 [03:19<01:09,  2.41s/it]Processing groups:  73%|███████▎  | 73/100 [03:21<00:58,  2.17s/it]Processing groups:  95%|█████████▌| 95/100 [03:21<00:02,  2.00it/s]Processing groups: 100%|██████████| 100/100 [03:29<00:00,  2.09s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 2500 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.52it/s]100%|██████████| 2/2 [00:01<00:00,  1.21it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 19352.67it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:10<1:55:57, 70.28s/it]Processing groups:   5%|▌         | 5/100 [01:10<16:39, 10.52s/it]  Processing groups:   7%|▋         | 7/100 [01:13<10:52,  7.02s/it]Processing groups:  33%|███▎      | 33/100 [02:14<03:18,  2.96s/it]Processing groups:  37%|███▋      | 37/100 [02:17<02:44,  2.60s/it]Processing groups:  49%|████▉     | 49/100 [02:18<01:19,  1.56s/it]Processing groups:  56%|█████▌    | 56/100 [02:20<00:54,  1.24s/it]Processing groups:  58%|█████▊    | 58/100 [02:21<00:47,  1.14s/it]Processing groups:  61%|██████    | 61/100 [02:21<00:38,  1.00it/s]Processing groups:  65%|██████▌   | 65/100 [03:20<02:29,  4.27s/it]Processing groups:  66%|██████▌   | 66/100 [03:23<02:22,  4.19s/it]Processing groups:  70%|███████   | 70/100 [03:23<01:26,  2.90s/it]Processing groups:  74%|███████▍  | 74/100 [03:23<00:52,  2.03s/it]Processing groups:  77%|███████▋  | 77/100 [03:24<00:35,  1.56s/it]Processing groups:  81%|████████  | 81/100 [03:24<00:20,  1.10s/it]Processing groups:  82%|████████▏ | 82/100 [03:25<00:19,  1.06s/it]Processing groups:  88%|████████▊ | 88/100 [03:26<00:07,  1.61it/s]Processing groups:  91%|█████████ | 91/100 [03:26<00:04,  2.08it/s]Processing groups:  97%|█████████▋| 97/100 [03:33<00:02,  1.33it/s]Processing groups: 100%|██████████| 100/100 [03:33<00:00,  2.13s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}

Processing n_feats: 5000

Processing n_plates: 2

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  3.99it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14629.59it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<57:42, 34.97s/it]Processing groups:   6%|▌         | 6/100 [00:36<07:03,  4.50s/it]Processing groups:  16%|█▌        | 16/100 [00:36<01:49,  1.31s/it]Processing groups:  19%|█▉        | 19/100 [00:37<01:29,  1.10s/it]Processing groups:  31%|███       | 31/100 [00:40<00:42,  1.64it/s]Processing groups:  33%|███▎      | 33/100 [01:04<02:12,  1.98s/it]Processing groups:  36%|███▌      | 36/100 [01:05<01:42,  1.61s/it]Processing groups:  38%|███▊      | 38/100 [01:08<01:39,  1.61s/it]Processing groups:  44%|████▍     | 44/100 [01:10<01:00,  1.08s/it]Processing groups:  56%|█████▌    | 56/100 [01:11<00:23,  1.89it/s]Processing groups:  59%|█████▉    | 59/100 [01:12<00:20,  1.99it/s]Processing groups:  62%|██████▏   | 62/100 [01:13<00:17,  2.12it/s]Processing groups:  64%|██████▍   | 64/100 [01:16<00:23,  1.51it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<01:24,  2.42s/it]Processing groups:  67%|██████▋   | 67/100 [01:37<01:09,  2.11s/it]Processing groups:  69%|██████▉   | 69/100 [01:42<01:08,  2.20s/it]Processing groups:  70%|███████   | 70/100 [01:42<00:56,  1.90s/it]Processing groups:  71%|███████   | 71/100 [01:42<00:47,  1.65s/it]Processing groups:  77%|███████▋  | 77/100 [01:43<00:15,  1.44it/s]Processing groups:  78%|███████▊  | 78/100 [01:43<00:15,  1.42it/s]Processing groups:  90%|█████████ | 90/100 [01:44<00:02,  3.93it/s]Processing groups:  96%|█████████▌| 96/100 [01:44<00:00,  5.15it/s]Processing groups:  98%|█████████▊| 98/100 [01:47<00:00,  3.15it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.07s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.07, 'mean_ap': 0.18, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.36it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14881.86it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:14, 33.48s/it]Processing groups:   4%|▍         | 4/100 [00:37<11:54,  7.44s/it]Processing groups:  16%|█▌        | 16/100 [00:41<02:10,  1.56s/it]Processing groups:  33%|███▎      | 33/100 [01:05<01:39,  1.48s/it]Processing groups:  34%|███▍      | 34/100 [01:05<01:33,  1.41s/it]Processing groups:  35%|███▌      | 35/100 [01:08<01:39,  1.53s/it]Processing groups:  41%|████      | 41/100 [01:09<01:00,  1.03s/it]Processing groups:  46%|████▌     | 46/100 [01:10<00:42,  1.27it/s]Processing groups:  49%|████▉     | 49/100 [01:10<00:32,  1.55it/s]Processing groups:  55%|█████▌    | 55/100 [01:14<00:27,  1.63it/s]Processing groups:  62%|██████▏   | 62/100 [01:16<00:19,  1.91it/s]Processing groups:  65%|██████▌   | 65/100 [01:34<00:53,  1.54s/it]Processing groups:  66%|██████▌   | 66/100 [01:38<00:59,  1.75s/it]Processing groups:  67%|██████▋   | 67/100 [01:41<00:59,  1.81s/it]Processing groups:  68%|██████▊   | 68/100 [01:41<00:51,  1.62s/it]Processing groups:  73%|███████▎  | 73/100 [01:43<00:28,  1.05s/it]Processing groups:  88%|████████▊ | 88/100 [01:44<00:04,  2.65it/s]Processing groups:  90%|█████████ | 90/100 [01:44<00:03,  2.93it/s]Processing groups:  93%|█████████▎| 93/100 [01:44<00:01,  3.52it/s]Processing groups:  95%|█████████▌| 95/100 [01:45<00:01,  3.64it/s]Processing groups:  97%|█████████▋| 97/100 [01:46<00:01,  2.62it/s]Processing groups:  98%|█████████▊| 98/100 [01:47<00:00,  2.64it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  3.27it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.07s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.05, 'mean_ap': 0.44, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.28it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16683.12it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:44, 30.75s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:50, 15.21s/it]Processing groups:   3%|▎         | 3/100 [00:36<14:11,  8.78s/it]Processing groups:   4%|▍         | 4/100 [00:36<08:47,  5.49s/it]Processing groups:  20%|██        | 20/100 [00:36<00:45,  1.77it/s]Processing groups:  24%|██▍       | 24/100 [00:40<00:48,  1.57it/s]Processing groups:  24%|██▍       | 24/100 [01:00<00:48,  1.57it/s]Processing groups:  33%|███▎      | 33/100 [01:02<01:34,  1.42s/it]Processing groups:  35%|███▌      | 35/100 [01:03<01:24,  1.30s/it]Processing groups:  36%|███▌      | 36/100 [01:03<01:18,  1.23s/it]Processing groups:  37%|███▋      | 37/100 [01:04<01:18,  1.25s/it]Processing groups:  39%|███▉      | 39/100 [01:07<01:16,  1.26s/it]Processing groups:  41%|████      | 41/100 [01:08<01:05,  1.10s/it]Processing groups:  45%|████▌     | 45/100 [01:12<00:54,  1.01it/s]Processing groups:  53%|█████▎    | 53/100 [01:12<00:23,  2.01it/s]Processing groups:  61%|██████    | 61/100 [01:15<00:17,  2.23it/s]Processing groups:  65%|██████▌   | 65/100 [01:36<00:55,  1.59s/it]Processing groups:  70%|███████   | 70/100 [01:39<00:37,  1.26s/it]Processing groups:  71%|███████   | 71/100 [01:39<00:34,  1.20s/it]Processing groups:  72%|███████▏  | 72/100 [01:40<00:31,  1.11s/it]Processing groups:  73%|███████▎  | 73/100 [01:41<00:32,  1.21s/it]Processing groups:  74%|███████▍  | 74/100 [01:43<00:30,  1.19s/it]Processing groups:  75%|███████▌  | 75/100 [01:43<00:25,  1.01s/it]Processing groups:  81%|████████  | 81/100 [01:44<00:09,  2.06it/s]Processing groups:  83%|████████▎ | 83/100 [01:44<00:06,  2.45it/s]Processing groups:  94%|█████████▍| 94/100 [01:44<00:01,  5.55it/s]Processing groups:  97%|█████████▋| 97/100 [01:46<00:00,  3.69it/s]Processing groups:  98%|█████████▊| 98/100 [01:47<00:00,  3.33it/s]Processing groups: 100%|██████████| 100/100 [01:47<00:00,  1.07s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.83, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.12it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16887.32it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:45, 34.40s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:21, 14.30s/it]Processing groups:  18%|█▊        | 18/100 [00:37<01:34,  1.15s/it]Processing groups:  22%|██▏       | 22/100 [00:37<01:08,  1.14it/s]Processing groups:  24%|██▍       | 24/100 [00:37<00:57,  1.32it/s]Processing groups:  24%|██▍       | 24/100 [00:51<00:57,  1.32it/s]Processing groups:  33%|███▎      | 33/100 [01:01<01:53,  1.69s/it]Processing groups:  35%|███▌      | 35/100 [01:03<01:41,  1.55s/it]Processing groups:  36%|███▌      | 36/100 [01:03<01:34,  1.47s/it]Processing groups:  37%|███▋      | 37/100 [01:05<01:33,  1.48s/it]Processing groups:  38%|███▊      | 38/100 [01:07<01:36,  1.56s/it]Processing groups:  43%|████▎     | 43/100 [01:08<00:49,  1.15it/s]Processing groups:  45%|████▌     | 45/100 [01:10<00:52,  1.04it/s]Processing groups:  46%|████▌     | 46/100 [01:13<01:04,  1.19s/it]Processing groups:  65%|██████▌   | 65/100 [01:38<00:45,  1.30s/it]Processing groups:  69%|██████▉   | 69/100 [01:42<00:38,  1.23s/it]Processing groups:  70%|███████   | 70/100 [01:42<00:35,  1.17s/it]Processing groups:  78%|███████▊  | 78/100 [01:42<00:15,  1.44it/s]Processing groups:  80%|████████  | 80/100 [01:43<00:12,  1.60it/s]Processing groups:  86%|████████▌ | 86/100 [01:43<00:06,  2.26it/s]Processing groups:  94%|█████████▍| 94/100 [01:44<00:01,  3.39it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:00,  3.33it/s]Processing groups:  98%|█████████▊| 98/100 [01:46<00:00,  2.87it/s]Processing groups:  99%|█████████▉| 99/100 [01:46<00:00,  3.07it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  1.07s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.0, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.27it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14939.11it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<48:46, 29.56s/it]Processing groups:   3%|▎         | 3/100 [00:35<15:57,  9.87s/it]Processing groups:  23%|██▎       | 23/100 [00:37<01:11,  1.08it/s]Processing groups:  24%|██▍       | 24/100 [00:38<01:13,  1.03it/s]Processing groups:  33%|███▎      | 33/100 [01:02<01:53,  1.70s/it]Processing groups:  35%|███▌      | 35/100 [01:06<01:52,  1.72s/it]Processing groups:  39%|███▉      | 39/100 [01:06<01:19,  1.31s/it]Processing groups:  45%|████▌     | 45/100 [01:10<00:58,  1.06s/it]Processing groups:  57%|█████▋    | 57/100 [01:11<00:24,  1.73it/s]Processing groups:  65%|██████▌   | 65/100 [01:35<00:47,  1.36s/it]Processing groups:  67%|██████▋   | 67/100 [01:37<00:43,  1.30s/it]Processing groups:  69%|██████▉   | 69/100 [01:41<00:43,  1.41s/it]Processing groups:  71%|███████   | 71/100 [01:41<00:35,  1.23s/it]Processing groups:  85%|████████▌ | 85/100 [01:42<00:07,  1.95it/s]Processing groups:  92%|█████████▏| 92/100 [01:43<00:03,  2.60it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:01,  2.58it/s]Processing groups:  98%|█████████▊| 98/100 [01:45<00:00,  2.57it/s]Processing groups: 100%|██████████| 100/100 [01:45<00:00,  1.06s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.24it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14986.08it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:29<49:10, 29.80s/it]Processing groups:   2%|▏         | 2/100 [00:35<25:06, 15.37s/it]Processing groups:  11%|█         | 11/100 [00:35<02:40,  1.81s/it]Processing groups:  15%|█▌        | 15/100 [00:36<01:48,  1.28s/it]Processing groups:  23%|██▎       | 23/100 [00:39<01:02,  1.23it/s]Processing groups:  23%|██▎       | 23/100 [00:55<01:02,  1.23it/s]Processing groups:  33%|███▎      | 33/100 [01:00<01:36,  1.43s/it]Processing groups:  34%|███▍      | 34/100 [01:00<01:29,  1.35s/it]Processing groups:  36%|███▌      | 36/100 [01:09<01:54,  1.79s/it]Processing groups:  50%|█████     | 50/100 [01:11<00:41,  1.21it/s]Processing groups:  53%|█████▎    | 53/100 [01:14<00:39,  1.19it/s]Processing groups:  58%|█████▊    | 58/100 [01:17<00:32,  1.30it/s]Processing groups:  59%|█████▉    | 59/100 [01:17<00:30,  1.37it/s]Processing groups:  65%|██████▌   | 65/100 [01:30<00:44,  1.26s/it]Processing groups:  66%|██████▌   | 66/100 [01:31<00:41,  1.22s/it]Processing groups:  67%|██████▋   | 67/100 [01:38<01:00,  1.83s/it]Processing groups:  69%|██████▉   | 69/100 [01:39<00:46,  1.52s/it]Processing groups:  72%|███████▏  | 72/100 [01:40<00:33,  1.19s/it]Processing groups:  77%|███████▋  | 77/100 [01:42<00:18,  1.21it/s]Processing groups:  84%|████████▍ | 84/100 [01:43<00:07,  2.04it/s]Processing groups:  90%|█████████ | 90/100 [01:43<00:03,  2.91it/s]Processing groups:  94%|█████████▍| 94/100 [01:44<00:01,  3.20it/s]Processing groups:  97%|█████████▋| 97/100 [01:45<00:00,  3.09it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  3.90it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  1.06s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.21it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 1600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 18346.98it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:52, 30.83s/it]Processing groups:   5%|▌         | 5/100 [00:33<08:18,  5.25s/it]Processing groups:  16%|█▌        | 16/100 [00:34<01:46,  1.27s/it]Processing groups:  17%|█▋        | 17/100 [00:35<01:43,  1.25s/it]Processing groups:  28%|██▊       | 28/100 [00:38<00:45,  1.58it/s]Processing groups:  33%|███▎      | 33/100 [01:03<02:03,  1.84s/it]Processing groups:  34%|███▍      | 34/100 [01:05<02:04,  1.89s/it]Processing groups:  36%|███▌      | 36/100 [01:08<01:54,  1.78s/it]Processing groups:  49%|████▉     | 49/100 [01:08<00:36,  1.38it/s]Processing groups:  51%|█████     | 51/100 [01:09<00:33,  1.45it/s]Processing groups:  55%|█████▌    | 55/100 [01:10<00:24,  1.87it/s]Processing groups:  60%|██████    | 60/100 [01:11<00:18,  2.13it/s]Processing groups:  63%|██████▎   | 63/100 [01:14<00:21,  1.70it/s]Processing groups:  64%|██████▍   | 64/100 [01:15<00:19,  1.82it/s]Processing groups:  65%|██████▌   | 65/100 [01:39<01:55,  3.31s/it]Processing groups:  69%|██████▉   | 69/100 [01:41<01:06,  2.15s/it]Processing groups:  70%|███████   | 70/100 [01:42<01:02,  2.07s/it]Processing groups:  82%|████████▏ | 82/100 [01:42<00:12,  1.46it/s]Processing groups:  88%|████████▊ | 88/100 [01:43<00:05,  2.11it/s]Processing groups:  90%|█████████ | 90/100 [01:43<00:04,  2.22it/s]Processing groups:  94%|█████████▍| 94/100 [01:44<00:02,  2.81it/s]Processing groups:  97%|█████████▋| 97/100 [01:46<00:01,  2.23it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  2.85it/s]Processing groups: 100%|██████████| 100/100 [01:46<00:00,  1.07s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 3200, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.07it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 11915.64it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:29, 33.63s/it]Processing groups:   2%|▏         | 2/100 [00:37<25:54, 15.86s/it]Processing groups:   6%|▌         | 6/100 [00:38<06:11,  3.95s/it]Processing groups:   7%|▋         | 7/100 [00:38<04:53,  3.16s/it]Processing groups:  15%|█▌        | 15/100 [00:41<01:35,  1.12s/it]Processing groups:  30%|███       | 30/100 [00:41<00:28,  2.41it/s]Processing groups:  30%|███       | 30/100 [00:59<00:28,  2.41it/s]Processing groups:  33%|███▎      | 33/100 [01:04<01:43,  1.54s/it]Processing groups:  34%|███▍      | 34/100 [01:11<02:03,  1.88s/it]Processing groups:  36%|███▌      | 36/100 [01:13<01:53,  1.77s/it]Processing groups:  37%|███▋      | 37/100 [01:14<01:44,  1.65s/it]Processing groups:  40%|████      | 40/100 [01:15<01:17,  1.29s/it]Processing groups:  41%|████      | 41/100 [01:16<01:13,  1.25s/it]Processing groups:  57%|█████▋    | 57/100 [01:18<00:18,  2.39it/s]Processing groups:  62%|██████▏   | 62/100 [01:19<00:12,  3.02it/s]Processing groups:  63%|██████▎   | 63/100 [01:21<00:18,  2.05it/s]Processing groups:  64%|██████▍   | 64/100 [01:23<00:22,  1.59it/s]Processing groups:  65%|██████▌   | 65/100 [01:42<01:33,  2.66s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<01:40,  2.95s/it]Processing groups:  67%|██████▋   | 67/100 [01:47<01:22,  2.50s/it]Processing groups:  68%|██████▊   | 68/100 [01:49<01:14,  2.32s/it]Processing groups:  69%|██████▉   | 69/100 [01:49<01:00,  1.94s/it]Processing groups:  78%|███████▊  | 78/100 [01:51<00:14,  1.56it/s]Processing groups:  81%|████████  | 81/100 [01:52<00:10,  1.79it/s]Processing groups:  85%|████████▌ | 85/100 [01:52<00:05,  2.51it/s]Processing groups:  93%|█████████▎| 93/100 [01:53<00:01,  4.33it/s]Processing groups:  95%|█████████▌| 95/100 [01:53<00:01,  4.65it/s]Processing groups:  96%|█████████▌| 96/100 [01:53<00:00,  4.52it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.32it/s]Processing groups:  98%|█████████▊| 98/100 [01:56<00:00,  2.36it/s]Processing groups:  99%|█████████▉| 99/100 [01:56<00:00,  2.51it/s]Processing groups: 100%|██████████| 100/100 [01:56<00:00,  1.16s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.01, 'mean_ap': 0.11, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.08it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14633.68it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:28, 30.59s/it]Processing groups:   2%|▏         | 2/100 [00:35<25:30, 15.61s/it]Processing groups:   4%|▍         | 4/100 [00:36<09:35,  5.99s/it]Processing groups:   6%|▌         | 6/100 [00:38<05:52,  3.75s/it]Processing groups:   7%|▋         | 7/100 [00:39<04:47,  3.09s/it]Processing groups:  33%|███▎      | 33/100 [01:02<01:13,  1.10s/it]Processing groups:  34%|███▍      | 34/100 [01:13<01:41,  1.54s/it]Processing groups:  43%|████▎     | 43/100 [01:14<00:56,  1.00it/s]Processing groups:  49%|████▉     | 49/100 [01:14<00:37,  1.34it/s]Processing groups:  51%|█████     | 51/100 [01:17<00:39,  1.24it/s]Processing groups:  60%|██████    | 60/100 [01:19<00:23,  1.71it/s]Processing groups:  65%|██████▌   | 65/100 [01:42<00:54,  1.57s/it]Processing groups:  67%|██████▋   | 67/100 [01:42<00:46,  1.42s/it]Processing groups:  68%|██████▊   | 68/100 [01:46<00:51,  1.62s/it]Processing groups:  72%|███████▏  | 72/100 [01:47<00:31,  1.11s/it]Processing groups:  74%|███████▍  | 74/100 [01:47<00:25,  1.02it/s]Processing groups:  82%|████████▏ | 82/100 [01:49<00:10,  1.77it/s]Processing groups:  84%|████████▍ | 84/100 [01:49<00:07,  2.03it/s]Processing groups:  88%|████████▊ | 88/100 [01:49<00:04,  2.76it/s]Processing groups:  93%|█████████▎| 93/100 [01:50<00:01,  3.80it/s]Processing groups:  96%|█████████▌| 96/100 [01:50<00:01,  3.85it/s]Processing groups:  97%|█████████▋| 97/100 [01:52<00:01,  2.39it/s]Processing groups:  98%|█████████▊| 98/100 [01:53<00:00,  2.26it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.13s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.03, 'mean_ap': 0.34, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.99it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 15639.30it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<59:47, 36.24s/it]Processing groups:   6%|▌         | 6/100 [00:40<08:15,  5.27s/it]Processing groups:  11%|█         | 11/100 [00:41<03:32,  2.38s/it]Processing groups:  33%|███▎      | 33/100 [01:08<01:40,  1.50s/it]Processing groups:  34%|███▍      | 34/100 [01:10<01:38,  1.49s/it]Processing groups:  35%|███▌      | 35/100 [01:14<01:49,  1.68s/it]Processing groups:  41%|████      | 41/100 [01:16<01:09,  1.18s/it]Processing groups:  42%|████▏     | 42/100 [01:16<01:05,  1.12s/it]Processing groups:  43%|████▎     | 43/100 [01:18<01:07,  1.19s/it]Processing groups:  49%|████▉     | 49/100 [01:18<00:33,  1.51it/s]Processing groups:  50%|█████     | 50/100 [01:18<00:30,  1.64it/s]Processing groups:  59%|█████▉    | 59/100 [01:20<00:14,  2.85it/s]Processing groups:  60%|██████    | 60/100 [01:21<00:16,  2.48it/s]Processing groups:  64%|██████▍   | 64/100 [01:22<00:13,  2.67it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<01:31,  2.62s/it]Processing groups:  66%|██████▌   | 66/100 [01:44<01:18,  2.31s/it]Processing groups:  67%|██████▋   | 67/100 [01:49<01:26,  2.64s/it]Processing groups:  68%|██████▊   | 68/100 [01:49<01:11,  2.24s/it]Processing groups:  69%|██████▉   | 69/100 [01:50<00:59,  1.92s/it]Processing groups:  72%|███████▏  | 72/100 [01:52<00:36,  1.32s/it]Processing groups:  73%|███████▎  | 73/100 [01:52<00:29,  1.11s/it]Processing groups:  75%|███████▌  | 75/100 [01:53<00:20,  1.22it/s]Processing groups:  76%|███████▌  | 76/100 [01:53<00:18,  1.28it/s]Processing groups:  90%|█████████ | 90/100 [01:54<00:02,  4.45it/s]Processing groups:  97%|█████████▋| 97/100 [01:57<00:00,  3.57it/s]Processing groups:  98%|█████████▊| 98/100 [01:57<00:00,  3.74it/s]Processing groups: 100%|██████████| 100/100 [01:57<00:00,  1.18s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.07, 'mean_ap': 0.72, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.04it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16421.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:31<51:35, 31.27s/it]Processing groups:   2%|▏         | 2/100 [00:37<26:46, 16.39s/it]Processing groups:   3%|▎         | 3/100 [00:37<14:34,  9.02s/it]Processing groups:  10%|█         | 10/100 [00:37<02:27,  1.64s/it]Processing groups:  14%|█▍        | 14/100 [00:39<01:44,  1.22s/it]Processing groups:  29%|██▉       | 29/100 [00:41<00:32,  2.17it/s]Processing groups:  29%|██▉       | 29/100 [00:55<00:32,  2.17it/s]Processing groups:  33%|███▎      | 33/100 [01:10<02:02,  1.83s/it]Processing groups:  36%|███▌      | 36/100 [01:13<01:49,  1.71s/it]Processing groups:  38%|███▊      | 38/100 [01:15<01:37,  1.58s/it]Processing groups:  44%|████▍     | 44/100 [01:16<00:59,  1.06s/it]Processing groups:  49%|████▉     | 49/100 [01:17<00:40,  1.27it/s]Processing groups:  61%|██████    | 61/100 [01:20<00:19,  1.98it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<00:56,  1.62s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<00:57,  1.69s/it]Processing groups:  68%|██████▊   | 68/100 [01:49<00:50,  1.58s/it]Processing groups:  73%|███████▎  | 73/100 [01:51<00:29,  1.11s/it]Processing groups:  75%|███████▌  | 75/100 [01:51<00:24,  1.03it/s]Processing groups:  80%|████████  | 80/100 [01:51<00:12,  1.61it/s]Processing groups:  84%|████████▍ | 84/100 [01:52<00:07,  2.14it/s]Processing groups:  88%|████████▊ | 88/100 [01:52<00:04,  2.99it/s]Processing groups:  90%|█████████ | 90/100 [01:53<00:03,  2.89it/s]Processing groups:  97%|█████████▋| 97/100 [01:55<00:01,  2.95it/s]Processing groups:  98%|█████████▊| 98/100 [01:55<00:00,  2.95it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.02it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 17079.18it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:10, 34.05s/it]Processing groups:   3%|▎         | 3/100 [00:34<14:29,  8.97s/it]Processing groups:   4%|▍         | 4/100 [00:39<12:13,  7.64s/it]Processing groups:  25%|██▌       | 25/100 [00:41<00:55,  1.35it/s]Processing groups:  30%|███       | 30/100 [00:41<00:40,  1.73it/s]Processing groups:  30%|███       | 30/100 [00:57<00:40,  1.73it/s]Processing groups:  33%|███▎      | 33/100 [01:10<02:21,  2.12s/it]Processing groups:  36%|███▌      | 36/100 [01:14<02:07,  1.99s/it]Processing groups:  40%|████      | 40/100 [01:15<01:30,  1.51s/it]Processing groups:  42%|████▏     | 42/100 [01:19<01:32,  1.59s/it]Processing groups:  53%|█████▎    | 53/100 [01:21<00:37,  1.24it/s]Processing groups:  65%|██████▌   | 65/100 [01:44<00:46,  1.32s/it]Processing groups:  66%|██████▌   | 66/100 [01:50<00:52,  1.53s/it]Processing groups:  69%|██████▉   | 69/100 [01:50<00:39,  1.29s/it]Processing groups:  73%|███████▎  | 73/100 [01:51<00:26,  1.00it/s]Processing groups:  76%|███████▌  | 76/100 [01:51<00:19,  1.22it/s]Processing groups:  77%|███████▋  | 77/100 [01:52<00:18,  1.25it/s]Processing groups:  82%|████████▏ | 82/100 [01:53<00:09,  1.85it/s]Processing groups:  88%|████████▊ | 88/100 [01:53<00:03,  3.01it/s]Processing groups:  90%|█████████ | 90/100 [01:53<00:03,  3.24it/s]Processing groups:  92%|█████████▏| 92/100 [01:54<00:02,  3.13it/s]Processing groups:  95%|█████████▌| 95/100 [01:54<00:01,  3.90it/s]Processing groups:  97%|█████████▋| 97/100 [01:57<00:01,  2.16it/s]Processing groups:  98%|█████████▊| 98/100 [01:57<00:00,  2.39it/s]Processing groups: 100%|██████████| 100/100 [01:57<00:00,  1.18s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.03it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16128.22it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:08:09, 41.31s/it]Processing groups:  20%|██        | 20/100 [00:41<01:58,  1.48s/it] Processing groups:  29%|██▉       | 29/100 [00:43<01:08,  1.03it/s]Processing groups:  29%|██▉       | 29/100 [00:57<01:08,  1.03it/s]Processing groups:  33%|███▎      | 33/100 [01:12<02:29,  2.24s/it]Processing groups:  35%|███▌      | 35/100 [01:15<02:19,  2.15s/it]Processing groups:  38%|███▊      | 38/100 [01:17<01:52,  1.81s/it]Processing groups:  51%|█████     | 51/100 [01:18<00:41,  1.17it/s]Processing groups:  53%|█████▎    | 53/100 [01:18<00:36,  1.30it/s]Processing groups:  55%|█████▌    | 55/100 [01:20<00:34,  1.31it/s]Processing groups:  61%|██████    | 61/100 [01:20<00:19,  2.01it/s]Processing groups:  63%|██████▎   | 63/100 [01:23<00:25,  1.48it/s]Processing groups:  65%|██████▌   | 65/100 [01:50<01:41,  2.89s/it]Processing groups:  66%|██████▌   | 66/100 [01:50<01:28,  2.59s/it]Processing groups:  68%|██████▊   | 68/100 [01:54<01:16,  2.40s/it]Processing groups:  79%|███████▉  | 79/100 [01:54<00:17,  1.18it/s]Processing groups:  87%|████████▋ | 87/100 [01:55<00:07,  1.80it/s]Processing groups:  96%|█████████▌| 96/100 [01:55<00:01,  2.86it/s]Processing groups:  98%|█████████▊| 98/100 [01:59<00:00,  2.07it/s]Processing groups: 100%|██████████| 100/100 [01:59<00:00,  1.19s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.09it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 3200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 15508.61it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<57:28, 34.84s/it]Processing groups:   4%|▍         | 4/100 [00:35<10:48,  6.76s/it]Processing groups:   8%|▊         | 8/100 [00:37<04:31,  2.95s/it]Processing groups:  10%|█         | 10/100 [00:38<03:13,  2.15s/it]Processing groups:  12%|█▏        | 12/100 [00:41<02:53,  1.97s/it]Processing groups:  19%|█▉        | 19/100 [00:41<01:09,  1.16it/s]Processing groups:  32%|███▏      | 32/100 [00:42<00:23,  2.91it/s]Processing groups:  32%|███▏      | 32/100 [00:56<00:23,  2.91it/s]Processing groups:  33%|███▎      | 33/100 [01:10<02:20,  2.10s/it]Processing groups:  34%|███▍      | 34/100 [01:11<02:13,  2.02s/it]Processing groups:  36%|███▌      | 36/100 [01:14<02:01,  1.90s/it]Processing groups:  38%|███▊      | 38/100 [01:14<01:36,  1.56s/it]Processing groups:  39%|███▉      | 39/100 [01:18<01:51,  1.83s/it]Processing groups:  49%|████▉     | 49/100 [01:19<00:36,  1.40it/s]Processing groups:  61%|██████    | 61/100 [01:20<00:15,  2.57it/s]Processing groups:  62%|██████▏   | 62/100 [01:21<00:14,  2.54it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<01:08,  1.95s/it]Processing groups:  66%|██████▌   | 66/100 [01:49<01:10,  2.09s/it]Processing groups:  67%|██████▋   | 67/100 [01:51<01:08,  2.07s/it]Processing groups:  71%|███████   | 71/100 [01:51<00:38,  1.34s/it]Processing groups:  73%|███████▎  | 73/100 [01:52<00:29,  1.08s/it]Processing groups:  74%|███████▍  | 74/100 [01:53<00:30,  1.15s/it]Processing groups:  84%|████████▍ | 84/100 [01:54<00:07,  2.17it/s]Processing groups:  87%|████████▋ | 87/100 [01:55<00:04,  2.66it/s]Processing groups:  96%|█████████▌| 96/100 [01:55<00:00,  4.59it/s]Processing groups:  98%|█████████▊| 98/100 [01:58<00:00,  2.77it/s]Processing groups: 100%|██████████| 100/100 [01:58<00:00,  1.18s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.43, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 3200, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.03it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 15676.71it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:43<1:12:26, 43.90s/it]Processing groups:   2%|▏         | 2/100 [00:49<34:26, 21.09s/it]  Processing groups:   6%|▌         | 6/100 [00:51<08:16,  5.28s/it]Processing groups:  14%|█▍        | 14/100 [00:52<02:27,  1.72s/it]Processing groups:  28%|██▊       | 28/100 [00:52<00:45,  1.57it/s]Processing groups:  28%|██▊       | 28/100 [01:05<00:45,  1.57it/s]Processing groups:  33%|███▎      | 33/100 [01:32<02:44,  2.46s/it]Processing groups:  36%|███▌      | 36/100 [01:33<02:13,  2.08s/it]Processing groups:  39%|███▉      | 39/100 [01:36<01:51,  1.83s/it]Processing groups:  41%|████      | 41/100 [01:39<01:48,  1.84s/it]Processing groups:  49%|████▉     | 49/100 [01:40<00:51,  1.01s/it]Processing groups:  54%|█████▍    | 54/100 [01:41<00:35,  1.31it/s]Processing groups:  56%|█████▌    | 56/100 [01:42<00:30,  1.42it/s]Processing groups:  58%|█████▊    | 58/100 [01:42<00:26,  1.60it/s]Processing groups:  64%|██████▍   | 64/100 [01:45<00:18,  1.90it/s]Processing groups:  65%|██████▌   | 65/100 [02:23<02:20,  4.02s/it]Processing groups:  69%|██████▉   | 69/100 [02:24<01:24,  2.71s/it]Processing groups:  71%|███████   | 71/100 [02:25<01:04,  2.23s/it]Processing groups:  77%|███████▋  | 77/100 [02:25<00:28,  1.26s/it]Processing groups:  79%|███████▉  | 79/100 [02:26<00:22,  1.08s/it]Processing groups:  89%|████████▉ | 89/100 [02:26<00:05,  1.99it/s]Processing groups:  92%|█████████▏| 92/100 [02:27<00:03,  2.23it/s]Processing groups:  96%|█████████▌| 96/100 [02:27<00:01,  2.89it/s]Processing groups:  98%|█████████▊| 98/100 [02:31<00:01,  1.69it/s]Processing groups:  99%|█████████▉| 99/100 [02:31<00:00,  1.83it/s]Processing groups: 100%|██████████| 100/100 [02:31<00:00,  1.52s/it]
{'replicate_reproducibility': 0.02, 'mp_value': 0.08, 'mean_ap': 0.05, 'mean_ap_p_value': 0.06, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.02it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 12895.23it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:52<1:25:51, 52.04s/it]Processing groups:  16%|█▌        | 16/100 [00:54<03:25,  2.45s/it] Processing groups:  33%|███▎      | 33/100 [01:30<02:31,  2.26s/it]Processing groups:  34%|███▍      | 34/100 [01:33<02:30,  2.28s/it]Processing groups:  36%|███▌      | 36/100 [01:36<02:20,  2.19s/it]Processing groups:  37%|███▋      | 37/100 [01:36<02:09,  2.06s/it]Processing groups:  41%|████      | 41/100 [01:39<01:37,  1.65s/it]Processing groups:  48%|████▊     | 48/100 [01:40<00:51,  1.00it/s]Processing groups:  64%|██████▍   | 64/100 [01:46<00:22,  1.63it/s]Processing groups:  65%|██████▌   | 65/100 [02:18<01:15,  2.16s/it]Processing groups:  66%|██████▌   | 66/100 [02:18<01:09,  2.05s/it]Processing groups:  67%|██████▋   | 67/100 [02:22<01:13,  2.24s/it]Processing groups:  71%|███████   | 71/100 [02:24<00:47,  1.64s/it]Processing groups:  76%|███████▌  | 76/100 [02:25<00:25,  1.06s/it]Processing groups:  78%|███████▊  | 78/100 [02:25<00:19,  1.11it/s]Processing groups:  82%|████████▏ | 82/100 [02:25<00:11,  1.59it/s]Processing groups:  87%|████████▋ | 87/100 [02:25<00:05,  2.43it/s]Processing groups:  94%|█████████▍| 94/100 [02:26<00:01,  3.96it/s]Processing groups:  96%|█████████▌| 96/100 [02:27<00:01,  3.41it/s]Processing groups:  98%|█████████▊| 98/100 [02:30<00:01,  1.84it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  1.51s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 0.19, 'mean_ap_p_value': 0.32, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.03it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14212.20it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:15:06, 45.52s/it]Processing groups:   2%|▏         | 2/100 [00:46<31:29, 19.28s/it]  Processing groups:   4%|▍         | 4/100 [00:47<12:09,  7.60s/it]Processing groups:   5%|▌         | 5/100 [00:48<08:32,  5.39s/it]Processing groups:   8%|▊         | 8/100 [00:48<03:47,  2.47s/it]Processing groups:   9%|▉         | 9/100 [00:50<03:18,  2.18s/it]Processing groups:  13%|█▎        | 13/100 [00:51<01:39,  1.14s/it]Processing groups:  17%|█▋        | 17/100 [00:52<01:04,  1.30it/s]Processing groups:  24%|██▍       | 24/100 [00:52<00:30,  2.46it/s]Processing groups:  33%|███▎      | 33/100 [01:30<02:31,  2.25s/it]Processing groups:  34%|███▍      | 34/100 [01:33<02:31,  2.29s/it]Processing groups:  35%|███▌      | 35/100 [01:36<02:33,  2.36s/it]Processing groups:  42%|████▏     | 42/100 [01:37<01:15,  1.30s/it]Processing groups:  46%|████▌     | 46/100 [01:38<00:52,  1.02it/s]Processing groups:  47%|████▋     | 47/100 [01:39<00:55,  1.05s/it]Processing groups:  48%|████▊     | 48/100 [01:40<00:51,  1.02it/s]Processing groups:  56%|█████▌    | 56/100 [01:42<00:25,  1.72it/s]Processing groups:  60%|██████    | 60/100 [01:43<00:20,  1.96it/s]Processing groups:  65%|██████▌   | 65/100 [02:15<01:27,  2.51s/it]Processing groups:  66%|██████▌   | 66/100 [02:17<01:21,  2.40s/it]Processing groups:  67%|██████▋   | 67/100 [02:21<01:27,  2.66s/it]Processing groups:  74%|███████▍  | 74/100 [02:24<00:37,  1.44s/it]Processing groups:  75%|███████▌  | 75/100 [02:24<00:33,  1.33s/it]Processing groups:  79%|███████▉  | 79/100 [02:25<00:20,  1.05it/s]Processing groups:  90%|█████████ | 90/100 [02:25<00:04,  2.44it/s]Processing groups:  94%|█████████▍| 94/100 [02:26<00:01,  3.05it/s]Processing groups:  96%|█████████▌| 96/100 [02:26<00:01,  2.97it/s]Processing groups:  98%|█████████▊| 98/100 [02:30<00:01,  1.74it/s]Processing groups:  99%|█████████▉| 99/100 [02:30<00:00,  1.87it/s]Processing groups: 100%|██████████| 100/100 [02:30<00:00,  1.51s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.19, 'mean_ap': 0.61, 'mean_ap_p_value': 0.75, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.04it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 12710.01it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:09:16, 41.98s/it]Processing groups:   2%|▏         | 2/100 [00:48<34:54, 21.37s/it]  Processing groups:   7%|▋         | 7/100 [00:49<06:25,  4.14s/it]Processing groups:   9%|▉         | 9/100 [00:51<04:45,  3.14s/it]Processing groups:  11%|█         | 11/100 [00:51<03:15,  2.19s/it]Processing groups:  12%|█▏        | 12/100 [00:51<02:43,  1.86s/it]Processing groups:  20%|██        | 20/100 [00:53<00:59,  1.35it/s]Processing groups:  26%|██▌       | 26/100 [00:53<00:33,  2.19it/s]Processing groups:  33%|███▎      | 33/100 [01:28<02:35,  2.33s/it]Processing groups:  34%|███▍      | 34/100 [01:36<03:03,  2.78s/it]Processing groups:  43%|████▎     | 43/100 [01:38<01:26,  1.51s/it]Processing groups:  44%|████▍     | 44/100 [01:39<01:20,  1.44s/it]Processing groups:  52%|█████▏    | 52/100 [01:41<00:42,  1.12it/s]Processing groups:  57%|█████▋    | 57/100 [01:42<00:30,  1.41it/s]Processing groups:  60%|██████    | 60/100 [01:43<00:24,  1.66it/s]Processing groups:  62%|██████▏   | 62/100 [01:45<00:27,  1.40it/s]Processing groups:  65%|██████▌   | 65/100 [02:17<01:51,  3.20s/it]Processing groups:  66%|██████▌   | 66/100 [02:20<01:48,  3.21s/it]Processing groups:  67%|██████▋   | 67/100 [02:22<01:41,  3.08s/it]Processing groups:  71%|███████   | 71/100 [02:24<00:56,  1.94s/it]Processing groups:  80%|████████  | 80/100 [02:26<00:18,  1.09it/s]Processing groups:  84%|████████▍ | 84/100 [02:27<00:11,  1.35it/s]Processing groups:  92%|█████████▏| 92/100 [02:27<00:03,  2.29it/s]Processing groups:  96%|█████████▌| 96/100 [02:27<00:01,  2.86it/s]Processing groups:  98%|█████████▊| 98/100 [02:31<00:01,  1.76it/s]Processing groups: 100%|██████████| 100/100 [02:31<00:00,  1.52s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.46, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.10it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16005.13it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:17:43, 47.10s/it]Processing groups:   2%|▏         | 2/100 [00:49<34:05, 20.87s/it]  Processing groups:   9%|▉         | 9/100 [00:50<04:50,  3.20s/it]Processing groups:  12%|█▏        | 12/100 [00:52<03:18,  2.25s/it]Processing groups:  14%|█▍        | 14/100 [00:52<02:33,  1.78s/it]Processing groups:  24%|██▍       | 24/100 [00:53<00:51,  1.49it/s]Processing groups:  24%|██▍       | 24/100 [01:08<00:51,  1.49it/s]Processing groups:  33%|███▎      | 33/100 [01:36<02:47,  2.51s/it]Processing groups:  38%|███▊      | 38/100 [01:38<02:01,  1.96s/it]Processing groups:  43%|████▎     | 43/100 [01:38<01:22,  1.44s/it]Processing groups:  45%|████▌     | 45/100 [01:38<01:10,  1.28s/it]Processing groups:  51%|█████     | 51/100 [01:41<00:46,  1.06it/s]Processing groups:  57%|█████▋    | 57/100 [01:41<00:27,  1.58it/s]Processing groups:  59%|█████▉    | 59/100 [01:43<00:27,  1.50it/s]Processing groups:  64%|██████▍   | 64/100 [01:45<00:20,  1.77it/s]Processing groups:  65%|██████▌   | 65/100 [02:19<02:03,  3.54s/it]Processing groups:  66%|██████▌   | 66/100 [02:23<02:00,  3.55s/it]Processing groups:  67%|██████▋   | 67/100 [02:25<01:51,  3.38s/it]Processing groups:  68%|██████▊   | 68/100 [02:26<01:32,  2.90s/it]Processing groups:  78%|███████▊  | 78/100 [02:26<00:20,  1.10it/s]Processing groups:  85%|████████▌ | 85/100 [02:27<00:08,  1.75it/s]Processing groups:  89%|████████▉ | 89/100 [02:28<00:05,  2.02it/s]Processing groups:  96%|█████████▌| 96/100 [02:28<00:01,  3.12it/s]Processing groups:  98%|█████████▊| 98/100 [02:32<00:01,  1.83it/s]Processing groups:  99%|█████████▉| 99/100 [02:32<00:00,  1.94it/s]Processing groups: 100%|██████████| 100/100 [02:32<00:00,  1.53s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.51, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.03it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 16582.86it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:51<1:25:13, 51.65s/it]Processing groups:   7%|▋         | 7/100 [00:51<08:26,  5.45s/it]  Processing groups:   9%|▉         | 9/100 [00:52<05:49,  3.84s/it]Processing groups:   9%|▉         | 9/100 [01:02<05:49,  3.84s/it]Processing groups:  33%|███▎      | 33/100 [01:31<02:13,  2.00s/it]Processing groups:  34%|███▍      | 34/100 [01:35<02:17,  2.08s/it]Processing groups:  37%|███▋      | 37/100 [01:36<01:54,  1.82s/it]Processing groups:  42%|████▏     | 42/100 [01:37<01:17,  1.33s/it]Processing groups:  43%|████▎     | 43/100 [01:40<01:25,  1.50s/it]Processing groups:  47%|████▋     | 47/100 [01:41<00:57,  1.09s/it]Processing groups:  48%|████▊     | 48/100 [01:41<00:53,  1.03s/it]Processing groups:  51%|█████     | 51/100 [01:42<00:36,  1.33it/s]Processing groups:  54%|█████▍    | 54/100 [01:42<00:27,  1.66it/s]Processing groups:  64%|██████▍   | 64/100 [01:44<00:12,  2.84it/s]Processing groups:  65%|██████▌   | 65/100 [02:18<01:43,  2.96s/it]Processing groups:  66%|██████▌   | 66/100 [02:19<01:32,  2.74s/it]Processing groups:  67%|██████▋   | 67/100 [02:24<01:40,  3.04s/it]Processing groups:  74%|███████▍  | 74/100 [02:24<00:35,  1.36s/it]Processing groups:  77%|███████▋  | 77/100 [02:25<00:23,  1.04s/it]Processing groups:  79%|███████▉  | 79/100 [02:26<00:19,  1.07it/s]Processing groups:  81%|████████  | 81/100 [02:26<00:14,  1.31it/s]Processing groups:  83%|████████▎ | 83/100 [02:26<00:10,  1.57it/s]Processing groups:  84%|████████▍ | 84/100 [02:27<00:09,  1.67it/s]Processing groups:  87%|████████▋ | 87/100 [02:27<00:05,  2.47it/s]Processing groups:  89%|████████▉ | 89/100 [02:27<00:03,  3.21it/s]Processing groups:  91%|█████████ | 91/100 [02:27<00:02,  3.88it/s]Processing groups:  96%|█████████▌| 96/100 [02:28<00:00,  6.07it/s]Processing groups:  98%|█████████▊| 98/100 [02:32<00:01,  1.81it/s]Processing groups:  99%|█████████▉| 99/100 [02:32<00:00,  2.00it/s]Processing groups: 100%|██████████| 100/100 [02:32<00:00,  1.52s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.98, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.01it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 100, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14271.19it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:23:32, 50.63s/it]Processing groups:   9%|▉         | 9/100 [00:53<06:40,  4.40s/it]  Processing groups:  18%|█▊        | 18/100 [00:54<02:30,  1.84s/it]Processing groups:  33%|███▎      | 33/100 [01:34<02:35,  2.32s/it]Processing groups:  37%|███▋      | 37/100 [01:39<02:15,  2.15s/it]Processing groups:  50%|█████     | 50/100 [01:41<01:00,  1.21s/it]Processing groups:  55%|█████▌    | 55/100 [01:42<00:45,  1.01s/it]Processing groups:  56%|█████▌    | 56/100 [01:43<00:43,  1.00it/s]Processing groups:  64%|██████▍   | 64/100 [01:47<00:29,  1.24it/s]Processing groups:  65%|██████▌   | 65/100 [02:23<01:47,  3.07s/it]Processing groups:  66%|██████▌   | 66/100 [02:25<01:42,  3.02s/it]Processing groups:  80%|████████  | 80/100 [02:26<00:23,  1.17s/it]Processing groups:  86%|████████▌ | 86/100 [02:26<00:12,  1.17it/s]Processing groups:  89%|████████▉ | 89/100 [02:26<00:07,  1.38it/s]Processing groups:  93%|█████████▎| 93/100 [02:27<00:03,  1.78it/s]Processing groups:  95%|█████████▌| 95/100 [02:27<00:02,  1.93it/s]Processing groups:  97%|█████████▋| 97/100 [02:32<00:02,  1.23it/s]Processing groups: 100%|██████████| 100/100 [02:32<00:00,  1.52s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 3200, 'differ_params': 1}

Processing n_plates: 3

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.84it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 10782.27it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:02:31, 37.89s/it]Processing groups:   3%|▎         | 3/100 [00:39<17:08, 10.60s/it]  Processing groups:  15%|█▌        | 15/100 [00:40<02:04,  1.47s/it]Processing groups:  22%|██▏       | 22/100 [00:41<01:09,  1.11it/s]Processing groups:  27%|██▋       | 27/100 [00:42<00:50,  1.46it/s]Processing groups:  29%|██▉       | 29/100 [00:42<00:42,  1.68it/s]Processing groups:  31%|███       | 31/100 [00:42<00:34,  1.98it/s]Processing groups:  31%|███       | 31/100 [00:53<00:34,  1.98it/s]Processing groups:  33%|███▎      | 33/100 [01:08<03:20,  2.99s/it]Processing groups:  34%|███▍      | 34/100 [01:11<03:14,  2.94s/it]Processing groups:  39%|███▉      | 39/100 [01:14<01:53,  1.86s/it]Processing groups:  47%|████▋     | 47/100 [01:14<00:49,  1.08it/s]Processing groups:  49%|████▉     | 49/100 [01:15<00:41,  1.22it/s]Processing groups:  50%|█████     | 50/100 [01:15<00:37,  1.33it/s]Processing groups:  54%|█████▍    | 54/100 [01:16<00:26,  1.71it/s]Processing groups:  58%|█████▊    | 58/100 [01:19<00:26,  1.57it/s]Processing groups:  63%|██████▎   | 63/100 [01:20<00:17,  2.11it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<01:25,  2.44s/it]Processing groups:  66%|██████▌   | 66/100 [01:44<01:15,  2.23s/it]Processing groups:  68%|██████▊   | 68/100 [01:48<01:11,  2.24s/it]Processing groups:  70%|███████   | 70/100 [01:49<00:53,  1.77s/it]Processing groups:  73%|███████▎  | 73/100 [01:50<00:33,  1.24s/it]Processing groups:  75%|███████▌  | 75/100 [01:51<00:26,  1.06s/it]Processing groups:  76%|███████▌  | 76/100 [01:51<00:22,  1.08it/s]Processing groups:  88%|████████▊ | 88/100 [01:51<00:03,  3.75it/s]Processing groups:  91%|█████████ | 91/100 [01:51<00:02,  4.49it/s]Processing groups:  94%|█████████▍| 94/100 [01:52<00:01,  4.79it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  2.89it/s]Processing groups:  99%|█████████▉| 99/100 [01:55<00:00,  3.21it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.15s/it]
{'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.01, 'mean_ap': 0.02, 'mean_ap_p_value': 0.14, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.84it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8680.09it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<57:15, 34.70s/it]Processing groups:   2%|▏         | 2/100 [00:36<25:17, 15.48s/it]Processing groups:   4%|▍         | 4/100 [00:38<09:52,  6.17s/it]Processing groups:   5%|▌         | 5/100 [00:38<06:48,  4.30s/it]Processing groups:  20%|██        | 20/100 [00:38<00:48,  1.65it/s]Processing groups:  22%|██▏       | 22/100 [00:40<00:47,  1.64it/s]Processing groups:  33%|███▎      | 33/100 [01:09<01:54,  1.70s/it]Processing groups:  34%|███▍      | 34/100 [01:10<01:47,  1.63s/it]Processing groups:  38%|███▊      | 38/100 [01:11<01:19,  1.28s/it]Processing groups:  39%|███▉      | 39/100 [01:13<01:22,  1.35s/it]Processing groups:  41%|████      | 41/100 [01:17<01:27,  1.49s/it]Processing groups:  64%|██████▍   | 64/100 [01:20<00:15,  2.31it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<00:51,  1.47s/it]Processing groups:  66%|██████▌   | 66/100 [01:48<00:56,  1.67s/it]Processing groups:  67%|██████▋   | 67/100 [01:48<00:52,  1.58s/it]Processing groups:  74%|███████▍  | 74/100 [01:49<00:23,  1.12it/s]Processing groups:  79%|███████▉  | 79/100 [01:50<00:14,  1.46it/s]Processing groups:  89%|████████▉ | 89/100 [01:50<00:04,  2.66it/s]Processing groups:  94%|█████████▍| 94/100 [01:50<00:01,  3.39it/s]Processing groups:  97%|█████████▋| 97/100 [01:53<00:01,  2.33it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.0, 'mean_ap': 0.04, 'mean_ap_p_value': 0.32, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.76it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 12791.41it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:01:36, 37.34s/it]Processing groups:   3%|▎         | 3/100 [00:37<15:57,  9.87s/it]  Processing groups:   4%|▍         | 4/100 [00:37<10:23,  6.50s/it]Processing groups:  18%|█▊        | 18/100 [00:40<01:20,  1.01it/s]Processing groups:  23%|██▎       | 23/100 [00:40<00:54,  1.42it/s]Processing groups:  28%|██▊       | 28/100 [00:41<00:35,  2.02it/s]Processing groups:  28%|██▊       | 28/100 [00:59<00:35,  2.02it/s]Processing groups:  33%|███▎      | 33/100 [01:07<02:11,  1.97s/it]Processing groups:  34%|███▍      | 34/100 [01:11<02:19,  2.12s/it]Processing groups:  38%|███▊      | 38/100 [01:12<01:34,  1.53s/it]Processing groups:  40%|████      | 40/100 [01:15<01:32,  1.54s/it]Processing groups:  46%|████▌     | 46/100 [01:16<00:48,  1.12it/s]Processing groups:  48%|████▊     | 48/100 [01:16<00:41,  1.26it/s]Processing groups:  51%|█████     | 51/100 [01:17<00:30,  1.59it/s]Processing groups:  55%|█████▌    | 55/100 [01:19<00:26,  1.68it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<00:59,  1.69s/it]Processing groups:  66%|██████▌   | 66/100 [01:47<00:57,  1.69s/it]Processing groups:  71%|███████   | 71/100 [01:47<00:33,  1.17s/it]Processing groups:  72%|███████▏  | 72/100 [01:49<00:34,  1.24s/it]Processing groups:  76%|███████▌  | 76/100 [01:50<00:20,  1.16it/s]Processing groups:  83%|████████▎ | 83/100 [01:50<00:08,  2.03it/s]Processing groups:  84%|████████▍ | 84/100 [01:50<00:07,  2.17it/s]Processing groups:  89%|████████▉ | 89/100 [01:51<00:03,  2.77it/s]Processing groups:  96%|█████████▌| 96/100 [01:52<00:00,  4.48it/s]Processing groups:  98%|█████████▊| 98/100 [01:55<00:00,  2.42it/s]Processing groups: 100%|██████████| 100/100 [01:55<00:00,  1.15s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.1, 'mean_ap': 0.51, 'mean_ap_p_value': 0.92, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.86it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 13785.26it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:35<58:33, 35.49s/it]Processing groups:   4%|▍         | 4/100 [00:37<11:29,  7.18s/it]Processing groups:   8%|▊         | 8/100 [00:37<04:29,  2.93s/it]Processing groups:  11%|█         | 11/100 [00:38<02:49,  1.91s/it]Processing groups:  33%|███▎      | 33/100 [01:09<01:40,  1.50s/it]Processing groups:  34%|███▍      | 34/100 [01:12<01:41,  1.54s/it]Processing groups:  41%|████      | 41/100 [01:12<01:03,  1.07s/it]Processing groups:  47%|████▋     | 47/100 [01:18<00:54,  1.03s/it]Processing groups:  48%|████▊     | 48/100 [01:18<00:50,  1.04it/s]Processing groups:  49%|████▉     | 49/100 [01:18<00:46,  1.11it/s]Processing groups:  65%|██████▌   | 65/100 [01:43<00:46,  1.33s/it]Processing groups:  66%|██████▌   | 66/100 [01:44<00:44,  1.31s/it]Processing groups:  67%|██████▋   | 67/100 [01:46<00:45,  1.37s/it]Processing groups:  68%|██████▊   | 68/100 [01:47<00:41,  1.31s/it]Processing groups:  70%|███████   | 70/100 [01:48<00:33,  1.11s/it]Processing groups:  72%|███████▏  | 72/100 [01:48<00:24,  1.15it/s]Processing groups:  75%|███████▌  | 75/100 [01:49<00:16,  1.49it/s]Processing groups:  85%|████████▌ | 85/100 [01:49<00:04,  3.50it/s]Processing groups:  89%|████████▉ | 89/100 [01:49<00:02,  4.34it/s]Processing groups:  93%|█████████▎| 93/100 [01:50<00:01,  4.49it/s]Processing groups:  97%|█████████▋| 97/100 [01:53<00:01,  2.64it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.68it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 15434.99it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:32<54:25, 32.99s/it]Processing groups:   3%|▎         | 3/100 [00:35<15:30,  9.60s/it]Processing groups:   4%|▍         | 4/100 [00:36<10:35,  6.62s/it]Processing groups:  11%|█         | 11/100 [00:39<02:34,  1.74s/it]Processing groups:  31%|███       | 31/100 [00:41<00:35,  1.93it/s]Processing groups:  33%|███▎      | 33/100 [01:03<01:42,  1.53s/it]Processing groups:  34%|███▍      | 34/100 [01:05<01:43,  1.57s/it]Processing groups:  35%|███▌      | 35/100 [01:10<01:59,  1.84s/it]Processing groups:  36%|███▌      | 36/100 [01:12<02:03,  1.93s/it]Processing groups:  41%|████      | 41/100 [01:13<01:08,  1.16s/it]Processing groups:  48%|████▊     | 48/100 [01:15<00:39,  1.32it/s]Processing groups:  55%|█████▌    | 55/100 [01:16<00:23,  1.93it/s]Processing groups:  58%|█████▊    | 58/100 [01:18<00:21,  1.94it/s]Processing groups:  65%|██████▌   | 65/100 [01:42<00:57,  1.64s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<00:56,  1.67s/it]Processing groups:  69%|██████▉   | 69/100 [01:46<00:46,  1.49s/it]Processing groups:  72%|███████▏  | 72/100 [01:48<00:35,  1.26s/it]Processing groups:  81%|████████  | 81/100 [01:49<00:12,  1.55it/s]Processing groups:  88%|████████▊ | 88/100 [01:49<00:05,  2.36it/s]Processing groups:  94%|█████████▍| 94/100 [01:49<00:01,  3.31it/s]Processing groups:  97%|█████████▋| 97/100 [01:52<00:01,  2.29it/s]Processing groups:  99%|█████████▉| 99/100 [01:53<00:00,  2.60it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.13s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.04, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.05it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14726.16it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:37<1:01:23, 37.21s/it]Processing groups:   3%|▎         | 3/100 [00:38<16:21, 10.11s/it]  Processing groups:  22%|██▏       | 22/100 [00:38<01:12,  1.08it/s]Processing groups:  27%|██▋       | 27/100 [00:40<00:57,  1.27it/s]Processing groups:  32%|███▏      | 32/100 [00:41<00:40,  1.67it/s]Processing groups:  32%|███▏      | 32/100 [01:00<00:40,  1.67it/s]Processing groups:  33%|███▎      | 33/100 [01:08<02:46,  2.49s/it]Processing groups:  34%|███▍      | 34/100 [01:09<02:33,  2.33s/it]Processing groups:  36%|███▌      | 36/100 [01:16<02:44,  2.57s/it]Processing groups:  41%|████      | 41/100 [01:16<01:30,  1.53s/it]Processing groups:  53%|█████▎    | 53/100 [01:18<00:33,  1.42it/s]Processing groups:  60%|██████    | 60/100 [01:19<00:20,  1.92it/s]Processing groups:  65%|██████▌   | 65/100 [01:45<00:59,  1.70s/it]Processing groups:  67%|██████▋   | 67/100 [01:46<00:52,  1.59s/it]Processing groups:  71%|███████   | 71/100 [01:47<00:34,  1.19s/it]Processing groups:  73%|███████▎  | 73/100 [01:49<00:31,  1.18s/it]Processing groups:  83%|████████▎ | 83/100 [01:49<00:09,  1.75it/s]Processing groups:  86%|████████▌ | 86/100 [01:50<00:06,  2.05it/s]Processing groups:  88%|████████▊ | 88/100 [01:50<00:05,  2.28it/s]Processing groups:  91%|█████████ | 91/100 [01:51<00:03,  2.72it/s]Processing groups:  93%|█████████▎| 93/100 [01:51<00:02,  3.14it/s]Processing groups:  94%|█████████▍| 94/100 [01:51<00:01,  3.26it/s]Processing groups:  97%|█████████▋| 97/100 [01:54<00:01,  1.92it/s]Processing groups: 100%|██████████| 100/100 [01:54<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.04, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.72it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 3600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14484.59it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:30<50:48, 30.79s/it]Processing groups:   2%|▏         | 2/100 [00:35<25:14, 15.46s/it]Processing groups:   7%|▋         | 7/100 [00:36<04:45,  3.07s/it]Processing groups:  11%|█         | 11/100 [00:38<02:52,  1.94s/it]Processing groups:  19%|█▉        | 19/100 [00:39<01:08,  1.19it/s]Processing groups:  23%|██▎       | 23/100 [00:39<00:47,  1.61it/s]Processing groups:  23%|██▎       | 23/100 [00:53<00:47,  1.61it/s]Processing groups:  33%|███▎      | 33/100 [01:04<01:46,  1.60s/it]Processing groups:  34%|███▍      | 34/100 [01:10<02:02,  1.85s/it]Processing groups:  36%|███▌      | 36/100 [01:11<01:47,  1.69s/it]Processing groups:  38%|███▊      | 38/100 [01:16<01:50,  1.79s/it]Processing groups:  54%|█████▍    | 54/100 [01:18<00:29,  1.54it/s]Processing groups:  65%|██████▌   | 65/100 [01:38<00:39,  1.13s/it]Processing groups:  66%|██████▌   | 66/100 [01:43<00:43,  1.29s/it]Processing groups:  67%|██████▋   | 67/100 [01:45<00:43,  1.33s/it]Processing groups:  68%|██████▊   | 68/100 [01:45<00:39,  1.25s/it]Processing groups:  69%|██████▉   | 69/100 [01:47<00:40,  1.30s/it]Processing groups:  71%|███████   | 71/100 [01:48<00:32,  1.11s/it]Processing groups:  78%|███████▊  | 78/100 [01:48<00:11,  1.89it/s]Processing groups:  80%|████████  | 80/100 [01:48<00:09,  2.10it/s]Processing groups:  83%|████████▎ | 83/100 [01:49<00:06,  2.64it/s]Processing groups:  85%|████████▌ | 85/100 [01:49<00:04,  3.17it/s]Processing groups:  86%|████████▌ | 86/100 [01:49<00:04,  3.22it/s]Processing groups:  87%|████████▋ | 87/100 [01:50<00:04,  2.78it/s]Processing groups:  88%|████████▊ | 88/100 [01:50<00:04,  2.49it/s]Processing groups:  97%|█████████▋| 97/100 [01:52<00:00,  3.94it/s]Processing groups:  98%|█████████▊| 98/100 [01:53<00:00,  3.15it/s]Processing groups:  99%|█████████▉| 99/100 [01:53<00:00,  3.41it/s]Processing groups: 100%|██████████| 100/100 [01:53<00:00,  1.14s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.18, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 3200, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.08s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 12899.60it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:44<1:12:44, 44.08s/it]Processing groups:   5%|▌         | 5/100 [00:49<12:03,  7.62s/it]  Processing groups:  33%|███▎      | 33/100 [01:23<02:08,  1.92s/it]Processing groups:  35%|███▌      | 35/100 [01:24<01:54,  1.76s/it]Processing groups:  36%|███▌      | 36/100 [01:24<01:49,  1.71s/it]Processing groups:  37%|███▋      | 37/100 [01:28<01:54,  1.82s/it]Processing groups:  45%|████▌     | 45/100 [01:31<01:03,  1.15s/it]Processing groups:  53%|█████▎    | 53/100 [01:33<00:37,  1.24it/s]Processing groups:  62%|██████▏   | 62/100 [01:35<00:21,  1.74it/s]Processing groups:  65%|██████▌   | 65/100 [02:07<01:15,  2.16s/it]Processing groups:  66%|██████▌   | 66/100 [02:07<01:09,  2.05s/it]Processing groups:  67%|██████▋   | 67/100 [02:10<01:09,  2.10s/it]Processing groups:  69%|██████▉   | 69/100 [02:10<00:53,  1.72s/it]Processing groups:  74%|███████▍  | 74/100 [02:12<00:29,  1.15s/it]Processing groups:  76%|███████▌  | 76/100 [02:13<00:23,  1.03it/s]Processing groups:  86%|████████▌ | 86/100 [02:13<00:06,  2.27it/s]Processing groups:  87%|████████▋ | 87/100 [02:14<00:05,  2.20it/s]Processing groups:  97%|█████████▋| 97/100 [02:18<00:01,  2.45it/s]Processing groups:  98%|█████████▊| 98/100 [02:18<00:00,  2.56it/s]Processing groups: 100%|██████████| 100/100 [02:18<00:00,  1.38s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.1, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.05s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14431.27it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:45<1:14:28, 45.14s/it]Processing groups:   5%|▌         | 5/100 [00:45<10:45,  6.80s/it]  Processing groups:   7%|▋         | 7/100 [00:47<07:03,  4.56s/it]Processing groups:  25%|██▌       | 25/100 [00:49<01:07,  1.11it/s]Processing groups:  33%|███▎      | 33/100 [01:25<02:21,  2.10s/it]Processing groups:  36%|███▌      | 36/100 [01:27<02:02,  1.92s/it]Processing groups:  41%|████      | 41/100 [01:29<01:27,  1.47s/it]Processing groups:  43%|████▎     | 43/100 [01:29<01:13,  1.29s/it]Processing groups:  45%|████▌     | 45/100 [01:29<01:00,  1.10s/it]Processing groups:  47%|████▋     | 47/100 [01:29<00:48,  1.09it/s]Processing groups:  48%|████▊     | 48/100 [01:30<00:48,  1.07it/s]Processing groups:  49%|████▉     | 49/100 [01:33<00:59,  1.16s/it]Processing groups:  55%|█████▌    | 55/100 [01:35<00:31,  1.42it/s]Processing groups:  64%|██████▍   | 64/100 [01:36<00:13,  2.72it/s]Processing groups:  65%|██████▌   | 65/100 [02:05<01:33,  2.66s/it]Processing groups:  66%|██████▌   | 66/100 [02:05<01:22,  2.42s/it]Processing groups:  67%|██████▋   | 67/100 [02:06<01:14,  2.25s/it]Processing groups:  68%|██████▊   | 68/100 [02:12<01:29,  2.80s/it]Processing groups:  78%|███████▊  | 78/100 [02:13<00:21,  1.05it/s]Processing groups:  85%|████████▌ | 85/100 [02:13<00:08,  1.73it/s]Processing groups:  87%|████████▋ | 87/100 [02:14<00:06,  1.97it/s]Processing groups:  91%|█████████ | 91/100 [02:14<00:03,  2.61it/s]Processing groups:  93%|█████████▎| 93/100 [02:14<00:02,  2.74it/s]Processing groups:  97%|█████████▋| 97/100 [02:18<00:01,  1.83it/s]Processing groups: 100%|██████████| 100/100 [02:18<00:00,  1.39s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 0.0, 'mean_ap_p_value': 0.34, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.10s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 15686.68it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:35, 46.42s/it]Processing groups:   7%|▋         | 7/100 [00:47<07:45,  5.01s/it]  Processing groups:  33%|███▎      | 33/100 [01:23<02:09,  1.93s/it]Processing groups:  35%|███▌      | 35/100 [01:24<01:58,  1.83s/it]Processing groups:  36%|███▌      | 36/100 [01:26<01:58,  1.85s/it]Processing groups:  37%|███▋      | 37/100 [01:30<02:03,  1.97s/it]Processing groups:  51%|█████     | 51/100 [01:31<00:39,  1.23it/s]Processing groups:  55%|█████▌    | 55/100 [01:31<00:29,  1.50it/s]Processing groups:  58%|█████▊    | 58/100 [01:31<00:23,  1.78it/s]Processing groups:  60%|██████    | 60/100 [01:31<00:19,  2.03it/s]Processing groups:  62%|██████▏   | 62/100 [01:34<00:24,  1.57it/s]Processing groups:  64%|██████▍   | 64/100 [01:36<00:25,  1.42it/s]Processing groups:  65%|██████▌   | 65/100 [02:07<02:34,  4.42s/it]Processing groups:  66%|██████▌   | 66/100 [02:09<02:18,  4.07s/it]Processing groups:  72%|███████▏  | 72/100 [02:10<00:52,  1.86s/it]Processing groups:  77%|███████▋  | 77/100 [02:10<00:26,  1.14s/it]Processing groups:  79%|███████▉  | 79/100 [02:12<00:22,  1.09s/it]Processing groups:  83%|████████▎ | 83/100 [02:13<00:13,  1.29it/s]Processing groups:  94%|█████████▍| 94/100 [02:13<00:02,  2.89it/s]Processing groups:  96%|█████████▌| 96/100 [02:13<00:01,  3.08it/s]Processing groups:  98%|█████████▊| 98/100 [02:17<00:01,  1.81it/s]Processing groups:  99%|█████████▉| 99/100 [02:17<00:00,  1.95it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.38s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.19, 'mean_ap': 0.36, 'mean_ap_p_value': 0.9, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.07s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 13687.64it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:10:10, 42.53s/it]Processing groups:   5%|▌         | 5/100 [00:44<10:45,  6.79s/it]  Processing groups:   8%|▊         | 8/100 [00:48<06:28,  4.22s/it]Processing groups:  33%|███▎      | 33/100 [01:24<02:03,  1.84s/it]Processing groups:  34%|███▍      | 34/100 [01:24<01:56,  1.77s/it]Processing groups:  36%|███▌      | 36/100 [01:27<01:48,  1.70s/it]Processing groups:  41%|████      | 41/100 [01:29<01:19,  1.35s/it]Processing groups:  44%|████▍     | 44/100 [01:30<01:02,  1.12s/it]Processing groups:  55%|█████▌    | 55/100 [01:33<00:30,  1.46it/s]Processing groups:  62%|██████▏   | 62/100 [01:33<00:18,  2.07it/s]Processing groups:  63%|██████▎   | 63/100 [01:34<00:19,  1.89it/s]Processing groups:  65%|██████▌   | 65/100 [02:06<01:38,  2.81s/it]Processing groups:  68%|██████▊   | 68/100 [02:09<01:15,  2.37s/it]Processing groups:  70%|███████   | 70/100 [02:10<01:01,  2.03s/it]Processing groups:  74%|███████▍  | 74/100 [02:11<00:36,  1.42s/it]Processing groups:  80%|████████  | 80/100 [02:12<00:16,  1.20it/s]Processing groups:  85%|████████▌ | 85/100 [02:12<00:08,  1.76it/s]Processing groups:  87%|████████▋ | 87/100 [02:12<00:06,  1.95it/s]Processing groups:  91%|█████████ | 91/100 [02:13<00:03,  2.46it/s]Processing groups:  93%|█████████▎| 93/100 [02:13<00:02,  2.85it/s]Processing groups:  94%|█████████▍| 94/100 [02:13<00:01,  3.01it/s]Processing groups:  97%|█████████▋| 97/100 [02:17<00:01,  1.53it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.38s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.09s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 13620.08it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:09:21, 42.03s/it]Processing groups:   2%|▏         | 2/100 [00:45<31:20, 19.19s/it]  Processing groups:   9%|▉         | 9/100 [00:50<05:08,  3.39s/it]Processing groups:  33%|███▎      | 33/100 [01:27<02:07,  1.90s/it]Processing groups:  38%|███▊      | 38/100 [01:27<01:35,  1.54s/it]Processing groups:  42%|████▏     | 42/100 [01:28<01:16,  1.31s/it]Processing groups:  43%|████▎     | 43/100 [01:29<01:11,  1.26s/it]Processing groups:  45%|████▌     | 45/100 [01:33<01:16,  1.38s/it]Processing groups:  64%|██████▍   | 64/100 [01:35<00:19,  1.83it/s]Processing groups:  65%|██████▌   | 65/100 [02:08<01:12,  2.07s/it]Processing groups:  67%|██████▋   | 67/100 [02:08<01:01,  1.87s/it]Processing groups:  69%|██████▉   | 69/100 [02:09<00:51,  1.67s/it]Processing groups:  72%|███████▏  | 72/100 [02:11<00:39,  1.42s/it]Processing groups:  73%|███████▎  | 73/100 [02:12<00:35,  1.31s/it]Processing groups:  76%|███████▌  | 76/100 [02:12<00:22,  1.07it/s]Processing groups:  78%|███████▊  | 78/100 [02:12<00:16,  1.36it/s]Processing groups:  81%|████████  | 81/100 [02:13<00:10,  1.73it/s]Processing groups:  90%|█████████ | 90/100 [02:13<00:02,  3.98it/s]Processing groups:  97%|█████████▋| 97/100 [02:17<00:01,  2.74it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  3.31it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.37s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.08s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 12706.93it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:09:10, 41.92s/it]Processing groups:   3%|▎         | 3/100 [00:42<18:00, 11.14s/it]  Processing groups:   4%|▍         | 4/100 [00:43<11:52,  7.42s/it]Processing groups:   5%|▌         | 5/100 [00:45<09:16,  5.85s/it]Processing groups:  16%|█▌        | 16/100 [00:46<01:23,  1.01it/s]Processing groups:  25%|██▌       | 25/100 [00:48<00:46,  1.63it/s]Processing groups:  33%|███▎      | 33/100 [01:24<02:21,  2.11s/it]Processing groups:  35%|███▌      | 35/100 [01:26<02:10,  2.01s/it]Processing groups:  40%|████      | 40/100 [01:30<01:37,  1.63s/it]Processing groups:  43%|████▎     | 43/100 [01:31<01:15,  1.32s/it]Processing groups:  51%|█████     | 51/100 [01:33<00:42,  1.14it/s]Processing groups:  65%|██████▌   | 65/100 [02:08<01:00,  1.73s/it]Processing groups:  66%|██████▌   | 66/100 [02:09<00:57,  1.70s/it]Processing groups:  67%|██████▋   | 67/100 [02:10<00:55,  1.67s/it]Processing groups:  69%|██████▉   | 69/100 [02:11<00:45,  1.48s/it]Processing groups:  75%|███████▌  | 75/100 [02:12<00:22,  1.13it/s]Processing groups:  84%|████████▍ | 84/100 [02:12<00:07,  2.04it/s]Processing groups:  87%|████████▋ | 87/100 [02:12<00:05,  2.42it/s]Processing groups:  89%|████████▉ | 89/100 [02:12<00:04,  2.69it/s]Processing groups:  92%|█████████▏| 92/100 [02:13<00:02,  3.32it/s]Processing groups:  95%|█████████▌| 95/100 [02:13<00:01,  4.27it/s]Processing groups:  97%|█████████▋| 97/100 [02:17<00:01,  1.75it/s]Processing groups:  99%|█████████▉| 99/100 [02:17<00:00,  2.13it/s]Processing groups: 100%|██████████| 100/100 [02:17<00:00,  1.37s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.54, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.10s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 7200

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8948.04it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:42<1:09:40, 42.22s/it]Processing groups:   2%|▏         | 2/100 [00:43<29:14, 17.91s/it]  Processing groups:   5%|▌         | 5/100 [00:45<09:03,  5.72s/it]Processing groups:  13%|█▎        | 13/100 [00:46<02:16,  1.57s/it]Processing groups:  19%|█▉        | 19/100 [00:47<01:17,  1.04it/s]Processing groups:  33%|███▎      | 33/100 [01:22<02:06,  1.89s/it]Processing groups:  34%|███▍      | 34/100 [01:26<02:11,  1.99s/it]Processing groups:  37%|███▋      | 37/100 [01:26<01:43,  1.65s/it]Processing groups:  43%|████▎     | 43/100 [01:28<01:04,  1.12s/it]Processing groups:  45%|████▌     | 45/100 [01:29<00:57,  1.05s/it]Processing groups:  47%|████▋     | 47/100 [01:30<00:51,  1.04it/s]Processing groups:  53%|█████▎    | 53/100 [01:32<00:32,  1.44it/s]Processing groups:  62%|██████▏   | 62/100 [01:32<00:14,  2.61it/s]Processing groups:  65%|██████▌   | 65/100 [02:06<01:22,  2.36s/it]Processing groups:  67%|██████▋   | 67/100 [02:08<01:11,  2.17s/it]Processing groups:  68%|██████▊   | 68/100 [02:09<01:05,  2.06s/it]Processing groups:  72%|███████▏  | 72/100 [02:10<00:40,  1.46s/it]Processing groups:  74%|███████▍  | 74/100 [02:11<00:31,  1.21s/it]Processing groups:  84%|████████▍ | 84/100 [02:11<00:08,  1.95it/s]Processing groups:  86%|████████▌ | 86/100 [02:11<00:06,  2.19it/s]Processing groups:  88%|████████▊ | 88/100 [02:11<00:04,  2.54it/s]Processing groups:  90%|█████████ | 90/100 [02:12<00:03,  2.78it/s]Processing groups:  96%|█████████▌| 96/100 [02:12<00:00,  4.82it/s]Processing groups:  98%|█████████▊| 98/100 [02:16<00:01,  1.93it/s]Processing groups: 100%|██████████| 100/100 [02:16<00:00,  1.36s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.89, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 3200, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.17s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 12293.16it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:56<1:32:32, 56.08s/it]Processing groups:   2%|▏         | 2/100 [00:59<41:25, 25.36s/it]  Processing groups:   5%|▌         | 5/100 [01:00<11:27,  7.23s/it]Processing groups:  11%|█         | 11/100 [01:00<03:40,  2.47s/it]Processing groups:  17%|█▋        | 17/100 [01:01<01:46,  1.29s/it]Processing groups:  17%|█▋        | 17/100 [01:19<01:46,  1.29s/it]Processing groups:  33%|███▎      | 33/100 [01:48<02:39,  2.39s/it]Processing groups:  34%|███▍      | 34/100 [01:52<02:40,  2.43s/it]Processing groups:  35%|███▌      | 35/100 [01:54<02:38,  2.44s/it]Processing groups:  42%|████▏     | 42/100 [01:55<01:25,  1.47s/it]Processing groups:  43%|████▎     | 43/100 [01:58<01:31,  1.60s/it]Processing groups:  48%|████▊     | 48/100 [01:59<00:55,  1.07s/it]Processing groups:  57%|█████▋    | 57/100 [02:00<00:26,  1.64it/s]Processing groups:  65%|██████▌   | 65/100 [02:47<01:31,  2.61s/it]Processing groups:  68%|██████▊   | 68/100 [02:52<01:17,  2.43s/it]Processing groups:  70%|███████   | 70/100 [02:52<01:03,  2.11s/it]Processing groups:  76%|███████▌  | 76/100 [02:52<00:32,  1.33s/it]Processing groups:  78%|███████▊  | 78/100 [02:52<00:25,  1.15s/it]Processing groups:  87%|████████▋ | 87/100 [02:53<00:07,  1.65it/s]Processing groups:  97%|█████████▋| 97/100 [02:58<00:01,  1.78it/s]Processing groups:  99%|█████████▉| 99/100 [02:58<00:00,  1.92it/s]Processing groups: 100%|██████████| 100/100 [02:58<00:00,  1.79s/it]
{'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.1, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.00s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 1244.42it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:56<1:33:53, 56.91s/it]Processing groups:   3%|▎         | 3/100 [00:57<24:25, 15.10s/it]  Processing groups:   4%|▍         | 4/100 [00:58<16:13, 10.14s/it]Processing groups:   6%|▌         | 6/100 [01:00<08:52,  5.66s/it]Processing groups:  10%|█         | 10/100 [01:01<03:34,  2.38s/it]Processing groups:  21%|██        | 21/100 [01:02<01:05,  1.21it/s]Processing groups:  33%|███▎      | 33/100 [01:52<02:52,  2.57s/it]Processing groups:  34%|███▍      | 34/100 [01:55<02:48,  2.56s/it]Processing groups:  38%|███▊      | 38/100 [01:55<02:00,  1.95s/it]Processing groups:  40%|████      | 40/100 [01:59<01:57,  1.95s/it]Processing groups:  54%|█████▍    | 54/100 [02:01<00:39,  1.15it/s]Processing groups:  59%|█████▉    | 59/100 [02:02<00:28,  1.42it/s]Processing groups:  65%|██████▌   | 65/100 [02:49<01:35,  2.72s/it]Processing groups:  66%|██████▌   | 66/100 [02:51<01:31,  2.69s/it]Processing groups:  68%|██████▊   | 68/100 [02:51<01:14,  2.32s/it]Processing groups:  69%|██████▉   | 69/100 [02:52<01:06,  2.15s/it]Processing groups:  70%|███████   | 70/100 [02:52<00:57,  1.92s/it]Processing groups:  71%|███████   | 71/100 [02:53<00:47,  1.65s/it]Processing groups:  74%|███████▍  | 74/100 [02:53<00:27,  1.06s/it]Processing groups:  75%|███████▌  | 75/100 [02:53<00:23,  1.07it/s]Processing groups:  82%|████████▏ | 82/100 [02:54<00:08,  2.12it/s]Processing groups:  87%|████████▋ | 87/100 [02:55<00:04,  3.19it/s]Processing groups:  89%|████████▉ | 89/100 [02:55<00:03,  3.64it/s]Processing groups:  97%|█████████▋| 97/100 [03:01<00:01,  2.02it/s]Processing groups: 100%|██████████| 100/100 [03:01<00:00,  1.81s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.12, 'mean_ap': 0.01, 'mean_ap_p_value': 0.36, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.11s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 13755.88it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:57<1:35:16, 57.74s/it]Processing groups:   3%|▎         | 3/100 [01:00<25:47, 15.96s/it]  Processing groups:   4%|▍         | 4/100 [01:01<17:33, 10.98s/it]Processing groups:  16%|█▌        | 16/100 [01:02<02:17,  1.64s/it]Processing groups:  33%|███▎      | 33/100 [01:51<02:41,  2.41s/it]Processing groups:  34%|███▍      | 34/100 [01:57<02:51,  2.60s/it]Processing groups:  40%|████      | 40/100 [01:58<01:50,  1.84s/it]Processing groups:  44%|████▍     | 44/100 [01:58<01:23,  1.48s/it]Processing groups:  46%|████▌     | 46/100 [02:02<01:21,  1.50s/it]Processing groups:  58%|█████▊    | 58/100 [02:03<00:31,  1.34it/s]Processing groups:  60%|██████    | 60/100 [02:04<00:28,  1.43it/s]Processing groups:  65%|██████▌   | 65/100 [02:50<01:51,  3.19s/it]Processing groups:  66%|██████▌   | 66/100 [02:55<01:52,  3.29s/it]Processing groups:  78%|███████▊  | 78/100 [02:55<00:32,  1.46s/it]Processing groups:  80%|████████  | 80/100 [02:57<00:27,  1.40s/it]Processing groups:  92%|█████████▏| 92/100 [02:58<00:05,  1.42it/s]Processing groups:  94%|█████████▍| 94/100 [02:58<00:03,  1.56it/s]Processing groups:  97%|█████████▋| 97/100 [03:03<00:02,  1.18it/s]Processing groups: 100%|██████████| 100/100 [03:03<00:00,  1.84s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.38, 'mean_ap': 0.16, 'mean_ap_p_value': 0.94, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.11s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 13346.18it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:56<1:32:33, 56.10s/it]Processing groups:   2%|▏         | 2/100 [00:58<40:20, 24.70s/it]  Processing groups:   3%|▎         | 3/100 [00:59<22:24, 13.86s/it]Processing groups:   9%|▉         | 9/100 [01:00<04:24,  2.90s/it]Processing groups:  11%|█         | 11/100 [01:00<03:13,  2.18s/it]Processing groups:  13%|█▎        | 13/100 [01:02<02:39,  1.83s/it]Processing groups:  25%|██▌       | 25/100 [01:04<00:46,  1.63it/s]Processing groups:  33%|███▎      | 33/100 [01:55<03:18,  2.96s/it]Processing groups:  34%|███▍      | 34/100 [01:56<03:05,  2.81s/it]Processing groups:  35%|███▌      | 35/100 [01:56<02:49,  2.62s/it]Processing groups:  36%|███▌      | 36/100 [01:57<02:29,  2.34s/it]Processing groups:  39%|███▉      | 39/100 [01:59<01:55,  1.89s/it]Processing groups:  40%|████      | 40/100 [02:00<01:46,  1.78s/it]Processing groups:  54%|█████▍    | 54/100 [02:02<00:25,  1.83it/s]Processing groups:  60%|██████    | 60/100 [02:03<00:16,  2.37it/s]Processing groups:  61%|██████    | 61/100 [02:03<00:17,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [02:54<02:15,  3.86s/it]Processing groups:  67%|██████▋   | 67/100 [02:54<01:47,  3.27s/it]Processing groups:  68%|██████▊   | 68/100 [02:56<01:39,  3.10s/it]Processing groups:  70%|███████   | 70/100 [02:57<01:15,  2.52s/it]Processing groups:  83%|████████▎ | 83/100 [02:58<00:14,  1.21it/s]Processing groups:  89%|████████▉ | 89/100 [02:58<00:06,  1.74it/s]Processing groups:  93%|█████████▎| 93/100 [02:58<00:03,  2.20it/s]Processing groups:  96%|█████████▌| 96/100 [02:59<00:01,  2.59it/s]Processing groups:  98%|█████████▊| 98/100 [03:04<00:01,  1.30it/s]Processing groups: 100%|██████████| 100/100 [03:04<00:00,  1.85s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.75, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.19s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14574.18it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:55<1:32:20, 55.96s/it]Processing groups:   2%|▏         | 2/100 [01:00<42:04, 25.76s/it]  Processing groups:   6%|▌         | 6/100 [01:01<09:23,  5.99s/it]Processing groups:  15%|█▌        | 15/100 [01:02<02:33,  1.81s/it]Processing groups:  17%|█▋        | 17/100 [01:04<02:17,  1.66s/it]Processing groups:  33%|███▎      | 33/100 [01:51<02:49,  2.53s/it]Processing groups:  34%|███▍      | 34/100 [01:53<02:45,  2.51s/it]Processing groups:  36%|███▌      | 36/100 [01:57<02:35,  2.43s/it]Processing groups:  39%|███▉      | 39/100 [01:58<02:02,  2.00s/it]Processing groups:  43%|████▎     | 43/100 [02:02<01:33,  1.65s/it]Processing groups:  58%|█████▊    | 58/100 [02:02<00:26,  1.58it/s]Processing groups:  61%|██████    | 61/100 [02:03<00:22,  1.77it/s]Processing groups:  64%|██████▍   | 64/100 [02:04<00:18,  1.90it/s]Processing groups:  64%|██████▍   | 64/100 [02:22<00:18,  1.90it/s]Processing groups:  65%|██████▌   | 65/100 [02:49<02:21,  4.05s/it]Processing groups:  67%|██████▋   | 67/100 [02:53<01:59,  3.62s/it]Processing groups:  69%|██████▉   | 69/100 [02:53<01:29,  2.89s/it]Processing groups:  71%|███████   | 71/100 [02:54<01:08,  2.35s/it]Processing groups:  73%|███████▎  | 73/100 [02:56<00:55,  2.05s/it]Processing groups:  78%|███████▊  | 78/100 [02:57<00:26,  1.20s/it]Processing groups:  87%|████████▋ | 87/100 [02:58<00:07,  1.77it/s]Processing groups:  97%|█████████▋| 97/100 [03:03<00:01,  1.82it/s]Processing groups:  98%|█████████▊| 98/100 [03:03<00:01,  1.87it/s]Processing groups: 100%|██████████| 100/100 [03:04<00:00,  2.16it/s]Processing groups: 100%|██████████| 100/100 [03:04<00:00,  1.84s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.86, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.19s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 13782.54it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:57<1:35:21, 57.80s/it]Processing groups:   2%|▏         | 2/100 [00:59<40:24, 24.74s/it]  Processing groups:   5%|▌         | 5/100 [01:00<11:42,  7.39s/it]Processing groups:   8%|▊         | 8/100 [01:01<05:44,  3.74s/it]Processing groups:  12%|█▏        | 12/100 [01:02<03:03,  2.09s/it]Processing groups:  29%|██▉       | 29/100 [01:03<00:38,  1.82it/s]Processing groups:  32%|███▏      | 32/100 [01:04<00:34,  1.97it/s]Processing groups:  33%|███▎      | 33/100 [01:54<04:27,  4.00s/it]Processing groups:  39%|███▉      | 39/100 [01:56<02:38,  2.60s/it]Processing groups:  42%|████▏     | 42/100 [01:58<02:09,  2.24s/it]Processing groups:  44%|████▍     | 44/100 [02:01<01:54,  2.05s/it]Processing groups:  46%|████▌     | 46/100 [02:02<01:34,  1.76s/it]Processing groups:  56%|█████▌    | 56/100 [02:02<00:34,  1.28it/s]Processing groups:  62%|██████▏   | 62/100 [02:04<00:22,  1.71it/s]Processing groups:  64%|██████▍   | 64/100 [02:04<00:20,  1.78it/s]Processing groups:  65%|██████▌   | 65/100 [02:51<02:42,  4.65s/it]Processing groups:  66%|██████▌   | 66/100 [02:53<02:28,  4.35s/it]Processing groups:  69%|██████▉   | 69/100 [02:54<01:35,  3.08s/it]Processing groups:  71%|███████   | 71/100 [02:55<01:08,  2.37s/it]Processing groups:  72%|███████▏  | 72/100 [02:56<01:03,  2.27s/it]Processing groups:  80%|████████  | 80/100 [02:57<00:17,  1.12it/s]Processing groups:  85%|████████▌ | 85/100 [02:57<00:09,  1.64it/s]Processing groups:  88%|████████▊ | 88/100 [02:58<00:06,  2.00it/s]Processing groups:  96%|█████████▌| 96/100 [02:58<00:01,  3.60it/s]Processing groups:  98%|█████████▊| 98/100 [03:03<00:01,  1.58it/s]Processing groups: 100%|██████████| 100/100 [03:03<00:00,  1.84s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.08s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 300, Neg pairs size: 14400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 14645.94it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:57<1:34:17, 57.15s/it]Processing groups:   2%|▏         | 2/100 [00:59<40:25, 24.75s/it]  Processing groups:  20%|██        | 20/100 [01:00<02:07,  1.59s/it]Processing groups:  25%|██▌       | 25/100 [01:03<01:39,  1.33s/it]Processing groups:  33%|███▎      | 33/100 [01:51<03:29,  3.12s/it]Processing groups:  34%|███▍      | 34/100 [01:53<03:19,  3.02s/it]Processing groups:  36%|███▌      | 36/100 [01:58<03:09,  2.95s/it]Processing groups:  49%|████▉     | 49/100 [02:00<01:06,  1.29s/it]Processing groups:  53%|█████▎    | 53/100 [02:01<00:51,  1.10s/it]Processing groups:  65%|██████▌   | 65/100 [02:49<01:26,  2.47s/it]Processing groups:  69%|██████▉   | 69/100 [02:50<01:03,  2.06s/it]Processing groups:  71%|███████   | 71/100 [02:51<00:55,  1.90s/it]Processing groups:  73%|███████▎  | 73/100 [02:52<00:44,  1.65s/it]Processing groups:  84%|████████▍ | 84/100 [02:53<00:13,  1.19it/s]Processing groups:  95%|█████████▌| 95/100 [02:53<00:02,  2.05it/s]Processing groups:  98%|█████████▊| 98/100 [02:58<00:01,  1.51it/s]Processing groups: 100%|██████████| 100/100 [02:58<00:00,  1.79s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 3200, 'differ_params': 1}

Processing n_plates: 4

Processing n_controls: 4

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.05it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8112.15it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<54:33, 33.07s/it]Processing groups:   3%|▎         | 3/100 [00:35<15:19,  9.48s/it]Processing groups:   4%|▍         | 4/100 [00:36<10:19,  6.45s/it]Processing groups:   5%|▌         | 5/100 [00:39<08:22,  5.29s/it]Processing groups:   6%|▌         | 6/100 [00:40<06:11,  3.96s/it]Processing groups:   7%|▋         | 7/100 [00:40<04:15,  2.75s/it]Processing groups:  22%|██▏       | 22/100 [00:40<00:28,  2.77it/s]Processing groups:  32%|███▏      | 32/100 [00:42<00:20,  3.38it/s]Processing groups:  32%|███▏      | 32/100 [00:52<00:20,  3.38it/s]Processing groups:  33%|███▎      | 33/100 [01:13<02:22,  2.13s/it]Processing groups:  35%|███▌      | 35/100 [01:13<02:01,  1.87s/it]Processing groups:  38%|███▊      | 38/100 [01:18<01:49,  1.76s/it]Processing groups:  41%|████      | 41/100 [01:19<01:22,  1.39s/it]Processing groups:  45%|████▌     | 45/100 [01:19<00:53,  1.02it/s]Processing groups:  50%|█████     | 50/100 [01:21<00:37,  1.33it/s]Processing groups:  52%|█████▏    | 52/100 [01:22<00:34,  1.40it/s]Processing groups:  58%|█████▊    | 58/100 [01:23<00:20,  2.05it/s]Processing groups:  63%|██████▎   | 63/100 [01:25<00:16,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [01:54<01:35,  2.74s/it]Processing groups:  76%|███████▌  | 76/100 [01:56<00:30,  1.29s/it]Processing groups:  77%|███████▋  | 77/100 [01:56<00:27,  1.22s/it]Processing groups:  78%|███████▊  | 78/100 [01:57<00:26,  1.19s/it]Processing groups:  80%|████████  | 80/100 [01:58<00:20,  1.03s/it]Processing groups:  86%|████████▌ | 86/100 [01:58<00:08,  1.70it/s]Processing groups:  97%|█████████▋| 97/100 [02:01<00:01,  2.38it/s]Processing groups:  98%|█████████▊| 98/100 [02:02<00:00,  2.45it/s]Processing groups: 100%|██████████| 100/100 [02:02<00:00,  1.22s/it]
{'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.08, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.08it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8582.05it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:41<1:07:51, 41.13s/it]Processing groups:   2%|▏         | 2/100 [00:41<27:45, 17.00s/it]  Processing groups:  26%|██▌       | 26/100 [00:42<01:02,  1.19it/s]Processing groups:  28%|██▊       | 28/100 [00:42<00:55,  1.29it/s]Processing groups:  28%|██▊       | 28/100 [00:58<00:55,  1.29it/s]Processing groups:  33%|███▎      | 33/100 [01:09<02:15,  2.02s/it]Processing groups:  34%|███▍      | 34/100 [01:13<02:19,  2.11s/it]Processing groups:  38%|███▊      | 38/100 [01:13<01:34,  1.52s/it]Processing groups:  40%|████      | 40/100 [01:16<01:29,  1.49s/it]Processing groups:  41%|████      | 41/100 [01:18<01:36,  1.63s/it]Processing groups:  44%|████▍     | 44/100 [01:19<01:06,  1.18s/it]Processing groups:  47%|████▋     | 47/100 [01:20<00:47,  1.11it/s]Processing groups:  54%|█████▍    | 54/100 [01:21<00:25,  1.79it/s]Processing groups:  55%|█████▌    | 55/100 [01:22<00:23,  1.92it/s]Processing groups:  63%|██████▎   | 63/100 [01:24<00:13,  2.66it/s]Processing groups:  65%|██████▌   | 65/100 [01:48<01:18,  2.24s/it]Processing groups:  66%|██████▌   | 66/100 [01:53<01:23,  2.47s/it]Processing groups:  69%|██████▉   | 69/100 [01:55<01:01,  1.98s/it]Processing groups:  72%|███████▏  | 72/100 [01:56<00:40,  1.45s/it]Processing groups:  76%|███████▌  | 76/100 [01:56<00:23,  1.03it/s]Processing groups:  79%|███████▉  | 79/100 [01:57<00:15,  1.36it/s]Processing groups:  94%|█████████▍| 94/100 [01:57<00:01,  4.00it/s]Processing groups:  98%|█████████▊| 98/100 [02:00<00:00,  2.69it/s]Processing groups: 100%|██████████| 100/100 [02:00<00:00,  1.21s/it]
{'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.41, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.07s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8787.75it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<55:10, 33.44s/it]Processing groups:   2%|▏         | 2/100 [00:39<27:57, 17.12s/it]Processing groups:   3%|▎         | 3/100 [00:41<17:07, 10.59s/it]Processing groups:  33%|███▎      | 33/100 [01:11<01:37,  1.46s/it]Processing groups:  34%|███▍      | 34/100 [01:12<01:34,  1.43s/it]Processing groups:  35%|███▌      | 35/100 [01:18<01:48,  1.67s/it]Processing groups:  39%|███▉      | 39/100 [01:18<01:19,  1.30s/it]Processing groups:  41%|████      | 41/100 [01:19<01:07,  1.15s/it]Processing groups:  48%|████▊     | 48/100 [01:20<00:38,  1.36it/s]Processing groups:  53%|█████▎    | 53/100 [01:21<00:24,  1.89it/s]Processing groups:  56%|█████▌    | 56/100 [01:23<00:25,  1.69it/s]Processing groups:  65%|██████▌   | 65/100 [01:51<01:01,  1.75s/it]Processing groups:  66%|██████▌   | 66/100 [01:53<01:01,  1.80s/it]Processing groups:  67%|██████▋   | 67/100 [01:56<01:02,  1.88s/it]Processing groups:  70%|███████   | 70/100 [01:57<00:43,  1.46s/it]Processing groups:  88%|████████▊ | 88/100 [01:57<00:05,  2.25it/s]Processing groups:  90%|█████████ | 90/100 [01:57<00:04,  2.45it/s]Processing groups:  93%|█████████▎| 93/100 [01:58<00:02,  2.79it/s]Processing groups:  95%|█████████▌| 95/100 [01:58<00:01,  3.09it/s]Processing groups:  97%|█████████▋| 97/100 [02:01<00:01,  1.88it/s]Processing groups: 100%|██████████| 100/100 [02:01<00:00,  1.22s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.27, 'mean_ap_p_value': 0.99, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.11s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8299.80it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:34<56:10, 34.04s/it]Processing groups:   2%|▏         | 2/100 [00:34<23:33, 14.42s/it]Processing groups:   4%|▍         | 4/100 [00:37<09:54,  6.19s/it]Processing groups:   5%|▌         | 5/100 [00:40<08:06,  5.12s/it]Processing groups:   9%|▉         | 9/100 [00:42<03:28,  2.30s/it]Processing groups:  31%|███       | 31/100 [00:43<00:29,  2.36it/s]Processing groups:  33%|███▎      | 33/100 [01:11<01:55,  1.73s/it]Processing groups:  34%|███▍      | 34/100 [01:12<01:50,  1.67s/it]Processing groups:  35%|███▌      | 35/100 [01:16<02:01,  1.87s/it]Processing groups:  36%|███▌      | 36/100 [01:16<01:50,  1.73s/it]Processing groups:  40%|████      | 40/100 [01:17<01:07,  1.13s/it]Processing groups:  41%|████      | 41/100 [01:18<01:01,  1.05s/it]Processing groups:  45%|████▌     | 45/100 [01:18<00:35,  1.56it/s]Processing groups:  46%|████▌     | 46/100 [01:19<00:38,  1.41it/s]Processing groups:  54%|█████▍    | 54/100 [01:20<00:17,  2.65it/s]Processing groups:  57%|█████▋    | 57/100 [01:20<00:13,  3.22it/s]Processing groups:  59%|█████▉    | 59/100 [01:22<00:16,  2.56it/s]Processing groups:  65%|██████▌   | 65/100 [01:50<01:21,  2.32s/it]Processing groups:  66%|██████▌   | 66/100 [01:54<01:23,  2.45s/it]Processing groups:  71%|███████   | 71/100 [01:55<00:44,  1.54s/it]Processing groups:  80%|████████  | 80/100 [01:56<00:15,  1.26it/s]Processing groups:  81%|████████  | 81/100 [01:56<00:14,  1.32it/s]Processing groups:  97%|█████████▋| 97/100 [02:00<00:01,  2.34it/s]Processing groups: 100%|██████████| 100/100 [02:00<00:00,  1.20s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.08s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 9854.11it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:36<59:57, 36.34s/it]Processing groups:   2%|▏         | 2/100 [00:37<25:47, 15.79s/it]Processing groups:   3%|▎         | 3/100 [00:37<13:57,  8.64s/it]Processing groups:   4%|▍         | 4/100 [00:41<10:57,  6.85s/it]Processing groups:  33%|███▎      | 33/100 [01:14<01:37,  1.46s/it]Processing groups:  34%|███▍      | 34/100 [01:15<01:33,  1.42s/it]Processing groups:  36%|███▌      | 36/100 [01:16<01:25,  1.33s/it]Processing groups:  45%|████▌     | 45/100 [01:19<00:50,  1.09it/s]Processing groups:  51%|█████     | 51/100 [01:20<00:34,  1.41it/s]Processing groups:  62%|██████▏   | 62/100 [01:23<00:19,  1.99it/s]Processing groups:  64%|██████▍   | 64/100 [01:24<00:18,  1.92it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:09,  1.97s/it]Processing groups:  66%|██████▌   | 66/100 [01:51<01:15,  2.21s/it]Processing groups:  72%|███████▏  | 72/100 [01:52<00:37,  1.35s/it]Processing groups:  78%|███████▊  | 78/100 [01:54<00:20,  1.06it/s]Processing groups:  89%|████████▉ | 89/100 [01:55<00:05,  1.91it/s]Processing groups:  94%|█████████▍| 94/100 [01:55<00:02,  2.46it/s]Processing groups:  96%|█████████▌| 96/100 [01:56<00:01,  2.49it/s]Processing groups:  97%|█████████▋| 97/100 [01:58<00:01,  1.88it/s]Processing groups:  99%|█████████▉| 99/100 [01:58<00:00,  2.16it/s]Processing groups: 100%|██████████| 100/100 [01:58<00:00,  1.19s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.06s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8523.97it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:33<56:02, 33.96s/it]Processing groups:   2%|▏         | 2/100 [00:35<24:40, 15.11s/it]Processing groups:   3%|▎         | 3/100 [00:37<14:22,  8.90s/it]Processing groups:   4%|▍         | 4/100 [00:39<09:58,  6.24s/it]Processing groups:   9%|▉         | 9/100 [00:39<02:30,  1.65s/it]Processing groups:  16%|█▌        | 16/100 [00:42<01:18,  1.07it/s]Processing groups:  33%|███▎      | 33/100 [01:11<01:36,  1.44s/it]Processing groups:  35%|███▌      | 35/100 [01:11<01:25,  1.32s/it]Processing groups:  37%|███▋      | 37/100 [01:12<01:15,  1.20s/it]Processing groups:  41%|████      | 41/100 [01:13<00:56,  1.05it/s]Processing groups:  42%|████▏     | 42/100 [01:14<00:55,  1.05it/s]Processing groups:  44%|████▍     | 44/100 [01:18<01:04,  1.15s/it]Processing groups:  45%|████▌     | 45/100 [01:18<00:56,  1.02s/it]Processing groups:  55%|█████▌    | 55/100 [01:19<00:18,  2.43it/s]Processing groups:  56%|█████▌    | 56/100 [01:19<00:17,  2.58it/s]Processing groups:  61%|██████    | 61/100 [01:24<00:23,  1.66it/s]Processing groups:  64%|██████▍   | 64/100 [01:24<00:17,  2.08it/s]Processing groups:  65%|██████▌   | 65/100 [01:49<01:46,  3.05s/it]Processing groups:  66%|██████▌   | 66/100 [01:51<01:37,  2.86s/it]Processing groups:  70%|███████   | 70/100 [01:53<00:54,  1.81s/it]Processing groups:  75%|███████▌  | 75/100 [01:54<00:27,  1.12s/it]Processing groups:  80%|████████  | 80/100 [01:55<00:15,  1.28it/s]Processing groups:  88%|████████▊ | 88/100 [01:55<00:05,  2.18it/s]Processing groups:  96%|█████████▌| 96/100 [01:56<00:01,  3.24it/s]Processing groups:  97%|█████████▋| 97/100 [01:58<00:01,  2.33it/s]Processing groups:  98%|█████████▊| 98/100 [01:59<00:00,  2.40it/s]Processing groups: 100%|██████████| 100/100 [01:59<00:00,  1.19s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.05it/s]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 6400

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 10050.09it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:39<1:05:37, 39.77s/it]Processing groups:  12%|█▏        | 12/100 [00:40<03:34,  2.44s/it] Processing groups:  24%|██▍       | 24/100 [00:42<01:23,  1.10s/it]Processing groups:  33%|███▎      | 33/100 [01:12<02:10,  1.95s/it]Processing groups:  35%|███▌      | 35/100 [01:14<01:59,  1.85s/it]Processing groups:  36%|███▌      | 36/100 [01:15<01:54,  1.79s/it]Processing groups:  44%|████▍     | 44/100 [01:17<01:00,  1.08s/it]Processing groups:  45%|████▌     | 45/100 [01:17<00:55,  1.01s/it]Processing groups:  48%|████▊     | 48/100 [01:21<00:56,  1.09s/it]Processing groups:  61%|██████    | 61/100 [01:21<00:17,  2.22it/s]Processing groups:  63%|██████▎   | 63/100 [01:22<00:15,  2.35it/s]Processing groups:  63%|██████▎   | 63/100 [01:33<00:15,  2.35it/s]Processing groups:  65%|██████▌   | 65/100 [01:46<01:14,  2.13s/it]Processing groups:  67%|██████▋   | 67/100 [01:50<01:08,  2.09s/it]Processing groups:  70%|███████   | 70/100 [01:51<00:49,  1.65s/it]Processing groups:  71%|███████   | 71/100 [01:52<00:42,  1.47s/it]Processing groups:  73%|███████▎  | 73/100 [01:53<00:35,  1.30s/it]Processing groups:  77%|███████▋  | 77/100 [01:54<00:20,  1.13it/s]Processing groups:  78%|███████▊  | 78/100 [01:55<00:18,  1.22it/s]Processing groups:  81%|████████  | 81/100 [01:55<00:11,  1.60it/s]Processing groups:  85%|████████▌ | 85/100 [01:56<00:05,  2.60it/s]Processing groups:  90%|█████████ | 90/100 [01:56<00:02,  4.15it/s]Processing groups:  97%|█████████▋| 97/100 [01:59<00:00,  3.16it/s]Processing groups:  99%|█████████▉| 99/100 [01:59<00:00,  3.51it/s]Processing groups: 100%|██████████| 100/100 [01:59<00:00,  1.19s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.42, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 3200, 'differ_params': 1}

Processing n_controls: 8

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.93s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 11861.72it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:18:39, 47.67s/it]Processing groups:   3%|▎         | 3/100 [00:49<21:15, 13.15s/it]  Processing groups:   6%|▌         | 6/100 [00:50<08:15,  5.28s/it]Processing groups:  10%|█         | 10/100 [00:54<04:22,  2.91s/it]Processing groups:  16%|█▌        | 16/100 [00:54<01:57,  1.40s/it]Processing groups:  33%|███▎      | 33/100 [01:33<02:12,  1.98s/it]Processing groups:  36%|███▌      | 36/100 [01:34<01:53,  1.77s/it]Processing groups:  37%|███▋      | 37/100 [01:37<01:55,  1.83s/it]Processing groups:  40%|████      | 40/100 [01:39<01:33,  1.55s/it]Processing groups:  44%|████▍     | 44/100 [01:40<01:06,  1.19s/it]Processing groups:  48%|████▊     | 48/100 [01:40<00:44,  1.18it/s]Processing groups:  52%|█████▏    | 52/100 [01:42<00:36,  1.31it/s]Processing groups:  55%|█████▌    | 55/100 [01:44<00:33,  1.36it/s]Processing groups:  63%|██████▎   | 63/100 [01:45<00:15,  2.39it/s]Processing groups:  64%|██████▍   | 64/100 [01:46<00:16,  2.20it/s]Processing groups:  65%|██████▌   | 65/100 [02:19<02:12,  3.78s/it]Processing groups:  66%|██████▌   | 66/100 [02:21<02:01,  3.58s/it]Processing groups:  67%|██████▋   | 67/100 [02:25<01:59,  3.62s/it]Processing groups:  69%|██████▉   | 69/100 [02:25<01:20,  2.58s/it]Processing groups:  75%|███████▌  | 75/100 [02:28<00:33,  1.33s/it]Processing groups:  76%|███████▌  | 76/100 [02:28<00:28,  1.19s/it]Processing groups:  79%|███████▉  | 79/100 [02:29<00:19,  1.10it/s]Processing groups:  82%|████████▏ | 82/100 [02:29<00:12,  1.50it/s]Processing groups:  91%|█████████ | 91/100 [02:30<00:02,  3.44it/s]Processing groups:  94%|█████████▍| 94/100 [02:30<00:01,  4.03it/s]Processing groups:  97%|█████████▋| 97/100 [02:33<00:01,  2.14it/s]Processing groups:  99%|█████████▉| 99/100 [02:34<00:00,  2.35it/s]Processing groups: 100%|██████████| 100/100 [02:34<00:00,  1.54s/it]
{'replicate_reproducibility': 0.015, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.09, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.95s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 6378.01it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:17:32, 46.99s/it]Processing groups:   2%|▏         | 2/100 [00:51<35:38, 21.82s/it]  Processing groups:   8%|▊         | 8/100 [00:53<05:56,  3.88s/it]Processing groups:  17%|█▋        | 17/100 [00:54<02:03,  1.49s/it]Processing groups:  27%|██▋       | 27/100 [00:54<00:55,  1.32it/s]Processing groups:  27%|██▋       | 27/100 [01:10<00:55,  1.32it/s]Processing groups:  33%|███▎      | 33/100 [01:34<02:50,  2.55s/it]Processing groups:  34%|███▍      | 34/100 [01:36<02:41,  2.45s/it]Processing groups:  35%|███▌      | 35/100 [01:37<02:34,  2.38s/it]Processing groups:  37%|███▋      | 37/100 [01:39<02:09,  2.06s/it]Processing groups:  43%|████▎     | 43/100 [01:41<01:12,  1.28s/it]Processing groups:  48%|████▊     | 48/100 [01:42<00:46,  1.12it/s]Processing groups:  50%|█████     | 50/100 [01:45<00:49,  1.01it/s]Processing groups:  59%|█████▉    | 59/100 [01:47<00:23,  1.74it/s]Processing groups:  65%|██████▌   | 65/100 [02:22<01:20,  2.31s/it]Processing groups:  66%|██████▌   | 66/100 [02:25<01:20,  2.37s/it]Processing groups:  67%|██████▋   | 67/100 [02:27<01:17,  2.34s/it]Processing groups:  73%|███████▎  | 73/100 [02:28<00:38,  1.43s/it]Processing groups:  86%|████████▌ | 86/100 [02:29<00:08,  1.61it/s]Processing groups:  88%|████████▊ | 88/100 [02:30<00:07,  1.70it/s]Processing groups:  90%|█████████ | 90/100 [02:30<00:05,  1.94it/s]Processing groups:  95%|█████████▌| 95/100 [02:30<00:01,  2.75it/s]Processing groups:  97%|█████████▋| 97/100 [02:34<00:01,  1.55it/s]Processing groups:  98%|█████████▊| 98/100 [02:35<00:01,  1.65it/s]Processing groups: 100%|██████████| 100/100 [02:35<00:00,  1.55s/it]
{'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.07, 'mean_ap': 0.0, 'mean_ap_p_value': 0.36, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.32s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 7966.54it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:50<1:23:14, 50.45s/it]Processing groups:   5%|▌         | 5/100 [00:52<12:40,  8.00s/it]  Processing groups:  18%|█▊        | 18/100 [00:53<02:16,  1.67s/it]Processing groups:  19%|█▉        | 19/100 [00:54<02:09,  1.59s/it]Processing groups:  33%|███▎      | 33/100 [01:39<02:53,  2.58s/it]Processing groups:  39%|███▉      | 39/100 [01:39<01:56,  1.91s/it]Processing groups:  42%|████▏     | 42/100 [01:42<01:42,  1.76s/it]Processing groups:  49%|████▉     | 49/100 [01:43<01:00,  1.18s/it]Processing groups:  54%|█████▍    | 54/100 [01:45<00:43,  1.05it/s]Processing groups:  63%|██████▎   | 63/100 [01:46<00:22,  1.66it/s]Processing groups:  65%|██████▌   | 65/100 [02:22<01:30,  2.59s/it]Processing groups:  67%|██████▋   | 67/100 [02:25<01:22,  2.49s/it]Processing groups:  68%|██████▊   | 68/100 [02:28<01:19,  2.48s/it]Processing groups:  77%|███████▋  | 77/100 [02:28<00:26,  1.15s/it]Processing groups:  79%|███████▉  | 79/100 [02:28<00:21,  1.00s/it]Processing groups:  82%|████████▏ | 82/100 [02:29<00:15,  1.17it/s]Processing groups:  86%|████████▌ | 86/100 [02:30<00:08,  1.63it/s]Processing groups:  95%|█████████▌| 95/100 [02:30<00:01,  3.06it/s]Processing groups:  97%|█████████▋| 97/100 [02:34<00:01,  1.81it/s]Processing groups:  99%|█████████▉| 99/100 [02:34<00:00,  2.07it/s]Processing groups: 100%|██████████| 100/100 [02:34<00:00,  1.55s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.08, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.92s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8366.19it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:46<1:16:51, 46.58s/it]Processing groups:   2%|▏         | 2/100 [00:47<32:21, 19.81s/it]  Processing groups:   3%|▎         | 3/100 [00:48<18:14, 11.28s/it]Processing groups:   6%|▌         | 6/100 [00:50<06:25,  4.10s/it]Processing groups:   9%|▉         | 9/100 [00:51<03:33,  2.35s/it]Processing groups:  13%|█▎        | 13/100 [00:53<02:04,  1.43s/it]Processing groups:  28%|██▊       | 28/100 [00:54<00:31,  2.25it/s]Processing groups:  33%|███▎      | 33/100 [01:37<02:48,  2.52s/it]Processing groups:  38%|███▊      | 38/100 [01:38<01:57,  1.90s/it]Processing groups:  39%|███▉      | 39/100 [01:38<01:48,  1.78s/it]Processing groups:  43%|████▎     | 43/100 [01:41<01:23,  1.46s/it]Processing groups:  44%|████▍     | 44/100 [01:41<01:18,  1.39s/it]Processing groups:  46%|████▌     | 46/100 [01:42<01:01,  1.14s/it]Processing groups:  55%|█████▌    | 55/100 [01:43<00:26,  1.69it/s]Processing groups:  58%|█████▊    | 58/100 [01:44<00:20,  2.03it/s]Processing groups:  61%|██████    | 61/100 [01:45<00:17,  2.20it/s]Processing groups:  64%|██████▍   | 64/100 [01:46<00:17,  2.11it/s]Processing groups:  65%|██████▌   | 65/100 [02:22<02:28,  4.25s/it]Processing groups:  66%|██████▌   | 66/100 [02:24<02:11,  3.88s/it]Processing groups:  67%|██████▋   | 67/100 [02:27<02:05,  3.80s/it]Processing groups:  71%|███████   | 71/100 [02:27<00:58,  2.02s/it]Processing groups:  72%|███████▏  | 72/100 [02:28<00:51,  1.84s/it]Processing groups:  76%|███████▌  | 76/100 [02:29<00:25,  1.08s/it]Processing groups:  83%|████████▎ | 83/100 [02:29<00:09,  1.88it/s]Processing groups:  86%|████████▌ | 86/100 [02:30<00:07,  1.98it/s]Processing groups:  95%|█████████▌| 95/100 [02:31<00:01,  3.79it/s]Processing groups:  97%|█████████▋| 97/100 [02:35<00:01,  1.91it/s]Processing groups:  99%|█████████▉| 99/100 [02:35<00:00,  2.23it/s]Processing groups: 100%|██████████| 100/100 [02:35<00:00,  1.55s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.21s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 7651.61it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:18:49, 47.77s/it]Processing groups:   4%|▍         | 4/100 [00:48<14:37,  9.14s/it]  Processing groups:   6%|▌         | 6/100 [00:49<08:22,  5.35s/it]Processing groups:   7%|▋         | 7/100 [00:50<06:41,  4.32s/it]Processing groups:   8%|▊         | 8/100 [00:52<05:44,  3.74s/it]Processing groups:  18%|█▊        | 18/100 [00:54<01:23,  1.02s/it]Processing groups:  33%|███▎      | 33/100 [01:30<02:05,  1.88s/it]Processing groups:  34%|███▍      | 34/100 [01:35<02:14,  2.04s/it]Processing groups:  37%|███▋      | 37/100 [01:37<01:51,  1.78s/it]Processing groups:  40%|████      | 40/100 [01:37<01:24,  1.40s/it]Processing groups:  41%|████      | 41/100 [01:37<01:15,  1.29s/it]Processing groups:  42%|████▏     | 42/100 [01:38<01:12,  1.25s/it]Processing groups:  44%|████▍     | 44/100 [01:40<01:07,  1.20s/it]Processing groups:  53%|█████▎    | 53/100 [01:41<00:23,  2.03it/s]Processing groups:  54%|█████▍    | 54/100 [01:42<00:25,  1.80it/s]Processing groups:  56%|█████▌    | 56/100 [01:44<00:27,  1.62it/s]Processing groups:  62%|██████▏   | 62/100 [01:45<00:15,  2.49it/s]Processing groups:  64%|██████▍   | 64/100 [01:47<00:17,  2.00it/s]Processing groups:  65%|██████▌   | 65/100 [02:19<02:24,  4.12s/it]Processing groups:  66%|██████▌   | 66/100 [02:23<02:23,  4.22s/it]Processing groups:  67%|██████▋   | 67/100 [02:25<02:04,  3.78s/it]Processing groups:  69%|██████▉   | 69/100 [02:26<01:26,  2.79s/it]Processing groups:  70%|███████   | 70/100 [02:27<01:11,  2.40s/it]Processing groups:  74%|███████▍  | 74/100 [02:28<00:32,  1.24s/it]Processing groups:  84%|████████▍ | 84/100 [02:29<00:08,  1.99it/s]Processing groups:  92%|█████████▏| 92/100 [02:29<00:02,  3.39it/s]Processing groups:  95%|█████████▌| 95/100 [02:29<00:01,  3.69it/s]Processing groups:  97%|█████████▋| 97/100 [02:33<00:01,  1.94it/s]Processing groups:  99%|█████████▉| 99/100 [02:34<00:00,  2.16it/s]Processing groups: 100%|██████████| 100/100 [02:34<00:00,  1.54s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.28, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.79s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8825.47it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:48<1:20:50, 48.99s/it]Processing groups:   3%|▎         | 3/100 [00:49<21:06, 13.06s/it]  Processing groups:   4%|▍         | 4/100 [00:53<15:31,  9.70s/it]Processing groups:  33%|███▎      | 33/100 [01:36<02:15,  2.03s/it]Processing groups:  34%|███▍      | 34/100 [01:37<02:11,  1.99s/it]Processing groups:  35%|███▌      | 35/100 [01:39<02:09,  1.99s/it]Processing groups:  46%|████▌     | 46/100 [01:40<00:57,  1.07s/it]Processing groups:  47%|████▋     | 47/100 [01:43<01:02,  1.18s/it]Processing groups:  63%|██████▎   | 63/100 [01:46<00:22,  1.67it/s]Processing groups:  64%|██████▍   | 64/100 [01:46<00:20,  1.74it/s]Processing groups:  65%|██████▌   | 65/100 [02:22<01:41,  2.91s/it]Processing groups:  66%|██████▌   | 66/100 [02:23<01:33,  2.74s/it]Processing groups:  67%|██████▋   | 67/100 [02:26<01:30,  2.74s/it]Processing groups:  71%|███████   | 71/100 [02:27<00:50,  1.75s/it]Processing groups:  72%|███████▏  | 72/100 [02:27<00:44,  1.58s/it]Processing groups:  73%|███████▎  | 73/100 [02:30<00:48,  1.78s/it]Processing groups:  91%|█████████ | 91/100 [02:30<00:03,  2.64it/s]Processing groups:  96%|█████████▌| 96/100 [02:30<00:01,  3.33it/s]Processing groups: 100%|██████████| 100/100 [02:35<00:00,  2.12it/s]Processing groups: 100%|██████████| 100/100 [02:35<00:00,  1.55s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.47, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:02<00:00,  2.20s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 12800

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8095.71it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [00:47<1:17:58, 47.26s/it]Processing groups:   2%|▏         | 2/100 [00:49<34:02, 20.84s/it]  Processing groups:   7%|▋         | 7/100 [00:51<06:34,  4.25s/it]Processing groups:   8%|▊         | 8/100 [00:51<05:28,  3.58s/it]Processing groups:  12%|█▏        | 12/100 [00:53<02:50,  1.94s/it]Processing groups:  24%|██▍       | 24/100 [00:54<00:48,  1.57it/s]Processing groups:  33%|███▎      | 33/100 [01:33<02:30,  2.24s/it]Processing groups:  35%|███▌      | 35/100 [01:34<02:09,  1.99s/it]Processing groups:  37%|███▋      | 37/100 [01:37<02:03,  1.97s/it]Processing groups:  41%|████      | 41/100 [01:41<01:36,  1.64s/it]Processing groups:  51%|█████     | 51/100 [01:44<00:47,  1.04it/s]Processing groups:  59%|█████▉    | 59/100 [01:44<00:26,  1.56it/s]Processing groups:  63%|██████▎   | 63/100 [01:45<00:19,  1.89it/s]Processing groups:  65%|██████▌   | 65/100 [02:21<01:37,  2.78s/it]Processing groups:  66%|██████▌   | 66/100 [02:24<01:36,  2.83s/it]Processing groups:  70%|███████   | 70/100 [02:27<01:04,  2.15s/it]Processing groups:  72%|███████▏  | 72/100 [02:28<00:52,  1.89s/it]Processing groups:  79%|███████▉  | 79/100 [02:29<00:21,  1.00s/it]Processing groups:  83%|████████▎ | 83/100 [02:30<00:13,  1.31it/s]Processing groups:  91%|█████████ | 91/100 [02:30<00:04,  2.24it/s]Processing groups:  97%|█████████▋| 97/100 [02:34<00:01,  1.90it/s]Processing groups: 100%|██████████| 100/100 [02:34<00:00,  1.55s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.63, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 3200, 'differ_params': 1}

Processing n_controls: 16

Processing differ_params: {'gaussian': (1, 1), 'lognormal': (0, 1), 'poisson': 3, 'nbinom': (1, 0.5)}

Processing features_differ: {'gaussian': 50, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.01)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  1.23it/s]100%|██████████| 2/2 [00:02<00:00,  1.61s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8366.52it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:07<1:50:38, 67.05s/it]Processing groups:   2%|▏         | 2/100 [01:11<49:27, 30.29s/it]  Processing groups:   6%|▌         | 6/100 [01:12<11:15,  7.18s/it]Processing groups:  10%|█         | 10/100 [01:12<05:09,  3.44s/it]Processing groups:  19%|█▉        | 19/100 [01:13<01:48,  1.35s/it]Processing groups:  22%|██▏       | 22/100 [01:14<01:26,  1.10s/it]Processing groups:  26%|██▌       | 26/100 [01:15<00:59,  1.24it/s]Processing groups:  33%|███▎      | 33/100 [02:20<05:02,  4.51s/it]Processing groups:  38%|███▊      | 38/100 [02:21<03:15,  3.15s/it]Processing groups:  42%|████▏     | 42/100 [02:21<02:18,  2.38s/it]Processing groups:  45%|████▌     | 45/100 [02:23<01:47,  1.96s/it]Processing groups:  47%|████▋     | 47/100 [02:24<01:30,  1.71s/it]Processing groups:  56%|█████▌    | 56/100 [02:25<00:39,  1.12it/s]Processing groups:  59%|█████▉    | 59/100 [02:26<00:31,  1.31it/s]Processing groups:  62%|██████▏   | 62/100 [02:26<00:22,  1.66it/s]Processing groups:  63%|██████▎   | 63/100 [02:27<00:23,  1.61it/s]Processing groups:  65%|██████▌   | 65/100 [03:27<04:04,  6.97s/it]Processing groups:  66%|██████▌   | 66/100 [03:30<03:36,  6.35s/it]Processing groups:  70%|███████   | 70/100 [03:30<01:49,  3.66s/it]Processing groups:  71%|███████   | 71/100 [03:30<01:32,  3.19s/it]Processing groups:  73%|███████▎  | 73/100 [03:31<01:06,  2.47s/it]Processing groups:  74%|███████▍  | 74/100 [03:32<00:54,  2.10s/it]Processing groups:  82%|████████▏ | 82/100 [03:32<00:13,  1.31it/s]Processing groups:  86%|████████▌ | 86/100 [03:32<00:07,  1.87it/s]Processing groups:  88%|████████▊ | 88/100 [03:32<00:05,  2.25it/s]Processing groups:  92%|█████████▏| 92/100 [03:32<00:02,  3.33it/s]Processing groups:  95%|█████████▌| 95/100 [03:33<00:01,  3.77it/s]Processing groups:  97%|█████████▋| 97/100 [03:40<00:02,  1.13it/s]Processing groups:  99%|█████████▉| 99/100 [03:40<00:00,  1.42it/s]Processing groups: 100%|██████████| 100/100 [03:40<00:00,  2.20s/it]
{'replicate_reproducibility': 0.01, 'mp_value': 0.16, 'mean_ap': 0.0, 'mean_ap_p_value': 0.1, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}

Processing features_differ: {'gaussian': 100, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.02)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  1.17it/s]100%|██████████| 2/2 [00:02<00:00,  1.60s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8445.70it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:07<1:51:30, 67.59s/it]Processing groups:   2%|▏         | 2/100 [01:12<50:04, 30.66s/it]  Processing groups:   3%|▎         | 3/100 [01:14<28:14, 17.47s/it]Processing groups:   8%|▊         | 8/100 [01:15<06:41,  4.36s/it]Processing groups:   9%|▉         | 9/100 [01:16<05:29,  3.62s/it]Processing groups:  33%|███▎      | 33/100 [02:14<02:54,  2.60s/it]Processing groups:  34%|███▍      | 34/100 [02:18<02:56,  2.67s/it]Processing groups:  35%|███▌      | 35/100 [02:19<02:47,  2.57s/it]Processing groups:  36%|███▌      | 36/100 [02:23<02:52,  2.69s/it]Processing groups:  44%|████▍     | 44/100 [02:24<01:20,  1.43s/it]Processing groups:  50%|█████     | 50/100 [02:26<00:52,  1.06s/it]Processing groups:  58%|█████▊    | 58/100 [02:27<00:28,  1.48it/s]Processing groups:  61%|██████    | 61/100 [02:28<00:24,  1.62it/s]Processing groups:  62%|██████▏   | 62/100 [02:29<00:24,  1.56it/s]Processing groups:  65%|██████▌   | 65/100 [03:24<02:57,  5.06s/it]Processing groups:  66%|██████▌   | 66/100 [03:32<03:02,  5.36s/it]Processing groups:  73%|███████▎  | 73/100 [03:34<01:12,  2.70s/it]Processing groups:  77%|███████▋  | 77/100 [03:34<00:44,  1.93s/it]Processing groups:  78%|███████▊  | 78/100 [03:34<00:39,  1.78s/it]Processing groups:  92%|█████████▏| 92/100 [03:35<00:05,  1.58it/s]Processing groups:  97%|█████████▋| 97/100 [03:41<00:02,  1.25it/s]Processing groups:  98%|█████████▊| 98/100 [03:41<00:01,  1.32it/s]Processing groups: 100%|██████████| 100/100 [03:41<00:00,  2.22s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 0.0, 'mean_ap_p_value': 0.42, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}

Processing features_differ: {'gaussian': 200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.04)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  1.00it/s]100%|██████████| 2/2 [00:03<00:00,  1.91s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 7855.38it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:08<1:52:42, 68.31s/it]Processing groups:   2%|▏         | 2/100 [01:13<51:09, 31.32s/it]  Processing groups:   7%|▋         | 7/100 [01:14<09:24,  6.07s/it]Processing groups:  10%|█         | 10/100 [01:15<05:46,  3.85s/it]Processing groups:  24%|██▍       | 24/100 [01:16<01:20,  1.06s/it]Processing groups:  24%|██▍       | 24/100 [01:35<01:20,  1.06s/it]Processing groups:  33%|███▎      | 33/100 [02:13<03:34,  3.20s/it]Processing groups:  34%|███▍      | 34/100 [02:16<03:29,  3.17s/it]Processing groups:  37%|███▋      | 37/100 [02:18<02:45,  2.62s/it]Processing groups:  41%|████      | 41/100 [02:19<01:58,  2.01s/it]Processing groups:  42%|████▏     | 42/100 [02:20<01:47,  1.86s/it]Processing groups:  44%|████▍     | 44/100 [02:22<01:36,  1.73s/it]Processing groups:  50%|█████     | 50/100 [02:23<00:50,  1.01s/it]Processing groups:  54%|█████▍    | 54/100 [02:25<00:36,  1.25it/s]Processing groups:  57%|█████▋    | 57/100 [02:26<00:30,  1.43it/s]Processing groups:  64%|██████▍   | 64/100 [02:30<00:23,  1.52it/s]Processing groups:  65%|██████▌   | 65/100 [03:22<02:56,  5.03s/it]Processing groups:  66%|██████▌   | 66/100 [03:24<02:38,  4.66s/it]Processing groups:  68%|██████▊   | 68/100 [03:27<02:03,  3.86s/it]Processing groups:  71%|███████   | 71/100 [03:27<01:17,  2.67s/it]Processing groups:  72%|███████▏  | 72/100 [03:28<01:05,  2.33s/it]Processing groups:  73%|███████▎  | 73/100 [03:30<01:01,  2.27s/it]Processing groups:  81%|████████  | 81/100 [03:31<00:16,  1.16it/s]Processing groups:  90%|█████████ | 90/100 [03:31<00:04,  2.25it/s]Processing groups:  96%|█████████▌| 96/100 [03:31<00:01,  3.18it/s]Processing groups:  98%|█████████▊| 98/100 [03:38<00:01,  1.42it/s]Processing groups: 100%|██████████| 100/100 [03:38<00:00,  2.18s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.52, 'mean_ap': 0.07, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}

Processing features_differ: {'gaussian': 400, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.08)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  1.20it/s]100%|██████████| 2/2 [00:02<00:00,  1.50s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8346.87it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:14<2:02:33, 74.28s/it]Processing groups:   2%|▏         | 2/100 [01:16<51:40, 31.64s/it]  Processing groups:   3%|▎         | 3/100 [01:17<28:34, 17.67s/it]Processing groups:  23%|██▎       | 23/100 [01:17<01:39,  1.29s/it]Processing groups:  23%|██▎       | 23/100 [01:31<01:39,  1.29s/it]Processing groups:  33%|███▎      | 33/100 [02:25<03:51,  3.46s/it]Processing groups:  35%|███▌      | 35/100 [02:25<03:23,  3.13s/it]Processing groups:  40%|████      | 40/100 [02:30<02:32,  2.54s/it]Processing groups:  50%|█████     | 50/100 [02:32<01:16,  1.52s/it]Processing groups:  65%|██████▌   | 65/100 [03:34<01:37,  2.79s/it]Processing groups:  68%|██████▊   | 68/100 [03:36<01:20,  2.51s/it]Processing groups:  69%|██████▉   | 69/100 [03:38<01:17,  2.49s/it]Processing groups:  72%|███████▏  | 72/100 [03:38<00:57,  2.05s/it]Processing groups:  75%|███████▌  | 75/100 [03:38<00:40,  1.63s/it]Processing groups:  86%|████████▌ | 86/100 [03:38<00:10,  1.29it/s]Processing groups:  89%|████████▉ | 89/100 [03:39<00:07,  1.52it/s]Processing groups:  96%|█████████▌| 96/100 [03:39<00:01,  2.33it/s]Processing groups:  99%|█████████▉| 99/100 [03:46<00:00,  1.23it/s]Processing groups: 100%|██████████| 100/100 [03:46<00:00,  2.27s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 0.97, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}

Processing features_differ: {'gaussian': 800, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.16)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:01<00:01,  1.00s/it]100%|██████████| 2/2 [00:03<00:00,  1.89s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8223.32it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:11<1:57:49, 71.41s/it]Processing groups:   2%|▏         | 2/100 [01:13<49:40, 30.41s/it]  Processing groups:   4%|▍         | 4/100 [01:14<18:59, 11.87s/it]Processing groups:  29%|██▉       | 29/100 [01:15<01:10,  1.00it/s]Processing groups:  29%|██▉       | 29/100 [01:26<01:10,  1.00it/s]Processing groups:  33%|███▎      | 33/100 [02:18<03:57,  3.55s/it]Processing groups:  35%|███▌      | 35/100 [02:19<03:29,  3.23s/it]Processing groups:  37%|███▋      | 37/100 [02:22<03:09,  3.00s/it]Processing groups:  45%|████▌     | 45/100 [02:27<01:45,  1.93s/it]Processing groups:  46%|████▌     | 46/100 [02:28<01:43,  1.92s/it]Processing groups:  60%|██████    | 60/100 [02:32<00:37,  1.08it/s]Processing groups:  65%|██████▌   | 65/100 [03:29<01:58,  3.37s/it]Processing groups:  66%|██████▌   | 66/100 [03:29<01:48,  3.18s/it]Processing groups:  67%|██████▋   | 67/100 [03:32<01:44,  3.16s/it]Processing groups:  68%|██████▊   | 68/100 [03:33<01:32,  2.89s/it]Processing groups:  71%|███████   | 71/100 [03:34<01:01,  2.11s/it]Processing groups:  72%|███████▏  | 72/100 [03:36<00:59,  2.12s/it]Processing groups:  78%|███████▊  | 78/100 [03:36<00:22,  1.03s/it]Processing groups:  80%|████████  | 80/100 [03:37<00:17,  1.16it/s]Processing groups:  86%|████████▌ | 86/100 [03:37<00:06,  2.06it/s]Processing groups:  95%|█████████▌| 95/100 [03:38<00:01,  3.64it/s]Processing groups:  97%|█████████▋| 97/100 [03:44<00:02,  1.45it/s]Processing groups:  98%|█████████▊| 98/100 [03:44<00:01,  1.56it/s]Processing groups: 100%|██████████| 100/100 [03:44<00:00,  2.25s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}

Processing features_differ: {'gaussian': 1600, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.32)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  1.16it/s]100%|██████████| 2/2 [00:03<00:00,  1.67s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 8660.55it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:08<1:52:49, 68.38s/it]Processing groups:   2%|▏         | 2/100 [01:13<51:15, 31.38s/it]  Processing groups:   7%|▋         | 7/100 [01:17<10:21,  6.68s/it]Processing groups:  27%|██▋       | 27/100 [01:17<01:27,  1.19s/it]Processing groups:  27%|██▋       | 27/100 [01:35<01:27,  1.19s/it]Processing groups:  33%|███▎      | 33/100 [02:19<03:58,  3.56s/it]Processing groups:  34%|███▍      | 34/100 [02:22<03:52,  3.52s/it]Processing groups:  39%|███▉      | 39/100 [02:24<02:37,  2.58s/it]Processing groups:  43%|████▎     | 43/100 [02:24<01:53,  1.99s/it]Processing groups:  46%|████▌     | 46/100 [02:28<01:38,  1.82s/it]Processing groups:  60%|██████    | 60/100 [02:29<00:31,  1.25it/s]Processing groups:  63%|██████▎   | 63/100 [02:31<00:27,  1.33it/s]Processing groups:  63%|██████▎   | 63/100 [02:45<00:27,  1.33it/s]Processing groups:  65%|██████▌   | 65/100 [03:34<02:42,  4.65s/it]Processing groups:  68%|██████▊   | 68/100 [03:35<02:00,  3.78s/it]Processing groups:  70%|███████   | 70/100 [03:36<01:35,  3.19s/it]Processing groups:  74%|███████▍  | 74/100 [03:37<00:57,  2.22s/it]Processing groups:  81%|████████  | 81/100 [03:37<00:23,  1.24s/it]Processing groups:  84%|████████▍ | 84/100 [03:37<00:15,  1.01it/s]Processing groups:  97%|█████████▋| 97/100 [03:44<00:02,  1.37it/s]Processing groups:  98%|█████████▊| 98/100 [03:45<00:01,  1.41it/s]Processing groups: 100%|██████████| 100/100 [03:45<00:00,  2.25s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}

Processing features_differ: {'gaussian': 3200, 'lognormal': 0, 'poisson': 0, 'nbinom': 0} of 5000 (0.64)

Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:01<00:01,  1.00s/it]100%|██████████| 2/2 [00:03<00:00,  2.06s/it]                                             /dgx1nas1/storage/data/akalinin/projects/copairs/src/copairs/compute.py:105: RuntimeWarning: invalid value encountered in divide
  ap_scores = np.add.reduceat(pr_k * rel_k_list, cutoffs) / num_pos

Calculating metric: replicate_reproducibility

Calculating metric: mean_ap
  0%|          | 0/2 [00:00<?, ?it/s]                                     
Calculating distances.
Pos pairs size: 600, Neg pairs size: 25600

Calculating metric: mp_value
Calculating mp-values:   0%|          | 0/100 [00:00<?, ?it/s]Calculating mp-values: 100%|██████████| 100/100 [00:00<00:00, 6688.52it/s]
Processing groups:   0%|          | 0/100 [00:00<?, ?it/s]Processing groups:   1%|          | 1/100 [01:09<1:54:58, 69.68s/it]Processing groups:   4%|▍         | 4/100 [01:12<22:14, 13.90s/it]  Processing groups:  12%|█▏        | 12/100 [01:14<05:19,  3.63s/it]Processing groups:  13%|█▎        | 13/100 [01:15<04:43,  3.26s/it]Processing groups:  33%|███▎      | 33/100 [02:20<03:37,  3.24s/it]Processing groups:  36%|███▌      | 36/100 [02:25<03:13,  3.03s/it]Processing groups:  44%|████▍     | 44/100 [02:25<01:51,  1.99s/it]Processing groups:  45%|████▌     | 45/100 [02:27<01:48,  1.98s/it]Processing groups:  47%|████▋     | 47/100 [02:27<01:30,  1.71s/it]Processing groups:  62%|██████▏   | 62/100 [02:29<00:28,  1.36it/s]Processing groups:  64%|██████▍   | 64/100 [02:31<00:27,  1.29it/s]Processing groups:  65%|██████▌   | 65/100 [03:33<02:55,  5.02s/it]Processing groups:  67%|██████▋   | 67/100 [03:34<02:20,  4.26s/it]Processing groups:  68%|██████▊   | 68/100 [03:36<02:06,  3.96s/it]Processing groups:  71%|███████   | 71/100 [03:36<01:19,  2.75s/it]Processing groups:  73%|███████▎  | 73/100 [03:37<01:01,  2.27s/it]Processing groups:  82%|████████▏ | 82/100 [03:37<00:16,  1.08it/s]Processing groups:  85%|████████▌ | 85/100 [03:38<00:11,  1.32it/s]Processing groups:  94%|█████████▍| 94/100 [03:38<00:02,  2.43it/s]Processing groups:  96%|█████████▌| 96/100 [03:39<00:01,  2.64it/s]Processing groups:  98%|█████████▊| 98/100 [03:45<00:01,  1.15it/s]Processing groups: 100%|██████████| 100/100 [03:45<00:00,  2.26s/it]
{'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 3200, 'differ_params': 1}
[{'replicate_reproducibility': 0.01, 'mp_value': 0.03, 'mean_ap': 0.14, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.04, 'mp_value': 0.06, 'mean_ap': 0.12, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.02, 'mean_ap': 0.11, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.04, 'mp_value': 0.1, 'mean_ap': 0.13, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.3, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.24, 'mean_ap': 0.7, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 0.95, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.09, 'mean_ap': 0.01, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.05, 'mp_value': 0.08, 'mean_ap': 0.01, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.03, 'mean_ap': 0.04, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.09, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.04, 'mean_ap': 0.18, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 0.67, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.53, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 2, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.11, 'mean_ap': 0.01, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.04, 'mp_value': 0.01, 'mean_ap': 0.02, 'mean_ap_p_value': 0.06, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.13, 'mean_ap': 0.04, 'mean_ap_p_value': 0.08, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.06, 'mean_ap_p_value': 0.1, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.04, 'mean_ap': 0.17, 'mean_ap_p_value': 0.23, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.24, 'mean_ap': 0.57, 'mean_ap_p_value': 0.68, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.91, 'mean_ap': 0.96, 'mean_ap_p_value': 0.97, 'n_feats': 100, 'n_plates': 2, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.023333333333333334, 'mp_value': 0.16, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.04666666666666667, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.02, 'mean_ap': 0.0, 'mean_ap_p_value': 0.06, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.07, 'mean_ap': 0.02, 'mean_ap_p_value': 0.27, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 0.43, 'mean_ap_p_value': 0.92, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.43, 'mean_ap': 0.89, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 3, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.05, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.04, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.07, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.06, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.42, 'mean_ap': 0.01, 'mean_ap_p_value': 0.35, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.29, 'mean_ap': 0.18, 'mean_ap_p_value': 0.81, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 0.96, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 3, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.07, 'mp_value': 0.08, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.02, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.023333333333333334, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.49, 'mean_ap': 0.0, 'mean_ap_p_value': 0.15, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.35, 'mean_ap': 0.03, 'mean_ap_p_value': 0.41, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.95, 'mean_ap': 0.22, 'mean_ap_p_value': 0.95, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 0.95, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 3, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.041666666666666664, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.025, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.12, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.18, 'mean_ap': 0.01, 'mean_ap_p_value': 0.31, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 0.23, 'mean_ap_p_value': 0.94, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.19, 'mean_ap': 0.69, 'mean_ap_p_value': 0.99, 'n_feats': 100, 'n_plates': 4, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.06, 'mp_value': 0.02, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.04, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.14, 'mean_ap': 0.0, 'mean_ap_p_value': 0.08, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.34, 'mean_ap': 0.01, 'mean_ap_p_value': 0.4, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.63, 'mean_ap': 0.09, 'mean_ap_p_value': 0.96, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.97, 'mean_ap': 0.73, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.04666666666666667, 'mp_value': 0.01, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 1, 'differ_params': 1}, {'replicate_reproducibility': 0.03666666666666667, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.028333333333333332, 'mp_value': 0.22, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.011666666666666667, 'mp_value': 0.08, 'mean_ap': 0.0, 'mean_ap_p_value': 0.1, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.82, 'mean_ap': 0.0, 'mean_ap_p_value': 0.55, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 0.06, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 0.72, 'mean_ap_p_value': 1.0, 'n_feats': 100, 'n_plates': 4, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.06, 'mp_value': 0.01, 'mean_ap': 0.04, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.0, 'mean_ap': 0.13, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.03, 'mean_ap': 0.12, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.0, 'mean_ap': 0.19, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.03, 'mean_ap': 0.55, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.27, 'mean_ap': 0.92, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 4, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.05, 'mp_value': 0.02, 'mean_ap': 0.02, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.04, 'mean_ap': 0.03, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.07, 'mean_ap': 0.07, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.25, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.36, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.95, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.57, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 8, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.05, 'mean_ap': 0.03, 'mean_ap_p_value': 0.03, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.08, 'mean_ap': 0.02, 'mean_ap_p_value': 0.05, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.18, 'mean_ap': 0.04, 'mean_ap_p_value': 0.05, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 0.13, 'mean_ap_p_value': 0.22, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.23, 'mean_ap': 0.39, 'mean_ap_p_value': 0.56, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.31, 'mean_ap': 0.83, 'mean_ap_p_value': 0.91, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.84, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 2, 'n_controls': 16, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.09, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.03, 'mean_ap_p_value': 0.22, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.12, 'mean_ap_p_value': 0.55, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.5, 'mean_ap': 0.85, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 4, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.03666666666666667, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.07, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.13, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 0.11, 'mean_ap_p_value': 0.71, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.56, 'mean_ap': 0.62, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.45, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 8, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.04666666666666667, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.25, 'mean_ap': 0.0, 'mean_ap_p_value': 0.09, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 0.01, 'mean_ap_p_value': 0.25, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.68, 'mean_ap': 0.05, 'mean_ap_p_value': 0.76, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.91, 'mean_ap': 0.66, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 3, 'n_controls': 16, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.025, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.03166666666666667, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.008333333333333333, 'mp_value': 0.15, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.15, 'mean_ap': 0.0, 'mean_ap_p_value': 0.23, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 0.02, 'mean_ap_p_value': 0.79, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.29, 'mean_ap': 0.67, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.49, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 4, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.041666666666666664, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.025, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.12, 'mean_ap': 0.0, 'mean_ap_p_value': 0.26, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.35, 'mean_ap': 0.0, 'mean_ap_p_value': 0.79, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.55, 'mean_ap': 0.55, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 8, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.028333333333333332, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 2, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.15, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 4, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.18, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 8, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.47, 'mean_ap': 0.0, 'mean_ap_p_value': 0.24, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 16, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.65, 'mean_ap': 0.0, 'mean_ap_p_value': 0.93, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 32, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.97, 'mean_ap': 0.22, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 64, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 200, 'n_plates': 4, 'n_controls': 16, 'features_differ': 128, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.1, 'mean_ap': 0.12, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.02, 'mean_ap': 0.18, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 0.21, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 0.45, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 0.89, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.02, 'mean_ap': 0.04, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.06, 'mean_ap': 0.11, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.07, 'mean_ap': 0.14, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.07, 'mean_ap': 0.35, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 0.84, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.15, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.21, 'mean_ap': 0.04, 'mean_ap_p_value': 0.07, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.02, 'mean_ap': 0.05, 'mean_ap_p_value': 0.08, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.1, 'mean_ap_p_value': 0.18, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.19, 'mean_ap': 0.29, 'mean_ap_p_value': 0.36, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.49, 'mean_ap': 0.76, 'mean_ap_p_value': 0.89, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.45, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.043333333333333335, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.07, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.28, 'mean_ap': 0.0, 'mean_ap_p_value': 0.11, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.03, 'mean_ap': 0.12, 'mean_ap_p_value': 0.49, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 0.57, 'mean_ap_p_value': 0.99, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.34, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.73, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.06, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.08, 'mean_ap': 0.01, 'mean_ap_p_value': 0.14, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.26, 'mean_ap': 0.05, 'mean_ap_p_value': 0.47, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 0.56, 'mean_ap_p_value': 0.98, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.9, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.03333333333333333, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.17, 'mean_ap': 0.0, 'mean_ap_p_value': 0.18, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.24, 'mean_ap': 0.03, 'mean_ap_p_value': 0.57, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.84, 'mean_ap': 0.44, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.08, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.025, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.008333333333333333, 'mp_value': 0.28, 'mean_ap': 0.0, 'mean_ap_p_value': 0.11, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.03, 'mean_ap_p_value': 0.72, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.33, 'mean_ap': 0.36, 'mean_ap_p_value': 0.99, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.6, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.78, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.015, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.005, 'mp_value': 0.12, 'mean_ap': 0.0, 'mean_ap_p_value': 0.14, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.61, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 0.14, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.8, 'mean_ap': 0.96, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.48, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.028333333333333332, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 5, 'differ_params': 1}, {'replicate_reproducibility': 0.011666666666666667, 'mp_value': 0.13, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.18, 'mean_ap': 0.0, 'mean_ap_p_value': 0.09, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.59, 'mean_ap': 0.0, 'mean_ap_p_value': 0.62, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.73, 'mean_ap': 0.14, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 0.97, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.07, 'mean_ap': 0.05, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.06, 'mean_ap': 0.19, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.04, 'mean_ap': 0.25, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.65, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.07, 'mean_ap': 0.99, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.37, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.08, 'mean_ap': 0.06, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 0.07, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.21, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.65, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 0.99, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.15, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.37, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.04, 'mp_value': 0.07, 'mean_ap': 0.02, 'mean_ap_p_value': 0.03, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.12, 'mean_ap': 0.05, 'mean_ap_p_value': 0.08, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.14, 'mean_ap': 0.17, 'mean_ap_p_value': 0.28, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.39, 'mean_ap': 0.52, 'mean_ap_p_value': 0.67, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.32, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.82, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.05, 'mp_value': 0.13, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.05, 'mean_ap': 0.01, 'mean_ap_p_value': 0.24, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.36, 'mean_ap_p_value': 0.83, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.29, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.31, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.02666666666666667, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.11, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.15, 'mean_ap': 0.01, 'mean_ap_p_value': 0.26, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.21, 'mean_ap_p_value': 0.87, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.16, 'mean_ap': 0.93, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.34, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.09, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.08, 'mean_ap': 0.01, 'mean_ap_p_value': 0.09, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.33, 'mean_ap': 0.0, 'mean_ap_p_value': 0.3, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.35, 'mean_ap': 0.12, 'mean_ap_p_value': 0.91, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.87, 'mean_ap': 0.88, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.01, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.011666666666666667, 'mp_value': 0.2, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.15, 'mean_ap': 0.0, 'mean_ap_p_value': 0.22, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 0.14, 'mean_ap_p_value': 0.9, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 0.89, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.5, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.78, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.03166666666666667, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.06, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.36, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.01, 'mean_ap_p_value': 0.96, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.84, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.97, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.01, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 10, 'differ_params': 1}, {'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 20, 'differ_params': 1}, {'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.24, 'mean_ap': 0.0, 'mean_ap_p_value': 0.35, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 40, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.82, 'mean_ap': 0.01, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 80, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 0.78, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 160, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 320, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 1000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 640, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.12, 'mean_ap': 0.19, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.0, 'mean_ap': 0.2, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.65, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.95, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.03, 'mp_value': 0.01, 'mean_ap': 0.06, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.01, 'mean_ap': 0.18, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.08, 'mean_ap': 0.48, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 0.94, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.21, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.29, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.04, 'mean_ap': 0.02, 'mean_ap_p_value': 0.07, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.13, 'mean_ap': 0.13, 'mean_ap_p_value': 0.21, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.34, 'mean_ap_p_value': 0.51, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 0.87, 'mean_ap_p_value': 0.93, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.86, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.96, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 2, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 0.02, 'mean_ap_p_value': 0.23, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 0.12, 'mean_ap_p_value': 0.63, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.02, 'mean_ap': 0.85, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.01, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.02, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.22, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 0.09, 'mean_ap_p_value': 0.71, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.72, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.52, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.74, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.07, 'mean_ap': 0.0, 'mean_ap_p_value': 0.06, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.14, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.47, 'mean_ap': 0.02, 'mean_ap_p_value': 0.75, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.46, 'mean_ap': 0.69, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.92, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 3, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.05, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 0.0, 'mean_ap_p_value': 0.19, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.17, 'mean_ap': 0.02, 'mean_ap_p_value': 0.75, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.69, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.18, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.66, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.04, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.1, 'mean_ap': 0.0, 'mean_ap_p_value': 0.14, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.01, 'mean_ap_p_value': 0.82, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.05, 'mean_ap': 0.67, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.26, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.23, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.72, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.016666666666666666, 'mp_value': 0.11, 'mean_ap': 0.0, 'mean_ap_p_value': 0.03, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 25, 'differ_params': 1}, {'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.21, 'mean_ap': 0.0, 'mean_ap_p_value': 0.25, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.53, 'mean_ap': 0.0, 'mean_ap_p_value': 0.89, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.94, 'mean_ap': 0.41, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.94, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 2500, 'n_plates': 4, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.07, 'mean_ap': 0.18, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.05, 'mean_ap': 0.44, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 0.83, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.0, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.06, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 4, 'features_differ': 3200, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.01, 'mean_ap': 0.11, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.03, 'mean_ap': 0.34, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.07, 'mean_ap': 0.72, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.09, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.43, 'mean_ap': 1.0, 'mean_ap_p_value': 0.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 8, 'features_differ': 3200, 'differ_params': 1}, {'replicate_reproducibility': 0.02, 'mp_value': 0.08, 'mean_ap': 0.05, 'mean_ap_p_value': 0.06, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 0.19, 'mean_ap_p_value': 0.32, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.19, 'mean_ap': 0.61, 'mean_ap_p_value': 0.75, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.46, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.51, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.98, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 2, 'n_controls': 16, 'features_differ': 3200, 'differ_params': 1}, {'replicate_reproducibility': 0.006666666666666667, 'mp_value': 0.01, 'mean_ap': 0.02, 'mean_ap_p_value': 0.14, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.0, 'mean_ap': 0.04, 'mean_ap_p_value': 0.32, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.1, 'mean_ap': 0.51, 'mean_ap_p_value': 0.92, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.12, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.04, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.04, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.18, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 4, 'features_differ': 3200, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.06, 'mean_ap': 0.0, 'mean_ap_p_value': 0.1, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 0.0, 'mean_ap_p_value': 0.34, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.19, 'mean_ap': 0.36, 'mean_ap_p_value': 0.9, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.22, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.2, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.54, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.89, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 8, 'features_differ': 3200, 'differ_params': 1}, {'replicate_reproducibility': 0.013333333333333334, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.1, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.12, 'mean_ap': 0.01, 'mean_ap_p_value': 0.36, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.38, 'mean_ap': 0.16, 'mean_ap_p_value': 0.94, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.75, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.86, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 3, 'n_controls': 16, 'features_differ': 3200, 'differ_params': 1}, {'replicate_reproducibility': 0.018333333333333333, 'mp_value': 0.08, 'mean_ap': 0.0, 'mean_ap_p_value': 0.05, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0033333333333333335, 'mp_value': 0.04, 'mean_ap': 0.0, 'mean_ap_p_value': 0.41, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 0.27, 'mean_ap_p_value': 0.99, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.11, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.41, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.42, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 4, 'features_differ': 3200, 'differ_params': 1}, {'replicate_reproducibility': 0.015, 'mp_value': 0.03, 'mean_ap': 0.0, 'mean_ap_p_value': 0.09, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0016666666666666668, 'mp_value': 0.07, 'mean_ap': 0.0, 'mean_ap_p_value': 0.36, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.14, 'mean_ap': 0.08, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.13, 'mean_ap': 0.98, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.28, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.47, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.63, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 8, 'features_differ': 3200, 'differ_params': 1}, {'replicate_reproducibility': 0.01, 'mp_value': 0.16, 'mean_ap': 0.0, 'mean_ap_p_value': 0.1, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 50, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.25, 'mean_ap': 0.0, 'mean_ap_p_value': 0.42, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 100, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.52, 'mean_ap': 0.07, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 200, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 0.97, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 400, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 0.99, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 800, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 1600, 'differ_params': 1}, {'replicate_reproducibility': 0.0, 'mp_value': 1.0, 'mean_ap': 1.0, 'mean_ap_p_value': 1.0, 'n_feats': 5000, 'n_plates': 4, 'n_controls': 16, 'features_differ': 3200, 'differ_params': 1}]
